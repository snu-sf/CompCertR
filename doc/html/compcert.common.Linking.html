
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module Linking</title>
<meta name="description" content="Documentation of Coq module Linking" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module Linking</h1>
<div class="coq">
<br/>
<div class="doc">Separate compilation and syntactic linking </div>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.lib.Coqlib.html">Coqlib</a></span> <span class="id"><a href="compcert.lib.Maps.html">Maps</a></span> <span class="id"><a href="compcert.common.Errors.html">Errors</a></span> <span class="id"><a href="compcert.common.AST.html">AST</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.lib.sflib.html">sflib</a></span>.<br/>
<br/>
<div class="doc">This file follows "approach A" from the paper
       "Lightweight Verification of Separate Compilation"
    by Kang, Kim, Hur, Dreyer and Vafeiadis, POPL 2016. </div>
<br/>
<br/>
<h1> Syntactic linking </h1>
<br/>
<div class="doc">A syntactic element <span class="bracket"><span class="id">A</span></span> supports syntactic linking if it is equipped with the following:
<ul>
<li>
 a partial binary operator <span class="bracket"><span class="id">link</span></span> that produces the result of linking two elements,
  or fails if they cannot be linked (e.g. two definitions that are incompatible);
</li>
<li>
 a preorder <span class="bracket"><span class="id">linkorder</span></span> with the meaning that <span class="bracket"><span class="id">linkorder</span> <span class="id">a1</span> <span class="id">a2</span></span> holds
  if <span class="bracket"><span class="id">a2</span></span> can be obtained by linking <span class="bracket"><span class="id">a1</span></span> with some other syntactic element.
</li>
</ul>
</div>
<br/>
<span class="kwd">Class</span> <span class="id"><a name="Linker">Linker</a></span> (<span class="id">A</span>: <span class="kwd">Type</span>) := {<br/>
&nbsp;&nbsp;<span class="id"><a name="link">link</a></span>: <span class="id"><a href="compcert.common.Linking.html#A">A</a></span> -&gt; <span class="id"><a href="compcert.common.Linking.html#A">A</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="compcert.common.Linking.html#A">A</a></span>;<br/>
&nbsp;&nbsp;<span class="id"><a name="linkorder">linkorder</a></span>: <span class="id"><a href="compcert.common.Linking.html#A">A</a></span> -&gt; <span class="id"><a href="compcert.common.Linking.html#A">A</a></span> -&gt; <span class="kwd">Prop</span>;<br/>
&nbsp;&nbsp;<span class="id"><a name="linkorder_refl">linkorder_refl</a></span>: <span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="compcert.common.Linking.html#linkorder">linkorder</a></span> <span class="id"><a href="compcert.common.Linking.html#x">x</a></span> <span class="id"><a href="compcert.common.Linking.html#x">x</a></span>;<br/>
&nbsp;&nbsp;<span class="id"><a name="linkorder_trans">linkorder_trans</a></span>: <span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span> <span class="id">z</span>, <span class="id"><a href="compcert.common.Linking.html#linkorder">linkorder</a></span> <span class="id"><a href="compcert.common.Linking.html#x">x</a></span> <span class="id"><a href="compcert.common.Linking.html#y">y</a></span> -&gt; <span class="id"><a href="compcert.common.Linking.html#linkorder">linkorder</a></span> <span class="id"><a href="compcert.common.Linking.html#y">y</a></span> <span class="id"><a href="compcert.common.Linking.html#z">z</a></span> -&gt; <span class="id"><a href="compcert.common.Linking.html#linkorder">linkorder</a></span> <span class="id"><a href="compcert.common.Linking.html#x">x</a></span> <span class="id"><a href="compcert.common.Linking.html#z">z</a></span>;<br/>
&nbsp;&nbsp;<span class="id"><a name="link_linkorder">link_linkorder</a></span>: <span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span> <span class="id">z</span>, <span class="id"><a href="compcert.common.Linking.html#link">link</a></span> <span class="id"><a href="compcert.common.Linking.html#x">x</a></span> <span class="id"><a href="compcert.common.Linking.html#y">y</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.common.Linking.html#z">z</a></span> -&gt; <span class="id"><a href="compcert.common.Linking.html#linkorder">linkorder</a></span> <span class="id"><a href="compcert.common.Linking.html#x">x</a></span> <span class="id"><a href="compcert.common.Linking.html#z">z</a></span> /\ <span class="id"><a href="compcert.common.Linking.html#linkorder">linkorder</a></span> <span class="id"><a href="compcert.common.Linking.html#y">y</a></span> <span class="id"><a href="compcert.common.Linking.html#z">z</a></span><br/>
}.<br/>
<br/>
<div class="doc">Linking function definitions.  External functions of the <span class="bracket"><span class="id">EF_external</span></span>
  kind can link with internal function definitions; the result of
  linking is the internal definition.  Two external functions can link
  if they are identical. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="link_fundef">link_fundef</a></span> {<span class="id">F</span>: <span class="kwd">Type</span>} (<span class="id">fd1</span> <span class="id">fd2</span>: <span class="id"><a href="compcert.common.AST.html#fundef">fundef</a></span> <span class="id"><a href="compcert.common.Linking.html#F">F</a></span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.common.Linking.html#fd1">fd1</a></span>, <span class="id"><a href="compcert.common.Linking.html#fd2">fd2</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.common.AST.html#Internal">Internal</a></span> <span class="id">_</span>, <span class="id"><a href="compcert.common.AST.html#Internal">Internal</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.common.AST.html#External">External</a></span> <span class="id">ef1</span>, <span class="id"><a href="compcert.common.AST.html#External">External</a></span> <span class="id">ef2</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">ef1</span>, <span class="id">ef2</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="compcert.common.AST.html#EF_external">EF_external</a></span> <span class="id">_</span> <span class="id">sg1</span>, <span class="id"><a href="compcert.common.AST.html#EF_external">EF_external</a></span> <span class="id">_</span> <span class="id">sg2</span> =&gt; <span class="kwd">if</span> <span class="id"><a href="compcert.common.AST.html#signature_eq">signature_eq</a></span> <span class="id">sg1</span> <span class="id">sg2</span> <span class="kwd">then</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="compcert.common.AST.html#External">External</a></span> <span class="id">ef1</span>) <span class="kwd">else</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="kwd">if</span> <span class="id"><a href="compcert.common.AST.html#external_function_eq">external_function_eq</a></span> <span class="id">ef1</span> <span class="id">ef2</span> <span class="kwd">then</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="compcert.common.AST.html#External">External</a></span> <span class="id">ef1</span>) <span class="kwd">else</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.common.AST.html#Internal">Internal</a></span> <span class="id">f</span>, <span class="id"><a href="compcert.common.AST.html#External">External</a></span> <span class="id">ef</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">ef</span> <span class="kwd">with</span> <span class="id"><a href="compcert.common.AST.html#EF_external">EF_external</a></span> <span class="id">id</span> <span class="id">sg</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="compcert.common.AST.html#Internal">Internal</a></span> <span class="id">f</span>) | <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> <span class="kwd">end</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.common.AST.html#External">External</a></span> <span class="id">ef</span>, <span class="id"><a href="compcert.common.AST.html#Internal">Internal</a></span> <span class="id">f</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">ef</span> <span class="kwd">with</span> <span class="id"><a href="compcert.common.AST.html#EF_external">EF_external</a></span> <span class="id">id</span> <span class="id">sg</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="compcert.common.AST.html#Internal">Internal</a></span> <span class="id">f</span>) | <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> <span class="kwd">end</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="linkorder_fundef">linkorder_fundef</a></span> {<span class="id">F</span>: <span class="kwd">Type</span>}: <span class="id"><a href="compcert.common.AST.html#fundef">fundef</a></span> <span class="id">F</span> -&gt; <span class="id"><a href="compcert.common.AST.html#fundef">fundef</a></span> <span class="id">F</span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="linkorder_fundef_refl">linkorder_fundef_refl</a></span>: <span class="kwd">forall</span> <span class="id">fd</span>, <span class="id"><a href="compcert.common.Linking.html#linkorder_fundef">linkorder_fundef</a></span> <span class="id"><a href="compcert.common.Linking.html#fd">fd</a></span> <span class="id"><a href="compcert.common.Linking.html#fd">fd</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="linkorder_fundef_ext_ext">linkorder_fundef_ext_ext</a></span>: <span class="kwd">forall</span> <span class="id">name0</span> <span class="id">name1</span> <span class="id">sg</span>, <span class="id"><a href="compcert.common.Linking.html#linkorder_fundef">linkorder_fundef</a></span> (<span class="id"><a href="compcert.common.AST.html#External">External</a></span> (<span class="id"><a href="compcert.common.AST.html#EF_external">EF_external</a></span> <span class="id"><a href="compcert.common.Linking.html#name0">name0</a></span> <span class="id"><a href="compcert.common.Linking.html#sg">sg</a></span>)) (<span class="id"><a href="compcert.common.AST.html#External">External</a></span> (<span class="id"><a href="compcert.common.AST.html#EF_external">EF_external</a></span> <span class="id"><a href="compcert.common.Linking.html#name1">name1</a></span> <span class="id"><a href="compcert.common.Linking.html#sg">sg</a></span>))<br/>
&nbsp;&nbsp;| <span class="id"><a name="linkorder_fundef_ext_int">linkorder_fundef_ext_int</a></span>: <span class="kwd">forall</span> <span class="id">f</span> <span class="id">id</span> <span class="id">sg</span>, <span class="id"><a href="compcert.common.Linking.html#linkorder_fundef">linkorder_fundef</a></span> (<span class="id"><a href="compcert.common.AST.html#External">External</a></span> (<span class="id"><a href="compcert.common.AST.html#EF_external">EF_external</a></span> <span class="id"><a href="compcert.common.Linking.html#id">id</a></span> <span class="id"><a href="compcert.common.Linking.html#sg">sg</a></span>)) (<span class="id"><a href="compcert.common.AST.html#Internal">Internal</a></span> <span class="id"><a href="compcert.common.Linking.html#f">f</a></span>).<br/>
<br/>
<span class="kwd">Program</span> <span class="kwd">Instance</span> <span class="id"><a name="Linker_fundef">Linker_fundef</a></span> (<span class="id">F</span>: <span class="kwd">Type</span>): <span class="id"><a href="compcert.common.Linking.html#Linker">Linker</a></span> (<span class="id"><a href="compcert.common.AST.html#fundef">fundef</a></span> <span class="id"><a href="compcert.common.Linking.html#F">F</a></span>) := {<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#link">link</a></span> := <span class="id"><a href="compcert.common.Linking.html#link_fundef">link_fundef</a></span>;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#linkorder">linkorder</a></span> := <span class="id"><a href="compcert.common.Linking.html#linkorder_fundef">linkorder_fundef</a></span><br/>
}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1225')">Next Obligation.</div>
<div class="proofscript" id="proof1225">
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
Defined.</div>
<div class="toggleproof" onclick="toggleDisplay('proof1226')">Next Obligation.</div>
<div class="proofscript" id="proof1226">
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>; <span class="id">inv</span> <span class="id">H0</span>; <span class="id">constructor</span>.<br/>
Defined.</div>
<div class="toggleproof" onclick="toggleDisplay('proof1227')">Next Obligation.</div>
<div class="proofscript" id="proof1227">
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">x</span>, <span class="id">y</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
+ <span class="tactic">discriminate</span>.<br/>
+ <span class="tactic">destruct</span> <span class="id">e</span>; <span class="id">inv</span> <span class="id">H</span>. <span class="tactic">split</span>; <span class="id">constructor</span>.<br/>
+ <span class="tactic">destruct</span> <span class="id">e</span>; <span class="id">inv</span> <span class="id">H</span>. <span class="tactic">split</span>; <span class="id">constructor</span>.<br/>
+ <span class="id">des_ifs</span>; <span class="id">esplits</span>; <span class="tactic">try</span> <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
Defined.</div>
<br/>
<span class="kwd">Global</span> <span class="id">Opaque</span> <span class="id"><a href="compcert.common.Linking.html#Linker_fundef">Linker_fundef</a></span>.<br/>
<br/>
<div class="doc">Linking variable initializers.  We adopt the following conventions:
<ul>
<li>
 an "extern" variable has an empty initialization list;
</li>
<li>
 a "common" variable has an initialization list of the form <span class="bracket"><span class="id">Init_space</span> <span class="id">sz</span></span>;
</li>
<li>
 all other initialization lists correspond to fully defined variables, neither "common" nor "extern".
</li>
</ul>
</div>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="init_class">init_class</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.common.AST.html#init_data">init_data</a></span> -&gt; <span class="kwd">Type</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="Init_extern">Init_extern</a></span>: <span class="id"><a href="compcert.common.Linking.html#init_class">init_class</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="Init_common">Init_common</a></span>: <span class="kwd">forall</span> <span class="id">sz</span>, <span class="id"><a href="compcert.common.Linking.html#init_class">init_class</a></span> (<span class="id"><a href="compcert.common.AST.html#Init_space">Init_space</a></span> <span class="id"><a href="compcert.common.Linking.html#sz">sz</a></span> :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="Init_definitive">Init_definitive</a></span>: <span class="kwd">forall</span> <span class="id">il</span>, <span class="id"><a href="compcert.common.Linking.html#init_class">init_class</a></span> <span class="id"><a href="compcert.common.Linking.html#il">il</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="classify_init">classify_init</a></span> (<span class="id">i</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.common.AST.html#init_data">init_data</a></span>) : <span class="id"><a href="compcert.common.Linking.html#init_class">init_class</a></span> <span class="id"><a href="compcert.common.Linking.html#i">i</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.common.Linking.html#i">i</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; <span class="id"><a href="compcert.common.Linking.html#Init_extern">Init_extern</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.common.AST.html#Init_space">Init_space</a></span> <span class="id">sz</span> :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; <span class="id"><a href="compcert.common.Linking.html#Init_common">Init_common</a></span> <span class="id">sz</span><br/>
&nbsp;&nbsp;| <span class="id">i</span> =&gt; <span class="id"><a href="compcert.common.Linking.html#Init_definitive">Init_definitive</a></span> <span class="id"><a href="compcert.common.Linking.html#i">i</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="link_varinit">link_varinit</a></span> (<span class="id">i1</span> <span class="id">i2</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.common.AST.html#init_data">init_data</a></span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.common.Linking.html#classify_init">classify_init</a></span> <span class="id"><a href="compcert.common.Linking.html#i1">i1</a></span>, <span class="id"><a href="compcert.common.Linking.html#classify_init">classify_init</a></span> <span class="id"><a href="compcert.common.Linking.html#i2">i2</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.common.Linking.html#Init_extern">Init_extern</a></span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.common.Linking.html#i2">i2</a></span><br/>
&nbsp;&nbsp;| <span class="id">_</span>, <span class="id"><a href="compcert.common.Linking.html#Init_extern">Init_extern</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.common.Linking.html#i1">i1</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.common.Linking.html#Init_common">Init_common</a></span> <span class="id">sz1</span>, <span class="id">_</span> =&gt; <span class="kwd">if</span> <span class="id"><a href="compcert.lib.Coqlib.html#zeq">zeq</a></span> <span class="id">sz1</span> (<span class="id"><a href="compcert.common.AST.html#init_data_list_size">init_data_list_size</a></span> <span class="id"><a href="compcert.common.Linking.html#i2">i2</a></span>) <span class="kwd">then</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.common.Linking.html#i2">i2</a></span> <span class="kwd">else</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;| <span class="id">_</span>, <span class="id"><a href="compcert.common.Linking.html#Init_common">Init_common</a></span> <span class="id">sz2</span> =&gt; <span class="kwd">if</span> <span class="id"><a href="compcert.lib.Coqlib.html#zeq">zeq</a></span> <span class="id">sz2</span> (<span class="id"><a href="compcert.common.AST.html#init_data_list_size">init_data_list_size</a></span> <span class="id"><a href="compcert.common.Linking.html#i1">i1</a></span>) <span class="kwd">then</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.common.Linking.html#i1">i1</a></span> <span class="kwd">else</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="linkorder_varinit">linkorder_varinit</a></span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.common.AST.html#init_data">init_data</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.common.AST.html#init_data">init_data</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="linkorder_varinit_refl">linkorder_varinit_refl</a></span>: <span class="kwd">forall</span> <span class="id">il</span>, <span class="id"><a href="compcert.common.Linking.html#linkorder_varinit">linkorder_varinit</a></span> <span class="id"><a href="compcert.common.Linking.html#il">il</a></span> <span class="id"><a href="compcert.common.Linking.html#il">il</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="linkorder_varinit_extern">linkorder_varinit_extern</a></span>: <span class="kwd">forall</span> <span class="id">il</span>, <span class="id"><a href="compcert.common.Linking.html#linkorder_varinit">linkorder_varinit</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id"><a href="compcert.common.Linking.html#il">il</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="linkorder_varinit_common">linkorder_varinit_common</a></span>: <span class="kwd">forall</span> <span class="id">sz</span> <span class="id">il</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#il">il</a></span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> -&gt; <span class="id"><a href="compcert.common.AST.html#init_data_list_size">init_data_list_size</a></span> <span class="id"><a href="compcert.common.Linking.html#il">il</a></span> = <span class="id"><a href="compcert.common.Linking.html#sz">sz</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#linkorder_varinit">linkorder_varinit</a></span> (<span class="id"><a href="compcert.common.AST.html#Init_space">Init_space</a></span> <span class="id"><a href="compcert.common.Linking.html#sz">sz</a></span> :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) <span class="id"><a href="compcert.common.Linking.html#il">il</a></span>.<br/>
<br/>
<span class="kwd">Program</span> <span class="kwd">Instance</span> <span class="id"><a name="Linker_varinit">Linker_varinit</a></span> : <span class="id"><a href="compcert.common.Linking.html#Linker">Linker</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.common.AST.html#init_data">init_data</a></span>) := {<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#link">link</a></span> := <span class="id"><a href="compcert.common.Linking.html#link_varinit">link_varinit</a></span>;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#linkorder">linkorder</a></span> := <span class="id"><a href="compcert.common.Linking.html#linkorder_varinit">linkorder_varinit</a></span><br/>
}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1228')">Next Obligation.</div>
<div class="proofscript" id="proof1228">
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
Defined.</div>
<div class="toggleproof" onclick="toggleDisplay('proof1229')">Next Obligation.</div>
<div class="proofscript" id="proof1229">
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>; <span class="id">inv</span> <span class="id">H0</span>; <span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">generalize</span> (<span class="id"><a href="compcert.common.AST.html#init_data_list_size_pos">init_data_list_size_pos</a></span> <span class="id">z</span>). <span class="id">xomega</span>.<br/>
Defined.</div>
<div class="toggleproof" onclick="toggleDisplay('proof1230')">Next Obligation.</div>
<div class="proofscript" id="proof1230">
&nbsp;&nbsp;<span class="id">revert</span> <span class="id">H</span>; <span class="tactic">unfold</span> <span class="id"><a href="compcert.common.Linking.html#link_varinit">link_varinit</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.Linking.html#classify_init">classify_init</a></span> <span class="id">x</span>) <span class="id">eqn</span>:<span class="id">Cx</span>, (<span class="id"><a href="compcert.common.Linking.html#classify_init">classify_init</a></span> <span class="id">y</span>) <span class="id">eqn</span>:<span class="id">Cy</span>; <span class="tactic">intros</span> <span class="id">E</span>; <span class="id">inv</span> <span class="id">E</span>; <span class="tactic">try</span> (<span class="tactic">split</span>; <span class="id">constructor</span>; <span class="tactic">fail</span>).<br/>
+ <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zeq">zeq</a></span> <span class="id">sz</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.max">Z.max</a></span> <span class="id">sz0</span> 0 + 0)); <span class="id">inv</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="id">constructor</span>. <span class="tactic">congruence</span>. <span class="tactic">auto</span>.<br/>
+ <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zeq">zeq</a></span> <span class="id">sz</span> (<span class="id"><a href="compcert.common.AST.html#init_data_list_size">init_data_list_size</a></span> <span class="id">il</span>)); <span class="id">inv</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="id">constructor</span>. <span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="tactic">subst</span> <span class="id">z</span>; <span class="tactic">discriminate</span>. <span class="tactic">auto</span>.<br/>
+ <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zeq">zeq</a></span> <span class="id">sz</span> (<span class="id"><a href="compcert.common.AST.html#init_data_list_size">init_data_list_size</a></span> <span class="id">il</span>)); <span class="id">inv</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="id">constructor</span>. <span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="tactic">subst</span> <span class="id">z</span>; <span class="tactic">discriminate</span>. <span class="tactic">auto</span>.<br/>
Defined.</div>
<br/>
<span class="kwd">Global</span> <span class="id">Opaque</span> <span class="id"><a href="compcert.common.Linking.html#Linker_varinit">Linker_varinit</a></span>.<br/>
<br/>
<div class="doc">Linking variable definitions. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="link_vardef">link_vardef</a></span> {<span class="id">V</span>: <span class="kwd">Type</span>} {<span class="id">LV</span>: <span class="id"><a href="compcert.common.Linking.html#Linker">Linker</a></span> <span class="id"><a href="compcert.common.Linking.html#V">V</a></span>} (<span class="id">v1</span> <span class="id">v2</span>: <span class="id"><a href="compcert.common.AST.html#globvar">globvar</a></span> <span class="id"><a href="compcert.common.Linking.html#V">V</a></span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.common.Linking.html#link">link</a></span> <span class="id"><a href="compcert.common.Linking.html#v1">v1</a></span>.(<span class="id"><a href="compcert.common.AST.html#gvar_info">gvar_info</a></span>) <span class="id"><a href="compcert.common.Linking.html#v2">v2</a></span>.(<span class="id"><a href="compcert.common.AST.html#gvar_info">gvar_info</a></span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">info</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.common.Linking.html#link">link</a></span> <span class="id"><a href="compcert.common.Linking.html#v1">v1</a></span>.(<span class="id"><a href="compcert.common.AST.html#gvar_init">gvar_init</a></span>) <span class="id"><a href="compcert.common.Linking.html#v2">v2</a></span>.(<span class="id"><a href="compcert.common.AST.html#gvar_init">gvar_init</a></span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">init</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Bool.Bool.html#eqb">eqb</a></span> <span class="id"><a href="compcert.common.Linking.html#v1">v1</a></span>.(<span class="id"><a href="compcert.common.AST.html#gvar_readonly">gvar_readonly</a></span>) <span class="id"><a href="compcert.common.Linking.html#v2">v2</a></span>.(<span class="id"><a href="compcert.common.AST.html#gvar_readonly">gvar_readonly</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp; <span class="id"><a href="http://coq.inria.fr/library/Coq.Bool.Bool.html#eqb">eqb</a></span> <span class="id"><a href="compcert.common.Linking.html#v1">v1</a></span>.(<span class="id"><a href="compcert.common.AST.html#gvar_volatile">gvar_volatile</a></span>) <span class="id"><a href="compcert.common.Linking.html#v2">v2</a></span>.(<span class="id"><a href="compcert.common.AST.html#gvar_volatile">gvar_volatile</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> {| <span class="id"><a href="compcert.common.AST.html#mkglobvar">gvar_info</a></span> := <span class="id">info</span>; <span class="id">gvar_init</span> := <span class="id">init</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">gvar_readonly</span> := <span class="id"><a href="compcert.common.Linking.html#v1">v1</a></span>.(<span class="id"><a href="compcert.common.AST.html#gvar_readonly">gvar_readonly</a></span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">gvar_volatile</span> := <span class="id"><a href="compcert.common.Linking.html#v1">v1</a></span>.(<span class="id"><a href="compcert.common.AST.html#gvar_volatile">gvar_volatile</a></span>) |}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="linkorder_vardef">linkorder_vardef</a></span> {<span class="id">V</span>: <span class="kwd">Type</span>} {<span class="id">LV</span>: <span class="id"><a href="compcert.common.Linking.html#Linker">Linker</a></span> <span class="id"><a href="compcert.common.Linking.html#V">V</a></span>}: <span class="id"><a href="compcert.common.AST.html#globvar">globvar</a></span> <span class="id">V</span> -&gt; <span class="id"><a href="compcert.common.AST.html#globvar">globvar</a></span> <span class="id">V</span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="linkorder_vardef_intro">linkorder_vardef_intro</a></span>: <span class="kwd">forall</span> <span class="id">info1</span> <span class="id">info2</span> <span class="id">i1</span> <span class="id">i2</span> <span class="id">ro</span> <span class="id">vo</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#linkorder">linkorder</a></span> <span class="id"><a href="compcert.common.Linking.html#info1">info1</a></span> <span class="id"><a href="compcert.common.Linking.html#info2">info2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#linkorder">linkorder</a></span> <span class="id"><a href="compcert.common.Linking.html#i1">i1</a></span> <span class="id"><a href="compcert.common.Linking.html#i2">i2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#linkorder_vardef">linkorder_vardef</a></span> (<span class="id"><a href="compcert.common.AST.html#mkglobvar">mkglobvar</a></span> <span class="id"><a href="compcert.common.Linking.html#info1">info1</a></span> <span class="id"><a href="compcert.common.Linking.html#i1">i1</a></span> <span class="id"><a href="compcert.common.Linking.html#ro">ro</a></span> <span class="id"><a href="compcert.common.Linking.html#vo">vo</a></span>) (<span class="id"><a href="compcert.common.AST.html#mkglobvar">mkglobvar</a></span> <span class="id"><a href="compcert.common.Linking.html#info2">info2</a></span> <span class="id"><a href="compcert.common.Linking.html#i2">i2</a></span> <span class="id"><a href="compcert.common.Linking.html#ro">ro</a></span> <span class="id"><a href="compcert.common.Linking.html#vo">vo</a></span>).<br/>
<br/>
<span class="kwd">Program</span> <span class="kwd">Instance</span> <span class="id"><a name="Linker_vardef">Linker_vardef</a></span> (<span class="id">V</span>: <span class="kwd">Type</span>) {<span class="id">LV</span>: <span class="id"><a href="compcert.common.Linking.html#Linker">Linker</a></span> <span class="id"><a href="compcert.common.Linking.html#V">V</a></span>}: <span class="id"><a href="compcert.common.Linking.html#Linker">Linker</a></span> (<span class="id"><a href="compcert.common.AST.html#globvar">globvar</a></span> <span class="id"><a href="compcert.common.Linking.html#V">V</a></span>) := {<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#link">link</a></span> := <span class="id"><a href="compcert.common.Linking.html#link_vardef">link_vardef</a></span>;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#linkorder">linkorder</a></span> := <span class="id"><a href="compcert.common.Linking.html#linkorder_vardef">linkorder_vardef</a></span><br/>
}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1231')">Next Obligation.</div>
<div class="proofscript" id="proof1231">
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">x</span>; <span class="id">constructor</span>; <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Linking.html#linkorder_refl">linkorder_refl</a></span>.<br/>
Defined.</div>
<div class="toggleproof" onclick="toggleDisplay('proof1232')">Next Obligation.</div>
<div class="proofscript" id="proof1232">
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>; <span class="id">inv</span> <span class="id">H0</span>. <span class="id">constructor</span>; <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Linking.html#linkorder_trans">linkorder_trans</a></span>; <span class="tactic">eauto</span>.<br/>
Defined.</div>
<div class="toggleproof" onclick="toggleDisplay('proof1233')">Next Obligation.</div>
<div class="proofscript" id="proof1233">
&nbsp;&nbsp;<span class="id">revert</span> <span class="id">H</span>; <span class="tactic">unfold</span> <span class="id"><a href="compcert.common.Linking.html#link_vardef">link_vardef</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">x</span> <span class="kwd">as</span> [<span class="id">f1</span> <span class="id">i1</span> <span class="id">r1</span> <span class="id">v1</span>], <span class="id">y</span> <span class="kwd">as</span> [<span class="id">f2</span> <span class="id">i2</span> <span class="id">r2</span> <span class="id">v2</span>]; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.Linking.html#link">link</a></span> <span class="id">f1</span> <span class="id">f2</span>) <span class="kwd">as</span> [<span class="id">f</span>|] <span class="id">eqn</span>:<span class="id">LF</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.Linking.html#link">link</a></span> <span class="id">i1</span> <span class="id">i2</span>) <span class="kwd">as</span> [<span class="id">i</span>|] <span class="id">eqn</span>:<span class="id">LI</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Bool.Bool.html#eqb">eqb</a></span> <span class="id">r1</span> <span class="id">r2</span>) <span class="id">eqn</span>:<span class="id">ER</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Bool.Bool.html#eqb">eqb</a></span> <span class="id">v1</span> <span class="id">v2</span>) <span class="id">eqn</span>:<span class="id">EV</span>; <span class="tactic">intros</span> <span class="id">EQ</span>; <span class="id">inv</span> <span class="id">EQ</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Bool.Bool.html#eqb_prop">eqb_prop</a></span> <span class="kwd">in</span> <span class="id">ER</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Bool.Bool.html#eqb_prop">eqb_prop</a></span> <span class="kwd">in</span> <span class="id">EV</span>; <span class="tactic">subst</span> <span class="id">r2</span> <span class="id">v2</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Linking.html#link_linkorder">link_linkorder</a></span> <span class="kwd">in</span> <span class="id">LF</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Linking.html#link_linkorder">link_linkorder</a></span> <span class="kwd">in</span> <span class="id">LI</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="id">constructor</span>; <span class="tactic">tauto</span>.<br/>
Defined.</div>
<br/>
<span class="kwd">Global</span> <span class="id">Opaque</span> <span class="id"><a href="compcert.common.Linking.html#Linker_vardef">Linker_vardef</a></span>.<br/>
<br/>
<div class="doc">A trivial linker for the trivial var info <span class="bracket"><span class="id">unit</span></span>. </div>
<br/>
<span class="kwd">Program</span> <span class="kwd">Instance</span> <span class="id"><a name="Linker_unit">Linker_unit</a></span>: <span class="id"><a href="compcert.common.Linking.html#Linker">Linker</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#unit">unit</a></span> := {<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#link">link</a></span> := <span class="kwd">fun</span> <span class="id">x</span> <span class="id">y</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#linkorder">linkorder</a></span> := <span class="kwd">fun</span> <span class="id">x</span> <span class="id">y</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span><br/>
}.<br/>
<br/>
<span class="kwd">Global</span> <span class="id">Opaque</span> <span class="id"><a href="compcert.common.Linking.html#Linker_unit">Linker_unit</a></span>.<br/>
<br/>
<div class="doc">Linking global definitions </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="link_def">link_def</a></span> {<span class="id">F</span> <span class="id">V</span>: <span class="kwd">Type</span>} {<span class="id">LF</span>: <span class="id"><a href="compcert.common.Linking.html#Linker">Linker</a></span> <span class="id"><a href="compcert.common.Linking.html#F">F</a></span>} {<span class="id">LV</span>: <span class="id"><a href="compcert.common.Linking.html#Linker">Linker</a></span> <span class="id"><a href="compcert.common.Linking.html#V">V</a></span>} (<span class="id">gd1</span> <span class="id">gd2</span>: <span class="id"><a href="compcert.common.AST.html#globdef">globdef</a></span> <span class="id"><a href="compcert.common.Linking.html#F">F</a></span> <span class="id"><a href="compcert.common.Linking.html#V">V</a></span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.common.Linking.html#gd1">gd1</a></span>, <span class="id"><a href="compcert.common.Linking.html#gd2">gd2</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.common.AST.html#Gfun">Gfun</a></span> <span class="id">f1</span>, <span class="id"><a href="compcert.common.AST.html#Gfun">Gfun</a></span> <span class="id">f2</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.common.Linking.html#link">link</a></span> <span class="id">f1</span> <span class="id">f2</span> <span class="kwd">with</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">f</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="compcert.common.AST.html#Gfun">Gfun</a></span> <span class="id">f</span>) | <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> <span class="kwd">end</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.common.AST.html#Gvar">Gvar</a></span> <span class="id">v1</span>, <span class="id"><a href="compcert.common.AST.html#Gvar">Gvar</a></span> <span class="id">v2</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.common.Linking.html#link">link</a></span> <span class="id">v1</span> <span class="id">v2</span> <span class="kwd">with</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="compcert.common.AST.html#Gvar">Gvar</a></span> <span class="id">v</span>) | <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> <span class="kwd">end</span><br/>
&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="linkorder_def">linkorder_def</a></span> {<span class="id">F</span> <span class="id">V</span>: <span class="kwd">Type</span>} {<span class="id">LF</span>: <span class="id"><a href="compcert.common.Linking.html#Linker">Linker</a></span> <span class="id"><a href="compcert.common.Linking.html#F">F</a></span>} {<span class="id">LV</span>: <span class="id"><a href="compcert.common.Linking.html#Linker">Linker</a></span> <span class="id"><a href="compcert.common.Linking.html#V">V</a></span>}: <span class="id"><a href="compcert.common.AST.html#globdef">globdef</a></span> <span class="id">F</span> <span class="id">V</span> -&gt; <span class="id"><a href="compcert.common.AST.html#globdef">globdef</a></span> <span class="id">F</span> <span class="id">V</span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="linkorder_def_fun">linkorder_def_fun</a></span>: <span class="kwd">forall</span> <span class="id">fd1</span> <span class="id">fd2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#linkorder">linkorder</a></span> <span class="id"><a href="compcert.common.Linking.html#fd1">fd1</a></span> <span class="id"><a href="compcert.common.Linking.html#fd2">fd2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#linkorder_def">linkorder_def</a></span> (<span class="id"><a href="compcert.common.AST.html#Gfun">Gfun</a></span> <span class="id"><a href="compcert.common.Linking.html#fd1">fd1</a></span>) (<span class="id"><a href="compcert.common.AST.html#Gfun">Gfun</a></span> <span class="id"><a href="compcert.common.Linking.html#fd2">fd2</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="linkorder_def_var">linkorder_def_var</a></span>: <span class="kwd">forall</span> <span class="id">v1</span> <span class="id">v2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#linkorder">linkorder</a></span> <span class="id"><a href="compcert.common.Linking.html#v1">v1</a></span> <span class="id"><a href="compcert.common.Linking.html#v2">v2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#linkorder_def">linkorder_def</a></span> (<span class="id"><a href="compcert.common.AST.html#Gvar">Gvar</a></span> <span class="id"><a href="compcert.common.Linking.html#v1">v1</a></span>) (<span class="id"><a href="compcert.common.AST.html#Gvar">Gvar</a></span> <span class="id"><a href="compcert.common.Linking.html#v2">v2</a></span>).<br/>
<br/>
<span class="kwd">Program</span> <span class="kwd">Instance</span> <span class="id"><a name="Linker_def">Linker_def</a></span> (<span class="id">F</span> <span class="id">V</span>: <span class="kwd">Type</span>) {<span class="id">LF</span>: <span class="id"><a href="compcert.common.Linking.html#Linker">Linker</a></span> <span class="id"><a href="compcert.common.Linking.html#F">F</a></span>} {<span class="id">LV</span>: <span class="id"><a href="compcert.common.Linking.html#Linker">Linker</a></span> <span class="id"><a href="compcert.common.Linking.html#V">V</a></span>}: <span class="id"><a href="compcert.common.Linking.html#Linker">Linker</a></span> (<span class="id"><a href="compcert.common.AST.html#globdef">globdef</a></span> <span class="id"><a href="compcert.common.Linking.html#F">F</a></span> <span class="id"><a href="compcert.common.Linking.html#V">V</a></span>) := {<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#link">link</a></span> := <span class="id"><a href="compcert.common.Linking.html#link_def">link_def</a></span>;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#linkorder">linkorder</a></span> := <span class="id"><a href="compcert.common.Linking.html#linkorder_def">linkorder_def</a></span><br/>
}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1234')">Next Obligation.</div>
<div class="proofscript" id="proof1234">
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">x</span>; <span class="id">constructor</span>; <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Linking.html#linkorder_refl">linkorder_refl</a></span>.<br/>
Defined.</div>
<div class="toggleproof" onclick="toggleDisplay('proof1235')">Next Obligation.</div>
<div class="proofscript" id="proof1235">
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>; <span class="id">inv</span> <span class="id">H0</span>; <span class="id">constructor</span>; <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Linking.html#linkorder_trans">linkorder_trans</a></span>; <span class="tactic">eauto</span>.<br/>
Defined.</div>
<div class="toggleproof" onclick="toggleDisplay('proof1236')">Next Obligation.</div>
<div class="proofscript" id="proof1236">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.common.Linking.html#link_def">link_def</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">x</span> <span class="kwd">as</span> [<span class="id">f1</span>|<span class="id">v1</span>], <span class="id">y</span> <span class="kwd">as</span> [<span class="id">f2</span>|<span class="id">v2</span>]; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
+ <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.Linking.html#link">link</a></span> <span class="id">f1</span> <span class="id">f2</span>) <span class="kwd">as</span> [<span class="id">f</span>|] <span class="id">eqn</span>:<span class="id">L</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Linking.html#link_linkorder">link_linkorder</a></span> <span class="kwd">in</span> <span class="id">L</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="id">constructor</span>; <span class="tactic">tauto</span>. <span class="tactic">discriminate</span>.<br/>
+ <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.Linking.html#link">link</a></span> <span class="id">v1</span> <span class="id">v2</span>) <span class="kwd">as</span> [<span class="id">v</span>|] <span class="id">eqn</span>:<span class="id">L</span>; <span class="id">inv</span> <span class="id">H</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Linking.html#link_linkorder">link_linkorder</a></span> <span class="kwd">in</span> <span class="id">L</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="id">constructor</span>; <span class="tactic">tauto</span>.<br/>
Defined.</div>
<br/>
<span class="kwd">Global</span> <span class="id">Opaque</span> <span class="id"><a href="compcert.common.Linking.html#Linker_def">Linker_def</a></span>.<br/>
<br/>
<div class="doc">Linking two compilation units.  Compilation units are represented like
  whole programs using the type <span class="bracket"><span class="id">program</span> <span class="id">F</span> <span class="id">V</span></span>.  If a name has
  a global definition in one unit but not in the other, this definition
  is left unchanged in the result of the link.  If a name has
  global definitions in both units, and is public (not static) in both,
  the two definitions are linked as per <span class="bracket"><span class="id">Linker_def</span></span> above.
  If one or both definitions are static (not public), we should ideally
  rename it so that it can be kept unchanged in the result of the link.
  This would require a general notion of renaming of global identifiers
  in programs that we do not have yet.  Hence, as a first step, linking
  is undefined if static definitions with the same name appear in both
  compilation units. </div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="LINKER_PROG">LINKER_PROG</a></span>.<br/>
<br/>
<span class="kwd">Context</span> {<span class="id">F</span> <span class="id">V</span>: <span class="kwd">Type</span>} {<span class="id">LF</span>: <span class="id"><a href="compcert.common.Linking.html#Linker">Linker</a></span> <span class="id"><a href="compcert.common.Linking.html#F">F</a></span>} {<span class="id">LV</span>: <span class="id"><a href="compcert.common.Linking.html#Linker">Linker</a></span> <span class="id"><a href="compcert.common.Linking.html#V">V</a></span>} (<span class="id">p1</span> <span class="id">p2</span>: <span class="id"><a href="compcert.common.AST.html#program">program</a></span> <span class="id"><a href="compcert.common.Linking.html#F">F</a></span> <span class="id"><a href="compcert.common.Linking.html#V">V</a></span>).<br/>
<br/>
<span class="kwd">Let</span> <span class="id"><a name="LINKER_PROG.dm1">dm1</a></span> := <span class="id"><a href="compcert.common.AST.html#prog_defmap">prog_defmap</a></span> <span class="id"><a href="compcert.common.Linking.html#LINKER_PROG.p1">p1</a></span>.<br/>
<span class="kwd">Let</span> <span class="id"><a name="LINKER_PROG.dm2">dm2</a></span> := <span class="id"><a href="compcert.common.AST.html#prog_defmap">prog_defmap</a></span> <span class="id"><a href="compcert.common.Linking.html#LINKER_PROG.p2">p2</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="link_prog_check">link_prog_check</a></span> (<span class="id">x</span>: <span class="id"><a href="compcert.common.AST.html#ident">ident</a></span>) (<span class="id">gd1</span>: <span class="id"><a href="compcert.common.AST.html#globdef">globdef</a></span> <span class="id"><a href="compcert.common.Linking.html#LINKER_PROG.F">F</a></span> <span class="id"><a href="compcert.common.Linking.html#LINKER_PROG.V">V</a></span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.common.Linking.html#LINKER_PROG.dm2">dm2</a></span>!<span class="id"><a href="compcert.common.Linking.html#x">x</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">gd2</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In_dec">In_dec</a></span> <span class="id"><a href="compcert.lib.Coqlib.html#peq">peq</a></span> <span class="id"><a href="compcert.common.Linking.html#x">x</a></span> <span class="id"><a href="compcert.common.Linking.html#LINKER_PROG.p1">p1</a></span>.(<span class="id"><a href="compcert.common.AST.html#prog_public">prog_public</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In_dec">In_dec</a></span> <span class="id"><a href="compcert.lib.Coqlib.html#peq">peq</a></span> <span class="id"><a href="compcert.common.Linking.html#x">x</a></span> <span class="id"><a href="compcert.common.Linking.html#LINKER_PROG.p2">p2</a></span>.(<span class="id"><a href="compcert.common.AST.html#prog_public">prog_public</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp; <span class="kwd">match</span> <span class="id"><a href="compcert.common.Linking.html#link">link</a></span> <span class="id"><a href="compcert.common.Linking.html#gd1">gd1</a></span> <span class="id">gd2</span> <span class="kwd">with</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> | <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> <span class="kwd">end</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="link_prog_merge">link_prog_merge</a></span> (<span class="id">o1</span> <span class="id">o2</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> (<span class="id"><a href="compcert.common.AST.html#globdef">globdef</a></span> <span class="id"><a href="compcert.common.Linking.html#LINKER_PROG.F">F</a></span> <span class="id"><a href="compcert.common.Linking.html#LINKER_PROG.V">V</a></span>)) :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.common.Linking.html#o1">o1</a></span>, <span class="id"><a href="compcert.common.Linking.html#o2">o2</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>, <span class="id">_</span> =&gt; <span class="id"><a href="compcert.common.Linking.html#o2">o2</a></span><br/>
&nbsp;&nbsp;| <span class="id">_</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="compcert.common.Linking.html#o1">o1</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">gd1</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">gd2</span> =&gt; <span class="id"><a href="compcert.common.Linking.html#link">link</a></span> <span class="id">gd1</span> <span class="id">gd2</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="link_prog">link_prog</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="compcert.common.AST.html#ident_eq">ident_eq</a></span> <span class="id"><a href="compcert.common.Linking.html#LINKER_PROG.p1">p1</a></span>.(<span class="id"><a href="compcert.common.AST.html#prog_main">prog_main</a></span>) <span class="id"><a href="compcert.common.Linking.html#LINKER_PROG.p2">p2</a></span>.(<span class="id"><a href="compcert.common.AST.html#prog_main">prog_main</a></span>)<br/>
&nbsp;&nbsp;&amp;&amp; <span class="id"><a href="compcert.lib.Maps.html#PTree_Properties.for_all">PTree_Properties.for_all</a></span> <span class="id"><a href="compcert.common.Linking.html#LINKER_PROG.dm1">dm1</a></span> <span class="id"><a href="compcert.common.Linking.html#link_prog_check">link_prog_check</a></span> <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> {| <span class="id"><a href="compcert.common.AST.html#mkprogram">prog_main</a></span> := <span class="id"><a href="compcert.common.Linking.html#LINKER_PROG.p1">p1</a></span>.(<span class="id"><a href="compcert.common.AST.html#prog_main">prog_main</a></span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">prog_public</span> := <span class="id"><a href="compcert.common.Linking.html#LINKER_PROG.p1">p1</a></span>.(<span class="id"><a href="compcert.common.AST.html#prog_public">prog_public</a></span>) ++ <span class="id"><a href="compcert.common.Linking.html#LINKER_PROG.p2">p2</a></span>.(<span class="id"><a href="compcert.common.AST.html#prog_public">prog_public</a></span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">prog_defs</span> := <span class="id"><a href="compcert.lib.Maps.html#PTree.elements">PTree.elements</a></span> (<span class="id"><a href="compcert.lib.Maps.html#PTree.combine">PTree.combine</a></span> <span class="id"><a href="compcert.common.Linking.html#link_prog_merge">link_prog_merge</a></span> <span class="id"><a href="compcert.common.Linking.html#LINKER_PROG.dm1">dm1</a></span> <span class="id"><a href="compcert.common.Linking.html#LINKER_PROG.dm2">dm2</a></span>) |}<br/>
&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="link_prog_inv">link_prog_inv</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#link_prog">link_prog</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.common.Linking.html#p">p</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#LINKER_PROG.p1">p1</a></span>.(<span class="id"><a href="compcert.common.AST.html#prog_main">prog_main</a></span>) = <span class="id"><a href="compcert.common.Linking.html#LINKER_PROG.p2">p2</a></span>.(<span class="id"><a href="compcert.common.AST.html#prog_main">prog_main</a></span>)<br/>
&nbsp;&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">id</span> <span class="id">gd1</span> <span class="id">gd2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#LINKER_PROG.dm1">dm1</a></span>!<span class="id"><a href="compcert.common.Linking.html#id">id</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.common.Linking.html#gd1">gd1</a></span> -&gt; <span class="id"><a href="compcert.common.Linking.html#LINKER_PROG.dm2">dm2</a></span>!<span class="id"><a href="compcert.common.Linking.html#id">id</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.common.Linking.html#gd2">gd2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.common.Linking.html#id">id</a></span> <span class="id"><a href="compcert.common.Linking.html#LINKER_PROG.p1">p1</a></span>.(<span class="id"><a href="compcert.common.AST.html#prog_public">prog_public</a></span>) /\ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.common.Linking.html#id">id</a></span> <span class="id"><a href="compcert.common.Linking.html#LINKER_PROG.p2">p2</a></span>.(<span class="id"><a href="compcert.common.AST.html#prog_public">prog_public</a></span>) /\ <span class="id">exists</span> <span class="id">gd</span>, <span class="id"><a href="compcert.common.Linking.html#link">link</a></span> <span class="id"><a href="compcert.common.Linking.html#gd1">gd1</a></span> <span class="id"><a href="compcert.common.Linking.html#gd2">gd2</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.common.Linking.html#gd">gd</a></span>)<br/>
&nbsp;&nbsp;/\ <span class="id"><a href="compcert.common.Linking.html#p">p</a></span> = {| <span class="id"><a href="compcert.common.AST.html#mkprogram">prog_main</a></span> := <span class="id"><a href="compcert.common.Linking.html#LINKER_PROG.p1">p1</a></span>.(<span class="id"><a href="compcert.common.AST.html#prog_main">prog_main</a></span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">prog_public</span> := <span class="id"><a href="compcert.common.Linking.html#LINKER_PROG.p1">p1</a></span>.(<span class="id"><a href="compcert.common.AST.html#prog_public">prog_public</a></span>) ++ <span class="id"><a href="compcert.common.Linking.html#LINKER_PROG.p2">p2</a></span>.(<span class="id"><a href="compcert.common.AST.html#prog_public">prog_public</a></span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">prog_defs</span> := <span class="id"><a href="compcert.lib.Maps.html#PTree.elements">PTree.elements</a></span> (<span class="id"><a href="compcert.lib.Maps.html#PTree.combine">PTree.combine</a></span> <span class="id"><a href="compcert.common.Linking.html#link_prog_merge">link_prog_merge</a></span> <span class="id"><a href="compcert.common.Linking.html#LINKER_PROG.dm1">dm1</a></span> <span class="id"><a href="compcert.common.Linking.html#LINKER_PROG.dm2">dm2</a></span>) |}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1237')">Proof.</div>
<div class="proofscript" id="proof1237">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.common.Linking.html#link_prog">link_prog</a></span>; <span class="tactic">intros</span> <span class="id">p</span> <span class="id">E</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.AST.html#ident_eq">ident_eq</a></span> (<span class="id"><a href="compcert.common.AST.html#prog_main">prog_main</a></span> <span class="id"><a href="compcert.common.Linking.html#LINKER_PROG.p1">p1</a></span>) (<span class="id"><a href="compcert.common.AST.html#prog_main">prog_main</a></span> <span class="id"><a href="compcert.common.Linking.html#LINKER_PROG.p2">p2</a></span>)); <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Maps.html#PTree_Properties.for_all">PTree_Properties.for_all</a></span> <span class="id"><a href="compcert.common.Linking.html#LINKER_PROG.dm1">dm1</a></span> <span class="id"><a href="compcert.common.Linking.html#link_prog_check">link_prog_check</a></span>) <span class="id">eqn</span>:<span class="id">C</span>; <span class="id">inv</span> <span class="id">E</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Maps.html#PTree_Properties.for_all_correct">PTree_Properties.for_all_correct</a></span> <span class="kwd">in</span> <span class="id">C</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id">C</span>; <span class="tactic">eauto</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.common.Linking.html#link_prog_check">link_prog_check</a></span>. <span class="tactic">rewrite</span> <span class="id">H0</span>. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_dec">in_dec</a></span> <span class="id"><a href="compcert.lib.Coqlib.html#peq">peq</a></span> <span class="id">id</span> (<span class="id"><a href="compcert.common.AST.html#prog_public">prog_public</a></span> <span class="id"><a href="compcert.common.Linking.html#LINKER_PROG.p1">p1</a></span>)); <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_dec">in_dec</a></span> <span class="id"><a href="compcert.lib.Coqlib.html#peq">peq</a></span> <span class="id">id</span> (<span class="id"><a href="compcert.common.AST.html#prog_public">prog_public</a></span> <span class="id"><a href="compcert.common.Linking.html#LINKER_PROG.p2">p2</a></span>)); <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.Linking.html#link">link</a></span> <span class="id">gd1</span> <span class="id">gd2</span>) <span class="id">eqn</span>:<span class="id">L</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intuition</span> <span class="tactic">auto</span>. <span class="id">exists</span> <span class="id">g</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="link_prog_succeeds">link_prog_succeeds</a></span>:<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#LINKER_PROG.p1">p1</a></span>.(<span class="id"><a href="compcert.common.AST.html#prog_main">prog_main</a></span>) = <span class="id"><a href="compcert.common.Linking.html#LINKER_PROG.p2">p2</a></span>.(<span class="id"><a href="compcert.common.AST.html#prog_main">prog_main</a></span>) -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">id</span> <span class="id">gd1</span> <span class="id">gd2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#LINKER_PROG.dm1">dm1</a></span>!<span class="id"><a href="compcert.common.Linking.html#id">id</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.common.Linking.html#gd1">gd1</a></span> -&gt; <span class="id"><a href="compcert.common.Linking.html#LINKER_PROG.dm2">dm2</a></span>!<span class="id"><a href="compcert.common.Linking.html#id">id</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.common.Linking.html#gd2">gd2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.common.Linking.html#id">id</a></span> <span class="id"><a href="compcert.common.Linking.html#LINKER_PROG.p1">p1</a></span>.(<span class="id"><a href="compcert.common.AST.html#prog_public">prog_public</a></span>) /\ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.common.Linking.html#id">id</a></span> <span class="id"><a href="compcert.common.Linking.html#LINKER_PROG.p2">p2</a></span>.(<span class="id"><a href="compcert.common.AST.html#prog_public">prog_public</a></span>) /\ <span class="id"><a href="compcert.common.Linking.html#link">link</a></span> <span class="id"><a href="compcert.common.Linking.html#gd1">gd1</a></span> <span class="id"><a href="compcert.common.Linking.html#gd2">gd2</a></span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#link_prog">link_prog</a></span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> {| <span class="id"><a href="compcert.common.AST.html#mkprogram">prog_main</a></span> := <span class="id"><a href="compcert.common.Linking.html#LINKER_PROG.p1">p1</a></span>.(<span class="id"><a href="compcert.common.AST.html#prog_main">prog_main</a></span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">prog_public</span> := <span class="id"><a href="compcert.common.Linking.html#LINKER_PROG.p1">p1</a></span>.(<span class="id"><a href="compcert.common.AST.html#prog_public">prog_public</a></span>) ++ <span class="id"><a href="compcert.common.Linking.html#LINKER_PROG.p2">p2</a></span>.(<span class="id"><a href="compcert.common.AST.html#prog_public">prog_public</a></span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">prog_defs</span> := <span class="id"><a href="compcert.lib.Maps.html#PTree.elements">PTree.elements</a></span> (<span class="id"><a href="compcert.lib.Maps.html#PTree.combine">PTree.combine</a></span> <span class="id"><a href="compcert.common.Linking.html#link_prog_merge">link_prog_merge</a></span> <span class="id"><a href="compcert.common.Linking.html#LINKER_PROG.dm1">dm1</a></span> <span class="id"><a href="compcert.common.Linking.html#LINKER_PROG.dm2">dm2</a></span>) |}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1238')">Proof.</div>
<div class="proofscript" id="proof1238">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.common.Linking.html#link_prog">link_prog</a></span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.lib.Coqlib.html#proj_sumbool">proj_sumbool</a></span>. <span class="tactic">rewrite</span> <span class="id">H</span>, <span class="id"><a href="compcert.lib.Coqlib.html#dec_eq_true">dec_eq_true</a></span>. <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="compcert.lib.Maps.html#PTree_Properties.for_all">PTree_Properties.for_all</a></span> <span class="id"><a href="compcert.common.Linking.html#LINKER_PROG.dm1">dm1</a></span> <span class="id"><a href="compcert.common.Linking.html#link_prog_check">link_prog_check</a></span>) <span class="kwd">with</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">symmetry</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Maps.html#PTree_Properties.for_all_correct">PTree_Properties.for_all_correct</a></span>; <span class="tactic">intros</span>. <span class="tactic">rename</span> <span class="id">a</span> <span class="id">into</span> <span class="id">gd1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.common.Linking.html#link_prog_check">link_prog_check</a></span>. <span class="tactic">destruct</span> <span class="id"><a href="compcert.common.Linking.html#LINKER_PROG.dm2">dm2</a></span>!<span class="id">x</span> <span class="kwd">as</span> [<span class="id">gd2</span>|] <span class="id">eqn</span>:<span class="id">G2</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H0</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">P</span> &amp; <span class="id">Q</span> &amp; <span class="id">R</span>). <span class="tactic">unfold</span> <span class="id"><a href="compcert.lib.Coqlib.html#proj_sumbool">proj_sumbool</a></span>; <span class="tactic">rewrite</span> ! <span class="id"><a href="compcert.lib.Coqlib.html#pred_dec_true">pred_dec_true</a></span> <span class="tactic">by</span> <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.Linking.html#link">link</a></span> <span class="id">gd1</span> <span class="id">gd2</span>); <span class="tactic">auto</span>; <span class="tactic">discriminate</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="prog_defmap_elements">prog_defmap_elements</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">m</span>: <span class="id"><a href="compcert.lib.Maps.html#PTree.t">PTree.t</a></span> (<span class="id"><a href="compcert.common.AST.html#globdef">globdef</a></span> <span class="id"><a href="compcert.common.Linking.html#LINKER_PROG.F">F</a></span> <span class="id"><a href="compcert.common.Linking.html#LINKER_PROG.V">V</a></span>)) <span class="id">pub</span> <span class="id">mn</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.common.AST.html#prog_defmap">prog_defmap</a></span> {| <span class="id"><a href="compcert.common.AST.html#mkprogram">prog_defs</a></span> := <span class="id"><a href="compcert.lib.Maps.html#PTree.elements">PTree.elements</a></span> <span class="id"><a href="compcert.common.Linking.html#m">m</a></span>; <span class="id">prog_public</span> := <span class="id"><a href="compcert.common.Linking.html#pub">pub</a></span>; <span class="id">prog_main</span> := <span class="id"><a href="compcert.common.Linking.html#mn">mn</a></span> |})!<span class="id"><a href="compcert.common.Linking.html#x">x</a></span> = <span class="id"><a href="compcert.common.Linking.html#m">m</a></span>!<span class="id"><a href="compcert.common.Linking.html#x">x</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1239')">Proof.</div>
<div class="proofscript" id="proof1239">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.common.AST.html#prog_defmap">prog_defmap</a></span>; <span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Maps.html#PTree_Properties.of_list_elements">PTree_Properties.of_list_elements</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.common.Linking.html#LINKER_PROG">LINKER_PROG</a></span>.<br/>
<br/>
<span class="kwd">Program</span> <span class="kwd">Instance</span> <span class="id"><a name="Linker_prog">Linker_prog</a></span> (<span class="id">F</span> <span class="id">V</span>: <span class="kwd">Type</span>) {<span class="id">LF</span>: <span class="id"><a href="compcert.common.Linking.html#Linker">Linker</a></span> <span class="id"><a href="compcert.common.Linking.html#F">F</a></span>} {<span class="id">LV</span>: <span class="id"><a href="compcert.common.Linking.html#Linker">Linker</a></span> <span class="id"><a href="compcert.common.Linking.html#V">V</a></span>} : <span class="id"><a href="compcert.common.Linking.html#Linker">Linker</a></span> (<span class="id"><a href="compcert.common.AST.html#program">program</a></span> <span class="id"><a href="compcert.common.Linking.html#F">F</a></span> <span class="id"><a href="compcert.common.Linking.html#V">V</a></span>) := {<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#link">link</a></span> := <span class="id"><a href="compcert.common.Linking.html#link_prog">link_prog</a></span>;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#linkorder">linkorder</a></span> := <span class="kwd">fun</span> <span class="id">p1</span> <span class="id">p2</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#p1">p1</a></span>.(<span class="id"><a href="compcert.common.AST.html#prog_main">prog_main</a></span>) = <span class="id"><a href="compcert.common.Linking.html#p2">p2</a></span>.(<span class="id"><a href="compcert.common.AST.html#prog_main">prog_main</a></span>)<br/>
&nbsp;&nbsp;/\ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#incl">incl</a></span> <span class="id"><a href="compcert.common.Linking.html#p1">p1</a></span>.(<span class="id"><a href="compcert.common.AST.html#prog_public">prog_public</a></span>) <span class="id"><a href="compcert.common.Linking.html#p2">p2</a></span>.(<span class="id"><a href="compcert.common.AST.html#prog_public">prog_public</a></span>)<br/>
&nbsp;&nbsp;/\ <span class="kwd">forall</span> <span class="id">id</span> <span class="id">gd1</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.common.AST.html#prog_defmap">prog_defmap</a></span> <span class="id"><a href="compcert.common.Linking.html#p1">p1</a></span>)!<span class="id"><a href="compcert.common.Linking.html#id">id</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.common.Linking.html#gd1">gd1</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">gd2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.common.AST.html#prog_defmap">prog_defmap</a></span> <span class="id"><a href="compcert.common.Linking.html#p2">p2</a></span>)!<span class="id"><a href="compcert.common.Linking.html#id">id</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.common.Linking.html#gd2">gd2</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="compcert.common.Linking.html#linkorder">linkorder</a></span> <span class="id"><a href="compcert.common.Linking.html#gd1">gd1</a></span> <span class="id"><a href="compcert.common.Linking.html#gd2">gd2</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ (~<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.common.Linking.html#id">id</a></span> <span class="id"><a href="compcert.common.Linking.html#p2">p2</a></span>.(<span class="id"><a href="compcert.common.AST.html#prog_public">prog_public</a></span>) -&gt; <span class="id"><a href="compcert.common.Linking.html#gd2">gd2</a></span> = <span class="id"><a href="compcert.common.Linking.html#gd1">gd1</a></span>)<br/>
}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1240')">Next Obligation.</div>
<div class="proofscript" id="proof1240">
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#incl_refl">incl_refl</a></span>. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">gd1</span>; <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Linking.html#linkorder_refl">linkorder_refl</a></span>.<br/>
Defined.</div>
<div class="toggleproof" onclick="toggleDisplay('proof1241')">Next Obligation.</div>
<div class="proofscript" id="proof1241">
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">congruence</span>. <span class="tactic">split</span>. <span class="tactic">red</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id">H4</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">gd2</span> &amp; <span class="id">P</span> &amp; <span class="id">Q</span> &amp; <span class="id">R</span>).<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H2</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">gd3</span> &amp; <span class="id">U</span> &amp; <span class="id">X</span> &amp; <span class="id">Y</span>).<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">gd3</span>. <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">split</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Linking.html#linkorder_trans">linkorder_trans</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">transitivity</span> <span class="id">gd2</span>. <span class="tactic">apply</span> <span class="id">Y</span>. <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id">R</span>. <span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="tactic">elim</span> <span class="id">H0</span>; <span class="tactic">auto</span>.<br/>
Defined.</div>
<div class="toggleproof" onclick="toggleDisplay('proof1242')">Next Obligation.</div>
<div class="proofscript" id="proof1242">
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Linking.html#link_prog_inv">link_prog_inv</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> (<span class="id">L1</span> &amp; <span class="id">L2</span> &amp; <span class="id">L3</span>).<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">z</span>; <span class="tactic">simpl</span>. <span class="tactic">intuition</span> <span class="tactic">auto</span>.<br/>
+ <span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_app_iff">in_app_iff</a></span>; <span class="tactic">auto</span>.<br/>
+ <span class="tactic">rewrite</span> <span class="id"><a href="compcert.common.Linking.html#prog_defmap_elements">prog_defmap_elements</a></span>, <span class="id"><a href="compcert.lib.Maps.html#PTree.gcombine">PTree.gcombine</a></span>, <span class="id">H</span> <span class="tactic">by</span> <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.AST.html#prog_defmap">prog_defmap</a></span> <span class="id">y</span>)!<span class="id">id</span> <span class="kwd">as</span> [<span class="id">gd2</span>|] <span class="id">eqn</span>:<span class="id">GD2</span>; <span class="tactic">simpl</span>.<br/>
* <span class="id">exploit</span> <span class="id">L2</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">P</span> &amp; <span class="id">Q</span> &amp; <span class="id">gd</span> &amp; <span class="id">R</span>).<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">gd</span>; <span class="tactic">split</span>. <span class="tactic">auto</span>. <span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Linking.html#link_linkorder">link_linkorder</a></span> <span class="kwd">in</span> <span class="id">R</span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_app_iff">in_app_iff</a></span>; <span class="tactic">tauto</span>.<br/>
* <span class="id">exists</span> <span class="id">gd1</span>; <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Linking.html#linkorder_refl">linkorder_refl</a></span>. <span class="tactic">auto</span>.<br/>
+ <span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_app_iff">in_app_iff</a></span>; <span class="tactic">auto</span>.<br/>
+ <span class="tactic">rewrite</span> <span class="id"><a href="compcert.common.Linking.html#prog_defmap_elements">prog_defmap_elements</a></span>, <span class="id"><a href="compcert.lib.Maps.html#PTree.gcombine">PTree.gcombine</a></span>, <span class="id">H</span> <span class="tactic">by</span> <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.AST.html#prog_defmap">prog_defmap</a></span> <span class="id">x</span>)!<span class="id">id</span> <span class="kwd">as</span> [<span class="id">gd2</span>|] <span class="id">eqn</span>:<span class="id">GD2</span>; <span class="tactic">simpl</span>.<br/>
* <span class="id">exploit</span> <span class="id">L2</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">P</span> &amp; <span class="id">Q</span> &amp; <span class="id">gd</span> &amp; <span class="id">R</span>).<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">gd</span>; <span class="tactic">split</span>. <span class="tactic">auto</span>. <span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Linking.html#link_linkorder">link_linkorder</a></span> <span class="kwd">in</span> <span class="id">R</span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_app_iff">in_app_iff</a></span>; <span class="tactic">tauto</span>.<br/>
* <span class="id">exists</span> <span class="id">gd1</span>; <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Linking.html#linkorder_refl">linkorder_refl</a></span>. <span class="tactic">auto</span>.<br/>
Defined.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="prog_defmap_linkorder">prog_defmap_linkorder</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">F</span> <span class="id">V</span>: <span class="kwd">Type</span>} {<span class="id">LF</span>: <span class="id"><a href="compcert.common.Linking.html#Linker">Linker</a></span> <span class="id"><a href="compcert.common.Linking.html#F">F</a></span>} {<span class="id">LV</span>: <span class="id"><a href="compcert.common.Linking.html#Linker">Linker</a></span> <span class="id"><a href="compcert.common.Linking.html#V">V</a></span>} (<span class="id">p1</span> <span class="id">p2</span>: <span class="id"><a href="compcert.common.AST.html#program">program</a></span> <span class="id"><a href="compcert.common.Linking.html#F">F</a></span> <span class="id"><a href="compcert.common.Linking.html#V">V</a></span>) <span class="id">id</span> <span class="id">gd1</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#linkorder">linkorder</a></span> <span class="id"><a href="compcert.common.Linking.html#p1">p1</a></span> <span class="id"><a href="compcert.common.Linking.html#p2">p2</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.common.AST.html#prog_defmap">prog_defmap</a></span> <span class="id"><a href="compcert.common.Linking.html#p1">p1</a></span>)!<span class="id"><a href="compcert.common.Linking.html#id">id</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.common.Linking.html#gd1">gd1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">gd2</span>, (<span class="id"><a href="compcert.common.AST.html#prog_defmap">prog_defmap</a></span> <span class="id"><a href="compcert.common.Linking.html#p2">p2</a></span>)!<span class="id"><a href="compcert.common.Linking.html#id">id</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.common.Linking.html#gd2">gd2</a></span> /\ <span class="id"><a href="compcert.common.Linking.html#linkorder">linkorder</a></span> <span class="id"><a href="compcert.common.Linking.html#gd1">gd1</a></span> <span class="id"><a href="compcert.common.Linking.html#gd2">gd2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1243')">Proof.</div>
<div class="proofscript" id="proof1243">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> (<span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span>).<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">C</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">gd2</span> &amp; <span class="id">P</span> &amp; <span class="id">Q</span> &amp; <span class="id">R</span>). <span class="id">exists</span> <span class="id">gd2</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Global</span> <span class="id">Opaque</span> <span class="id"><a href="compcert.common.Linking.html#Linker_prog">Linker_prog</a></span>.<br/>
<br/>
<h1> Matching between two programs </h1>
<br/>
<div class="doc">The following is a relational presentation of program transformations,
  e.g. <span class="bracket"><span class="id">transf_partial_program</span></span> from module <span class="bracket"><span class="id">AST</span></span>.  </div>
<br/>
<div class="doc">To capture the possibility of separate compilation, we parameterize
  the <span class="bracket"><span class="id">match_fundef</span></span> relation between function definitions with
  a context, e.g. the compilation unit from which the function definition comes.
  This unit is characterized as any program that is in the <span class="bracket"><span class="id">linkorder</span></span>
  relation with the final, whole program. </div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="MATCH_PROGRAM_GENERIC">MATCH_PROGRAM_GENERIC</a></span>.<br/>
<br/>
<span class="kwd">Context</span> {<span class="id">C</span> <span class="id">F1</span> <span class="id">V1</span> <span class="id">F2</span> <span class="id">V2</span>: <span class="kwd">Type</span>} {<span class="id">LC</span>: <span class="id"><a href="compcert.common.Linking.html#Linker">Linker</a></span> <span class="id"><a href="compcert.common.Linking.html#C">C</a></span>} {<span class="id">LF</span>: <span class="id"><a href="compcert.common.Linking.html#Linker">Linker</a></span> <span class="id"><a href="compcert.common.Linking.html#F1">F1</a></span>} {<span class="id">LV</span>: <span class="id"><a href="compcert.common.Linking.html#Linker">Linker</a></span> <span class="id"><a href="compcert.common.Linking.html#V1">V1</a></span>}.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="MATCH_PROGRAM_GENERIC.match_fundef">match_fundef</a></span>: <span class="id"><a href="compcert.common.Linking.html#MATCH_PROGRAM_GENERIC.C">C</a></span> -&gt; <span class="id"><a href="compcert.common.Linking.html#MATCH_PROGRAM_GENERIC.F1">F1</a></span> -&gt; <span class="id"><a href="compcert.common.Linking.html#MATCH_PROGRAM_GENERIC.F2">F2</a></span> -&gt; <span class="kwd">Prop</span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="MATCH_PROGRAM_GENERIC.match_varinfo">match_varinfo</a></span>: <span class="id"><a href="compcert.common.Linking.html#MATCH_PROGRAM_GENERIC.V1">V1</a></span> -&gt; <span class="id"><a href="compcert.common.Linking.html#MATCH_PROGRAM_GENERIC.V2">V2</a></span> -&gt; <span class="kwd">Prop</span>.<br/>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="match_globvar">match_globvar</a></span>: <span class="id"><a href="compcert.common.AST.html#globvar">globvar</a></span> <span class="id"><a href="compcert.common.Linking.html#MATCH_PROGRAM_GENERIC.V1">V1</a></span> -&gt; <span class="id"><a href="compcert.common.AST.html#globvar">globvar</a></span> <span class="id"><a href="compcert.common.Linking.html#MATCH_PROGRAM_GENERIC.V2">V2</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="match_globvar_intro">match_globvar_intro</a></span>: <span class="kwd">forall</span> <span class="id">i1</span> <span class="id">i2</span> <span class="id">init</span> <span class="id">ro</span> <span class="id">vo</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#MATCH_PROGRAM_GENERIC.match_varinfo">match_varinfo</a></span> <span class="id"><a href="compcert.common.Linking.html#i1">i1</a></span> <span class="id"><a href="compcert.common.Linking.html#i2">i2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#match_globvar">match_globvar</a></span> (<span class="id"><a href="compcert.common.AST.html#mkglobvar">mkglobvar</a></span> <span class="id"><a href="compcert.common.Linking.html#i1">i1</a></span> <span class="id"><a href="compcert.common.Linking.html#init">init</a></span> <span class="id"><a href="compcert.common.Linking.html#ro">ro</a></span> <span class="id"><a href="compcert.common.Linking.html#vo">vo</a></span>) (<span class="id"><a href="compcert.common.AST.html#mkglobvar">mkglobvar</a></span> <span class="id"><a href="compcert.common.Linking.html#i2">i2</a></span> <span class="id"><a href="compcert.common.Linking.html#init">init</a></span> <span class="id"><a href="compcert.common.Linking.html#ro">ro</a></span> <span class="id"><a href="compcert.common.Linking.html#vo">vo</a></span>).<br/>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="match_globdef">match_globdef</a></span> (<span class="id">ctx</span>: <span class="id"><a href="compcert.common.Linking.html#MATCH_PROGRAM_GENERIC.C">C</a></span>): <span class="id"><a href="compcert.common.AST.html#globdef">globdef</a></span> <span class="id"><a href="compcert.common.Linking.html#MATCH_PROGRAM_GENERIC.F1">F1</a></span> <span class="id"><a href="compcert.common.Linking.html#MATCH_PROGRAM_GENERIC.V1">V1</a></span> -&gt; <span class="id"><a href="compcert.common.AST.html#globdef">globdef</a></span> <span class="id"><a href="compcert.common.Linking.html#MATCH_PROGRAM_GENERIC.F2">F2</a></span> <span class="id"><a href="compcert.common.Linking.html#MATCH_PROGRAM_GENERIC.V2">V2</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="match_globdef_fun">match_globdef_fun</a></span>: <span class="kwd">forall</span> <span class="id">ctx</span>' <span class="id">f1</span> <span class="id">f2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#linkorder">linkorder</a></span> <span class="id">ctx</span>' <span class="id"><a href="compcert.common.Linking.html#ctx">ctx</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#MATCH_PROGRAM_GENERIC.match_fundef">match_fundef</a></span> <span class="id">ctx</span>' <span class="id"><a href="compcert.common.Linking.html#f1">f1</a></span> <span class="id"><a href="compcert.common.Linking.html#f2">f2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#match_globdef">match_globdef</a></span> <span class="id"><a href="compcert.common.Linking.html#ctx">ctx</a></span> (<span class="id"><a href="compcert.common.AST.html#Gfun">Gfun</a></span> <span class="id"><a href="compcert.common.Linking.html#f1">f1</a></span>) (<span class="id"><a href="compcert.common.AST.html#Gfun">Gfun</a></span> <span class="id"><a href="compcert.common.Linking.html#f2">f2</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="match_globdef_var">match_globdef_var</a></span>: <span class="kwd">forall</span> <span class="id">v1</span> <span class="id">v2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#match_globvar">match_globvar</a></span> <span class="id"><a href="compcert.common.Linking.html#v1">v1</a></span> <span class="id"><a href="compcert.common.Linking.html#v2">v2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#match_globdef">match_globdef</a></span> <span class="id"><a href="compcert.common.Linking.html#ctx">ctx</a></span> (<span class="id"><a href="compcert.common.AST.html#Gvar">Gvar</a></span> <span class="id"><a href="compcert.common.Linking.html#v1">v1</a></span>) (<span class="id"><a href="compcert.common.AST.html#Gvar">Gvar</a></span> <span class="id"><a href="compcert.common.Linking.html#v2">v2</a></span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="match_ident_globdef">match_ident_globdef</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ctx</span>: <span class="id"><a href="compcert.common.Linking.html#MATCH_PROGRAM_GENERIC.C">C</a></span>) (<span class="id">ig1</span>: <span class="id"><a href="compcert.common.AST.html#ident">ident</a></span> * <span class="id"><a href="compcert.common.AST.html#globdef">globdef</a></span> <span class="id"><a href="compcert.common.Linking.html#MATCH_PROGRAM_GENERIC.F1">F1</a></span> <span class="id"><a href="compcert.common.Linking.html#MATCH_PROGRAM_GENERIC.V1">V1</a></span>) (<span class="id">ig2</span>: <span class="id"><a href="compcert.common.AST.html#ident">ident</a></span> * <span class="id"><a href="compcert.common.AST.html#globdef">globdef</a></span> <span class="id"><a href="compcert.common.Linking.html#MATCH_PROGRAM_GENERIC.F2">F2</a></span> <span class="id"><a href="compcert.common.Linking.html#MATCH_PROGRAM_GENERIC.V2">V2</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="compcert.common.Linking.html#ig1">ig1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="compcert.common.Linking.html#ig2">ig2</a></span> /\ <span class="id"><a href="compcert.common.Linking.html#match_globdef">match_globdef</a></span> <span class="id"><a href="compcert.common.Linking.html#ctx">ctx</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id"><a href="compcert.common.Linking.html#ig1">ig1</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id"><a href="compcert.common.Linking.html#ig2">ig2</a></span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="match_program_gen">match_program_gen</a></span> (<span class="id">ctx</span>: <span class="id"><a href="compcert.common.Linking.html#MATCH_PROGRAM_GENERIC.C">C</a></span>) (<span class="id">p1</span>: <span class="id"><a href="compcert.common.AST.html#program">program</a></span> <span class="id"><a href="compcert.common.Linking.html#MATCH_PROGRAM_GENERIC.F1">F1</a></span> <span class="id"><a href="compcert.common.Linking.html#MATCH_PROGRAM_GENERIC.V1">V1</a></span>) (<span class="id">p2</span>: <span class="id"><a href="compcert.common.AST.html#program">program</a></span> <span class="id"><a href="compcert.common.Linking.html#MATCH_PROGRAM_GENERIC.F2">F2</a></span> <span class="id"><a href="compcert.common.Linking.html#MATCH_PROGRAM_GENERIC.V2">V2</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#list_forall2">list_forall2</a></span> (<span class="id"><a href="compcert.common.Linking.html#match_ident_globdef">match_ident_globdef</a></span> <span class="id"><a href="compcert.common.Linking.html#ctx">ctx</a></span>) <span class="id"><a href="compcert.common.Linking.html#p1">p1</a></span>.(<span class="id"><a href="compcert.common.AST.html#prog_defs">prog_defs</a></span>) <span class="id"><a href="compcert.common.Linking.html#p2">p2</a></span>.(<span class="id"><a href="compcert.common.AST.html#prog_defs">prog_defs</a></span>)<br/>
&nbsp;&nbsp;/\ <span class="id"><a href="compcert.common.Linking.html#p2">p2</a></span>.(<span class="id"><a href="compcert.common.AST.html#prog_main">prog_main</a></span>) = <span class="id"><a href="compcert.common.Linking.html#p1">p1</a></span>.(<span class="id"><a href="compcert.common.AST.html#prog_main">prog_main</a></span>)<br/>
&nbsp;&nbsp;/\ <span class="id"><a href="compcert.common.Linking.html#p2">p2</a></span>.(<span class="id"><a href="compcert.common.AST.html#prog_public">prog_public</a></span>) = <span class="id"><a href="compcert.common.Linking.html#p1">p1</a></span>.(<span class="id"><a href="compcert.common.AST.html#prog_public">prog_public</a></span>).<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="match_program_defmap">match_program_defmap</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ctx</span> <span class="id">p1</span> <span class="id">p2</span>, <span class="id"><a href="compcert.common.Linking.html#match_program_gen">match_program_gen</a></span> <span class="id"><a href="compcert.common.Linking.html#ctx">ctx</a></span> <span class="id"><a href="compcert.common.Linking.html#p1">p1</a></span> <span class="id"><a href="compcert.common.Linking.html#p2">p2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">id</span>, <span class="id"><a href="compcert.lib.Coqlib.html#option_rel">option_rel</a></span> (<span class="id"><a href="compcert.common.Linking.html#match_globdef">match_globdef</a></span> <span class="id"><a href="compcert.common.Linking.html#ctx">ctx</a></span>) (<span class="id"><a href="compcert.common.AST.html#prog_defmap">prog_defmap</a></span> <span class="id"><a href="compcert.common.Linking.html#p1">p1</a></span>)!<span class="id"><a href="compcert.common.Linking.html#id">id</a></span> (<span class="id"><a href="compcert.common.AST.html#prog_defmap">prog_defmap</a></span> <span class="id"><a href="compcert.common.Linking.html#p2">p2</a></span>)!<span class="id"><a href="compcert.common.Linking.html#id">id</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1244')">Proof.</div>
<div class="proofscript" id="proof1244">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Maps.html#PTree_Properties.of_list_related">PTree_Properties.of_list_related</a></span>. <span class="tactic">apply</span> <span class="id">H</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="match_program_gen_main">match_program_gen_main</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ctx</span> <span class="id">p1</span> <span class="id">p2</span>, <span class="id"><a href="compcert.common.Linking.html#match_program_gen">match_program_gen</a></span> <span class="id"><a href="compcert.common.Linking.html#ctx">ctx</a></span> <span class="id"><a href="compcert.common.Linking.html#p1">p1</a></span> <span class="id"><a href="compcert.common.Linking.html#p2">p2</a></span> -&gt; <span class="id"><a href="compcert.common.Linking.html#p2">p2</a></span>.(<span class="id"><a href="compcert.common.AST.html#prog_main">prog_main</a></span>) = <span class="id"><a href="compcert.common.Linking.html#p1">p1</a></span>.(<span class="id"><a href="compcert.common.AST.html#prog_main">prog_main</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1245')">Proof.</div>
<div class="proofscript" id="proof1245">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id">H</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="match_program_public">match_program_public</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ctx</span> <span class="id">p1</span> <span class="id">p2</span>, <span class="id"><a href="compcert.common.Linking.html#match_program_gen">match_program_gen</a></span> <span class="id"><a href="compcert.common.Linking.html#ctx">ctx</a></span> <span class="id"><a href="compcert.common.Linking.html#p1">p1</a></span> <span class="id"><a href="compcert.common.Linking.html#p2">p2</a></span> -&gt; <span class="id"><a href="compcert.common.Linking.html#p2">p2</a></span>.(<span class="id"><a href="compcert.common.AST.html#prog_public">prog_public</a></span>) = <span class="id"><a href="compcert.common.Linking.html#p1">p1</a></span>.(<span class="id"><a href="compcert.common.AST.html#prog_public">prog_public</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1246')">Proof.</div>
<div class="proofscript" id="proof1246">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id">H</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.common.Linking.html#MATCH_PROGRAM_GENERIC">MATCH_PROGRAM_GENERIC</a></span>.<br/>
<br/>
<div class="doc">In many cases, the context for <span class="bracket"><span class="id">match_program_gen</span></span> is the source program or
  source compilation unit itself.  We provide a specialized definition for this case. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="match_program">match_program</a></span> {<span class="id">F1</span> <span class="id">V1</span> <span class="id">F2</span> <span class="id">V2</span>: <span class="kwd">Type</span>} {<span class="id">LF</span>: <span class="id"><a href="compcert.common.Linking.html#Linker">Linker</a></span> <span class="id"><a href="compcert.common.Linking.html#F1">F1</a></span>} {<span class="id">LV</span>: <span class="id"><a href="compcert.common.Linking.html#Linker">Linker</a></span> <span class="id"><a href="compcert.common.Linking.html#V1">V1</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">match_fundef</span>: <span class="id"><a href="compcert.common.AST.html#program">program</a></span> <span class="id"><a href="compcert.common.Linking.html#F1">F1</a></span> <span class="id"><a href="compcert.common.Linking.html#V1">V1</a></span> -&gt; <span class="id"><a href="compcert.common.Linking.html#F1">F1</a></span> -&gt; <span class="id"><a href="compcert.common.Linking.html#F2">F2</a></span> -&gt; <span class="kwd">Prop</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">match_varinfo</span>: <span class="id"><a href="compcert.common.Linking.html#V1">V1</a></span> -&gt; <span class="id"><a href="compcert.common.Linking.html#V2">V2</a></span> -&gt; <span class="kwd">Prop</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">p1</span>: <span class="id"><a href="compcert.common.AST.html#program">program</a></span> <span class="id"><a href="compcert.common.Linking.html#F1">F1</a></span> <span class="id"><a href="compcert.common.Linking.html#V1">V1</a></span>) (<span class="id">p2</span>: <span class="id"><a href="compcert.common.AST.html#program">program</a></span> <span class="id"><a href="compcert.common.Linking.html#F2">F2</a></span> <span class="id"><a href="compcert.common.Linking.html#V2">V2</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#match_program_gen">match_program_gen</a></span> <span class="id"><a href="compcert.common.Linking.html#match_fundef">match_fundef</a></span> <span class="id"><a href="compcert.common.Linking.html#match_varinfo">match_varinfo</a></span> <span class="id"><a href="compcert.common.Linking.html#p1">p1</a></span> <span class="id"><a href="compcert.common.Linking.html#p1">p1</a></span> <span class="id"><a href="compcert.common.Linking.html#p2">p2</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="match_program_main">match_program_main</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">F1</span> <span class="id">V1</span> <span class="id">F2</span> <span class="id">V2</span>: <span class="kwd">Type</span>} {<span class="id">LF</span>: <span class="id"><a href="compcert.common.Linking.html#Linker">Linker</a></span> <span class="id"><a href="compcert.common.Linking.html#F1">F1</a></span>} {<span class="id">LV</span>: <span class="id"><a href="compcert.common.Linking.html#Linker">Linker</a></span> <span class="id"><a href="compcert.common.Linking.html#V1">V1</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">match_fundef</span>: <span class="id"><a href="compcert.common.AST.html#program">program</a></span> <span class="id"><a href="compcert.common.Linking.html#F1">F1</a></span> <span class="id"><a href="compcert.common.Linking.html#V1">V1</a></span> -&gt; <span class="id"><a href="compcert.common.Linking.html#F1">F1</a></span> -&gt; <span class="id"><a href="compcert.common.Linking.html#F2">F2</a></span> -&gt; <span class="kwd">Prop</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">match_varinfo</span>: <span class="id"><a href="compcert.common.Linking.html#V1">V1</a></span> -&gt; <span class="id"><a href="compcert.common.Linking.html#V2">V2</a></span> -&gt; <span class="kwd">Prop</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">p1</span>: <span class="id"><a href="compcert.common.AST.html#program">program</a></span> <span class="id"><a href="compcert.common.Linking.html#F1">F1</a></span> <span class="id"><a href="compcert.common.Linking.html#V1">V1</a></span>} {<span class="id">p2</span>: <span class="id"><a href="compcert.common.AST.html#program">program</a></span> <span class="id"><a href="compcert.common.Linking.html#F2">F2</a></span> <span class="id"><a href="compcert.common.Linking.html#V2">V2</a></span>},<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#match_program">match_program</a></span> <span class="id"><a href="compcert.common.Linking.html#match_fundef">match_fundef</a></span> <span class="id"><a href="compcert.common.Linking.html#match_varinfo">match_varinfo</a></span> <span class="id"><a href="compcert.common.Linking.html#p1">p1</a></span> <span class="id"><a href="compcert.common.Linking.html#p2">p2</a></span> -&gt; <span class="id"><a href="compcert.common.Linking.html#p2">p2</a></span>.(<span class="id"><a href="compcert.common.AST.html#prog_main">prog_main</a></span>) = <span class="id"><a href="compcert.common.Linking.html#p1">p1</a></span>.(<span class="id"><a href="compcert.common.AST.html#prog_main">prog_main</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1247')">Proof.</div>
<div class="proofscript" id="proof1247">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id">H</span>.<br/>
Qed.</div>
<br/>
<br/>
<div class="doc">Relation between the program transformation functions from <span class="bracket"><span class="id">AST</span></span>
  and the <span class="bracket"><span class="id">match_program</span></span> predicate. </div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="match_transform_partial_program2">match_transform_partial_program2</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">C</span> <span class="id">F1</span> <span class="id">V1</span> <span class="id">F2</span> <span class="id">V2</span>: <span class="kwd">Type</span>} {<span class="id">LC</span>: <span class="id"><a href="compcert.common.Linking.html#Linker">Linker</a></span> <span class="id"><a href="compcert.common.Linking.html#C">C</a></span>} {<span class="id">LF</span>: <span class="id"><a href="compcert.common.Linking.html#Linker">Linker</a></span> <span class="id"><a href="compcert.common.Linking.html#F1">F1</a></span>} {<span class="id">LV</span>: <span class="id"><a href="compcert.common.Linking.html#Linker">Linker</a></span> <span class="id"><a href="compcert.common.Linking.html#V1">V1</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">match_fundef</span>: <span class="id"><a href="compcert.common.Linking.html#C">C</a></span> -&gt; <span class="id"><a href="compcert.common.Linking.html#F1">F1</a></span> -&gt; <span class="id"><a href="compcert.common.Linking.html#F2">F2</a></span> -&gt; <span class="kwd">Prop</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">match_varinfo</span>: <span class="id"><a href="compcert.common.Linking.html#V1">V1</a></span> -&gt; <span class="id"><a href="compcert.common.Linking.html#V2">V2</a></span> -&gt; <span class="kwd">Prop</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">transf_fun</span>: <span class="id"><a href="compcert.common.AST.html#ident">ident</a></span> -&gt; <span class="id"><a href="compcert.common.Linking.html#F1">F1</a></span> -&gt; <span class="id"><a href="compcert.common.Errors.html#res">res</a></span> <span class="id"><a href="compcert.common.Linking.html#F2">F2</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">transf_var</span>: <span class="id"><a href="compcert.common.AST.html#ident">ident</a></span> -&gt; <span class="id"><a href="compcert.common.Linking.html#V1">V1</a></span> -&gt; <span class="id"><a href="compcert.common.Errors.html#res">res</a></span> <span class="id"><a href="compcert.common.Linking.html#V2">V2</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ctx</span>: <span class="id"><a href="compcert.common.Linking.html#C">C</a></span>) (<span class="id">p</span>: <span class="id"><a href="compcert.common.AST.html#program">program</a></span> <span class="id"><a href="compcert.common.Linking.html#F1">F1</a></span> <span class="id"><a href="compcert.common.Linking.html#V1">V1</a></span>) (<span class="id">tp</span>: <span class="id"><a href="compcert.common.AST.html#program">program</a></span> <span class="id"><a href="compcert.common.Linking.html#F2">F2</a></span> <span class="id"><a href="compcert.common.Linking.html#V2">V2</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.AST.html#transform_partial_program2">transform_partial_program2</a></span> <span class="id"><a href="compcert.common.Linking.html#transf_fun">transf_fun</a></span> <span class="id"><a href="compcert.common.Linking.html#transf_var">transf_var</a></span> <span class="id"><a href="compcert.common.Linking.html#p">p</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.common.Linking.html#tp">tp</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">i</span> <span class="id">f</span> <span class="id">tf</span>, <span class="id"><a href="compcert.common.Linking.html#transf_fun">transf_fun</a></span> <span class="id"><a href="compcert.common.Linking.html#i">i</a></span> <span class="id"><a href="compcert.common.Linking.html#f">f</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.common.Linking.html#tf">tf</a></span> -&gt; <span class="id"><a href="compcert.common.Linking.html#match_fundef">match_fundef</a></span> <span class="id"><a href="compcert.common.Linking.html#ctx">ctx</a></span> <span class="id"><a href="compcert.common.Linking.html#f">f</a></span> <span class="id"><a href="compcert.common.Linking.html#tf">tf</a></span>) -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">i</span> <span class="id">v</span> <span class="id">tv</span>, <span class="id"><a href="compcert.common.Linking.html#transf_var">transf_var</a></span> <span class="id"><a href="compcert.common.Linking.html#i">i</a></span> <span class="id"><a href="compcert.common.Linking.html#v">v</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.common.Linking.html#tv">tv</a></span> -&gt; <span class="id"><a href="compcert.common.Linking.html#match_varinfo">match_varinfo</a></span> <span class="id"><a href="compcert.common.Linking.html#v">v</a></span> <span class="id"><a href="compcert.common.Linking.html#tv">tv</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#match_program_gen">match_program_gen</a></span> <span class="id"><a href="compcert.common.Linking.html#match_fundef">match_fundef</a></span> <span class="id"><a href="compcert.common.Linking.html#match_varinfo">match_varinfo</a></span> <span class="id"><a href="compcert.common.Linking.html#ctx">ctx</a></span> <span class="id"><a href="compcert.common.Linking.html#p">p</a></span> <span class="id"><a href="compcert.common.Linking.html#tp">tp</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1248')">Proof.</div>
<div class="proofscript" id="proof1248">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.common.AST.html#transform_partial_program2">transform_partial_program2</a></span>; <span class="tactic">intros</span>. <span class="id">monadInv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">simpl</span>; <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">revert</span> <span class="id">x</span> <span class="id">EQ</span>. <span class="tactic">generalize</span> (<span class="id"><a href="compcert.common.AST.html#prog_defs">prog_defs</a></span> <span class="id">p</span>).<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span> <span class="kwd">as</span> [ | [<span class="id">i</span> <span class="id">g</span>] <span class="id">l</span>]; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
- <span class="id">monadInv</span> <span class="id">EQ</span>. <span class="id">constructor</span>.<br/>
- <span class="tactic">destruct</span> <span class="id">g</span> <span class="kwd">as</span> [<span class="id">f</span>|<span class="id">v</span>].<br/>
+ <span class="tactic">destruct</span> (<span class="id">transf_fun</span> <span class="id">i</span> <span class="id">f</span>) <span class="kwd">as</span> [<span class="id">tf</span>|?] <span class="id">eqn</span>:<span class="id">TF</span>; <span class="id">monadInv</span> <span class="id">EQ</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">auto</span>. <span class="tactic">split</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>. <span class="id">econstructor</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Linking.html#linkorder_refl">linkorder_refl</a></span>. <span class="tactic">eauto</span>.<br/>
+ <span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.AST.html#transf_globvar">transf_globvar</a></span> <span class="id">transf_var</span> <span class="id">i</span> <span class="id">v</span>) <span class="kwd">as</span> [<span class="id">tv</span>|?] <span class="id">eqn</span>:<span class="id">TV</span>; <span class="id">monadInv</span> <span class="id">EQ</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">auto</span>. <span class="tactic">split</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">monadInv</span> <span class="id">TV</span>. <span class="tactic">destruct</span> <span class="id">v</span>; <span class="tactic">simpl</span>; <span class="id">constructor</span>. <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="match_transform_partial_program_contextual">match_transform_partial_program_contextual</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">A</span> <span class="id">B</span> <span class="id">V</span>: <span class="kwd">Type</span>} {<span class="id">LA</span>: <span class="id"><a href="compcert.common.Linking.html#Linker">Linker</a></span> <span class="id"><a href="compcert.common.Linking.html#A">A</a></span>} {<span class="id">LV</span>: <span class="id"><a href="compcert.common.Linking.html#Linker">Linker</a></span> <span class="id"><a href="compcert.common.Linking.html#V">V</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">match_fundef</span>: <span class="id"><a href="compcert.common.AST.html#program">program</a></span> <span class="id"><a href="compcert.common.Linking.html#A">A</a></span> <span class="id"><a href="compcert.common.Linking.html#V">V</a></span> -&gt; <span class="id"><a href="compcert.common.Linking.html#A">A</a></span> -&gt; <span class="id"><a href="compcert.common.Linking.html#B">B</a></span> -&gt; <span class="kwd">Prop</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">transf_fun</span>: <span class="id"><a href="compcert.common.Linking.html#A">A</a></span> -&gt; <span class="id"><a href="compcert.common.Errors.html#res">res</a></span> <span class="id"><a href="compcert.common.Linking.html#B">B</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">p</span>: <span class="id"><a href="compcert.common.AST.html#program">program</a></span> <span class="id"><a href="compcert.common.Linking.html#A">A</a></span> <span class="id"><a href="compcert.common.Linking.html#V">V</a></span>) (<span class="id">tp</span>: <span class="id"><a href="compcert.common.AST.html#program">program</a></span> <span class="id"><a href="compcert.common.Linking.html#B">B</a></span> <span class="id"><a href="compcert.common.Linking.html#V">V</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.AST.html#transform_partial_program">transform_partial_program</a></span> <span class="id"><a href="compcert.common.Linking.html#transf_fun">transf_fun</a></span> <span class="id"><a href="compcert.common.Linking.html#p">p</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.common.Linking.html#tp">tp</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">f</span> <span class="id">tf</span>, <span class="id"><a href="compcert.common.Linking.html#transf_fun">transf_fun</a></span> <span class="id"><a href="compcert.common.Linking.html#f">f</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.common.Linking.html#tf">tf</a></span> -&gt; <span class="id"><a href="compcert.common.Linking.html#match_fundef">match_fundef</a></span> <span class="id"><a href="compcert.common.Linking.html#p">p</a></span> <span class="id"><a href="compcert.common.Linking.html#f">f</a></span> <span class="id"><a href="compcert.common.Linking.html#tf">tf</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#match_program">match_program</a></span> <span class="id"><a href="compcert.common.Linking.html#match_fundef">match_fundef</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> <span class="id"><a href="compcert.common.Linking.html#p">p</a></span> <span class="id"><a href="compcert.common.Linking.html#tp">tp</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1249')">Proof.</div>
<div class="proofscript" id="proof1249">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Linking.html#match_transform_partial_program2">match_transform_partial_program2</a></span>. <span class="id">eexact</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">intros</span>. <span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="match_transform_program_contextual">match_transform_program_contextual</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">A</span> <span class="id">B</span> <span class="id">V</span>: <span class="kwd">Type</span>} {<span class="id">LA</span>: <span class="id"><a href="compcert.common.Linking.html#Linker">Linker</a></span> <span class="id"><a href="compcert.common.Linking.html#A">A</a></span>} {<span class="id">LV</span>: <span class="id"><a href="compcert.common.Linking.html#Linker">Linker</a></span> <span class="id"><a href="compcert.common.Linking.html#V">V</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">match_fundef</span>: <span class="id"><a href="compcert.common.AST.html#program">program</a></span> <span class="id"><a href="compcert.common.Linking.html#A">A</a></span> <span class="id"><a href="compcert.common.Linking.html#V">V</a></span> -&gt; <span class="id"><a href="compcert.common.Linking.html#A">A</a></span> -&gt; <span class="id"><a href="compcert.common.Linking.html#B">B</a></span> -&gt; <span class="kwd">Prop</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">transf_fun</span>: <span class="id"><a href="compcert.common.Linking.html#A">A</a></span> -&gt; <span class="id"><a href="compcert.common.Linking.html#B">B</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">p</span>: <span class="id"><a href="compcert.common.AST.html#program">program</a></span> <span class="id"><a href="compcert.common.Linking.html#A">A</a></span> <span class="id"><a href="compcert.common.Linking.html#V">V</a></span>),<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">f</span>, <span class="id"><a href="compcert.common.Linking.html#match_fundef">match_fundef</a></span> <span class="id"><a href="compcert.common.Linking.html#p">p</a></span> <span class="id"><a href="compcert.common.Linking.html#f">f</a></span> (<span class="id"><a href="compcert.common.Linking.html#transf_fun">transf_fun</a></span> <span class="id"><a href="compcert.common.Linking.html#f">f</a></span>)) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#match_program">match_program</a></span> <span class="id"><a href="compcert.common.Linking.html#match_fundef">match_fundef</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> <span class="id"><a href="compcert.common.Linking.html#p">p</a></span> (<span class="id"><a href="compcert.common.AST.html#transform_program">transform_program</a></span> <span class="id"><a href="compcert.common.Linking.html#transf_fun">transf_fun</a></span> <span class="id"><a href="compcert.common.Linking.html#p">p</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1250')">Proof.</div>
<div class="proofscript" id="proof1250">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Linking.html#match_transform_partial_program_contextual">match_transform_partial_program_contextual</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.AST.html#transform_program_partial_program">transform_program_partial_program</a></span> <span class="kwd">with</span> (<span class="id">transf_fun</span> := <span class="id">transf_fun</span>).<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H0</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">The following two theorems are simpler versions for the case where the
  function transformation does not depend on the compilation unit. </div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="match_transform_partial_program">match_transform_partial_program</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">A</span> <span class="id">B</span> <span class="id">V</span>: <span class="kwd">Type</span>} {<span class="id">LA</span>: <span class="id"><a href="compcert.common.Linking.html#Linker">Linker</a></span> <span class="id"><a href="compcert.common.Linking.html#A">A</a></span>} {<span class="id">LV</span>: <span class="id"><a href="compcert.common.Linking.html#Linker">Linker</a></span> <span class="id"><a href="compcert.common.Linking.html#V">V</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">transf_fun</span>: <span class="id"><a href="compcert.common.Linking.html#A">A</a></span> -&gt; <span class="id"><a href="compcert.common.Errors.html#res">res</a></span> <span class="id"><a href="compcert.common.Linking.html#B">B</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">p</span>: <span class="id"><a href="compcert.common.AST.html#program">program</a></span> <span class="id"><a href="compcert.common.Linking.html#A">A</a></span> <span class="id"><a href="compcert.common.Linking.html#V">V</a></span>) (<span class="id">tp</span>: <span class="id"><a href="compcert.common.AST.html#program">program</a></span> <span class="id"><a href="compcert.common.Linking.html#B">B</a></span> <span class="id"><a href="compcert.common.Linking.html#V">V</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.AST.html#transform_partial_program">transform_partial_program</a></span> <span class="id"><a href="compcert.common.Linking.html#transf_fun">transf_fun</a></span> <span class="id"><a href="compcert.common.Linking.html#p">p</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.common.Linking.html#tp">tp</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#match_program">match_program</a></span> (<span class="kwd">fun</span> <span class="id">cu</span> <span class="id">f</span> <span class="id">tf</span> =&gt; <span class="id"><a href="compcert.common.Linking.html#transf_fun">transf_fun</a></span> <span class="id"><a href="compcert.common.Linking.html#f">f</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.common.Linking.html#tf">tf</a></span>) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> <span class="id"><a href="compcert.common.Linking.html#p">p</a></span> <span class="id"><a href="compcert.common.Linking.html#tp">tp</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1251')">Proof.</div>
<div class="proofscript" id="proof1251">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Linking.html#match_transform_partial_program2">match_transform_partial_program2</a></span>. <span class="id">eexact</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">intros</span>. <span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="match_transform_program">match_transform_program</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> {<span class="id">A</span> <span class="id">B</span> <span class="id">V</span>: <span class="kwd">Type</span>} {<span class="id">LA</span>: <span class="id"><a href="compcert.common.Linking.html#Linker">Linker</a></span> <span class="id"><a href="compcert.common.Linking.html#A">A</a></span>} {<span class="id">LV</span>: <span class="id"><a href="compcert.common.Linking.html#Linker">Linker</a></span> <span class="id"><a href="compcert.common.Linking.html#V">V</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">transf</span>: <span class="id"><a href="compcert.common.Linking.html#A">A</a></span> -&gt; <span class="id"><a href="compcert.common.Linking.html#B">B</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">p</span>: <span class="id"><a href="compcert.common.AST.html#program">program</a></span> <span class="id"><a href="compcert.common.Linking.html#A">A</a></span> <span class="id"><a href="compcert.common.Linking.html#V">V</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#match_program">match_program</a></span> (<span class="kwd">fun</span> <span class="id">cu</span> <span class="id">f</span> <span class="id">tf</span> =&gt; <span class="id"><a href="compcert.common.Linking.html#tf">tf</a></span> = <span class="id"><a href="compcert.common.Linking.html#transf">transf</a></span> <span class="id"><a href="compcert.common.Linking.html#f">f</a></span>) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> <span class="id"><a href="compcert.common.Linking.html#p">p</a></span> (<span class="id"><a href="compcert.common.AST.html#transform_program">transform_program</a></span> <span class="id"><a href="compcert.common.Linking.html#transf">transf</a></span> <span class="id"><a href="compcert.common.Linking.html#p">p</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1252')">Proof.</div>
<div class="proofscript" id="proof1252">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Linking.html#match_transform_program_contextual">match_transform_program_contextual</a></span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<h1> Commutation between linking and program transformations </h1>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="LINK_MATCH_PROGRAM">LINK_MATCH_PROGRAM</a></span>.<br/>
<br/>
<span class="kwd">Context</span> {<span class="id">C</span> <span class="id">F1</span> <span class="id">V1</span> <span class="id">F2</span> <span class="id">V2</span>: <span class="kwd">Type</span>} {<span class="id">LC</span>: <span class="id"><a href="compcert.common.Linking.html#Linker">Linker</a></span> <span class="id"><a href="compcert.common.Linking.html#C">C</a></span>} {<span class="id">LF1</span>: <span class="id"><a href="compcert.common.Linking.html#Linker">Linker</a></span> <span class="id"><a href="compcert.common.Linking.html#F1">F1</a></span>} {<span class="id">LF2</span>: <span class="id"><a href="compcert.common.Linking.html#Linker">Linker</a></span> <span class="id"><a href="compcert.common.Linking.html#F2">F2</a></span>} {<span class="id">LV1</span>: <span class="id"><a href="compcert.common.Linking.html#Linker">Linker</a></span> <span class="id"><a href="compcert.common.Linking.html#V1">V1</a></span>} {<span class="id">LV2</span>: <span class="id"><a href="compcert.common.Linking.html#Linker">Linker</a></span> <span class="id"><a href="compcert.common.Linking.html#V2">V2</a></span>}.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="LINK_MATCH_PROGRAM.match_fundef">match_fundef</a></span>: <span class="id"><a href="compcert.common.Linking.html#LINK_MATCH_PROGRAM.C">C</a></span> -&gt; <span class="id"><a href="compcert.common.Linking.html#LINK_MATCH_PROGRAM.F1">F1</a></span> -&gt; <span class="id"><a href="compcert.common.Linking.html#LINK_MATCH_PROGRAM.F2">F2</a></span> -&gt; <span class="kwd">Prop</span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="LINK_MATCH_PROGRAM.match_varinfo">match_varinfo</a></span>: <span class="id"><a href="compcert.common.Linking.html#LINK_MATCH_PROGRAM.V1">V1</a></span> -&gt; <span class="id"><a href="compcert.common.Linking.html#LINK_MATCH_PROGRAM.V2">V2</a></span> -&gt; <span class="kwd">Prop</span>.<br/>
<br/>
<span class="kwd">Local</span> <span class="id">Transparent</span> <span class="id"><a href="compcert.common.Linking.html#Linker_vardef">Linker_vardef</a></span> <span class="id"><a href="compcert.common.Linking.html#Linker_def">Linker_def</a></span> <span class="id"><a href="compcert.common.Linking.html#Linker_prog">Linker_prog</a></span>.<br/>
<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="LINK_MATCH_PROGRAM.link_match_fundef">link_match_fundef</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ctx1</span> <span class="id">ctx2</span> <span class="id">f1</span> <span class="id">tf1</span> <span class="id">f2</span> <span class="id">tf2</span> <span class="id">f</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#link">link</a></span> <span class="id"><a href="compcert.common.Linking.html#f1">f1</a></span> <span class="id"><a href="compcert.common.Linking.html#f2">f2</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.common.Linking.html#f">f</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#LINK_MATCH_PROGRAM.match_fundef">match_fundef</a></span> <span class="id"><a href="compcert.common.Linking.html#ctx1">ctx1</a></span> <span class="id"><a href="compcert.common.Linking.html#f1">f1</a></span> <span class="id"><a href="compcert.common.Linking.html#tf1">tf1</a></span> -&gt; <span class="id"><a href="compcert.common.Linking.html#LINK_MATCH_PROGRAM.match_fundef">match_fundef</a></span> <span class="id"><a href="compcert.common.Linking.html#ctx2">ctx2</a></span> <span class="id"><a href="compcert.common.Linking.html#f2">f2</a></span> <span class="id"><a href="compcert.common.Linking.html#tf2">tf2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">tf</span>, <span class="id"><a href="compcert.common.Linking.html#link">link</a></span> <span class="id"><a href="compcert.common.Linking.html#tf1">tf1</a></span> <span class="id"><a href="compcert.common.Linking.html#tf2">tf2</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.common.Linking.html#tf">tf</a></span> /\ (<span class="id"><a href="compcert.common.Linking.html#LINK_MATCH_PROGRAM.match_fundef">match_fundef</a></span> <span class="id"><a href="compcert.common.Linking.html#ctx1">ctx1</a></span> <span class="id"><a href="compcert.common.Linking.html#f">f</a></span> <span class="id"><a href="compcert.common.Linking.html#tf">tf</a></span> \/ <span class="id"><a href="compcert.common.Linking.html#LINK_MATCH_PROGRAM.match_fundef">match_fundef</a></span> <span class="id"><a href="compcert.common.Linking.html#ctx2">ctx2</a></span> <span class="id"><a href="compcert.common.Linking.html#f">f</a></span> <span class="id"><a href="compcert.common.Linking.html#tf">tf</a></span>).<br/>
<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="LINK_MATCH_PROGRAM.link_match_varinfo">link_match_varinfo</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">v1</span> <span class="id">tv1</span> <span class="id">v2</span> <span class="id">tv2</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#link">link</a></span> <span class="id"><a href="compcert.common.Linking.html#v1">v1</a></span> <span class="id"><a href="compcert.common.Linking.html#v2">v2</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.common.Linking.html#v">v</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#LINK_MATCH_PROGRAM.match_varinfo">match_varinfo</a></span> <span class="id"><a href="compcert.common.Linking.html#v1">v1</a></span> <span class="id"><a href="compcert.common.Linking.html#tv1">tv1</a></span> -&gt; <span class="id"><a href="compcert.common.Linking.html#LINK_MATCH_PROGRAM.match_varinfo">match_varinfo</a></span> <span class="id"><a href="compcert.common.Linking.html#v2">v2</a></span> <span class="id"><a href="compcert.common.Linking.html#tv2">tv2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">tv</span>, <span class="id"><a href="compcert.common.Linking.html#link">link</a></span> <span class="id"><a href="compcert.common.Linking.html#tv1">tv1</a></span> <span class="id"><a href="compcert.common.Linking.html#tv2">tv2</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.common.Linking.html#tv">tv</a></span> /\ <span class="id"><a href="compcert.common.Linking.html#LINK_MATCH_PROGRAM.match_varinfo">match_varinfo</a></span> <span class="id"><a href="compcert.common.Linking.html#v">v</a></span> <span class="id"><a href="compcert.common.Linking.html#tv">tv</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="link_match_globvar">link_match_globvar</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">v1</span> <span class="id">tv1</span> <span class="id">v2</span> <span class="id">tv2</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#link">link</a></span> <span class="id"><a href="compcert.common.Linking.html#v1">v1</a></span> <span class="id"><a href="compcert.common.Linking.html#v2">v2</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.common.Linking.html#v">v</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#match_globvar">match_globvar</a></span> <span class="id"><a href="compcert.common.Linking.html#LINK_MATCH_PROGRAM.match_varinfo">match_varinfo</a></span> <span class="id"><a href="compcert.common.Linking.html#v1">v1</a></span> <span class="id"><a href="compcert.common.Linking.html#tv1">tv1</a></span> -&gt; <span class="id"><a href="compcert.common.Linking.html#match_globvar">match_globvar</a></span> <span class="id"><a href="compcert.common.Linking.html#LINK_MATCH_PROGRAM.match_varinfo">match_varinfo</a></span> <span class="id"><a href="compcert.common.Linking.html#v2">v2</a></span> <span class="id"><a href="compcert.common.Linking.html#tv2">tv2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">tv</span>, <span class="id"><a href="compcert.common.Linking.html#link">link</a></span> <span class="id"><a href="compcert.common.Linking.html#tv1">tv1</a></span> <span class="id"><a href="compcert.common.Linking.html#tv2">tv2</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.common.Linking.html#tv">tv</a></span> /\ <span class="id"><a href="compcert.common.Linking.html#match_globvar">match_globvar</a></span> <span class="id"><a href="compcert.common.Linking.html#LINK_MATCH_PROGRAM.match_varinfo">match_varinfo</a></span> <span class="id"><a href="compcert.common.Linking.html#v">v</a></span> <span class="id"><a href="compcert.common.Linking.html#tv">tv</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1253')">Proof.</div>
<div class="proofscript" id="proof1253">
&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.common.Linking.html#link_vardef">link_vardef</a></span> <span class="kwd">in</span> *. <span class="id">inv</span> <span class="id">H0</span>; <span class="id">inv</span> <span class="id">H1</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.Linking.html#link">link</a></span> <span class="id">i1</span> <span class="id">i0</span>) <span class="kwd">as</span> [<span class="id">info</span>'|] <span class="id">eqn</span>:<span class="id">LINFO</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.Linking.html#link">link</a></span> <span class="id">init</span> <span class="id">init0</span>) <span class="kwd">as</span> [<span class="id">init</span>'|] <span class="id">eqn</span>:<span class="id">LINIT</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Bool.Bool.html#eqb">eqb</a></span> <span class="id">ro</span> <span class="id">ro0</span> &amp;&amp; <span class="id"><a href="http://coq.inria.fr/library/Coq.Bool.Bool.html#eqb">eqb</a></span> <span class="id">vo</span> <span class="id">vo0</span>); <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Linking.html#LINK_MATCH_PROGRAM.link_match_varinfo">link_match_varinfo</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">tinfo</span> &amp; <span class="id">P</span> &amp; <span class="id">Q</span>). <span class="tactic">rewrite</span> <span class="id">P</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>. <span class="tactic">eauto</span>. <span class="id">constructor</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="link_match_globdef">link_match_globdef</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ctx1</span> <span class="id">ctx2</span> <span class="id">ctx</span> <span class="id">g1</span> <span class="id">tg1</span> <span class="id">g2</span> <span class="id">tg2</span> <span class="id">g</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#linkorder">linkorder</a></span> <span class="id"><a href="compcert.common.Linking.html#ctx1">ctx1</a></span> <span class="id"><a href="compcert.common.Linking.html#ctx">ctx</a></span> -&gt; <span class="id"><a href="compcert.common.Linking.html#linkorder">linkorder</a></span> <span class="id"><a href="compcert.common.Linking.html#ctx2">ctx2</a></span> <span class="id"><a href="compcert.common.Linking.html#ctx">ctx</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#link">link</a></span> <span class="id"><a href="compcert.common.Linking.html#g1">g1</a></span> <span class="id"><a href="compcert.common.Linking.html#g2">g2</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.common.Linking.html#g">g</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#match_globdef">match_globdef</a></span> <span class="id"><a href="compcert.common.Linking.html#LINK_MATCH_PROGRAM.match_fundef">match_fundef</a></span> <span class="id"><a href="compcert.common.Linking.html#LINK_MATCH_PROGRAM.match_varinfo">match_varinfo</a></span> <span class="id"><a href="compcert.common.Linking.html#ctx1">ctx1</a></span> <span class="id"><a href="compcert.common.Linking.html#g1">g1</a></span> <span class="id"><a href="compcert.common.Linking.html#tg1">tg1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#match_globdef">match_globdef</a></span> <span class="id"><a href="compcert.common.Linking.html#LINK_MATCH_PROGRAM.match_fundef">match_fundef</a></span> <span class="id"><a href="compcert.common.Linking.html#LINK_MATCH_PROGRAM.match_varinfo">match_varinfo</a></span> <span class="id"><a href="compcert.common.Linking.html#ctx2">ctx2</a></span> <span class="id"><a href="compcert.common.Linking.html#g2">g2</a></span> <span class="id"><a href="compcert.common.Linking.html#tg2">tg2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">tg</span>, <span class="id"><a href="compcert.common.Linking.html#link">link</a></span> <span class="id"><a href="compcert.common.Linking.html#tg1">tg1</a></span> <span class="id"><a href="compcert.common.Linking.html#tg2">tg2</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.common.Linking.html#tg">tg</a></span> /\ <span class="id"><a href="compcert.common.Linking.html#match_globdef">match_globdef</a></span> <span class="id"><a href="compcert.common.Linking.html#LINK_MATCH_PROGRAM.match_fundef">match_fundef</a></span> <span class="id"><a href="compcert.common.Linking.html#LINK_MATCH_PROGRAM.match_varinfo">match_varinfo</a></span> <span class="id"><a href="compcert.common.Linking.html#ctx">ctx</a></span> <span class="id"><a href="compcert.common.Linking.html#g">g</a></span> <span class="id"><a href="compcert.common.Linking.html#tg">tg</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1254')">Proof.</div>
<div class="proofscript" id="proof1254">
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="id">link</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.common.Linking.html#link_def">link_def</a></span>. <span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H2</span>; <span class="id">inv</span> <span class="id">H3</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
- <span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.Linking.html#link">link</a></span> <span class="id">f1</span> <span class="id">f0</span>) <span class="kwd">as</span> [<span class="id">f</span>|] <span class="id">eqn</span>:<span class="id">LF</span>; <span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Linking.html#LINK_MATCH_PROGRAM.link_match_fundef">link_match_fundef</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">tf</span> &amp; <span class="id">P</span> &amp; <span class="id">Q</span>).<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">X</span>: <span class="id">exists</span> <span class="id">ctx</span>', <span class="id"><a href="compcert.common.Linking.html#linkorder">linkorder</a></span> <span class="id">ctx</span>' <span class="id">ctx</span> /\ <span class="id"><a href="compcert.common.Linking.html#LINK_MATCH_PROGRAM.match_fundef">match_fundef</a></span> <span class="id">ctx</span>' <span class="id">f</span> <span class="id">tf</span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">destruct</span> <span class="id">Q</span> <span class="kwd">as</span> [<span class="id">Q</span>|<span class="id">Q</span>]; <span class="id">econstructor</span>; (<span class="tactic">split</span>; [|<span class="id">eassumption</span>]).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Linking.html#linkorder_trans">linkorder_trans</a></span> <span class="kwd">with</span> <span class="id">ctx1</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Linking.html#linkorder_trans">linkorder_trans</a></span> <span class="kwd">with</span> <span class="id">ctx2</span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">X</span> <span class="kwd">as</span> (<span class="id">cu</span> &amp; <span class="id">X</span> &amp; <span class="id">Y</span>).<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="compcert.common.AST.html#Gfun">Gfun</a></span> <span class="id">tf</span>); <span class="tactic">split</span>. <span class="tactic">rewrite</span> <span class="id">P</span>; <span class="tactic">auto</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
- <span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.Linking.html#link">link</a></span> <span class="id">v1</span> <span class="id">v0</span>) <span class="kwd">as</span> [<span class="id">v</span>|] <span class="id">eqn</span>:<span class="id">LVAR</span>; <span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Linking.html#link_match_globvar">link_match_globvar</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">tv</span> &amp; <span class="id">P</span> &amp; <span class="id">Q</span>).<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="compcert.common.AST.html#Gvar">Gvar</a></span> <span class="id">tv</span>); <span class="tactic">split</span>. <span class="tactic">rewrite</span> <span class="id">P</span>; <span class="tactic">auto</span>. <span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="match_globdef_linkorder">match_globdef_linkorder</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ctx</span> <span class="id">ctx</span>' <span class="id">g</span> <span class="id">tg</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#match_globdef">match_globdef</a></span> <span class="id"><a href="compcert.common.Linking.html#LINK_MATCH_PROGRAM.match_fundef">match_fundef</a></span> <span class="id"><a href="compcert.common.Linking.html#LINK_MATCH_PROGRAM.match_varinfo">match_varinfo</a></span> <span class="id"><a href="compcert.common.Linking.html#ctx">ctx</a></span> <span class="id"><a href="compcert.common.Linking.html#g">g</a></span> <span class="id"><a href="compcert.common.Linking.html#tg">tg</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#linkorder">linkorder</a></span> <span class="id"><a href="compcert.common.Linking.html#ctx">ctx</a></span> <span class="id">ctx</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#match_globdef">match_globdef</a></span> <span class="id"><a href="compcert.common.Linking.html#LINK_MATCH_PROGRAM.match_fundef">match_fundef</a></span> <span class="id"><a href="compcert.common.Linking.html#LINK_MATCH_PROGRAM.match_varinfo">match_varinfo</a></span> <span class="id">ctx</span>' <span class="id"><a href="compcert.common.Linking.html#g">g</a></span> <span class="id"><a href="compcert.common.Linking.html#tg">tg</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1255')">Proof.</div>
<div class="proofscript" id="proof1255">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>.<br/>
- <span class="id">econstructor</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Linking.html#linkorder_trans">linkorder_trans</a></span>; <span class="tactic">eauto</span>. <span class="tactic">auto</span>.<br/>
- <span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="link_match_program">link_match_program</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ctx1</span> <span class="id">ctx2</span> <span class="id">ctx</span> <span class="id">p1</span> <span class="id">p2</span> <span class="id">tp1</span> <span class="id">tp2</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#link">link</a></span> <span class="id"><a href="compcert.common.Linking.html#p1">p1</a></span> <span class="id"><a href="compcert.common.Linking.html#p2">p2</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.common.Linking.html#p">p</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#match_program_gen">match_program_gen</a></span> <span class="id"><a href="compcert.common.Linking.html#LINK_MATCH_PROGRAM.match_fundef">match_fundef</a></span> <span class="id"><a href="compcert.common.Linking.html#LINK_MATCH_PROGRAM.match_varinfo">match_varinfo</a></span> <span class="id"><a href="compcert.common.Linking.html#ctx1">ctx1</a></span> <span class="id"><a href="compcert.common.Linking.html#p1">p1</a></span> <span class="id"><a href="compcert.common.Linking.html#tp1">tp1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#match_program_gen">match_program_gen</a></span> <span class="id"><a href="compcert.common.Linking.html#LINK_MATCH_PROGRAM.match_fundef">match_fundef</a></span> <span class="id"><a href="compcert.common.Linking.html#LINK_MATCH_PROGRAM.match_varinfo">match_varinfo</a></span> <span class="id"><a href="compcert.common.Linking.html#ctx2">ctx2</a></span> <span class="id"><a href="compcert.common.Linking.html#p2">p2</a></span> <span class="id"><a href="compcert.common.Linking.html#tp2">tp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#linkorder">linkorder</a></span> <span class="id"><a href="compcert.common.Linking.html#ctx1">ctx1</a></span> <span class="id"><a href="compcert.common.Linking.html#ctx">ctx</a></span> -&gt; <span class="id"><a href="compcert.common.Linking.html#linkorder">linkorder</a></span> <span class="id"><a href="compcert.common.Linking.html#ctx2">ctx2</a></span> <span class="id"><a href="compcert.common.Linking.html#ctx">ctx</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">tp</span>, <span class="id"><a href="compcert.common.Linking.html#link">link</a></span> <span class="id"><a href="compcert.common.Linking.html#tp1">tp1</a></span> <span class="id"><a href="compcert.common.Linking.html#tp2">tp2</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.common.Linking.html#tp">tp</a></span> /\ <span class="id"><a href="compcert.common.Linking.html#match_program_gen">match_program_gen</a></span> <span class="id"><a href="compcert.common.Linking.html#LINK_MATCH_PROGRAM.match_fundef">match_fundef</a></span> <span class="id"><a href="compcert.common.Linking.html#LINK_MATCH_PROGRAM.match_varinfo">match_varinfo</a></span> <span class="id"><a href="compcert.common.Linking.html#ctx">ctx</a></span> <span class="id"><a href="compcert.common.Linking.html#p">p</a></span> <span class="id"><a href="compcert.common.Linking.html#tp">tp</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1256')">Proof.</div>
<div class="proofscript" id="proof1256">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.Linking.html#link_prog_inv">link_prog_inv</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H</span>) <span class="kwd">as</span> (<span class="id">P</span> &amp; <span class="id">Q</span> &amp; <span class="id">R</span>).<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="id">H0</span>; <span class="tactic">intros</span> (<span class="id">A1</span> &amp; <span class="id">B1</span> &amp; <span class="id">C1</span>).<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="id">H1</span>; <span class="tactic">intros</span> (<span class="id">A2</span> &amp; <span class="id">B2</span> &amp; <span class="id">C2</span>).<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
- <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Linking.html#link_prog_succeeds">link_prog_succeeds</a></span>.<br/>
+ <span class="tactic">congruence</span>.<br/>
+ <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="compcert.common.Linking.html#match_program_defmap">match_program_defmap</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H0</span> <span class="id">id</span>) (<span class="id"><a href="compcert.common.Linking.html#match_program_defmap">match_program_defmap</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H1</span> <span class="id">id</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H4</span>, <span class="id">H5</span>. <span class="tactic">intros</span> <span class="id">R1</span> <span class="id">R2</span>; <span class="id">inv</span> <span class="id">R1</span>; <span class="id">inv</span> <span class="id">R2</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">Q</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">X</span> &amp; <span class="id">Y</span> &amp; <span class="id">gd</span> &amp; <span class="id">Z</span>).<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Linking.html#link_match_globdef">link_match_globdef</a></span>. <span class="id">eexact</span> <span class="id">H2</span>. <span class="id">eexact</span> <span class="id">H3</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">tg</span> &amp; <span class="id">TL</span> &amp; <span class="id">_</span>). <span class="tactic">intuition</span> <span class="tactic">congruence</span>.<br/>
- <span class="tactic">split</span>; [|<span class="tactic">split</span>].<br/>
+ <span class="tactic">rewrite</span> <span class="id">R</span>. <span class="tactic">apply</span> <span class="id">PTree.elements_canonical_order</span>'. <span class="tactic">intros</span> <span class="id">id</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> ! <span class="id"><a href="compcert.lib.Maps.html#PTree.gcombine">PTree.gcombine</a></span> <span class="tactic">by</span> <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="compcert.common.Linking.html#match_program_defmap">match_program_defmap</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H0</span> <span class="id">id</span>) (<span class="id"><a href="compcert.common.Linking.html#match_program_defmap">match_program_defmap</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H1</span> <span class="id">id</span>).<br/>
&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">R</span>. <span class="tactic">intros</span> <span class="id">R1</span> <span class="id">R2</span>; <span class="id">inv</span> <span class="id">R1</span>; <span class="id">inv</span> <span class="id">R2</span>; <span class="tactic">unfold</span> <span class="id"><a href="compcert.common.Linking.html#link_prog_merge">link_prog_merge</a></span>.<br/>
* <span class="id">constructor</span>.<br/>
* <span class="id">constructor</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Linking.html#match_globdef_linkorder">match_globdef_linkorder</a></span> <span class="kwd">with</span> <span class="id">ctx2</span>; <span class="tactic">auto</span>.<br/>
* <span class="id">constructor</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Linking.html#match_globdef_linkorder">match_globdef_linkorder</a></span> <span class="kwd">with</span> <span class="id">ctx1</span>; <span class="tactic">auto</span>.<br/>
* <span class="id">exploit</span> <span class="id">Q</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">X</span> &amp; <span class="id">Y</span> &amp; <span class="id">gd</span> &amp; <span class="id">Z</span>).<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Linking.html#link_match_globdef">link_match_globdef</a></span>. <span class="id">eexact</span> <span class="id">H2</span>. <span class="id">eexact</span> <span class="id">H3</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">tg</span> &amp; <span class="id">TL</span> &amp; <span class="id">MG</span>). <span class="tactic">rewrite</span> <span class="id">Z</span>, <span class="id">TL</span>. <span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
+ <span class="tactic">rewrite</span> <span class="id">R</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
+ <span class="tactic">rewrite</span> <span class="id">R</span>; <span class="tactic">simpl</span>. <span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.common.Linking.html#LINK_MATCH_PROGRAM">LINK_MATCH_PROGRAM</a></span>.<br/>
<br/>
<div class="doc">We now wrap this commutation diagram into a class, and provide some common instances. </div>
<br/>
<span class="kwd">Class</span> <span class="id"><a name="TransfLink">TransfLink</a></span> {<span class="id">A</span> <span class="id">B</span>: <span class="kwd">Type</span>} {<span class="id">LA</span>: <span class="id"><a href="compcert.common.Linking.html#Linker">Linker</a></span> <span class="id"><a href="compcert.common.Linking.html#A">A</a></span>} {<span class="id">LB</span>: <span class="id"><a href="compcert.common.Linking.html#Linker">Linker</a></span> <span class="id"><a href="compcert.common.Linking.html#B">B</a></span>} (<span class="id">transf</span>: <span class="id"><a href="compcert.common.Linking.html#A">A</a></span> -&gt; <span class="id"><a href="compcert.common.Linking.html#B">B</a></span> -&gt; <span class="kwd">Prop</span>) :=<br/>
&nbsp;&nbsp;<span class="id"><a name="transf_link">transf_link</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">p1</span> <span class="id">p2</span>: <span class="id"><a href="compcert.common.Linking.html#A">A</a></span>) (<span class="id">tp1</span> <span class="id">tp2</span>: <span class="id"><a href="compcert.common.Linking.html#B">B</a></span>) (<span class="id">p</span>: <span class="id"><a href="compcert.common.Linking.html#A">A</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#link">link</a></span> <span class="id"><a href="compcert.common.Linking.html#p1">p1</a></span> <span class="id"><a href="compcert.common.Linking.html#p2">p2</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.common.Linking.html#p">p</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#transf">transf</a></span> <span class="id"><a href="compcert.common.Linking.html#p1">p1</a></span> <span class="id"><a href="compcert.common.Linking.html#tp1">tp1</a></span> -&gt; <span class="id"><a href="compcert.common.Linking.html#transf">transf</a></span> <span class="id"><a href="compcert.common.Linking.html#p2">p2</a></span> <span class="id"><a href="compcert.common.Linking.html#tp2">tp2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">tp</span>, <span class="id"><a href="compcert.common.Linking.html#link">link</a></span> <span class="id"><a href="compcert.common.Linking.html#tp1">tp1</a></span> <span class="id"><a href="compcert.common.Linking.html#tp2">tp2</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.common.Linking.html#tp">tp</a></span> /\ <span class="id"><a href="compcert.common.Linking.html#transf">transf</a></span> <span class="id"><a href="compcert.common.Linking.html#p">p</a></span> <span class="id"><a href="compcert.common.Linking.html#tp">tp</a></span>.<br/>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="link_transf_partial_fundef">link_transf_partial_fundef</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">A</span> <span class="id">B</span>: <span class="kwd">Type</span>) (<span class="id">tr1</span> <span class="id">tr2</span>: <span class="id"><a href="compcert.common.Linking.html#A">A</a></span> -&gt; <span class="id"><a href="compcert.common.Errors.html#res">res</a></span> <span class="id"><a href="compcert.common.Linking.html#B">B</a></span>) (<span class="id">f1</span> <span class="id">f2</span>: <span class="id"><a href="compcert.common.AST.html#fundef">fundef</a></span> <span class="id"><a href="compcert.common.Linking.html#A">A</a></span>) (<span class="id">tf1</span> <span class="id">tf2</span>: <span class="id"><a href="compcert.common.AST.html#fundef">fundef</a></span> <span class="id"><a href="compcert.common.Linking.html#B">B</a></span>) (<span class="id">f</span>: <span class="id"><a href="compcert.common.AST.html#fundef">fundef</a></span> <span class="id"><a href="compcert.common.Linking.html#A">A</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#link">link</a></span> <span class="id"><a href="compcert.common.Linking.html#f1">f1</a></span> <span class="id"><a href="compcert.common.Linking.html#f2">f2</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.common.Linking.html#f">f</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.AST.html#transf_partial_fundef">transf_partial_fundef</a></span> <span class="id"><a href="compcert.common.Linking.html#tr1">tr1</a></span> <span class="id"><a href="compcert.common.Linking.html#f1">f1</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.common.Linking.html#tf1">tf1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.AST.html#transf_partial_fundef">transf_partial_fundef</a></span> <span class="id"><a href="compcert.common.Linking.html#tr2">tr2</a></span> <span class="id"><a href="compcert.common.Linking.html#f2">f2</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.common.Linking.html#tf2">tf2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">tf</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#link">link</a></span> <span class="id"><a href="compcert.common.Linking.html#tf1">tf1</a></span> <span class="id"><a href="compcert.common.Linking.html#tf2">tf2</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.common.Linking.html#tf">tf</a></span><br/>
&nbsp;&nbsp;/\ (<span class="id"><a href="compcert.common.AST.html#transf_partial_fundef">transf_partial_fundef</a></span> <span class="id"><a href="compcert.common.Linking.html#tr1">tr1</a></span> <span class="id"><a href="compcert.common.Linking.html#f">f</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.common.Linking.html#tf">tf</a></span> \/ <span class="id"><a href="compcert.common.AST.html#transf_partial_fundef">transf_partial_fundef</a></span> <span class="id"><a href="compcert.common.Linking.html#tr2">tr2</a></span> <span class="id"><a href="compcert.common.Linking.html#f">f</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.common.Linking.html#tf">tf</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1257')">Proof.</div>
<div class="proofscript" id="proof1257">
<span class="kwd">Local</span> <span class="id">Transparent</span> <span class="id"><a href="compcert.common.Linking.html#Linker_fundef">Linker_fundef</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">f1</span> <span class="kwd">as</span> [<span class="id">f1</span>|<span class="id">ef1</span>], <span class="id">f2</span> <span class="kwd">as</span> [<span class="id">f2</span>|<span class="id">ef2</span>]; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="id">monadInv</span> <span class="id">H0</span>; <span class="id">monadInv</span> <span class="id">H1</span>.<br/>
- <span class="tactic">discriminate</span>.<br/>
- <span class="tactic">destruct</span> <span class="id">ef2</span>; <span class="id">inv</span> <span class="id">H</span>. <span class="id">exists</span> (<span class="id"><a href="compcert.common.AST.html#Internal">Internal</a></span> <span class="id">x</span>); <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="id">left</span>; <span class="tactic">simpl</span>; <span class="tactic">rewrite</span> <span class="id">EQ</span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">destruct</span> <span class="id">ef1</span>; <span class="id">inv</span> <span class="id">H</span>. <span class="id">exists</span> (<span class="id"><a href="compcert.common.AST.html#Internal">Internal</a></span> <span class="id">x</span>); <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="id">right</span>; <span class="tactic">simpl</span>; <span class="tactic">rewrite</span> <span class="id">EQ</span>; <span class="tactic">auto</span>.<br/>
- <span class="id">des_ifs</span>; <span class="id">esplits</span>; <span class="id">ss</span>; <span class="id">des_ifs</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Instance</span> <span class="id"><a name="TransfPartialContextualLink">TransfPartialContextualLink</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">A</span> <span class="id">B</span> <span class="id">C</span> <span class="id">V</span>: <span class="kwd">Type</span>} {<span class="id">LV</span>: <span class="id"><a href="compcert.common.Linking.html#Linker">Linker</a></span> <span class="id"><a href="compcert.common.Linking.html#V">V</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">tr_fun</span>: <span class="id"><a href="compcert.common.Linking.html#C">C</a></span> -&gt; <span class="id"><a href="compcert.common.Linking.html#A">A</a></span> -&gt; <span class="id"><a href="compcert.common.Errors.html#res">res</a></span> <span class="id"><a href="compcert.common.Linking.html#B">B</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ctx_for</span>: <span class="id"><a href="compcert.common.AST.html#program">program</a></span> (<span class="id"><a href="compcert.common.AST.html#fundef">fundef</a></span> <span class="id"><a href="compcert.common.Linking.html#A">A</a></span>) <span class="id"><a href="compcert.common.Linking.html#V">V</a></span> -&gt; <span class="id"><a href="compcert.common.Linking.html#C">C</a></span>):<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#TransfLink">TransfLink</a></span> (<span class="kwd">fun</span> (<span class="id">p1</span>: <span class="id"><a href="compcert.common.AST.html#program">program</a></span> (<span class="id"><a href="compcert.common.AST.html#fundef">fundef</a></span> <span class="id"><a href="compcert.common.Linking.html#A">A</a></span>) <span class="id"><a href="compcert.common.Linking.html#V">V</a></span>) (<span class="id">p2</span>: <span class="id"><a href="compcert.common.AST.html#program">program</a></span> (<span class="id"><a href="compcert.common.AST.html#fundef">fundef</a></span> <span class="id"><a href="compcert.common.Linking.html#B">B</a></span>) <span class="id"><a href="compcert.common.Linking.html#V">V</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#match_program">match_program</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">cu</span> <span class="id">f</span> <span class="id">tf</span> =&gt; <span class="id"><a href="compcert.common.AST.html#transf_partial_fundef">AST.transf_partial_fundef</a></span> (<span class="id"><a href="compcert.common.Linking.html#tr_fun">tr_fun</a></span> (<span class="id"><a href="compcert.common.Linking.html#ctx_for">ctx_for</a></span> <span class="id"><a href="compcert.common.Linking.html#cu">cu</a></span>)) <span class="id"><a href="compcert.common.Linking.html#f">f</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.common.Linking.html#tf">tf</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> <span class="id"><a href="compcert.common.Linking.html#p1">p1</a></span> <span class="id"><a href="compcert.common.Linking.html#p2">p2</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1258')">Proof.</div>
<div class="proofscript" id="proof1258">
&nbsp;&nbsp;<span class="tactic">red</span>. <span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.Linking.html#link_linkorder">link_linkorder</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H</span>) <span class="kwd">as</span> [<span class="id">LO1</span> <span class="id">LO2</span>].<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Linking.html#link_match_program">link_match_program</a></span>; <span class="tactic">eauto</span>.<br/>
- <span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Linking.html#link_transf_partial_fundef">link_transf_partial_fundef</a></span>; <span class="tactic">eauto</span>.<br/>
- <span class="tactic">intros</span>; <span class="tactic">subst</span>. <span class="id">exists</span> <span class="id">v</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Instance</span> <span class="id"><a name="TransfPartialLink">TransfPartialLink</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">A</span> <span class="id">B</span> <span class="id">V</span>: <span class="kwd">Type</span>} {<span class="id">LV</span>: <span class="id"><a href="compcert.common.Linking.html#Linker">Linker</a></span> <span class="id"><a href="compcert.common.Linking.html#V">V</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">tr_fun</span>: <span class="id"><a href="compcert.common.Linking.html#A">A</a></span> -&gt; <span class="id"><a href="compcert.common.Errors.html#res">res</a></span> <span class="id"><a href="compcert.common.Linking.html#B">B</a></span>):<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#TransfLink">TransfLink</a></span> (<span class="kwd">fun</span> (<span class="id">p1</span>: <span class="id"><a href="compcert.common.AST.html#program">program</a></span> (<span class="id"><a href="compcert.common.AST.html#fundef">fundef</a></span> <span class="id"><a href="compcert.common.Linking.html#A">A</a></span>) <span class="id"><a href="compcert.common.Linking.html#V">V</a></span>) (<span class="id">p2</span>: <span class="id"><a href="compcert.common.AST.html#program">program</a></span> (<span class="id"><a href="compcert.common.AST.html#fundef">fundef</a></span> <span class="id"><a href="compcert.common.Linking.html#B">B</a></span>) <span class="id"><a href="compcert.common.Linking.html#V">V</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#match_program">match_program</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">cu</span> <span class="id">f</span> <span class="id">tf</span> =&gt; <span class="id"><a href="compcert.common.AST.html#transf_partial_fundef">AST.transf_partial_fundef</a></span> <span class="id"><a href="compcert.common.Linking.html#tr_fun">tr_fun</a></span> <span class="id"><a href="compcert.common.Linking.html#f">f</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.common.Linking.html#tf">tf</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> <span class="id"><a href="compcert.common.Linking.html#p1">p1</a></span> <span class="id"><a href="compcert.common.Linking.html#p2">p2</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1259')">Proof.</div>
<div class="proofscript" id="proof1259">
&nbsp;&nbsp;<span class="tactic">red</span>. <span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.Linking.html#link_linkorder">link_linkorder</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H</span>) <span class="kwd">as</span> [<span class="id">LO1</span> <span class="id">LO2</span>].<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Linking.html#link_match_program">link_match_program</a></span>; <span class="tactic">eauto</span>.<br/>
- <span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Linking.html#link_transf_partial_fundef">link_transf_partial_fundef</a></span>; <span class="tactic">eauto</span>.<br/>
- <span class="tactic">intros</span>; <span class="tactic">subst</span>. <span class="id">exists</span> <span class="id">v</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Instance</span> <span class="id"><a name="TransfTotallContextualLink">TransfTotallContextualLink</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">A</span> <span class="id">B</span> <span class="id">C</span> <span class="id">V</span>: <span class="kwd">Type</span>} {<span class="id">LV</span>: <span class="id"><a href="compcert.common.Linking.html#Linker">Linker</a></span> <span class="id"><a href="compcert.common.Linking.html#V">V</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">tr_fun</span>: <span class="id"><a href="compcert.common.Linking.html#C">C</a></span> -&gt; <span class="id"><a href="compcert.common.Linking.html#A">A</a></span> -&gt; <span class="id"><a href="compcert.common.Linking.html#B">B</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ctx_for</span>: <span class="id"><a href="compcert.common.AST.html#program">program</a></span> (<span class="id"><a href="compcert.common.AST.html#fundef">fundef</a></span> <span class="id"><a href="compcert.common.Linking.html#A">A</a></span>) <span class="id"><a href="compcert.common.Linking.html#V">V</a></span> -&gt; <span class="id"><a href="compcert.common.Linking.html#C">C</a></span>):<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#TransfLink">TransfLink</a></span> (<span class="kwd">fun</span> (<span class="id">p1</span>: <span class="id"><a href="compcert.common.AST.html#program">program</a></span> (<span class="id"><a href="compcert.common.AST.html#fundef">fundef</a></span> <span class="id"><a href="compcert.common.Linking.html#A">A</a></span>) <span class="id"><a href="compcert.common.Linking.html#V">V</a></span>) (<span class="id">p2</span>: <span class="id"><a href="compcert.common.AST.html#program">program</a></span> (<span class="id"><a href="compcert.common.AST.html#fundef">fundef</a></span> <span class="id"><a href="compcert.common.Linking.html#B">B</a></span>) <span class="id"><a href="compcert.common.Linking.html#V">V</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#match_program">match_program</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">cu</span> <span class="id">f</span> <span class="id">tf</span> =&gt; <span class="id"><a href="compcert.common.Linking.html#tf">tf</a></span> = <span class="id"><a href="compcert.common.AST.html#transf_fundef">AST.transf_fundef</a></span> (<span class="id"><a href="compcert.common.Linking.html#tr_fun">tr_fun</a></span> (<span class="id"><a href="compcert.common.Linking.html#ctx_for">ctx_for</a></span> <span class="id"><a href="compcert.common.Linking.html#cu">cu</a></span>)) <span class="id"><a href="compcert.common.Linking.html#f">f</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> <span class="id"><a href="compcert.common.Linking.html#p1">p1</a></span> <span class="id"><a href="compcert.common.Linking.html#p2">p2</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1260')">Proof.</div>
<div class="proofscript" id="proof1260">
&nbsp;&nbsp;<span class="tactic">red</span>. <span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.Linking.html#link_linkorder">link_linkorder</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H</span>) <span class="kwd">as</span> [<span class="id">LO1</span> <span class="id">LO2</span>].<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Linking.html#link_match_program">link_match_program</a></span>; <span class="tactic">eauto</span>.<br/>
- <span class="tactic">intros</span>. <span class="tactic">subst</span>. <span class="tactic">destruct</span> <span class="id">f1</span>, <span class="id">f2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
+ <span class="tactic">discriminate</span>.<br/>
+ <span class="tactic">destruct</span> <span class="id">e</span>; <span class="id">inv</span> <span class="id">H2</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
+ <span class="tactic">destruct</span> <span class="id">e</span>; <span class="id">inv</span> <span class="id">H2</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
+ <span class="id">des_ifs</span>; <span class="id">esplits</span>; <span class="tactic">eauto</span>.<br/>
- <span class="tactic">intros</span>; <span class="tactic">subst</span>. <span class="id">exists</span> <span class="id">v</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Instance</span> <span class="id"><a name="TransfTotalLink">TransfTotalLink</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id">A</span> <span class="id">B</span> <span class="id">V</span>: <span class="kwd">Type</span>} {<span class="id">LV</span>: <span class="id"><a href="compcert.common.Linking.html#Linker">Linker</a></span> <span class="id"><a href="compcert.common.Linking.html#V">V</a></span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">tr_fun</span>: <span class="id"><a href="compcert.common.Linking.html#A">A</a></span> -&gt; <span class="id"><a href="compcert.common.Linking.html#B">B</a></span>):<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#TransfLink">TransfLink</a></span> (<span class="kwd">fun</span> (<span class="id">p1</span>: <span class="id"><a href="compcert.common.AST.html#program">program</a></span> (<span class="id"><a href="compcert.common.AST.html#fundef">fundef</a></span> <span class="id"><a href="compcert.common.Linking.html#A">A</a></span>) <span class="id"><a href="compcert.common.Linking.html#V">V</a></span>) (<span class="id">p2</span>: <span class="id"><a href="compcert.common.AST.html#program">program</a></span> (<span class="id"><a href="compcert.common.AST.html#fundef">fundef</a></span> <span class="id"><a href="compcert.common.Linking.html#B">B</a></span>) <span class="id"><a href="compcert.common.Linking.html#V">V</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#match_program">match_program</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">cu</span> <span class="id">f</span> <span class="id">tf</span> =&gt; <span class="id"><a href="compcert.common.Linking.html#tf">tf</a></span> = <span class="id"><a href="compcert.common.AST.html#transf_fundef">AST.transf_fundef</a></span> <span class="id"><a href="compcert.common.Linking.html#tr_fun">tr_fun</a></span> <span class="id"><a href="compcert.common.Linking.html#f">f</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> <span class="id"><a href="compcert.common.Linking.html#p1">p1</a></span> <span class="id"><a href="compcert.common.Linking.html#p2">p2</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1261')">Proof.</div>
<div class="proofscript" id="proof1261">
&nbsp;&nbsp;<span class="tactic">red</span>. <span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.Linking.html#link_linkorder">link_linkorder</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H</span>) <span class="kwd">as</span> [<span class="id">LO1</span> <span class="id">LO2</span>].<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Linking.html#link_match_program">link_match_program</a></span>; <span class="tactic">eauto</span>.<br/>
- <span class="tactic">intros</span>. <span class="tactic">subst</span>. <span class="tactic">destruct</span> <span class="id">f1</span>, <span class="id">f2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
+ <span class="tactic">discriminate</span>.<br/>
+ <span class="tactic">destruct</span> <span class="id">e</span>; <span class="id">inv</span> <span class="id">H2</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
+ <span class="tactic">destruct</span> <span class="id">e</span>; <span class="id">inv</span> <span class="id">H2</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
+ <span class="id">des_ifs</span>; <span class="id">esplits</span>; <span class="tactic">eauto</span>.<br/>
- <span class="tactic">intros</span>; <span class="tactic">subst</span>. <span class="id">exists</span> <span class="id">v</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<h1> Linking a set of compilation units </h1>
<br/>
<div class="doc">Here, we take a more general view of linking as taking a nonempty list of compilation units
  and producing a whole program. </div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="LINK_LIST">LINK_LIST</a></span>.<br/>
<br/>
<span class="kwd">Context</span> {<span class="id">A</span>: <span class="kwd">Type</span>} {<span class="id">LA</span>: <span class="id"><a href="compcert.common.Linking.html#Linker">Linker</a></span> <span class="id"><a href="compcert.common.Linking.html#A">A</a></span>}.<br/>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="link_list">link_list</a></span> (<span class="id">l</span>: <span class="id"><a href="compcert.lib.Coqlib.html#nlist">nlist</a></span> <span class="id"><a href="compcert.common.Linking.html#LINK_LIST.A">A</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="compcert.common.Linking.html#LINK_LIST.A">A</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.common.Linking.html#l">l</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.lib.Coqlib.html#nbase">nbase</a></span> <span class="id">a</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">a</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.lib.Coqlib.html#ncons">ncons</a></span> <span class="id">a</span> <span class="id">l</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.common.Linking.html#link_list">link_list</a></span> <span class="id"><a href="compcert.common.Linking.html#l">l</a></span> <span class="kwd">with</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> | <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">b</span> =&gt; <span class="id"><a href="compcert.common.Linking.html#link">link</a></span> <span class="id">a</span> <span class="id">b</span> <span class="kwd">end</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="link_list_linkorder">link_list_linkorder</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">a</span> <span class="id">l</span> <span class="id">b</span>, <span class="id"><a href="compcert.common.Linking.html#link_list">link_list</a></span> <span class="id"><a href="compcert.common.Linking.html#l">l</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.common.Linking.html#b">b</a></span> -&gt; <span class="id"><a href="compcert.lib.Coqlib.html#nIn">nIn</a></span> <span class="id"><a href="compcert.common.Linking.html#a">a</a></span> <span class="id"><a href="compcert.common.Linking.html#l">l</a></span> -&gt; <span class="id"><a href="compcert.common.Linking.html#linkorder">linkorder</a></span> <span class="id"><a href="compcert.common.Linking.html#a">a</a></span> <span class="id"><a href="compcert.common.Linking.html#b">b</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1262')">Proof.</div>
<div class="proofscript" id="proof1262">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
- <span class="id">inv</span> <span class="id">H</span>. <span class="tactic">subst</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Linking.html#linkorder_refl">linkorder_refl</a></span>.<br/>
- <span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.Linking.html#link_list">link_list</a></span> <span class="id">l</span>) <span class="kwd">as</span> [<span class="id">b</span>'|]; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Linking.html#link_linkorder">link_linkorder</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">destruct</span> <span class="id">H0</span>.<br/>
+ <span class="tactic">subst</span> <span class="id">a0</span>. <span class="tactic">tauto</span>.<br/>
+ <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Linking.html#linkorder_trans">linkorder_trans</a></span> <span class="kwd">with</span> <span class="id">b</span>'. <span class="tactic">auto</span>. <span class="tactic">tauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.common.Linking.html#LINK_LIST">LINK_LIST</a></span>.<br/>
<br/>
<div class="doc">List linking commutes with program transformations, provided the
  transformation commutes with simple (binary) linking. </div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="LINK_LIST_MATCH">LINK_LIST_MATCH</a></span>.<br/>
<br/>
<span class="kwd">Context</span> {<span class="id">A</span> <span class="id">B</span>: <span class="kwd">Type</span>} {<span class="id">LA</span>: <span class="id"><a href="compcert.common.Linking.html#Linker">Linker</a></span> <span class="id"><a href="compcert.common.Linking.html#A">A</a></span>} {<span class="id">LB</span>: <span class="id"><a href="compcert.common.Linking.html#Linker">Linker</a></span> <span class="id"><a href="compcert.common.Linking.html#B">B</a></span>} (<span class="id">prog_match</span>: <span class="id"><a href="compcert.common.Linking.html#A">A</a></span> -&gt; <span class="id"><a href="compcert.common.Linking.html#B">B</a></span> -&gt; <span class="kwd">Prop</span>) {<span class="id">TL</span>: <span class="id"><a href="compcert.common.Linking.html#TransfLink">TransfLink</a></span> <span class="id"><a href="compcert.common.Linking.html#prog_match">prog_match</a></span>}.<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="link_list_match">link_list_match</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">al</span> <span class="id">bl</span>, <span class="id"><a href="compcert.lib.Coqlib.html#nlist_forall2">nlist_forall2</a></span> <span class="id"><a href="compcert.common.Linking.html#LINK_LIST_MATCH.prog_match">prog_match</a></span> <span class="id"><a href="compcert.common.Linking.html#al">al</a></span> <span class="id"><a href="compcert.common.Linking.html#bl">bl</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">a</span>, <span class="id"><a href="compcert.common.Linking.html#link_list">link_list</a></span> <span class="id"><a href="compcert.common.Linking.html#al">al</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.common.Linking.html#a">a</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">b</span>, <span class="id"><a href="compcert.common.Linking.html#link_list">link_list</a></span> <span class="id"><a href="compcert.common.Linking.html#bl">bl</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.common.Linking.html#b">b</a></span> /\ <span class="id"><a href="compcert.common.Linking.html#LINK_LIST_MATCH.prog_match">prog_match</a></span> <span class="id"><a href="compcert.common.Linking.html#a">a</a></span> <span class="id"><a href="compcert.common.Linking.html#b">b</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1263')">Proof.</div>
<div class="proofscript" id="proof1263">
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">simpl</span>; <span class="tactic">intros</span> <span class="id">a</span>' <span class="id">L</span>.<br/>
- <span class="id">inv</span> <span class="id">L</span>. <span class="id">exists</span> <span class="id">b</span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.Linking.html#link_list">link_list</a></span> <span class="id">l</span>) <span class="kwd">as</span> [<span class="id">a1</span>|] <span class="id">eqn</span>:<span class="id">LL</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">IHnlist_forall2</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">b</span>' &amp; <span class="id">P</span> &amp; <span class="id">Q</span>).<br/>
&nbsp;&nbsp;<span class="tactic">red</span> <span class="kwd">in</span> <span class="id">TL</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.common.Linking.html#LINK_LIST_MATCH.TL">TL</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">b</span>'' &amp; <span class="id">U</span> &amp; <span class="id">V</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">P</span>; <span class="id">exists</span> <span class="id">b</span>''; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.common.Linking.html#LINK_LIST_MATCH">LINK_LIST_MATCH</a></span>.<br/>
<br/>
<h1> Linking and composition of compilation passes </h1>
<br/>
<span class="kwd">Set</span> <span class="kwd">Implicit</span> <span class="id">Arguments</span>.<br/>
<br/>
<div class="doc">A generic language is a type of programs and a linker. </div>
<br/>
<span class="kwd">Structure</span> <span class="id"><a name="Language">Language</a></span> := <span class="id"><a name="mklang">mklang</a></span> { <span class="id"><a name="lang_prog">lang_prog</a></span> :&gt; <span class="kwd">Type</span>; <span class="id"><a name="lang_link">lang_link</a></span>: <span class="id"><a href="compcert.common.Linking.html#Linker">Linker</a></span> <span class="id"><a href="compcert.common.Linking.html#lang_prog">lang_prog</a></span> }.<br/>
<br/>
<span class="id">Canonical</span> <span class="kwd">Structure</span> <span class="id">Language_gen</span> (<span class="id">A</span>: <span class="kwd">Type</span>) (<span class="id">L</span>: <span class="id"><a href="compcert.common.Linking.html#Linker">Linker</a></span> <span class="id"><a href="compcert.common.Linking.html#A">A</a></span>) : <span class="id"><a href="compcert.common.Linking.html#Language">Language</a></span> := @<span class="id"><a href="compcert.common.Linking.html#mklang">mklang</a></span> <span class="id"><a href="compcert.common.Linking.html#A">A</a></span> <span class="id"><a href="compcert.common.Linking.html#L">L</a></span>.<br/>
<br/>
<div class="doc">A compilation pass from language <span class="bracket"><span class="id">S</span></span> (source) to language <span class="bracket"><span class="id">T</span></span> (target)
  is a matching relation between <span class="bracket"><span class="id">S</span></span> programs and <span class="bracket"><span class="id">T</span></span> programs,
  plus two linkers, one for <span class="bracket"><span class="id">S</span></span> and one for <span class="bracket"><span class="id">T</span></span>,
  and a property of commutation with linking. </div>
<br/>
<span class="kwd">Record</span> <span class="id"><a name="Pass">Pass</a></span> (<span class="id">S</span> <span class="id">T</span>: <span class="id"><a href="compcert.common.Linking.html#Language">Language</a></span>) := <span class="id"><a name="mkpass">mkpass</a></span> {<br/>
&nbsp;&nbsp;<span class="id"><a name="pass_match">pass_match</a></span> :&gt; <span class="id"><a href="compcert.common.Linking.html#lang_prog">lang_prog</a></span> <span class="id"><a href="compcert.common.Linking.html#S">S</a></span> -&gt; <span class="id"><a href="compcert.common.Linking.html#lang_prog">lang_prog</a></span> <span class="id"><a href="compcert.common.Linking.html#T">T</a></span> -&gt; <span class="kwd">Prop</span>;<br/>
&nbsp;&nbsp;<span class="id"><a name="pass_match_link">pass_match_link</a></span>: @<span class="id"><a href="compcert.common.Linking.html#TransfLink">TransfLink</a></span> (<span class="id"><a href="compcert.common.Linking.html#lang_prog">lang_prog</a></span> <span class="id"><a href="compcert.common.Linking.html#S">S</a></span>) (<span class="id"><a href="compcert.common.Linking.html#lang_prog">lang_prog</a></span> <span class="id"><a href="compcert.common.Linking.html#T">T</a></span>) (<span class="id"><a href="compcert.common.Linking.html#lang_link">lang_link</a></span> <span class="id"><a href="compcert.common.Linking.html#S">S</a></span>) (<span class="id"><a href="compcert.common.Linking.html#lang_link">lang_link</a></span> <span class="id"><a href="compcert.common.Linking.html#T">T</a></span>) <span class="id"><a href="compcert.common.Linking.html#pass_match">pass_match</a></span><br/>
}.<br/>
<br/>
<span class="id">Arguments</span> <span class="id"><a href="compcert.common.Linking.html#mkpass">mkpass</a></span> {<span class="id">S</span>} {<span class="id">T</span>} (<span class="id">pass_match</span>) {<span class="id">pass_match_link</span>}.<br/>
<br/>
<span class="kwd">Program</span> <span class="kwd">Definition</span> <span class="id"><a name="pass_identity">pass_identity</a></span> (<span class="id">l</span>: <span class="id"><a href="compcert.common.Linking.html#Language">Language</a></span>): <span class="id"><a href="compcert.common.Linking.html#Pass">Pass</a></span> <span class="id"><a href="compcert.common.Linking.html#l">l</a></span> <span class="id"><a href="compcert.common.Linking.html#l">l</a></span> :=<br/>
&nbsp;&nbsp;{| <span class="id"><a href="compcert.common.Linking.html#mkpass">pass_match</a></span> := <span class="kwd">fun</span> <span class="id">p1</span> <span class="id">p2</span> =&gt; <span class="id"><a href="compcert.common.Linking.html#p1">p1</a></span> = <span class="id"><a href="compcert.common.Linking.html#p2">p2</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pass_match_link</span> := <span class="id">_</span> |}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1264')">Next Obligation.</div>
<div class="proofscript" id="proof1264">
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">subst</span>. <span class="id">exists</span> <span class="id">p</span>; <span class="tactic">auto</span>.<br/>
Defined.</div>
<br/>
<span class="kwd">Program</span> <span class="kwd">Definition</span> <span class="id"><a name="pass_compose">pass_compose</a></span> {<span class="id">l1</span> <span class="id">l2</span> <span class="id">l3</span>: <span class="id"><a href="compcert.common.Linking.html#Language">Language</a></span>} (<span class="id">pass</span>: <span class="id"><a href="compcert.common.Linking.html#Pass">Pass</a></span> <span class="id"><a href="compcert.common.Linking.html#l1">l1</a></span> <span class="id"><a href="compcert.common.Linking.html#l2">l2</a></span>) (<span class="id">pass</span>': <span class="id"><a href="compcert.common.Linking.html#Pass">Pass</a></span> <span class="id"><a href="compcert.common.Linking.html#l2">l2</a></span> <span class="id"><a href="compcert.common.Linking.html#l3">l3</a></span>) : <span class="id"><a href="compcert.common.Linking.html#Pass">Pass</a></span> <span class="id"><a href="compcert.common.Linking.html#l1">l1</a></span> <span class="id"><a href="compcert.common.Linking.html#l3">l3</a></span> :=<br/>
&nbsp;&nbsp;{| <span class="id"><a href="compcert.common.Linking.html#mkpass">pass_match</a></span> := <span class="kwd">fun</span> <span class="id">p1</span> <span class="id">p3</span> =&gt; <span class="id">exists</span> <span class="id">p2</span>, <span class="id"><a href="compcert.common.Linking.html#pass_match">pass_match</a></span> <span class="id"><a href="compcert.common.Linking.html#pass">pass</a></span> <span class="id"><a href="compcert.common.Linking.html#p1">p1</a></span> <span class="id"><a href="compcert.common.Linking.html#p2">p2</a></span> /\ <span class="id"><a href="compcert.common.Linking.html#pass_match">pass_match</a></span> <span class="id">pass</span>' <span class="id"><a href="compcert.common.Linking.html#p2">p2</a></span> <span class="id"><a href="compcert.common.Linking.html#p3">p3</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">pass_match_link</span> := <span class="id">_</span> |}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1265')">Next Obligation.</div>
<div class="proofscript" id="proof1265">
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span> <span class="kwd">as</span> (<span class="id">p1</span>' &amp; <span class="id">A1</span> &amp; <span class="id">B1</span>).<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H1</span> <span class="kwd">as</span> (<span class="id">p2</span>' &amp; <span class="id">A2</span> &amp; <span class="id">B2</span>).<br/>
&nbsp;&nbsp;<span class="id">edestruct</span> (<span class="id"><a href="compcert.common.Linking.html#pass_match_link">pass_match_link</a></span> <span class="id">pass</span>) <span class="kwd">as</span> (<span class="id">p</span>' &amp; <span class="id">A</span> &amp; <span class="id">B</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">edestruct</span> (<span class="id"><a href="compcert.common.Linking.html#pass_match_link">pass_match_link</a></span> <span class="id">pass</span>') <span class="kwd">as</span> (<span class="id">tp</span> &amp; <span class="id">C</span> &amp; <span class="id">D</span>); <span class="tactic">eauto</span>.<br/>
Defined.</div>
<br/>
<div class="doc">A list of compilation passes that can be composed. </div>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="Passes">Passes</a></span>: <span class="id"><a href="compcert.common.Linking.html#Language">Language</a></span> -&gt; <span class="id"><a href="compcert.common.Linking.html#Language">Language</a></span> -&gt; <span class="kwd">Type</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="pass_nil">pass_nil</a></span>: <span class="kwd">forall</span> <span class="id">l</span>, <span class="id"><a href="compcert.common.Linking.html#Passes">Passes</a></span> <span class="id"><a href="compcert.common.Linking.html#l">l</a></span> <span class="id"><a href="compcert.common.Linking.html#l">l</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="pass_cons">pass_cons</a></span>: <span class="kwd">forall</span> <span class="id">l1</span> <span class="id">l2</span> <span class="id">l3</span>, <span class="id"><a href="compcert.common.Linking.html#Pass">Pass</a></span> <span class="id"><a href="compcert.common.Linking.html#l1">l1</a></span> <span class="id"><a href="compcert.common.Linking.html#l2">l2</a></span> -&gt; <span class="id"><a href="compcert.common.Linking.html#Passes">Passes</a></span> <span class="id"><a href="compcert.common.Linking.html#l2">l2</a></span> <span class="id"><a href="compcert.common.Linking.html#l3">l3</a></span> -&gt; <span class="id"><a href="compcert.common.Linking.html#Passes">Passes</a></span> <span class="id"><a href="compcert.common.Linking.html#l1">l1</a></span> <span class="id"><a href="compcert.common.Linking.html#l3">l3</a></span>.<br/>
<br/>
<span class="kwd">Infix</span> ":::" := <span class="id"><a href="compcert.common.Linking.html#pass_cons">pass_cons</a></span> (<span class="tactic">at</span> <span class="id">level</span> 60, <span class="id">right</span> <span class="id">associativity</span>) : <span class="id">linking_scope</span>.<br/>
<br/>
<div class="doc">The pass corresponding to the composition of a list of passes. </div>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="compose_passes">compose_passes</a></span> (<span class="id">l</span> <span class="id">l</span>': <span class="id"><a href="compcert.common.Linking.html#Language">Language</a></span>) (<span class="id">passes</span>: <span class="id"><a href="compcert.common.Linking.html#Passes">Passes</a></span> <span class="id"><a href="compcert.common.Linking.html#l">l</a></span> <span class="id">l</span>') : <span class="id"><a href="compcert.common.Linking.html#Pass">Pass</a></span> <span class="id"><a href="compcert.common.Linking.html#l">l</a></span> <span class="id">l</span>' :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.common.Linking.html#passes">passes</a></span> <span class="kwd">in</span> <span class="id"><a href="compcert.common.Linking.html#Passes">Passes</a></span> <span class="id">l</span> <span class="id">l</span>' <span class="kwd">return</span> <span class="id"><a href="compcert.common.Linking.html#Pass">Pass</a></span> <span class="id"><a href="compcert.common.Linking.html#l">l</a></span> <span class="id">l</span>' <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.common.Linking.html#pass_nil">pass_nil</a></span> <span class="id">l</span> =&gt; <span class="id"><a href="compcert.common.Linking.html#pass_identity">pass_identity</a></span> <span class="id"><a href="compcert.common.Linking.html#l">l</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.common.Linking.html#pass_cons">pass_cons</a></span> <span class="id">l1</span> <span class="id">l2</span> <span class="id">l3</span> <span class="id">pass1</span> <span class="id">passes</span> =&gt; <span class="id"><a href="compcert.common.Linking.html#pass_compose">pass_compose</a></span> <span class="id">pass1</span> (<span class="id"><a href="compcert.common.Linking.html#compose_passes">compose_passes</a></span> <span class="id"><a href="compcert.common.Linking.html#passes">passes</a></span>)<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<div class="doc">Some more lemmas about <span class="bracket"><span class="id">nlist_forall2</span></span>. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="nlist_forall2_identity">nlist_forall2_identity</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">A</span>: <span class="kwd">Type</span>) (<span class="id">la</span> <span class="id">lb</span>: <span class="id"><a href="compcert.lib.Coqlib.html#nlist">nlist</a></span> <span class="id"><a href="compcert.common.Linking.html#A">A</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#nlist_forall2">nlist_forall2</a></span> (<span class="kwd">fun</span> <span class="id">a</span> <span class="id">b</span> =&gt; <span class="id"><a href="compcert.common.Linking.html#a">a</a></span> = <span class="id"><a href="compcert.common.Linking.html#b">b</a></span>) <span class="id"><a href="compcert.common.Linking.html#la">la</a></span> <span class="id"><a href="compcert.common.Linking.html#lb">lb</a></span> -&gt; <span class="id"><a href="compcert.common.Linking.html#la">la</a></span> = <span class="id"><a href="compcert.common.Linking.html#lb">lb</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1266')">Proof.</div>
<div class="proofscript" id="proof1266">
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="nlist_forall2_compose_inv">nlist_forall2_compose_inv</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">A</span> <span class="id">B</span> <span class="id">C</span>: <span class="kwd">Type</span>) (<span class="id">R1</span>: <span class="id"><a href="compcert.common.Linking.html#A">A</a></span> -&gt; <span class="id"><a href="compcert.common.Linking.html#B">B</a></span> -&gt; <span class="kwd">Prop</span>) (<span class="id">R2</span>: <span class="id"><a href="compcert.common.Linking.html#B">B</a></span> -&gt; <span class="id"><a href="compcert.common.Linking.html#C">C</a></span> -&gt; <span class="kwd">Prop</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">la</span>: <span class="id"><a href="compcert.lib.Coqlib.html#nlist">nlist</a></span> <span class="id"><a href="compcert.common.Linking.html#A">A</a></span>) (<span class="id">lc</span>: <span class="id"><a href="compcert.lib.Coqlib.html#nlist">nlist</a></span> <span class="id"><a href="compcert.common.Linking.html#C">C</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#nlist_forall2">nlist_forall2</a></span> (<span class="kwd">fun</span> <span class="id">a</span> <span class="id">c</span> =&gt; <span class="id">exists</span> <span class="id">b</span>, <span class="id"><a href="compcert.common.Linking.html#R1">R1</a></span> <span class="id"><a href="compcert.common.Linking.html#a">a</a></span> <span class="id"><a href="compcert.common.Linking.html#b">b</a></span> /\ <span class="id"><a href="compcert.common.Linking.html#R2">R2</a></span> <span class="id"><a href="compcert.common.Linking.html#b">b</a></span> <span class="id"><a href="compcert.common.Linking.html#c">c</a></span>) <span class="id"><a href="compcert.common.Linking.html#la">la</a></span> <span class="id"><a href="compcert.common.Linking.html#lc">lc</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">lb</span>: <span class="id"><a href="compcert.lib.Coqlib.html#nlist">nlist</a></span> <span class="id"><a href="compcert.common.Linking.html#B">B</a></span>, <span class="id"><a href="compcert.lib.Coqlib.html#nlist_forall2">nlist_forall2</a></span> <span class="id"><a href="compcert.common.Linking.html#R1">R1</a></span> <span class="id"><a href="compcert.common.Linking.html#la">la</a></span> <span class="id"><a href="compcert.common.Linking.html#lb">lb</a></span> /\ <span class="id"><a href="compcert.lib.Coqlib.html#nlist_forall2">nlist_forall2</a></span> <span class="id"><a href="compcert.common.Linking.html#R2">R2</a></span> <span class="id"><a href="compcert.common.Linking.html#lb">lb</a></span> <span class="id"><a href="compcert.common.Linking.html#lc">lc</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1267')">Proof.</div>
<div class="proofscript" id="proof1267">
&nbsp;&nbsp;<span class="tactic">induction</span> 1.<br/>
- <span class="tactic">rename</span> <span class="id">b</span> <span class="id">into</span> <span class="id">c</span>. <span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> (<span class="id">b</span> &amp; <span class="id">P</span> &amp; <span class="id">Q</span>).<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="compcert.lib.Coqlib.html#nbase">nbase</a></span> <span class="id">b</span>); <span class="tactic">split</span>; <span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">rename</span> <span class="id">b</span> <span class="id">into</span> <span class="id">c</span>. <span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> (<span class="id">b</span> &amp; <span class="id">P</span> &amp; <span class="id">Q</span>). <span class="tactic">destruct</span> <span class="id">IHnlist_forall2</span> <span class="kwd">as</span> (<span class="id">lb</span> &amp; <span class="id">U</span> &amp; <span class="id">V</span>).<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="compcert.lib.Coqlib.html#ncons">ncons</a></span> <span class="id">b</span> <span class="id">lb</span>); <span class="tactic">split</span>; <span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">List linking with a composition of compilation passes. </div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="link_list_compose_passes">link_list_compose_passes</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">src</span> <span class="id">tgt</span>: <span class="id"><a href="compcert.common.Linking.html#Language">Language</a></span>) (<span class="id">passes</span>: <span class="id"><a href="compcert.common.Linking.html#Passes">Passes</a></span> <span class="id"><a href="compcert.common.Linking.html#src">src</a></span> <span class="id"><a href="compcert.common.Linking.html#tgt">tgt</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">src_units</span>: <span class="id"><a href="compcert.lib.Coqlib.html#nlist">nlist</a></span> <span class="id"><a href="compcert.common.Linking.html#src">src</a></span>) (<span class="id">tgt_units</span>: <span class="id"><a href="compcert.lib.Coqlib.html#nlist">nlist</a></span> <span class="id"><a href="compcert.common.Linking.html#tgt">tgt</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#nlist_forall2">nlist_forall2</a></span> (<span class="id"><a href="compcert.common.Linking.html#pass_match">pass_match</a></span> (<span class="id"><a href="compcert.common.Linking.html#compose_passes">compose_passes</a></span> <span class="id"><a href="compcert.common.Linking.html#passes">passes</a></span>)) <span class="id"><a href="compcert.common.Linking.html#src_units">src_units</a></span> <span class="id"><a href="compcert.common.Linking.html#tgt_units">tgt_units</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">src_prog</span>,<br/>
&nbsp;&nbsp;@<span class="id"><a href="compcert.common.Linking.html#link_list">link_list</a></span> <span class="id">_</span> (<span class="id"><a href="compcert.common.Linking.html#lang_link">lang_link</a></span> <span class="id"><a href="compcert.common.Linking.html#src">src</a></span>) <span class="id"><a href="compcert.common.Linking.html#src_units">src_units</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.common.Linking.html#src_prog">src_prog</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">tgt_prog</span>,<br/>
&nbsp;&nbsp;@<span class="id"><a href="compcert.common.Linking.html#link_list">link_list</a></span> <span class="id">_</span> (<span class="id"><a href="compcert.common.Linking.html#lang_link">lang_link</a></span> <span class="id"><a href="compcert.common.Linking.html#tgt">tgt</a></span>) <span class="id"><a href="compcert.common.Linking.html#tgt_units">tgt_units</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.common.Linking.html#tgt_prog">tgt_prog</a></span><br/>
&nbsp;&nbsp;/\ <span class="id"><a href="compcert.common.Linking.html#pass_match">pass_match</a></span> (<span class="id"><a href="compcert.common.Linking.html#compose_passes">compose_passes</a></span> <span class="id"><a href="compcert.common.Linking.html#passes">passes</a></span>) <span class="id"><a href="compcert.common.Linking.html#src_prog">src_prog</a></span> <span class="id"><a href="compcert.common.Linking.html#tgt_prog">tgt_prog</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof1268')">Proof.</div>
<div class="proofscript" id="proof1268">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">passes</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span> <span class="id">src_units</span> <span class="id">tgt_units</span> <span class="id">F2</span> <span class="id">src_prog</span> <span class="id">LINK</span>.<br/>
- <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Linking.html#nlist_forall2_identity">nlist_forall2_identity</a></span> <span class="kwd">in</span> <span class="id">F2</span>. <span class="tactic">subst</span> <span class="id">tgt_units</span>. <span class="id">exists</span> <span class="id">src_prog</span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Linking.html#nlist_forall2_compose_inv">nlist_forall2_compose_inv</a></span> <span class="kwd">in</span> <span class="id">F2</span>. <span class="tactic">destruct</span> <span class="id">F2</span> <span class="kwd">as</span> (<span class="id">interm_units</span> &amp; <span class="id">P</span> &amp; <span class="id">Q</span>).<br/>
&nbsp;&nbsp;<span class="id">edestruct</span> (@<span class="id"><a href="compcert.common.Linking.html#link_list_match">link_list_match</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="compcert.common.Linking.html#lang_link">lang_link</a></span> <span class="id">l1</span>) (<span class="id"><a href="compcert.common.Linking.html#lang_link">lang_link</a></span> <span class="id">l2</span>) (<span class="id"><a href="compcert.common.Linking.html#pass_match">pass_match</a></span> <span class="id">p</span>))<br/>
&nbsp;&nbsp;<span class="kwd">as</span> (<span class="id">interm_prog</span> &amp; <span class="id">U</span> &amp; <span class="id">V</span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Linking.html#pass_match_link">pass_match_link</a></span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">IHpasses</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">tgt_prog</span> &amp; <span class="id">X</span> &amp; <span class="id">Y</span>).<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">tgt_prog</span>; <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="id">exists</span> <span class="id">interm_prog</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</div>
</body>
</html>
