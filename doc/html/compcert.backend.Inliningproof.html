
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module Inliningproof</title>
<meta name="description" content="Documentation of Coq module Inliningproof" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module Inliningproof</h1>
<div class="coq">
<br/>
<div class="doc">RTL function inlining: semantic preservation </div>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.lib.Coqlib.html">Coqlib</a></span> <span class="id"><a href="compcert.lib.Wfsimpl.html">Wfsimpl</a></span> <span class="id"><a href="compcert.lib.Maps.html">Maps</a></span> <span class="id"><a href="compcert.common.Errors.html">Errors</a></span> <span class="id"><a href="compcert.lib.Integers.html">Integers</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.common.AST.html">AST</a></span> <span class="id"><a href="compcert.common.Linking.html">Linking</a></span> <span class="id"><a href="compcert.common.Values.html">Values</a></span> <span class="id"><a href="compcert.common.Memory.html">Memory</a></span> <span class="id"><a href="compcert.common.Globalenvs.html">Globalenvs</a></span> <span class="id"><a href="compcert.common.Events.html">Events</a></span> <span class="id"><a href="compcert.common.Smallstep.html">Smallstep</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.x86.Op.html">Op</a></span> <span class="id"><a href="compcert.backend.Registers.html">Registers</a></span> <span class="id"><a href="compcert.backend.RTL.html">RTL</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.backend.Inlining.html">Inlining</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html">Inliningspec</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.lib.sflib.html">sflib</a></span>.<br/>
<span class="kwd">Require</span> <span class="id"><a href="compcert.common.SimMemInj.html">SimMemInj</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="match_prog">match_prog</a></span> (<span class="id">prog</span> <span class="id">tprog</span>: <span class="id"><a href="compcert.backend.RTL.html#program">program</a></span>) :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#match_program">match_program</a></span> (<span class="kwd">fun</span> <span class="id">cunit</span> <span class="id">f</span> <span class="id">tf</span> =&gt; <span class="id"><a href="compcert.backend.Inlining.html#transf_fundef">transf_fundef</a></span> (<span class="id"><a href="compcert.backend.Inlining.html#funenv_program">funenv_program</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#cunit">cunit</a></span>) <span class="id"><a href="compcert.backend.Inliningproof.html#f">f</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#tf">tf</a></span>) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#prog">prog</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#tprog">tprog</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="transf_program_match">transf_program_match</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">prog</span> <span class="id">tprog</span>, <span class="id"><a href="compcert.backend.Inlining.html#transf_program">transf_program</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#prog">prog</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#tprog">tprog</a></span> -&gt; <span class="id"><a href="compcert.backend.Inliningproof.html#match_prog">match_prog</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#prog">prog</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#tprog">tprog</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2746')">Proof.</div>
<div class="proofscript" id="proof2746">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Linking.html#match_transform_partial_program_contextual">match_transform_partial_program_contextual</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="INLINING">INLINING</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="INLINING.prog">prog</a></span> <span class="id"><a name="INLINING.tprog">tprog</a></span>: <span class="id"><a href="compcert.backend.RTL.html#program">program</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="INLINING.TRANSF">TRANSF</a></span>: <span class="id"><a href="compcert.backend.Inliningproof.html#match_prog">match_prog</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.prog">prog</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.tprog">tprog</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="INLINING.CORELEMMA">CORELEMMA</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="INLINING.CORELEMMA.se">se</a></span> <span class="id"><a name="INLINING.CORELEMMA.tse">tse</a></span>: <span class="id"><a href="compcert.common.Globalenvs.html#Senv.t">Senv.t</a></span>.<br/>
<span class="kwd">Hypothesis</span> (<span class="id"><a name="INLINING.CORELEMMA.MATCH_SENV">MATCH_SENV</a></span>: <span class="id"><a href="compcert.common.Globalenvs.html#Senv.equiv">Senv.equiv</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.se">se</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.tse">tse</a></span>).<br/>
<span class="kwd">Variable</span> <span class="id"><a name="INLINING.CORELEMMA.ge">ge</a></span> <span class="id"><a name="INLINING.CORELEMMA.tge">tge</a></span>: <span class="id"><a href="compcert.backend.RTL.html#genv">genv</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="INLINING.CORELEMMA.SECOMPATSRC">SECOMPATSRC</a></span>: <span class="id"><a href="compcert.common.Globalenvs.html#senv_genv_compat">senv_genv_compat</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.se">se</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.ge">ge</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="INLINING.CORELEMMA.SECOMPATTGT">SECOMPATTGT</a></span>: <span class="id"><a href="compcert.common.Globalenvs.html#senv_genv_compat">senv_genv_compat</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.tse">tse</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.tge">tge</a></span>.<br/>
<br/>
<span class="kwd">Hypothesis</span> (<span class="id"><a name="INLINING.CORELEMMA.GENV_COMPAT">GENV_COMPAT</a></span>: <span class="id"><a href="compcert.common.Globalenvs.html#genv_compat">genv_compat</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.ge">ge</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.prog">prog</a></span>).<br/>
<br/>
<span class="kwd">Hypothesis</span> (<span class="id"><a name="INLINING.CORELEMMA.MATCH_GENV">MATCH_GENV</a></span>: <span class="id"><a href="compcert.common.Globalenvs.html#Genv.match_genvs">Genv.match_genvs</a></span> (<span class="id"><a href="compcert.common.Linking.html#match_globdef">match_globdef</a></span> (<span class="kwd">fun</span> <span class="id">cunit</span> <span class="id">f</span> <span class="id">tf</span> =&gt; <span class="id"><a href="compcert.backend.Inlining.html#transf_fundef">transf_fundef</a></span> (<span class="id"><a href="compcert.backend.Inlining.html#funenv_program">funenv_program</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#cunit">cunit</a></span>) <span class="id"><a href="compcert.backend.Inliningproof.html#f">f</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#tf">tf</a></span>) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.prog">prog</a></span>) <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.ge">ge</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.tge">tge</a></span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="symbols_preserved">symbols_preserved</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">s</span>: <span class="id"><a href="compcert.common.AST.html#ident">ident</a></span>), <span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_symbol">Genv.find_symbol</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.tge">tge</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#s">s</a></span> = <span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_symbol">Genv.find_symbol</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.ge">ge</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#s">s</a></span>.<br/>
<span class="kwd">Proof</span> (<span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_symbol_match_genv">Genv.find_symbol_match_genv</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.MATCH_GENV">MATCH_GENV</a></span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="senv_preserved">senv_preserved</a></span>:<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Globalenvs.html#Senv.equiv">Senv.equiv</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.ge">ge</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.tge">tge</a></span>.<br/>
<span class="kwd">Proof</span> (<span class="id"><a href="compcert.common.Globalenvs.html#Genv.senv_match_genv">Genv.senv_match_genv</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.MATCH_GENV">MATCH_GENV</a></span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="functions_translated">functions_translated</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">v</span>: <span class="id"><a href="compcert.common.Values.html#val">val</a></span>) (<span class="id">f</span>: <span class="id"><a href="compcert.backend.RTL.html#fundef">fundef</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_funct">Genv.find_funct</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.ge">ge</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#v">v</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#f">f</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">cu</span> <span class="id">f</span>', <span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_funct">Genv.find_funct</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.tge">tge</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#v">v</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">f</span>' /\ <span class="id"><a href="compcert.backend.Inlining.html#transf_fundef">transf_fundef</a></span> (<span class="id"><a href="compcert.backend.Inlining.html#funenv_program">funenv_program</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#cu">cu</a></span>) <span class="id"><a href="compcert.backend.Inliningproof.html#f">f</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id">f</span>' /\ <span class="id"><a href="compcert.common.Linking.html#linkorder">linkorder</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#cu">cu</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.prog">prog</a></span>.<br/>
<span class="kwd">Proof</span> (<span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_funct_match_genv">Genv.find_funct_match_genv</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.MATCH_GENV">MATCH_GENV</a></span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="function_ptr_translated">function_ptr_translated</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">b</span>: <span class="id"><a href="compcert.common.Values.html#block">block</a></span>) (<span class="id">f</span>: <span class="id"><a href="compcert.backend.RTL.html#fundef">fundef</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_funct_ptr">Genv.find_funct_ptr</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.ge">ge</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#f">f</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">cu</span> <span class="id">f</span>', <span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_funct_ptr">Genv.find_funct_ptr</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.tge">tge</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">f</span>' /\ <span class="id"><a href="compcert.backend.Inlining.html#transf_fundef">transf_fundef</a></span> (<span class="id"><a href="compcert.backend.Inlining.html#funenv_program">funenv_program</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#cu">cu</a></span>) <span class="id"><a href="compcert.backend.Inliningproof.html#f">f</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id">f</span>' /\ <span class="id"><a href="compcert.common.Linking.html#linkorder">linkorder</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#cu">cu</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.prog">prog</a></span>.<br/>
<span class="kwd">Proof</span> (<span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_funct_ptr_match_genv">Genv.find_funct_ptr_match_genv</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.MATCH_GENV">MATCH_GENV</a></span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sig_function_translated">sig_function_translated</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">cu</span> <span class="id">f</span> <span class="id">f</span>', <span class="id"><a href="compcert.backend.Inlining.html#transf_fundef">transf_fundef</a></span> (<span class="id"><a href="compcert.backend.Inlining.html#funenv_program">funenv_program</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#cu">cu</a></span>) <span class="id"><a href="compcert.backend.Inliningproof.html#f">f</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id">f</span>' -&gt; <span class="id"><a href="compcert.backend.RTL.html#funsig">funsig</a></span> <span class="id">f</span>' = <span class="id"><a href="compcert.backend.RTL.html#funsig">funsig</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#f">f</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2747')">Proof.</div>
<div class="proofscript" id="proof2747">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">f</span>; <span class="id">Errors.monadInv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Inliningspec.html#transf_function_spec">transf_function_spec</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> <span class="id">SP</span>; <span class="id">inv</span> <span class="id">SP</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<h2> Properties of contexts and relocations </h2>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="sreg_below_diff">sreg_below_diff</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ctx</span> <span class="id">r</span> <span class="id">r</span>', <span class="id"><a href="compcert.lib.Coqlib.html#Plt">Plt</a></span> <span class="id">r</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dreg">dreg</a></span>) -&gt; <span class="id"><a href="compcert.backend.Inlining.html#sreg">sreg</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span> &lt;&gt; <span class="id">r</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2748')">Proof.</div>
<div class="proofscript" id="proof2748">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">zify</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Inlining.html#sreg">sreg</a></span>; <span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Inliningspec.html#shiftpos_eq">shiftpos_eq</a></span>. <span class="id">xomega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="context_below_diff">context_below_diff</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ctx1</span> <span class="id">ctx2</span> <span class="id">r1</span> <span class="id">r2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#context_below">context_below</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx1">ctx1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx2">ctx2</a></span> -&gt; <span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#r1">r1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx1">ctx1</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#mreg">mreg</a></span>) -&gt; <span class="id"><a href="compcert.backend.Inlining.html#sreg">sreg</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx1">ctx1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#r1">r1</a></span> &lt;&gt; <span class="id"><a href="compcert.backend.Inlining.html#sreg">sreg</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx2">ctx2</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#r2">r2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2749')">Proof.</div>
<div class="proofscript" id="proof2749">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">red</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="id">zify</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Inlining.html#sreg">sreg</a></span>; <span class="tactic">rewrite</span> ! <span class="id"><a href="compcert.backend.Inliningspec.html#shiftpos_eq">shiftpos_eq</a></span>. <span class="id">xomega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="context_below_lt">context_below_lt</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ctx1</span> <span class="id">ctx2</span> <span class="id">r</span>, <span class="id"><a href="compcert.backend.Inliningspec.html#context_below">context_below</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx1">ctx1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx2">ctx2</a></span> -&gt; <span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx1">ctx1</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#mreg">mreg</a></span>) -&gt; <span class="id"><a href="compcert.lib.Coqlib.html#Plt">Plt</a></span> (<span class="id"><a href="compcert.backend.Inlining.html#sreg">sreg</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx1">ctx1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span>) <span class="id"><a href="compcert.backend.Inliningproof.html#ctx2">ctx2</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dreg">dreg</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2750')">Proof.</div>
<div class="proofscript" id="proof2750">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">red</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.lib.Coqlib.html#Plt">Plt</a></span>; <span class="id">zify</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Inlining.html#sreg">sreg</a></span>; <span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Inliningspec.html#shiftpos_eq">shiftpos_eq</a></span>.<br/>
&nbsp;&nbsp;<span class="id">xomega</span>.<br/>
Qed.</div>
<br/>
<br/>
<h2> Agreement between register sets before and after inlining. </h2>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="agree_regs">agree_regs</a></span> (<span class="id">F</span>: <span class="id"><a href="compcert.common.Values.html#meminj">meminj</a></span>) (<span class="id">ctx</span>: <span class="id"><a href="compcert.backend.Inlining.html#context">context</a></span>) (<span class="id">rs</span> <span class="id">rs</span>': <span class="id"><a href="compcert.backend.RTL.html#regset">regset</a></span>) :=<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">r</span>, <span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#mreg">mreg</a></span>) -&gt; <span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rs">rs</a></span>#<span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span> <span class="id">rs</span>'#(<span class="id"><a href="compcert.backend.Inlining.html#sreg">sreg</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span>))<br/>
/\(<span class="kwd">forall</span> <span class="id">r</span>, <span class="id"><a href="compcert.lib.Coqlib.html#Plt">Plt</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#mreg">mreg</a></span>) <span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span> -&gt; <span class="id"><a href="compcert.backend.Inliningproof.html#rs">rs</a></span>#<span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span> = <span class="id"><a href="compcert.common.Values.html#Vundef">Vundef</a></span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="val_reg_charact">val_reg_charact</a></span> (<span class="id">F</span>: <span class="id"><a href="compcert.common.Values.html#meminj">meminj</a></span>) (<span class="id">ctx</span>: <span class="id"><a href="compcert.backend.Inlining.html#context">context</a></span>) (<span class="id">rs</span>': <span class="id"><a href="compcert.backend.RTL.html#regset">regset</a></span>) (<span class="id">v</span>: <span class="id"><a href="compcert.common.Values.html#val">val</a></span>) (<span class="id">r</span>: <span class="id"><a href="compcert.backend.Registers.html#reg">reg</a></span>) :=<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.lib.Coqlib.html#Plt">Plt</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#mreg">mreg</a></span>) <span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span> /\ <span class="id"><a href="compcert.backend.Inliningproof.html#v">v</a></span> = <span class="id"><a href="compcert.common.Values.html#Vundef">Vundef</a></span>) \/ (<span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#mreg">mreg</a></span>) /\ <span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#v">v</a></span> <span class="id">rs</span>'#(<span class="id"><a href="compcert.backend.Inlining.html#sreg">sreg</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span>)).<br/>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="Plt_Ple_dec">Plt_Ple_dec</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">p</span> <span class="id">q</span>, {<span class="id"><a href="compcert.lib.Coqlib.html#Plt">Plt</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#p">p</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#q">q</a></span>} + {<span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#q">q</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#p">p</a></span>}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2751')">Proof.</div>
<div class="proofscript" id="proof2751">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#plt">plt</a></span> <span class="id">p</span> <span class="id">q</span>). <span class="id">left</span>; <span class="tactic">auto</span>. <span class="id">right</span>; <span class="id">xomega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_val_reg_gen">agree_val_reg_gen</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">F</span> <span class="id">ctx</span> <span class="id">rs</span> <span class="id">rs</span>' <span class="id">r</span>, <span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rs">rs</a></span> <span class="id">rs</span>' -&gt; <span class="id"><a href="compcert.backend.Inliningproof.html#val_reg_charact">val_reg_charact</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id">rs</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#rs">rs</a></span>#<span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2752')">Proof.</div>
<div class="proofscript" id="proof2752">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [<span class="id">A</span> <span class="id">B</span>].<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.backend.Inliningproof.html#Plt_Ple_dec">Plt_Ple_dec</a></span> (<span class="id"><a href="compcert.backend.Inlining.html#mreg">mreg</a></span> <span class="id">ctx</span>) <span class="id">r</span>).<br/>
&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">rewrite</span> <span class="id">B</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">right</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_val_regs_gen">agree_val_regs_gen</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">F</span> <span class="id">ctx</span> <span class="id">rs</span> <span class="id">rs</span>' <span class="id">rl</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rs">rs</a></span> <span class="id">rs</span>' -&gt; <span class="id"><a href="compcert.lib.Coqlib.html#list_forall2">list_forall2</a></span> (<span class="id"><a href="compcert.backend.Inliningproof.html#val_reg_charact">val_reg_charact</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id">rs</span>') <span class="id"><a href="compcert.backend.Inliningproof.html#rs">rs</a></span>##<span class="id"><a href="compcert.backend.Inliningproof.html#rl">rl</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rl">rl</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2753')">Proof.</div>
<div class="proofscript" id="proof2753">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">rl</span>; <span class="tactic">intros</span>; <span class="id">constructor</span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_val_reg_gen">agree_val_reg_gen</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_val_reg">agree_val_reg</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">F</span> <span class="id">ctx</span> <span class="id">rs</span> <span class="id">rs</span>' <span class="id">r</span>, <span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rs">rs</a></span> <span class="id">rs</span>' -&gt; <span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rs">rs</a></span>#<span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span> <span class="id">rs</span>'#(<span class="id"><a href="compcert.backend.Inlining.html#sreg">sreg</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2754')">Proof.</div>
<div class="proofscript" id="proof2754">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_val_reg_gen">agree_val_reg_gen</a></span>; <span class="tactic">eauto</span>. <span class="id">instantiate</span> (1 := <span class="id">r</span>). <span class="tactic">intros</span> [[<span class="id">A</span> <span class="id">B</span>] | [<span class="id">A</span> <span class="id">B</span>]].<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">B</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_val_regs">agree_val_regs</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">F</span> <span class="id">ctx</span> <span class="id">rs</span> <span class="id">rs</span>' <span class="id">rl</span>, <span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rs">rs</a></span> <span class="id">rs</span>' -&gt; <span class="id"><a href="compcert.common.Values.html#Val.inject_list">Val.inject_list</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rs">rs</a></span>##<span class="id"><a href="compcert.backend.Inliningproof.html#rl">rl</a></span> <span class="id">rs</span>'##(<span class="id"><a href="compcert.backend.Inlining.html#sregs">sregs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rl">rl</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2755')">Proof.</div>
<div class="proofscript" id="proof2755">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">rl</span>; <span class="tactic">intros</span>; <span class="tactic">simpl</span>. <span class="id">constructor</span>. <span class="id">constructor</span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_val_reg">agree_val_reg</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_set_reg">agree_set_reg</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">F</span> <span class="id">ctx</span> <span class="id">rs</span> <span class="id">rs</span>' <span class="id">r</span> <span class="id">v</span> <span class="id">v</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rs">rs</a></span> <span class="id">rs</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#v">v</a></span> <span class="id">v</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#mreg">mreg</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> (<span class="id"><a href="compcert.backend.Inliningproof.html#rs">rs</a></span>#<span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span> &lt;- <span class="id"><a href="compcert.backend.Inliningproof.html#v">v</a></span>) (<span class="id">rs</span>'#(<span class="id"><a href="compcert.backend.Inlining.html#sreg">sreg</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span>) &lt;- <span class="id">v</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2756')">Proof.</div>
<div class="proofscript" id="proof2756">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs">agree_regs</a></span>; <span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H</span>. <span class="tactic">split</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Registers.html#Regmap.gsspec">Regmap.gsspec</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#peq">peq</a></span> <span class="id">r0</span> <span class="id">r</span>). <span class="tactic">subst</span> <span class="id">r0</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#peq_true">peq_true</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#peq_false">peq_false</a></span>. <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningspec.html#shiftpos_diff">shiftpos_diff</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Registers.html#Regmap.gso">Regmap.gso</a></span>. <span class="tactic">auto</span>. <span class="id">xomega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_set_reg_undef">agree_set_reg_undef</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">F</span> <span class="id">ctx</span> <span class="id">rs</span> <span class="id">rs</span>' <span class="id">r</span> <span class="id">v</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rs">rs</a></span> <span class="id">rs</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> (<span class="id"><a href="compcert.backend.Inliningproof.html#rs">rs</a></span>#<span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span> &lt;- <span class="id"><a href="compcert.common.Values.html#Vundef">Vundef</a></span>) (<span class="id">rs</span>'#(<span class="id"><a href="compcert.backend.Inlining.html#sreg">sreg</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span>) &lt;- <span class="id">v</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2757')">Proof.</div>
<div class="proofscript" id="proof2757">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs">agree_regs</a></span>; <span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H</span>. <span class="tactic">split</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Registers.html#Regmap.gsspec">Regmap.gsspec</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#peq">peq</a></span> <span class="id">r0</span> <span class="id">r</span>). <span class="tactic">subst</span> <span class="id">r0</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#peq_true">peq_true</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#peq_false">peq_false</a></span>. <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningspec.html#shiftpos_diff">shiftpos_diff</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Registers.html#Regmap.gsspec">Regmap.gsspec</a></span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#peq">peq</a></span> <span class="id">r0</span> <span class="id">r</span>); <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">agree_set_reg_undef</span>':<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">F</span> <span class="id">ctx</span> <span class="id">rs</span> <span class="id">rs</span>' <span class="id">r</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rs">rs</a></span> <span class="id">rs</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> (<span class="id"><a href="compcert.backend.Inliningproof.html#rs">rs</a></span>#<span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span> &lt;- <span class="id"><a href="compcert.common.Values.html#Vundef">Vundef</a></span>) <span class="id">rs</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2758')">Proof.</div>
<div class="proofscript" id="proof2758">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs">agree_regs</a></span>; <span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H</span>. <span class="tactic">split</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Registers.html#Regmap.gsspec">Regmap.gsspec</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#peq">peq</a></span> <span class="id">r0</span> <span class="id">r</span>). <span class="tactic">subst</span> <span class="id">r0</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Registers.html#Regmap.gsspec">Regmap.gsspec</a></span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#peq">peq</a></span> <span class="id">r0</span> <span class="id">r</span>); <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_regs_invariant">agree_regs_invariant</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">F</span> <span class="id">ctx</span> <span class="id">rs</span> <span class="id">rs1</span> <span class="id">rs2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rs">rs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rs1">rs1</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">r</span>, <span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dreg">dreg</a></span>) <span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span> -&gt; <span class="id"><a href="compcert.lib.Coqlib.html#Plt">Plt</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span> (<span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dreg">dreg</a></span>) + <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#mreg">mreg</a></span>)) -&gt; <span class="id"><a href="compcert.backend.Inliningproof.html#rs2">rs2</a></span>#<span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span> = <span class="id"><a href="compcert.backend.Inliningproof.html#rs1">rs1</a></span>#<span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rs">rs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rs2">rs2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2759')">Proof.</div>
<div class="proofscript" id="proof2759">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs">agree_regs</a></span>; <span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H</span>. <span class="tactic">split</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H0</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningspec.html#shiftpos_above">shiftpos_above</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.lt_le_trans">Pos.lt_le_trans</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningspec.html#shiftpos_below">shiftpos_below</a></span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H1</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_regs_incr">agree_regs_incr</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">F</span> <span class="id">ctx</span> <span class="id">rs1</span> <span class="id">rs2</span> <span class="id">F</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rs1">rs1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rs2">rs2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Values.html#inject_incr">inject_incr</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id">F</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs">agree_regs</a></span> <span class="id">F</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rs1">rs1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rs2">rs2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2760')">Proof.</div>
<div class="proofscript" id="proof2760">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H</span>. <span class="tactic">split</span>; <span class="tactic">intros</span>. <span class="tactic">eauto</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="agree_regs_init">agree_regs_init</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">F</span> <span class="id">ctx</span> <span class="id">rs</span>, <span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> (<span class="id"><a href="compcert.backend.Registers.html#Regmap.init">Regmap.init</a></span> <span class="id"><a href="compcert.common.Values.html#Vundef">Vundef</a></span>) <span class="id"><a href="compcert.backend.Inliningproof.html#rs">rs</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2761')">Proof.</div>
<div class="proofscript" id="proof2761">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">split</span>; <span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Registers.html#Regmap.gi">Regmap.gi</a></span>; <span class="tactic">auto</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Registers.html#Regmap.gi">Regmap.gi</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_regs_init_regs">agree_regs_init_regs</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">F</span> <span class="id">ctx</span> <span class="id">rl</span> <span class="id">vl</span> <span class="id">vl</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Values.html#Val.inject_list">Val.inject_list</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#vl">vl</a></span> <span class="id">vl</span>' -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">r</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rl">rl</a></span> -&gt; <span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#mreg">mreg</a></span>)) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> (<span class="id"><a href="compcert.backend.RTL.html#init_regs">init_regs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#vl">vl</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rl">rl</a></span>) (<span class="id"><a href="compcert.backend.RTL.html#init_regs">init_regs</a></span> <span class="id">vl</span>' (<span class="id"><a href="compcert.backend.Inlining.html#sregs">sregs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rl">rl</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2762')">Proof.</div>
<div class="proofscript" id="proof2762">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">rl</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs_init">agree_regs_init</a></span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs_init">agree_regs_init</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_set_reg">agree_set_reg</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<h2> Executing sequences of moves </h2>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="tr_moves_init_regs">tr_moves_init_regs</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">F</span> <span class="id">stk</span> <span class="id">f</span> <span class="id">sp</span> <span class="id">m</span> <span class="id">ctx1</span> <span class="id">ctx2</span>, <span class="id"><a href="compcert.backend.Inliningspec.html#context_below">context_below</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx1">ctx1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx2">ctx2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">rdsts</span> <span class="id">rsrcs</span> <span class="id">vl</span> <span class="id">pc1</span> <span class="id">pc2</span> <span class="id">rs1</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#tr_moves">tr_moves</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#f">f</a></span>.(<span class="id"><a href="compcert.backend.RTL.html#fn_code">fn_code</a></span>) <span class="id"><a href="compcert.backend.Inliningproof.html#pc1">pc1</a></span> (<span class="id"><a href="compcert.backend.Inlining.html#sregs">sregs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx1">ctx1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rsrcs">rsrcs</a></span>) (<span class="id"><a href="compcert.backend.Inlining.html#sregs">sregs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx2">ctx2</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rdsts">rdsts</a></span>) <span class="id"><a href="compcert.backend.Inliningproof.html#pc2">pc2</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">r</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rdsts">rdsts</a></span> -&gt; <span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx2">ctx2</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#mreg">mreg</a></span>)) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#list_forall2">list_forall2</a></span> (<span class="id"><a href="compcert.backend.Inliningproof.html#val_reg_charact">val_reg_charact</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx1">ctx1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rs1">rs1</a></span>) <span class="id"><a href="compcert.backend.Inliningproof.html#vl">vl</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rsrcs">rsrcs</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">rs2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Smallstep.html#star">star</a></span> <span class="id"><a href="compcert.backend.RTL.html#step">step</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.tse">tse</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.tge">tge</a></span> (<span class="id"><a href="compcert.backend.RTL.html#State">State</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#f">f</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#pc1">pc1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rs1">rs1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Events.html#E0">E0</a></span> (<span class="id"><a href="compcert.backend.RTL.html#State">State</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#f">f</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#pc2">pc2</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rs2">rs2</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span>)<br/>
&nbsp;&nbsp;/\ <span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx2">ctx2</a></span> (<span class="id"><a href="compcert.backend.RTL.html#init_regs">init_regs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#vl">vl</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rdsts">rdsts</a></span>) <span class="id"><a href="compcert.backend.Inliningproof.html#rs2">rs2</a></span><br/>
&nbsp;&nbsp;/\ <span class="kwd">forall</span> <span class="id">r</span>, <span class="id"><a href="compcert.lib.Coqlib.html#Plt">Plt</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx2">ctx2</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dreg">dreg</a></span>) -&gt; <span class="id"><a href="compcert.backend.Inliningproof.html#rs2">rs2</a></span>#<span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span> = <span class="id"><a href="compcert.backend.Inliningproof.html#rs1">rs1</a></span>#<span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2763')">Proof.</div>
<div class="proofscript" id="proof2763">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">rdsts</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
<span class="comment">(*&nbsp;rdsts&nbsp;=&nbsp;nil&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H0</span>. <span class="id">exists</span> <span class="id">rs1</span>; <span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Smallstep.html#star_refl">star_refl</a></span>. <span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs_init">agree_regs_init</a></span>. <span class="tactic">auto</span>.<br/>
<span class="comment">(*&nbsp;rdsts&nbsp;=&nbsp;a&nbsp;::&nbsp;rdsts&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H2</span>. <span class="id">inv</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">rs1</span>; <span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Smallstep.html#star_refl">star_refl</a></span>. <span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs_init">agree_regs_init</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="id">inv</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">IHrdsts</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">rs2</span> [<span class="id">A</span> [<span class="id">B</span> <span class="id">C</span>]]].<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id">rs2</span>#(<span class="id"><a href="compcert.backend.Inlining.html#sreg">sreg</a></span> <span class="id">ctx2</span> <span class="id">a</span>) &lt;- (<span class="id">rs2</span>#(<span class="id"><a href="compcert.backend.Inlining.html#sreg">sreg</a></span> <span class="id">ctx1</span> <span class="id">b1</span>))).<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#star_right">star_right</a></span>. <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.RTL.html#exec_Iop">exec_Iop</a></span>; <span class="tactic">eauto</span>. <span class="id">traceEq</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">destruct</span> <span class="id">H3</span> <span class="kwd">as</span> [[<span class="id">P</span> <span class="id">Q</span>] | [<span class="id">P</span> <span class="id">Q</span>]].<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">a1</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_set_reg_undef">agree_set_reg_undef</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_set_reg">agree_set_reg</a></span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id">C</span>; <span class="tactic">auto</span>.  <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#context_below_lt">context_below_lt</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Registers.html#Regmap.gso">Regmap.gso</a></span>. <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#not_eq_sym">not_eq_sym</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#sreg_below_diff">sreg_below_diff</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H2</span>; <span class="tactic">discriminate</span>.<br/>
Qed.</div>
<br/>
<h2> Memory invariants </h2>
<br/>
<div class="doc">A stack location is private if it is not the image of a valid
   location and we have full rights on it. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="loc_private">loc_private</a></span> (<span class="id">F</span>: <span class="id"><a href="compcert.common.Values.html#meminj">meminj</a></span>) (<span class="id">m</span> <span class="id">m</span>': <span class="id"><a href="compcert.common.Memory.html#mem">mem</a></span>) (<span class="id">sp</span>: <span class="id"><a href="compcert.common.Values.html#block">block</a></span>) (<span class="id">ofs</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.common.Memtype.html#Cur">Cur</a></span> <span class="id"><a href="compcert.common.Memtype.html#Freeable">Freeable</a></span> /\<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">b</span> <span class="id">delta</span>, <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span>, <span class="id"><a href="compcert.backend.Inliningproof.html#delta">delta</a></span>) -&gt; ~<span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> (<span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> - <span class="id"><a href="compcert.backend.Inliningproof.html#delta">delta</a></span>) <span class="id"><a href="compcert.common.Memtype.html#Max">Max</a></span> <span class="id"><a href="compcert.common.Memtype.html#Nonempty">Nonempty</a></span>).<br/>
<br/>
<div class="doc">Likewise, for a range of locations. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="range_private">range_private</a></span> (<span class="id">F</span>: <span class="id"><a href="compcert.common.Values.html#meminj">meminj</a></span>) (<span class="id">m</span> <span class="id">m</span>': <span class="id"><a href="compcert.common.Memory.html#mem">mem</a></span>) (<span class="id">sp</span>: <span class="id"><a href="compcert.common.Values.html#block">block</a></span>) (<span class="id">lo</span> <span class="id">hi</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ofs</span>, <span class="id"><a href="compcert.backend.Inliningproof.html#lo">lo</a></span> &lt;= <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> &lt; <span class="id"><a href="compcert.backend.Inliningproof.html#hi">hi</a></span> -&gt; <span class="id"><a href="compcert.backend.Inliningproof.html#loc_private">loc_private</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="range_private_tgt_private">range_private_tgt_private</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sm</span> <span class="id">blk</span> <span class="id">lo</span> <span class="id">hi</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">MWF</span>: <span class="id">SimMemInj.wf</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sm">sm</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">PRIVTGT</span>: <span class="id"><a href="compcert.backend.Inliningproof.html#range_private">range_private</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#sm">sm</a></span>.(<span class="id"><a href="compcert.common.SimMemInj.html#inj">SimMemInj.inj</a></span>) <span class="id"><a href="compcert.backend.Inliningproof.html#sm">sm</a></span>.(<span class="id"><a href="compcert.common.SimMemInj.html#src">SimMemInj.src</a></span>) <span class="id"><a href="compcert.backend.Inliningproof.html#sm">sm</a></span>.(<span class="id"><a href="compcert.common.SimMemInj.html#tgt">SimMemInj.tgt</a></span>) <span class="id"><a href="compcert.backend.Inliningproof.html#blk">blk</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#lo">lo</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#hi">hi</a></span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ofs</span> (<span class="id">BDD</span>: <span class="id"><a href="compcert.backend.Inliningproof.html#lo">lo</a></span> &lt;= <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> &lt; <span class="id"><a href="compcert.backend.Inliningproof.html#hi">hi</a></span>), &lt;&lt;<span class="id">PRIVTGT</span>: <span class="id"><a href="compcert.backend.Inliningproof.html#sm">sm</a></span>.(<span class="id"><a href="compcert.common.SimMemInj.html#tgt_private">SimMemInj.tgt_private</a></span>) <span class="id"><a href="compcert.backend.Inliningproof.html#blk">blk</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span>&gt;&gt;.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2764')">Proof.</div>
<div class="proofscript" id="proof2764">
&nbsp;&nbsp;<span class="id">ii</span>. <span class="tactic">repeat</span> <span class="tactic">red</span>. <span class="id">specialize</span> (<span class="id">PRIVTGT</span> <span class="id">ofs</span> <span class="id">BDD</span>). <span class="tactic">red</span> <span class="kwd">in</span> <span class="id">PRIVTGT</span>. <span class="id">des</span>.<br/>
&nbsp;&nbsp;<span class="id">esplits</span>; <span class="tactic">eauto</span>. <span class="tactic">red</span>. <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="range_private_invariant">range_private_invariant</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">F</span> <span class="id">m</span> <span class="id">m</span>' <span class="id">sp</span> <span class="id">lo</span> <span class="id">hi</span> <span class="id">F1</span> <span class="id">m1</span> <span class="id">m1</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#range_private">range_private</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#lo">lo</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#hi">hi</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">b</span> <span class="id">delta</span> <span class="id">ofs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#F1">F1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span>, <span class="id"><a href="compcert.backend.Inliningproof.html#delta">delta</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m1">m1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.common.Memtype.html#Max">Max</a></span> <span class="id"><a href="compcert.common.Memtype.html#Nonempty">Nonempty</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#lo">lo</a></span> &lt;= <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> + <span class="id"><a href="compcert.backend.Inliningproof.html#delta">delta</a></span> &lt; <span class="id"><a href="compcert.backend.Inliningproof.html#hi">hi</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span>, <span class="id"><a href="compcert.backend.Inliningproof.html#delta">delta</a></span>) /\ <span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.common.Memtype.html#Max">Max</a></span> <span class="id"><a href="compcert.common.Memtype.html#Nonempty">Nonempty</a></span>) -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">ofs</span>, <span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.common.Memtype.html#Cur">Cur</a></span> <span class="id"><a href="compcert.common.Memtype.html#Freeable">Freeable</a></span> -&gt; <span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id">m1</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.common.Memtype.html#Cur">Cur</a></span> <span class="id"><a href="compcert.common.Memtype.html#Freeable">Freeable</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#range_private">range_private</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F1">F1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m1">m1</a></span> <span class="id">m1</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#lo">lo</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#hi">hi</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2765')">Proof.</div>
<div class="proofscript" id="proof2765">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id">H</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">A</span> <span class="id">B</span>]. <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id">H0</span>; <span class="tactic">eauto</span>. <span class="tactic">omega</span>. <span class="tactic">intros</span> [<span class="id">P</span> <span class="id">Q</span>].<br/>
&nbsp;&nbsp;<span class="id">eelim</span> <span class="id">B</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="range_private_perms">range_private_perms</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">F</span> <span class="id">m</span> <span class="id">m</span>' <span class="id">sp</span> <span class="id">lo</span> <span class="id">hi</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#range_private">range_private</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#lo">lo</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#hi">hi</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Memory.html#Mem.range_perm">Mem.range_perm</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#lo">lo</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#hi">hi</a></span> <span class="id"><a href="compcert.common.Memtype.html#Cur">Cur</a></span> <span class="id"><a href="compcert.common.Memtype.html#Freeable">Freeable</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2766')">Proof.</div>
<div class="proofscript" id="proof2766">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id">H</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="range_private_alloc_left">range_private_alloc_left</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">F</span> <span class="id">m</span> <span class="id">m</span>' <span class="id">sp</span>' <span class="id">base</span> <span class="id">hi</span> <span class="id">sz</span> <span class="id">m1</span> <span class="id">sp</span> <span class="id">F1</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#range_private">range_private</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id">sp</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#base">base</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#hi">hi</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Memory.html#Mem.alloc">Mem.alloc</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> 0 <span class="id"><a href="compcert.backend.Inliningproof.html#sz">sz</a></span> = (<span class="id"><a href="compcert.backend.Inliningproof.html#m1">m1</a></span>, <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#F1">F1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id">sp</span>', <span class="id"><a href="compcert.backend.Inliningproof.html#base">base</a></span>) -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">b</span>, <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> &lt;&gt; <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span> -&gt; <span class="id"><a href="compcert.backend.Inliningproof.html#F1">F1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> = <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#range_private">range_private</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F1">F1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m1">m1</a></span> <span class="id">m</span>' <span class="id">sp</span>' (<span class="id"><a href="compcert.backend.Inliningproof.html#base">base</a></span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.max">Z.max</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#sz">sz</a></span> 0) <span class="id"><a href="compcert.backend.Inliningproof.html#hi">hi</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2767')">Proof.</div>
<div class="proofscript" id="proof2767">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">H</span> <span class="id">ofs</span>). <span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.le_max_r">Z.le_max_r</a></span> <span class="id">sz</span> 0). <span class="tactic">omega</span>. <span class="tactic">intros</span> [<span class="id">A</span> <span class="id">B</span>].<br/>
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_alloc_inv">Mem.perm_alloc_inv</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.Values.html#eq_block">eq_block</a></span> <span class="id">b</span> <span class="id">sp</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">b</span>. <span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H4</span>; <span class="id">inv</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#Zmax_spec">Zmax_spec</a></span> <span class="kwd">in</span> <span class="id">H3</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> 0 <span class="id">sz</span>); <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">in</span> <span class="id">H4</span>; <span class="tactic">auto</span>. <span class="id">eelim</span> <span class="id">B</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="range_private_free_left">range_private_free_left</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">F</span> <span class="id">m</span> <span class="id">m</span>' <span class="id">sp</span> <span class="id">base</span> <span class="id">sz</span> <span class="id">hi</span> <span class="id">b</span> <span class="id">m1</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#range_private">range_private</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span> (<span class="id"><a href="compcert.backend.Inliningproof.html#base">base</a></span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.max">Z.max</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#sz">sz</a></span> 0) <span class="id"><a href="compcert.backend.Inliningproof.html#hi">hi</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Memory.html#Mem.free">Mem.free</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> 0 <span class="id"><a href="compcert.backend.Inliningproof.html#sz">sz</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m1">m1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span>, <span class="id"><a href="compcert.backend.Inliningproof.html#base">base</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Memory.html#Mem.inject">Mem.inject</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#range_private">range_private</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m1">m1</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#base">base</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#hi">hi</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2768')">Proof.</div>
<div class="proofscript" id="proof2768">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> <span class="id">ofs</span> (<span class="id">base</span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.max">Z.max</a></span> <span class="id">sz</span> 0)) <span class="kwd">as</span> [<span class="id">z</span>|<span class="id">z</span>].<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> <span class="id">ofs</span> <span class="kwd">with</span> ((<span class="id">ofs</span> - <span class="id">base</span>) + <span class="id">base</span>) <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_inject">Mem.perm_inject</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.free_range_perm">Mem.free_range_perm</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#Zmax_spec">Zmax_spec</a></span> <span class="kwd">in</span> <span class="id">z</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> 0 <span class="id">sz</span>); <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.Values.html#eq_block">eq_block</a></span> <span class="id">b</span> <span class="id">b0</span>).<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">b0</span>. <span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H4</span>; <span class="id">inv</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;<span class="id">eelim</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_free_2">Mem.perm_free_2</a></span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#Zmax_spec">Zmax_spec</a></span> <span class="kwd">in</span> <span class="id">z</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> 0 <span class="id">sz</span>); <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Memory.html#Mem.mi_no_overlap">Mem.mi_no_overlap</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_cur_max">Mem.perm_cur_max</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_implies">Mem.perm_implies</a></span> <span class="kwd">with</span> <span class="id"><a href="compcert.common.Memtype.html#Freeable">Freeable</a></span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.free_range_perm">Mem.free_range_perm</a></span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">instantiate</span> (1 := <span class="id">ofs</span> - <span class="id">base</span>). <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#Zmax_spec">Zmax_spec</a></span> <span class="kwd">in</span> <span class="id">z</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> 0 <span class="id">sz</span>); <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_free_3">Mem.perm_free_3</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">A</span> | <span class="id">A</span>]. <span class="tactic">congruence</span>. <span class="tactic">omega</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">H</span> <span class="id">ofs</span>). <span class="tactic">omega</span>. <span class="tactic">intros</span> [<span class="id">A</span> <span class="id">B</span>]. <span class="tactic">split</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="id">eelim</span> <span class="id">B</span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_free_3">Mem.perm_free_3</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="range_private_extcall">range_private_extcall</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">F</span> <span class="id">F</span>' <span class="id">m1</span> <span class="id">m2</span> <span class="id">m1</span>' <span class="id">m2</span>' <span class="id">sp</span> <span class="id">base</span> <span class="id">hi</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#range_private">range_private</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m1">m1</a></span> <span class="id">m1</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#base">base</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#hi">hi</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Memory.html#Mem.valid_block">Mem.valid_block</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m1">m1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> -&gt; <span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m2">m2</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.common.Memtype.html#Max">Max</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#p">p</a></span> -&gt; <span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m1">m1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.common.Memtype.html#Max">Max</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#p">p</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Memory.html#Mem.unchanged_on">Mem.unchanged_on</a></span> (<span class="id"><a href="compcert.common.Events.html#loc_out_of_reach">loc_out_of_reach</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m1">m1</a></span>) <span class="id">m1</span>' <span class="id">m2</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Memory.html#Mem.inject">Mem.inject</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m1">m1</a></span> <span class="id">m1</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Values.html#inject_incr">inject_incr</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id">F</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Events.html#inject_separated">inject_separated</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id">F</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#m1">m1</a></span> <span class="id">m1</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Memory.html#Mem.valid_block">Mem.valid_block</a></span> <span class="id">m1</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#range_private">range_private</a></span> <span class="id">F</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#m2">m2</a></span> <span class="id">m2</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#base">base</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#hi">hi</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2769')">Proof.</div>
<div class="proofscript" id="proof2769">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> <span class="id">hi</span>; <span class="tactic">intros</span> <span class="id">RP</span> <span class="id">PERM</span> <span class="id">UNCH</span> <span class="id">INJ</span> <span class="id">INCR</span> <span class="id">SEP</span> <span class="id">VB</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id">RP</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">A</span> <span class="id">B</span>].<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_unchanged_on">Mem.perm_unchanged_on</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">red</span> <span class="kwd">in</span> <span class="id">SEP</span>. <span class="tactic">destruct</span> (<span class="id">F</span> <span class="id">b</span>) <span class="kwd">as</span> [[<span class="id">sp1</span> <span class="id">delta1</span>] |] <span class="id">eqn</span>:?.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">INCR</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> <span class="id">EQ</span>; <span class="tactic">rewrite</span> <span class="id">H0</span> <span class="kwd">in</span> <span class="id">EQ</span>; <span class="id">inv</span> <span class="id">EQ</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="id">eelim</span> <span class="id">B</span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id">PERM</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#plt">plt</a></span> <span class="id">b</span> (<span class="id"><a href="compcert.common.Memory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">m1</span>)); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Memory.html#Mem.mi_freeblocks">Mem.mi_freeblocks</a></span>; <span class="tactic">eauto</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">SEP</span>; <span class="tactic">eauto</span>. <span class="tactic">tauto</span>.<br/>
Qed.</div>
<br/>
<h2> Relating global environments </h2>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="match_globalenvs">match_globalenvs</a></span> (<span class="id">F</span>: <span class="id"><a href="compcert.common.Values.html#meminj">meminj</a></span>) (<span class="id">bound</span>: <span class="id"><a href="compcert.common.Values.html#block">block</a></span>): <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="mk_match_globalenvs">mk_match_globalenvs</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">DOMAIN</span>: <span class="kwd">forall</span> <span class="id">b</span>, <span class="id"><a href="compcert.lib.Coqlib.html#Plt">Plt</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#bound">bound</a></span> -&gt; <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span>, 0))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">IMAGE</span>: <span class="kwd">forall</span> <span class="id">b1</span> <span class="id">b2</span> <span class="id">delta</span>, <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b1">b1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="compcert.backend.Inliningproof.html#b2">b2</a></span>, <span class="id"><a href="compcert.backend.Inliningproof.html#delta">delta</a></span>) -&gt; <span class="id"><a href="compcert.lib.Coqlib.html#Plt">Plt</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b2">b2</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#bound">bound</a></span> -&gt; <span class="id"><a href="compcert.backend.Inliningproof.html#b1">b1</a></span> = <span class="id"><a href="compcert.backend.Inliningproof.html#b2">b2</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SYMBOLS</span>: <span class="kwd">forall</span> <span class="id">id</span> <span class="id">b</span>, <span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_symbol">Genv.find_symbol</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.ge">ge</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#id">id</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> -&gt; <span class="id"><a href="compcert.lib.Coqlib.html#Plt">Plt</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#bound">bound</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FUNCTIONS</span>: <span class="kwd">forall</span> <span class="id">b</span> <span class="id">fd</span>, <span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_funct_ptr">Genv.find_funct_ptr</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.ge">ge</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#fd">fd</a></span> -&gt; <span class="id"><a href="compcert.lib.Coqlib.html#Plt">Plt</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#bound">bound</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">VARINFOS</span>: <span class="kwd">forall</span> <span class="id">b</span> <span class="id">gv</span>, <span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_var_info">Genv.find_var_info</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.ge">ge</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#gv">gv</a></span> -&gt; <span class="id"><a href="compcert.lib.Coqlib.html#Plt">Plt</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#bound">bound</a></span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="find_function_ptr_agree">find_function_ptr_agree</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ros</span> <span class="id">rs</span> <span class="id">fptr</span> <span class="id">F</span> <span class="id">ctx</span> <span class="id">rs</span>' <span class="id">bound</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.RTL.html#find_function_ptr">find_function_ptr</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.ge">ge</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ros">ros</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rs">rs</a></span> = <span class="id"><a href="compcert.backend.Inliningproof.html#fptr">fptr</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rs">rs</a></span> <span class="id">rs</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_globalenvs">match_globalenvs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#bound">bound</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">tfptr</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.RTL.html#find_function_ptr">find_function_ptr</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.tge">tge</a></span> (<span class="id"><a href="compcert.backend.Inlining.html#sros">sros</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ros">ros</a></span>) <span class="id">rs</span>' = <span class="id"><a href="compcert.backend.Inliningproof.html#tfptr">tfptr</a></span> /\ <span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#fptr">fptr</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#tfptr">tfptr</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2770')">Proof.</div>
<div class="proofscript" id="proof2770">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">ros</span> <span class="kwd">as</span> [<span class="id">r</span> | <span class="id">id</span>]; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
- <span class="comment">(*&nbsp;register&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">clarify</span>. <span class="id">esplits</span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_val_reg">agree_val_reg</a></span>; <span class="tactic">eauto</span>.<br/>
- <span class="comment">(*&nbsp;symbol&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Inliningproof.html#symbols_preserved">symbols_preserved</a></span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_symbol">Genv.find_symbol</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.ge">ge</a></span> <span class="id">id</span>) <span class="id">eqn</span>:<span class="id">T</span>; <span class="id">clarify</span>; <span class="id">esplits</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H1</span>. <span class="id">exploit</span> <span class="id">DOMAIN</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="find_inlined_function">find_inlined_function</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">fenv</span> <span class="id">id</span> <span class="id">rs</span> <span class="id">f</span> <span class="id">fptr</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#fenv_compat">fenv_compat</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.prog">prog</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#fenv">fenv</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.RTL.html#find_function_ptr">find_function_ptr</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.ge">ge</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#inr">inr</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#id">id</a></span>) <span class="id"><a href="compcert.backend.Inliningproof.html#rs">rs</a></span> = <span class="id"><a href="compcert.backend.Inliningproof.html#fptr">fptr</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#fenv">fenv</a></span>!<span class="id"><a href="compcert.backend.Inliningproof.html#id">id</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#f">f</a></span> -&gt;<br/>
&nbsp;&nbsp;&lt;&lt;<span class="id">FPTR</span>: <span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_funct">Genv.find_funct</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.ge">ge</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#fptr">fptr</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="compcert.common.AST.html#Internal">Internal</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#f">f</a></span>)&gt;&gt;.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2771')">Proof.</div>
<div class="proofscript" id="proof2771">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span> <span class="kwd">in</span> <span class="id">H1</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.GENV_COMPAT">GENV_COMPAT</a></span> <span class="kwd">in</span> <span class="id">H1</span>. <span class="tactic">destruct</span> <span class="id">H1</span> <span class="kwd">as</span> (<span class="id">b</span> &amp; <span class="id">A</span> &amp; <span class="id">B</span>).<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.RTL.html#fundef">fundef</a></span> <span class="kwd">in</span> *. <span class="tactic">rewrite</span> <span class="id">A</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">clarify</span>. <span class="id">ss</span>. <span class="id">des_ifs</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_funct_ptr">Genv.find_funct_ptr</a></span>. <span class="id">des_ifs</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="functions_injected">functions_injected</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">j</span> <span class="id">v</span> <span class="id">tv</span> <span class="id">f</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SRC</span>: <span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_funct">Genv.find_funct</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.ge">ge</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#v">v</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#f">f</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">INJ</span>: <span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#v">v</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#tv">tv</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">MATCH</span>: <span class="id">exists</span> <span class="id">bound</span>, <span class="id"><a href="compcert.backend.Inliningproof.html#match_globalenvs">match_globalenvs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#bound">bound</a></span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">cunit</span> <span class="id">tf</span>, &lt;&lt;<span class="id">TGT</span>: <span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_funct">Genv.find_funct</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.tge">tge</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#tv">tv</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#tf">tf</a></span>&gt;&gt; /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;<span class="id">TRANSF</span>: <span class="id"><a href="compcert.backend.Inlining.html#transf_fundef">transf_fundef</a></span> (<span class="id"><a href="compcert.backend.Inlining.html#funenv_program">funenv_program</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#cunit">cunit</a></span>) <span class="id"><a href="compcert.backend.Inliningproof.html#f">f</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#tf">tf</a></span>&gt;&gt; /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;<span class="id">LINK</span>: <span class="id"><a href="compcert.common.Linking.html#linkorder">linkorder</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#cunit">cunit</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.prog">prog</a></span>&gt;&gt;.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2772')">Proof.</div>
<div class="proofscript" id="proof2772">
&nbsp;&nbsp;<span class="id">des</span>. <span class="id">inv</span> <span class="id">MATCH</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_funct">Genv.find_funct</a></span> <span class="kwd">in</span> *. <span class="id">des_ifs_safe</span>. <span class="id">inv</span> <span class="id">INJ</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">FUNCTIONS</span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">BD</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">DOMAIN</span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">des</span>. <span class="id">clarify</span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Inliningproof.html#functions_translated">functions_translated</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;{ <span class="tactic">rewrite</span> <span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_funct_find_funct_ptr">Genv.find_funct_find_funct_ptr</a></span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Translation of builtin arguments. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="tr_builtin_arg">tr_builtin_arg</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">F</span> <span class="id">bound</span> <span class="id">ctx</span> <span class="id">rs</span> <span class="id">rs</span>' <span class="id">sp</span> <span class="id">sp</span>' <span class="id">m</span> <span class="id">m</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_globalenvs">match_globalenvs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#bound">bound</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rs">rs</a></span> <span class="id">rs</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id">sp</span>', <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span>)) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Memory.html#Mem.inject">Mem.inject</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">a</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Events.html#eval_builtin_arg">eval_builtin_arg</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.ge">ge</a></span> (<span class="kwd">fun</span> <span class="id">r</span> =&gt; <span class="id"><a href="compcert.backend.Inliningproof.html#rs">rs</a></span>#<span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span>) (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#a">a</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#v">v</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v</span>', <span class="id"><a href="compcert.common.Events.html#eval_builtin_arg">eval_builtin_arg</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.tge">tge</a></span> (<span class="kwd">fun</span> <span class="id">r</span> =&gt; <span class="id">rs</span>'#<span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span>) (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">sp</span>' <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id">m</span>' (<span class="id"><a href="compcert.backend.Inlining.html#sbuiltinarg">sbuiltinarg</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#a">a</a></span>) <span class="id">v</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#v">v</a></span> <span class="id">v</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2773')">Proof.</div>
<div class="proofscript" id="proof2773">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> <span class="id">m</span>'; <span class="tactic">intros</span> <span class="id">MG</span> <span class="id">AG</span> <span class="id">SP</span> <span class="id">MI</span>. <span class="tactic">induction</span> 1; <span class="tactic">simpl</span>.<br/>
- <span class="id">exists</span> <span class="id">rs</span>'#(<span class="id"><a href="compcert.backend.Inlining.html#sreg">sreg</a></span> <span class="id">ctx</span> <span class="id">x</span>); <span class="tactic">split</span>. <span class="id">constructor</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_val_reg">agree_val_reg</a></span>; <span class="tactic">eauto</span>.<br/>
- <span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">barg</span>.<br/>
- <span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">barg</span>.<br/>
- <span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">barg</span>.<br/>
- <span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">barg</span>.<br/>
- <span class="id">exploit</span> <span class="id"><a href="compcert.common.Memory.html#Mem.loadv_inject">Mem.loadv_inject</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">instantiate</span> (1 := <span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">sp</span>' (<span class="id"><a href="compcert.lib.Integers.html#Ptrofs.add">Ptrofs.add</a></span> <span class="id">ofs</span> (<span class="id"><a href="compcert.lib.Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> (<span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span> <span class="id">ctx</span>)))).<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.add_zero_l">Ptrofs.add_zero_l</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">v</span>' &amp; <span class="id">A</span> &amp; <span class="id">B</span>). <span class="id">exists</span> <span class="id">v</span>'; <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="id">constructor</span>. <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.add_zero_l">Ptrofs.add_zero_l</a></span>; <span class="tactic">auto</span>.<br/>
- <span class="id">econstructor</span>; <span class="tactic">split</span>. <span class="id">constructor</span>. <span class="tactic">simpl</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> ! <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.add_zero_l">Ptrofs.add_zero_l</a></span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">assert</span> (<span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id">F</span> (<span class="id"><a href="compcert.common.Globalenvs.html#Senv.symbol_address">Senv.symbol_address</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.ge">ge</a></span> <span class="id">id</span> <span class="id">ofs</span>) (<span class="id"><a href="compcert.common.Globalenvs.html#Senv.symbol_address">Senv.symbol_address</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.tge">tge</a></span> <span class="id">id</span> <span class="id">ofs</span>)).<br/>
&nbsp;&nbsp;{ <span class="tactic">unfold</span> <span class="id"><a href="compcert.common.Globalenvs.html#Senv.symbol_address">Senv.symbol_address</a></span>; <span class="tactic">simpl</span>; <span class="tactic">unfold</span> <span class="id"><a href="compcert.common.Globalenvs.html#Genv.symbol_address">Genv.symbol_address</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Inliningproof.html#symbols_preserved">symbols_preserved</a></span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_symbol">Genv.find_symbol</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.ge">ge</a></span> <span class="id">id</span>) <span class="kwd">as</span> [<span class="id">b</span>|] <span class="id">eqn</span>:<span class="id">FS</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">MG</span>. <span class="id">econstructor</span>. <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.add_zero">Ptrofs.add_zero</a></span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Memory.html#Mem.loadv_inject">Mem.loadv_inject</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">v</span>' &amp; <span class="id">A</span> &amp; <span class="id">B</span>).<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v</span>'; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">barg</span>.<br/>
- <span class="id">econstructor</span>; <span class="tactic">split</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.common.Globalenvs.html#Senv.symbol_address">Senv.symbol_address</a></span>; <span class="tactic">simpl</span>; <span class="tactic">unfold</span> <span class="id"><a href="compcert.common.Globalenvs.html#Genv.symbol_address">Genv.symbol_address</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Inliningproof.html#symbols_preserved">symbols_preserved</a></span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_symbol">Genv.find_symbol</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.ge">ge</a></span> <span class="id">id</span>) <span class="kwd">as</span> [<span class="id">b</span>|] <span class="id">eqn</span>:<span class="id">FS</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">MG</span>. <span class="id">econstructor</span>. <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.add_zero">Ptrofs.add_zero</a></span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">destruct</span> <span class="id">IHeval_builtin_arg1</span> <span class="kwd">as</span> (<span class="id">v1</span>' &amp; <span class="id">A1</span> &amp; <span class="id">B1</span>).<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">IHeval_builtin_arg2</span> <span class="kwd">as</span> (<span class="id">v2</span>' &amp; <span class="id">A2</span> &amp; <span class="id">B2</span>).<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>. <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">barg</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Values.html#Val.longofwords_inject">Val.longofwords_inject</a></span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">destruct</span> <span class="id">IHeval_builtin_arg1</span> <span class="kwd">as</span> (<span class="id">v1</span>' &amp; <span class="id">A1</span> &amp; <span class="id">B1</span>).<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">IHeval_builtin_arg2</span> <span class="kwd">as</span> (<span class="id">v2</span>' &amp; <span class="id">A2</span> &amp; <span class="id">B2</span>).<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>. <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">barg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="compcert.x86_64.Archi.html#ptr64">Archi.ptr64</a></span>; <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="compcert.common.Values.html#Val.add_inject">Val.add_inject</a></span>, <span class="id"><a href="compcert.common.Values.html#Val.addl_inject">Val.addl_inject</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="tr_builtin_args">tr_builtin_args</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">F</span> <span class="id">bound</span> <span class="id">ctx</span> <span class="id">rs</span> <span class="id">rs</span>' <span class="id">sp</span> <span class="id">sp</span>' <span class="id">m</span> <span class="id">m</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_globalenvs">match_globalenvs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#bound">bound</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rs">rs</a></span> <span class="id">rs</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id">sp</span>', <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span>)) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Memory.html#Mem.inject">Mem.inject</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">al</span> <span class="id">vl</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Events.html#eval_builtin_args">eval_builtin_args</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.ge">ge</a></span> (<span class="kwd">fun</span> <span class="id">r</span> =&gt; <span class="id"><a href="compcert.backend.Inliningproof.html#rs">rs</a></span>#<span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span>) (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#al">al</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#vl">vl</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">vl</span>', <span class="id"><a href="compcert.common.Events.html#eval_builtin_args">eval_builtin_args</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.tge">tge</a></span> (<span class="kwd">fun</span> <span class="id">r</span> =&gt; <span class="id">rs</span>'#<span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span>) (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">sp</span>' <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id">m</span>' (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="id"><a href="compcert.backend.Inlining.html#sbuiltinarg">sbuiltinarg</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>) <span class="id"><a href="compcert.backend.Inliningproof.html#al">al</a></span>) <span class="id">vl</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="compcert.common.Values.html#Val.inject_list">Val.inject_list</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#vl">vl</a></span> <span class="id">vl</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2774')">Proof.</div>
<div class="proofscript" id="proof2774">
&nbsp;&nbsp;<span class="tactic">induction</span> 5; <span class="tactic">simpl</span>.<br/>
- <span class="id">exists</span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id"><a href="compcert.common.Values.html#val">val</a></span>); <span class="tactic">split</span>; <span class="id">constructor</span>.<br/>
- <span class="id">exploit</span> <span class="id"><a href="compcert.backend.Inliningproof.html#tr_builtin_arg">tr_builtin_arg</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">v1</span>' &amp; <span class="id">A</span> &amp; <span class="id">B</span>).<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">IHlist_forall2</span> <span class="kwd">as</span> (<span class="id">vl</span>' &amp; <span class="id">C</span> &amp; <span class="id">D</span>).<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id">v1</span>' :: <span class="id">vl</span>'); <span class="tactic">split</span>; <span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<h2> Relating stacks </h2>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="match_stacks">match_stacks</a></span> (<span class="id">F</span>: <span class="id"><a href="compcert.common.Values.html#meminj">meminj</a></span>) (<span class="id">m</span> <span class="id">m</span>': <span class="id"><a href="compcert.common.Memory.html#mem">mem</a></span>) (<span class="id">sm0</span>: <span class="id">SimMemInj.t</span>') :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.backend.RTL.html#stackframe">stackframe</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.backend.RTL.html#stackframe">stackframe</a></span> -&gt; <span class="id"><a href="compcert.common.Values.html#block">block</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="match_stacks_nil">match_stacks_nil</a></span>: <span class="kwd">forall</span> <span class="id">bound1</span> <span class="id">bound</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SYMBINJ</span>: <span class="id"><a href="compcert.common.Events.html#symbols_inject">symbols_inject</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.se">se</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.tse">tse</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">HI</span>: <span class="id"><a href="compcert.backend.Inliningproof.html#bound1">bound1</a></span> = <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.ge">ge</a></span>.(<span class="id"><a href="compcert.common.Globalenvs.html#Genv.genv_next">Genv.genv_next</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">MG</span>: <span class="id"><a href="compcert.backend.Inliningproof.html#match_globalenvs">match_globalenvs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#bound1">bound1</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">BELOW</span>: <span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#bound1">bound1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#bound">bound</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#bound">bound</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="match_stacks_cons">match_stacks_cons</a></span>: <span class="kwd">forall</span> <span class="id">res</span> <span class="id">f</span> <span class="id">sp</span> <span class="id">pc</span> <span class="id">rs</span> <span class="id">stk</span> <span class="id">f</span>' <span class="id">sp</span>' <span class="id">rs</span>' <span class="id">stk</span>' <span class="id">bound</span> <span class="id">fenv</span> <span class="id">ctx</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">MS</span>: <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside">match_stacks_inside</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id">sp</span>' <span class="id">rs</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">DISJ</span>: <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span>.(<span class="id"><a href="compcert.common.SimMemInj.html#tgt_external">SimMemInj.tgt_external</a></span>) /2\ (<span class="kwd">fun</span> <span class="id">blk</span> <span class="id">_</span> =&gt; <span class="id">sp</span>' = <span class="id"><a href="compcert.backend.Inliningproof.html#blk">blk</a></span>)  &lt;2= <span class="id">bot2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">COMPAT</span>: <span class="id"><a href="compcert.backend.Inliningspec.html#fenv_compat">fenv_compat</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.prog">prog</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#fenv">fenv</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FB</span>: <span class="id"><a href="compcert.backend.Inliningspec.html#tr_funbody">tr_funbody</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#fenv">fenv</a></span> <span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span>) <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#f">f</a></span> <span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_code">fn_code</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">AG</span>: <span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rs">rs</a></span> <span class="id">rs</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SP</span>: <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id">sp</span>', <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">PRIV</span>: <span class="id"><a href="compcert.backend.Inliningproof.html#range_private">range_private</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id">sp</span>' (<span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span>) + <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#mstk">mstk</a></span>)) <span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SSZ1</span>: 0 &lt;= <span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span>) &lt; <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.max_unsigned">Ptrofs.max_unsigned</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SSZ2</span>: <span class="kwd">forall</span> <span class="id">ofs</span>, <span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id">m</span>' <span class="id">sp</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.common.Memtype.html#Max">Max</a></span> <span class="id"><a href="compcert.common.Memtype.html#Nonempty">Nonempty</a></span> -&gt; 0 &lt;= <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> &lt;= <span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">RES</span>: <span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#res">res</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#mreg">mreg</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">BELOW</span>: <span class="id"><a href="compcert.lib.Coqlib.html#Plt">Plt</a></span> <span class="id">sp</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#bound">bound</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.RTL.html#Stackframe">Stackframe</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#res">res</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#f">f</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="compcert.backend.Inliningproof.html#pc">pc</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rs">rs</a></span> :: <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.RTL.html#Stackframe">Stackframe</a></span> (<span class="id"><a href="compcert.backend.Inlining.html#sreg">sreg</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#res">res</a></span>) <span class="id">f</span>' (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">sp</span>' <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) (<span class="id"><a href="compcert.backend.Inlining.html#spc">spc</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#pc">pc</a></span>) <span class="id">rs</span>' :: <span class="id">stk</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#bound">bound</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="match_stacks_untailcall">match_stacks_untailcall</a></span>: <span class="kwd">forall</span> <span class="id">stk</span> <span class="id">res</span> <span class="id">f</span>' <span class="id">sp</span>' <span class="id">rpc</span> <span class="id">rs</span>' <span class="id">stk</span>' <span class="id">bound</span> <span class="id">ctx</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">MS</span>: <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside">match_stacks_inside</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id">sp</span>' <span class="id">rs</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">DISJ</span>: <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span>.(<span class="id"><a href="compcert.common.SimMemInj.html#tgt_external">SimMemInj.tgt_external</a></span>) /2\ (<span class="kwd">fun</span> <span class="id">blk</span> <span class="id">_</span> =&gt; <span class="id">sp</span>' = <span class="id"><a href="compcert.backend.Inliningproof.html#blk">blk</a></span>)  &lt;2= <span class="id">bot2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">PRIV</span>: <span class="id"><a href="compcert.backend.Inliningproof.html#range_private">range_private</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id">sp</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span>) <span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SSZ1</span>: 0 &lt;= <span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span>) &lt; <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.max_unsigned">Ptrofs.max_unsigned</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SSZ2</span>: <span class="kwd">forall</span> <span class="id">ofs</span>, <span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id">m</span>' <span class="id">sp</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.common.Memtype.html#Max">Max</a></span> <span class="id"><a href="compcert.common.Memtype.html#Nonempty">Nonempty</a></span> -&gt; 0 &lt;= <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> &lt;= <span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">RET</span>: <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#retinfo">retinfo</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="compcert.backend.Inliningproof.html#rpc">rpc</a></span>, <span class="id"><a href="compcert.backend.Inliningproof.html#res">res</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">BELOW</span>: <span class="id"><a href="compcert.lib.Coqlib.html#Plt">Plt</a></span> <span class="id">sp</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#bound">bound</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.RTL.html#Stackframe">Stackframe</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#res">res</a></span> <span class="id">f</span>' (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">sp</span>' <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="compcert.backend.Inliningproof.html#rpc">rpc</a></span> <span class="id">rs</span>' :: <span class="id">stk</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#bound">bound</a></span><br/>
<br/>
<span class="kwd">with</span> <span class="id"><a name="match_stacks_inside">match_stacks_inside</a></span> (<span class="id">F</span>: <span class="id">meminj</span>) (<span class="id">m</span> <span class="id">m</span>': <span class="id">mem</span>) (<span class="id">sm0</span>: <span class="id">SimMemInj.t</span>') :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.backend.RTL.html#stackframe">stackframe</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.backend.RTL.html#stackframe">stackframe</a></span> -&gt; <span class="id"><a href="compcert.backend.RTL.html#function">function</a></span> -&gt; <span class="id"><a href="compcert.backend.Inlining.html#context">context</a></span> -&gt; <span class="id"><a href="compcert.common.Values.html#block">block</a></span> -&gt; <span class="id"><a href="compcert.backend.RTL.html#regset">regset</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="match_stacks_inside_base">match_stacks_inside_base</a></span>: <span class="kwd">forall</span> <span class="id">stk</span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id">ctx</span> <span class="id">sp</span>' <span class="id">rs</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">MS</span>: <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id">sp</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">DISJ</span>: <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span>.(<span class="id"><a href="compcert.common.SimMemInj.html#tgt_external">SimMemInj.tgt_external</a></span>) /2\ (<span class="kwd">fun</span> <span class="id">blk</span> <span class="id">_</span> =&gt; <span class="id">sp</span>' = <span class="id"><a href="compcert.backend.Inliningproof.html#blk">blk</a></span>)  &lt;2= <span class="id">bot2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">BB</span>: (<span class="id"><a href="compcert.common.SimMemInj.html#tgt_parent_nb">SimMemInj.tgt_parent_nb</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span> &lt;= <span class="id">sp</span>')%<span class="id">positive</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">RET</span>: <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#retinfo">retinfo</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">DSTK</span>: <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span>) = 0),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside">match_stacks_inside</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id">sp</span>' <span class="id">rs</span>'<br/>
&nbsp;&nbsp;| <span class="id"><a name="match_stacks_inside_inlined">match_stacks_inside_inlined</a></span>: <span class="kwd">forall</span> <span class="id">res</span> <span class="id">f</span> <span class="id">sp</span> <span class="id">pc</span> <span class="id">rs</span> <span class="id">stk</span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id">fenv</span> <span class="id">ctx</span> <span class="id">sp</span>' <span class="id">rs</span>' <span class="id">ctx</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">MS</span>: <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside">match_stacks_inside</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id">ctx</span>' <span class="id">sp</span>' <span class="id">rs</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">DISJ</span>: <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span>.(<span class="id"><a href="compcert.common.SimMemInj.html#tgt_external">SimMemInj.tgt_external</a></span>) /2\ (<span class="kwd">fun</span> <span class="id">blk</span> <span class="id">_</span> =&gt; <span class="id">sp</span>' = <span class="id"><a href="compcert.backend.Inliningproof.html#blk">blk</a></span>)  &lt;2= <span class="id">bot2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">BB</span>: (<span class="id"><a href="compcert.common.SimMemInj.html#tgt_parent_nb">SimMemInj.tgt_parent_nb</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span> &lt;= <span class="id">sp</span>')%<span class="id">positive</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">COMPAT</span>: <span class="id"><a href="compcert.backend.Inliningspec.html#fenv_compat">fenv_compat</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.prog">prog</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#fenv">fenv</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FB</span>: <span class="id"><a href="compcert.backend.Inliningspec.html#tr_funbody">tr_funbody</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#fenv">fenv</a></span> <span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span>) <span class="id">ctx</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#f">f</a></span> <span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_code">fn_code</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">AG</span>: <span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id">ctx</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#rs">rs</a></span> <span class="id">rs</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SP</span>: <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id">sp</span>', <span class="id">ctx</span>'.(<span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">PAD</span>: <span class="id"><a href="compcert.backend.Inliningproof.html#range_private">range_private</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id">sp</span>' (<span class="id">ctx</span>'.(<span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span>) + <span class="id">ctx</span>'.(<span class="id"><a href="compcert.backend.Inlining.html#mstk">mstk</a></span>)) <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">RES</span>: <span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#res">res</a></span> <span class="id">ctx</span>'.(<span class="id"><a href="compcert.backend.Inlining.html#mreg">mreg</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">RET</span>: <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#retinfo">retinfo</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="compcert.backend.Inlining.html#spc">spc</a></span> <span class="id">ctx</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#pc">pc</a></span>, <span class="id"><a href="compcert.backend.Inlining.html#sreg">sreg</a></span> <span class="id">ctx</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#res">res</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">BELOW</span>: <span class="id"><a href="compcert.backend.Inliningspec.html#context_below">context_below</a></span> <span class="id">ctx</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SBELOW</span>: <span class="id"><a href="compcert.backend.Inliningspec.html#context_stack_call">context_stack_call</a></span> <span class="id">ctx</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside">match_stacks_inside</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span> (<span class="id"><a href="compcert.backend.RTL.html#Stackframe">Stackframe</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#res">res</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#f">f</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="compcert.backend.Inliningproof.html#pc">pc</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rs">rs</a></span> :: <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">stk</span>' <span class="id">f</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id">sp</span>' <span class="id">rs</span>'.<br/>
<br/>
<div class="doc">Properties of match_stacks </div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="INLINING.CORELEMMA.MATCH_STACKS">MATCH_STACKS</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="INLINING.CORELEMMA.MATCH_STACKS.F">F</a></span>: <span class="id"><a href="compcert.common.Values.html#meminj">meminj</a></span>.<br/>
<span class="kwd">Variables</span> <span class="id"><a name="INLINING.CORELEMMA.MATCH_STACKS.m">m</a></span> <span class="id">m</span>': <span class="id"><a href="compcert.common.Memory.html#mem">mem</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="match_stacks_symbols_inject">match_stacks_symbols_inject</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">stk</span> <span class="id">stk</span>' <span class="id">bound</span> <span class="id">sm0</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.MATCH_STACKS.F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.MATCH_STACKS.m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#bound">bound</a></span> -&gt; <span class="id"><a href="compcert.common.Events.html#symbols_inject">symbols_inject</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.MATCH_STACKS.F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.se">se</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.tse">tse</a></span><br/>
<span class="kwd">with</span> <span class="id"><a name="match_stacks_inside_symbols_inject">match_stacks_inside_symbols_inject</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">stk</span> <span class="id">stk</span>' <span class="id">f</span> <span class="id">ctx</span> <span class="id">sp</span> <span class="id">rs</span>' <span class="id">sm0</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside">match_stacks_inside</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.MATCH_STACKS.F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.MATCH_STACKS.m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#f">f</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span> <span class="id">rs</span>' -&gt; <span class="id"><a href="compcert.common.Events.html#symbols_inject">symbols_inject</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.MATCH_STACKS.F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.se">se</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.tse">tse</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2775')">Proof.</div>
<div class="proofscript" id="proof2775">
 <span class="tactic">induction</span> 1; <span class="tactic">eauto</span>. <span class="tactic">induction</span> 1; <span class="tactic">eauto</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="match_stacks_globalenvs">match_stacks_globalenvs</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">stk</span> <span class="id">stk</span>' <span class="id">bound</span> <span class="id">sm0</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.MATCH_STACKS.F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.MATCH_STACKS.m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#bound">bound</a></span> -&gt; <span class="id">exists</span> <span class="id">b</span>, <span class="id"><a href="compcert.backend.Inliningproof.html#match_globalenvs">match_globalenvs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.MATCH_STACKS.F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span><br/>
<span class="kwd">with</span> <span class="id"><a name="match_stacks_inside_globalenvs">match_stacks_inside_globalenvs</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">stk</span> <span class="id">stk</span>' <span class="id">f</span> <span class="id">ctx</span> <span class="id">sp</span> <span class="id">rs</span>' <span class="id">sm0</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside">match_stacks_inside</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.MATCH_STACKS.F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.MATCH_STACKS.m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#f">f</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span> <span class="id">rs</span>' -&gt; <span class="id">exists</span> <span class="id">b</span>, <span class="id"><a href="compcert.backend.Inliningproof.html#match_globalenvs">match_globalenvs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.MATCH_STACKS.F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2776')">Proof.</div>
<div class="proofscript" id="proof2776">
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="match_globalenvs_preserves_globals">match_globalenvs_preserves_globals</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span>, <span class="id"><a href="compcert.backend.Inliningproof.html#match_globalenvs">match_globalenvs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.MATCH_STACKS.F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> -&gt; <span class="id"><a href="compcert.common.Events.html#meminj_preserves_globals">meminj_preserves_globals</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.ge">ge</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.MATCH_STACKS.F">F</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2777')">Proof.</div>
<div class="proofscript" id="proof2777">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="tactic">red</span>. <span class="tactic">split</span>. <span class="tactic">eauto</span>. <span class="tactic">split</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">symmetry</span>. <span class="tactic">eapply</span> <span class="id">IMAGE</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="match_stacks_inside_globals">match_stacks_inside_globals</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">stk</span> <span class="id">stk</span>' <span class="id">f</span> <span class="id">ctx</span> <span class="id">sp</span> <span class="id">rs</span>' <span class="id">sm0</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside">match_stacks_inside</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.MATCH_STACKS.F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.MATCH_STACKS.m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#f">f</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span> <span class="id">rs</span>' -&gt; <span class="id"><a href="compcert.common.Events.html#meminj_preserves_globals">meminj_preserves_globals</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.ge">ge</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.MATCH_STACKS.F">F</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2778')">Proof.</div>
<div class="proofscript" id="proof2778">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_globalenvs">match_stacks_inside_globalenvs</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">b</span> <span class="id">A</span>].<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_globalenvs_preserves_globals">match_globalenvs_preserves_globals</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="match_stacks_bound">match_stacks_bound</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">stk</span> <span class="id">stk</span>' <span class="id">bound</span> <span class="id">bound1</span> <span class="id">sm0</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.MATCH_STACKS.F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.MATCH_STACKS.m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#bound">bound</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#bound">bound</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#bound1">bound1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.MATCH_STACKS.F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.MATCH_STACKS.m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#bound1">bound1</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2779')">Proof.</div>
<div class="proofscript" id="proof2779">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_nil">match_stacks_nil</a></span> <span class="kwd">with</span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.ge">ge</a></span>.(<span class="id"><a href="compcert.common.Globalenvs.html#Genv.genv_next">Genv.genv_next</a></span>); <span class="tactic">auto</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.lib.Coqlib.html#Ple_trans">Ple_trans</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_cons">match_stacks_cons</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.lt_le_trans">Pos.lt_le_trans</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_untailcall">match_stacks_untailcall</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.lt_le_trans">Pos.lt_le_trans</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="INLINING.CORELEMMA.MATCH_STACKS.F1">F1</a></span>: <span class="id"><a href="compcert.common.Values.html#meminj">meminj</a></span>.<br/>
<span class="kwd">Variables</span> <span class="id"><a name="INLINING.CORELEMMA.MATCH_STACKS.m1">m1</a></span> <span class="id">m1</span>': <span class="id"><a href="compcert.common.Memory.html#mem">mem</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="INLINING.CORELEMMA.MATCH_STACKS.INCR">INCR</a></span>: <span class="id"><a href="compcert.common.Values.html#inject_incr">inject_incr</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.MATCH_STACKS.F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.MATCH_STACKS.F1">F1</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="match_stacks_invariant">match_stacks_invariant</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">stk</span> <span class="id">stk</span>' <span class="id">bound</span> <span class="id">sm0</span>, <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.MATCH_STACKS.F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.MATCH_STACKS.m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#bound">bound</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">INJ</span>: <span class="kwd">forall</span> <span class="id">b1</span> <span class="id">b2</span> <span class="id">delta</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.MATCH_STACKS.F1">F1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b1">b1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="compcert.backend.Inliningproof.html#b2">b2</a></span>, <span class="id"><a href="compcert.backend.Inliningproof.html#delta">delta</a></span>) -&gt; <span class="id"><a href="compcert.lib.Coqlib.html#Plt">Plt</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b2">b2</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#bound">bound</a></span> -&gt; <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.MATCH_STACKS.F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b1">b1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="compcert.backend.Inliningproof.html#b2">b2</a></span>, <span class="id"><a href="compcert.backend.Inliningproof.html#delta">delta</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">PERM1</span>: <span class="kwd">forall</span> <span class="id">b1</span> <span class="id">b2</span> <span class="id">delta</span> <span class="id">ofs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.MATCH_STACKS.F1">F1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b1">b1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="compcert.backend.Inliningproof.html#b2">b2</a></span>, <span class="id"><a href="compcert.backend.Inliningproof.html#delta">delta</a></span>) -&gt; <span class="id"><a href="compcert.lib.Coqlib.html#Plt">Plt</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b2">b2</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#bound">bound</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.MATCH_STACKS.m1">m1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b1">b1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.common.Memtype.html#Max">Max</a></span> <span class="id"><a href="compcert.common.Memtype.html#Nonempty">Nonempty</a></span> -&gt; <span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.MATCH_STACKS.m">m</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b1">b1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.common.Memtype.html#Max">Max</a></span> <span class="id"><a href="compcert.common.Memtype.html#Nonempty">Nonempty</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">PERM2</span>: <span class="kwd">forall</span> <span class="id">b</span> <span class="id">ofs</span>, <span class="id"><a href="compcert.lib.Coqlib.html#Plt">Plt</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#bound">bound</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.common.Memtype.html#Cur">Cur</a></span> <span class="id"><a href="compcert.common.Memtype.html#Freeable">Freeable</a></span> -&gt; <span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id">m1</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.common.Memtype.html#Cur">Cur</a></span> <span class="id"><a href="compcert.common.Memtype.html#Freeable">Freeable</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">PERM3</span>: <span class="kwd">forall</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">k</span> <span class="id">p</span>, <span class="id"><a href="compcert.lib.Coqlib.html#Plt">Plt</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#bound">bound</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id">m1</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#k">k</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#p">p</a></span> -&gt; <span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#k">k</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#p">p</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.MATCH_STACKS.F1">F1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.MATCH_STACKS.m1">m1</a></span> <span class="id">m1</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#bound">bound</a></span><br/>
<br/>
<span class="kwd">with</span> <span class="id"><a name="match_stacks_inside_invariant">match_stacks_inside_invariant</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">stk</span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id">ctx</span> <span class="id">sp</span>' <span class="id">rs1</span> <span class="id">sm0</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside">match_stacks_inside</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.MATCH_STACKS.F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.MATCH_STACKS.m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id">sp</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#rs1">rs1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">rs2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">RS</span>: <span class="kwd">forall</span> <span class="id">r</span>, <span class="id"><a href="compcert.lib.Coqlib.html#Plt">Plt</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dreg">dreg</a></span>) -&gt; <span class="id"><a href="compcert.backend.Inliningproof.html#rs2">rs2</a></span>#<span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span> = <span class="id"><a href="compcert.backend.Inliningproof.html#rs1">rs1</a></span>#<span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">INJ</span>: <span class="kwd">forall</span> <span class="id">b1</span> <span class="id">b2</span> <span class="id">delta</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.MATCH_STACKS.F1">F1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b1">b1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="compcert.backend.Inliningproof.html#b2">b2</a></span>, <span class="id"><a href="compcert.backend.Inliningproof.html#delta">delta</a></span>) -&gt; <span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b2">b2</a></span> <span class="id">sp</span>' -&gt; <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.MATCH_STACKS.F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b1">b1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="compcert.backend.Inliningproof.html#b2">b2</a></span>, <span class="id"><a href="compcert.backend.Inliningproof.html#delta">delta</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">PERM1</span>: <span class="kwd">forall</span> <span class="id">b1</span> <span class="id">b2</span> <span class="id">delta</span> <span class="id">ofs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.MATCH_STACKS.F1">F1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b1">b1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="compcert.backend.Inliningproof.html#b2">b2</a></span>, <span class="id"><a href="compcert.backend.Inliningproof.html#delta">delta</a></span>) -&gt; <span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b2">b2</a></span> <span class="id">sp</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.MATCH_STACKS.m1">m1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b1">b1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.common.Memtype.html#Max">Max</a></span> <span class="id"><a href="compcert.common.Memtype.html#Nonempty">Nonempty</a></span> -&gt; <span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.MATCH_STACKS.m">m</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b1">b1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.common.Memtype.html#Max">Max</a></span> <span class="id"><a href="compcert.common.Memtype.html#Nonempty">Nonempty</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">PERM2</span>: <span class="kwd">forall</span> <span class="id">b</span> <span class="id">ofs</span>, <span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> <span class="id">sp</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.common.Memtype.html#Cur">Cur</a></span> <span class="id"><a href="compcert.common.Memtype.html#Freeable">Freeable</a></span> -&gt; <span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id">m1</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.common.Memtype.html#Cur">Cur</a></span> <span class="id"><a href="compcert.common.Memtype.html#Freeable">Freeable</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">PERM3</span>: <span class="kwd">forall</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">k</span> <span class="id">p</span>, <span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> <span class="id">sp</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id">m1</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#k">k</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#p">p</a></span> -&gt; <span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#k">k</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#p">p</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside">match_stacks_inside</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.MATCH_STACKS.F1">F1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.MATCH_STACKS.m1">m1</a></span> <span class="id">m1</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id">sp</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#rs2">rs2</a></span>.<br/>
<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2780')">Proof.</div>
<div class="proofscript" id="proof2780">
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;nil&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_nil">match_stacks_nil</a></span> <span class="kwd">with</span> (<span class="id">bound1</span> := <span class="id">bound1</span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Events.html#symbols_inject_incr">symbols_inject_incr</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">i</span>. <span class="id">inv</span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.SECOMPATSRC">SECOMPATSRC</a></span>. <span class="tactic">rewrite</span> <span class="id">NB</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">MG</span>. <span class="id">exploit</span> <span class="id">DOMAIN</span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.MATCH_STACKS.INCR">INCR</a></span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">i</span>. <span class="id">inv</span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.SECOMPATTGT">SECOMPATTGT</a></span>. <span class="tactic">rewrite</span> <span class="id">NB</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id">INJ</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.MATCH_GENV">MATCH_GENV</a></span>. <span class="tactic">rewrite</span> <span class="id">mge_next</span> <span class="kwd">in</span> *. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{ <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">MG</span>. <span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id">IMAGE</span> <span class="kwd">with</span> <span class="id">delta</span>. <span class="tactic">eapply</span> <span class="id">INJ</span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.lt_le_trans">Pos.lt_le_trans</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;cons&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_cons">match_stacks_cons</a></span> <span class="kwd">with</span> (<span class="id">fenv</span> := <span class="id">fenv</span>) (<span class="id">ctx</span> := <span class="id">ctx</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">match_stacks_inside_invariant</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">eapply</span> <span class="id">INJ</span>; <span class="tactic">eauto</span>; <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">eapply</span> <span class="id">PERM1</span>; <span class="tactic">eauto</span>; <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">eapply</span> <span class="id">PERM2</span>; <span class="tactic">eauto</span>; <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">eapply</span> <span class="id">PERM3</span>; <span class="tactic">eauto</span>; <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs_incr">agree_regs_incr</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#range_private_invariant">range_private_invariant</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;untailcall&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_untailcall">match_stacks_untailcall</a></span> <span class="kwd">with</span> (<span class="id">ctx</span> := <span class="id">ctx</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">match_stacks_inside_invariant</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">eapply</span> <span class="id">INJ</span>; <span class="tactic">eauto</span>; <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">eapply</span> <span class="id">PERM1</span>; <span class="tactic">eauto</span>; <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">eapply</span> <span class="id">PERM2</span>; <span class="tactic">eauto</span>; <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">eapply</span> <span class="id">PERM3</span>; <span class="tactic">eauto</span>; <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#range_private_invariant">range_private_invariant</a></span>; <span class="tactic">eauto</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;base&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_base">match_stacks_inside_base</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">match_stacks_invariant</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">eapply</span> <span class="id">INJ</span>; <span class="tactic">eauto</span>; <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">eapply</span> <span class="id">PERM1</span>; <span class="tactic">eauto</span>; <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">eapply</span> <span class="id">PERM2</span>; <span class="tactic">eauto</span>; <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">eapply</span> <span class="id">PERM3</span>; <span class="tactic">eauto</span>; <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;inlined&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_inlined">match_stacks_inside_inlined</a></span> <span class="kwd">with</span> (<span class="id">fenv</span> := <span class="id">fenv</span>) (<span class="id">ctx</span>' := <span class="id">ctx</span>'); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHmatch_stacks_inside</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id">RS</span>. <span class="tactic">red</span> <span class="kwd">in</span> <span class="id">BELOW</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs_incr">agree_regs_incr</a></span> <span class="kwd">with</span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.MATCH_STACKS.F">F</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs_invariant">agree_regs_invariant</a></span> <span class="kwd">with</span> <span class="id">rs</span>'; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id">RS</span>. <span class="tactic">red</span> <span class="kwd">in</span> <span class="id">BELOW</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#range_private_invariant">range_private_invariant</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">split</span>. <span class="tactic">eapply</span> <span class="id">INJ</span>; <span class="tactic">eauto</span>. <span class="id">xomega</span>. <span class="tactic">eapply</span> <span class="id">PERM1</span>; <span class="tactic">eauto</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id">PERM2</span>; <span class="tactic">eauto</span>. <span class="id">xomega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="match_stacks_empty">match_stacks_empty</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">stk</span> <span class="id">stk</span>' <span class="id">bound</span> <span class="id">sm0</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.MATCH_STACKS.F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.MATCH_STACKS.m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#bound">bound</a></span> -&gt; <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> -&gt; <span class="id">stk</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span><br/>
<span class="kwd">with</span> <span class="id"><a name="match_stacks_inside_empty">match_stacks_inside_empty</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">stk</span> <span class="id">stk</span>' <span class="id">f</span> <span class="id">ctx</span> <span class="id">sp</span> <span class="id">rs</span> <span class="id">sm0</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside">match_stacks_inside</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.MATCH_STACKS.F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.MATCH_STACKS.m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#f">f</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rs">rs</a></span> -&gt; <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> -&gt; <span class="id">stk</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> /\ <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#retinfo">retinfo</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2781')">Proof.</div>
<div class="proofscript" id="proof2781">
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">match_stacks_inside_empty</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">A</span> <span class="id">B</span>]. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">eapply</span> <span class="id">match_stacks_empty</span>; <span class="tactic">eauto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">discriminate</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="match_stacks_le">match_stacks_le</a></span>: <span class="kwd">forall</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sm0</span> <span class="id">sm1</span> <span class="id">F</span> <span class="id">m</span> <span class="id">m</span>' <span class="id">stk</span> <span class="id">stk</span>' <span class="id">bound</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">MS</span>: <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#bound">bound</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">LE</span>: <span class="id">SimMemInj.le</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#sm1">sm1</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;<span class="id">MS</span>: <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sm1">sm1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#bound">bound</a></span>&gt;&gt;<br/>
<span class="kwd">with</span> <span class="id"><a name="match_stacks_inside_le">match_stacks_inside_le</a></span>: <span class="kwd">forall</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sm0</span> <span class="id">sm1</span> <span class="id">F</span> <span class="id">m</span> <span class="id">m</span>' <span class="id">stk</span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id">ctx</span> <span class="id">sp</span>' <span class="id">rs</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">MS</span>: <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside">match_stacks_inside</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id">sp</span>' <span class="id">rs</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">LE</span>: <span class="id">SimMemInj.le</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#sm1">sm1</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;<span class="id">MS</span>: <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside">match_stacks_inside</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sm1">sm1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id">sp</span>' <span class="id">rs</span>'&gt;&gt;.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2782')">Proof.</div>
<div class="proofscript" id="proof2782">
&nbsp;&nbsp;- <span class="tactic">induction</span> 1; <span class="id">ii</span>; <span class="id">ss</span>; <span class="id">econs</span>; <span class="tactic">eauto</span>; <span class="tactic">try</span> (<span class="tactic">eapply</span> <span class="id">match_stacks_inside_le</span>; <span class="tactic">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">all</span>: <span class="id">ii</span>; <span class="id">des</span>; <span class="tactic">eapply</span> <span class="id">DISJ</span>; <span class="tactic">eauto</span>; <span class="id">esplits</span>; <span class="tactic">eauto</span>; <span class="id">inv</span> <span class="id">LE</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">induction</span> 1; <span class="id">ii</span>; <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">econs</span>; <span class="tactic">eauto</span>; <span class="tactic">try</span> (<span class="tactic">eapply</span> <span class="id">match_stacks_le</span>; <span class="tactic">eauto</span>); <span class="id">inv</span> <span class="id">LE</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ii</span>; <span class="id">des</span>; <span class="tactic">eapply</span> <span class="id">DISJ</span>; <span class="tactic">eauto</span>; <span class="id">esplits</span>; <span class="tactic">eauto</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">econs</span> 2; <span class="tactic">eauto</span>; <span class="tactic">try</span> (<span class="tactic">eapply</span> <span class="id">match_stacks_inside_le</span>; <span class="tactic">eauto</span>); <span class="id">inv</span> <span class="id">LE</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ii</span>; <span class="id">des</span>; <span class="tactic">eapply</span> <span class="id">DISJ</span>; <span class="tactic">eauto</span>; <span class="id">esplits</span>; <span class="tactic">eauto</span>; <span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.MATCH_STACKS">MATCH_STACKS</a></span>.<br/>
<br/>
<div class="doc">Preservation by assignment to a register </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="match_stacks_inside_set_reg">match_stacks_inside_set_reg</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">F</span> <span class="id">m</span> <span class="id">m</span>' <span class="id">stk</span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id">ctx</span> <span class="id">sp</span>' <span class="id">rs</span>' <span class="id">r</span> <span class="id">v</span> <span class="id">sm0</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside">match_stacks_inside</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id">sp</span>' <span class="id">rs</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside">match_stacks_inside</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id">sp</span>' (<span class="id">rs</span>'#(<span class="id"><a href="compcert.backend.Inlining.html#sreg">sreg</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span>) &lt;- <span class="id"><a href="compcert.backend.Inliningproof.html#v">v</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2783')">Proof.</div>
<div class="proofscript" id="proof2783">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_invariant">match_stacks_inside_invariant</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Registers.html#Regmap.gso">Regmap.gso</a></span>. <span class="id">zify</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Inlining.html#sreg">sreg</a></span>; <span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Inliningspec.html#shiftpos_eq">shiftpos_eq</a></span>. <span class="id">xomega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="match_stacks_inside_set_res">match_stacks_inside_set_res</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">F</span> <span class="id">m</span> <span class="id">m</span>' <span class="id">stk</span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id">ctx</span> <span class="id">sp</span>' <span class="id">rs</span>' <span class="id">res</span> <span class="id">v</span> <span class="id">sm0</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside">match_stacks_inside</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id">sp</span>' <span class="id">rs</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside">match_stacks_inside</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id">sp</span>' (<span class="id"><a href="compcert.backend.Registers.html#regmap_setres">regmap_setres</a></span> (<span class="id"><a href="compcert.backend.Inlining.html#sbuiltinres">sbuiltinres</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#res">res</a></span>) <span class="id"><a href="compcert.backend.Inliningproof.html#v">v</a></span> <span class="id">rs</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2784')">Proof.</div>
<div class="proofscript" id="proof2784">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">res</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_set_reg">match_stacks_inside_set_reg</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Preservation by a memory store </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="match_stacks_inside_store">match_stacks_inside_store</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">F</span> <span class="id">m</span> <span class="id">m</span>' <span class="id">stk</span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id">ctx</span> <span class="id">sp</span>' <span class="id">rs</span>' <span class="id">chunk</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">v</span> <span class="id">m1</span> <span class="id">chunk</span>' <span class="id">b</span>' <span class="id">ofs</span>' <span class="id">v</span>' <span class="id">m1</span>' <span class="id">sm0</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside">match_stacks_inside</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id">sp</span>' <span class="id">rs</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Memory.html#Mem.store">Mem.store</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#chunk">chunk</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#v">v</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m1">m1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Memory.html#Mem.store">Mem.store</a></span> <span class="id">chunk</span>' <span class="id">m</span>' <span class="id">b</span>' <span class="id">ofs</span>' <span class="id">v</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m1</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside">match_stacks_inside</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m1">m1</a></span> <span class="id">m1</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id">sp</span>' <span class="id">rs</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2785')">Proof.</div>
<div class="proofscript" id="proof2785">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_invariant">match_stacks_inside_invariant</a></span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Preservation by an allocation </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="match_stacks_inside_alloc_left">match_stacks_inside_alloc_left</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">F</span> <span class="id">m</span> <span class="id">m</span>' <span class="id">stk</span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id">ctx</span> <span class="id">sp</span>' <span class="id">rs</span>' <span class="id">sm0</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside">match_stacks_inside</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id">sp</span>' <span class="id">rs</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">sz</span> <span class="id">m1</span> <span class="id">b</span> <span class="id">F1</span> <span class="id">delta</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Memory.html#Mem.alloc">Mem.alloc</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> 0 <span class="id"><a href="compcert.backend.Inliningproof.html#sz">sz</a></span> = (<span class="id"><a href="compcert.backend.Inliningproof.html#m1">m1</a></span>, <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Values.html#inject_incr">inject_incr</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F1">F1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#F1">F1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id">sp</span>', <span class="id"><a href="compcert.backend.Inliningproof.html#delta">delta</a></span>) -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">b1</span>, <span class="id"><a href="compcert.backend.Inliningproof.html#b1">b1</a></span> &lt;&gt; <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> -&gt; <span class="id"><a href="compcert.backend.Inliningproof.html#F1">F1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b1">b1</a></span> = <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b1">b1</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#delta">delta</a></span> &gt;= <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside">match_stacks_inside</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F1">F1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m1">m1</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id">sp</span>' <span class="id">rs</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2786')">Proof.</div>
<div class="proofscript" id="proof2786">
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;base&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_base">match_stacks_inside_base</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_invariant">match_stacks_invariant</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.Values.html#eq_block">eq_block</a></span> <span class="id">b1</span> <span class="id">b</span>).<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">b1</span>. <span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H4</span>; <span class="id">inv</span> <span class="id">H4</span>. <span class="id">eelim</span> <span class="id"><a href="compcert.lib.Coqlib.html#Plt_strict">Plt_strict</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">in</span> <span class="id">H4</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_alloc_inv">Mem.perm_alloc_inv</a></span>; <span class="tactic">eauto</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.Values.html#eq_block">eq_block</a></span> <span class="id">b1</span> <span class="id">b</span>); <span class="tactic">intros</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">b1</span>. <span class="tactic">rewrite</span> <span class="id">H1</span> <span class="kwd">in</span> <span class="id">H4</span>. <span class="id">inv</span> <span class="id">H4</span>. <span class="id">eelim</span> <span class="id"><a href="compcert.lib.Coqlib.html#Plt_strict">Plt_strict</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;inlined&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_inlined">match_stacks_inside_inlined</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">IHmatch_stacks_inside</span>; <span class="tactic">eauto</span>. <span class="tactic">destruct</span> <span class="id">SBELOW</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs_incr">agree_regs_incr</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#range_private_invariant">range_private_invariant</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_alloc_inv">Mem.perm_alloc_inv</a></span>; <span class="tactic">eauto</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.Values.html#eq_block">eq_block</a></span> <span class="id">b0</span> <span class="id">b</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">b0</span>. <span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">in</span> <span class="id">H5</span>; <span class="id">inv</span> <span class="id">H5</span>. <span class="tactic">elimtype</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span>; <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H3</span> <span class="kwd">in</span> <span class="id">H5</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Preservation by freeing </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="match_stacks_free_left">match_stacks_free_left</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">F</span> <span class="id">m</span> <span class="id">m</span>' <span class="id">stk</span> <span class="id">stk</span>' <span class="id">sp</span> <span class="id">b</span> <span class="id">lo</span> <span class="id">hi</span> <span class="id">m1</span> <span class="id">sm0</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Memory.html#Mem.free">Mem.free</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#lo">lo</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#hi">hi</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m1">m1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m1">m1</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2787')">Proof.</div>
<div class="proofscript" id="proof2787">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_invariant">match_stacks_invariant</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_free_3">Mem.perm_free_3</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="match_stacks_free_right">match_stacks_free_right</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">F</span> <span class="id">m</span> <span class="id">m</span>' <span class="id">stk</span> <span class="id">stk</span>' <span class="id">sp</span> <span class="id">lo</span> <span class="id">hi</span> <span class="id">m1</span>' <span class="id">sm0</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Memory.html#Mem.free">Mem.free</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#lo">lo</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#hi">hi</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m1</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m1</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2788')">Proof.</div>
<div class="proofscript" id="proof2788">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_invariant">match_stacks_invariant</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_free_1">Mem.perm_free_1</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_free_3">Mem.perm_free_3</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="min_alignment_sound">min_alignment_sound</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">sz</span> <span class="id">n</span>, (<span class="id"><a href="compcert.backend.Inlining.html#min_alignment">min_alignment</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#sz">sz</a></span> | <span class="id"><a href="compcert.backend.Inliningproof.html#n">n</a></span>) -&gt; <span class="id"><a href="compcert.common.Memory.html#Mem.inj_offset_aligned">Mem.inj_offset_aligned</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#n">n</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#sz">sz</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2789')">Proof.</div>
<div class="proofscript" id="proof2789">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Inlining.html#min_alignment">min_alignment</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (2 &lt;= <span class="id">sz</span> -&gt; (2 | <span class="id">n</span>)). <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zle">zle</a></span> <span class="id">sz</span> 1). <span class="id">omegaContradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zle">zle</a></span> <span class="id">sz</span> 2). <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zle">zle</a></span> <span class="id">sz</span> 4). <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#Zdivides_trans">Zdivides_trans</a></span> <span class="kwd">with</span> 4; <span class="tactic">auto</span>. <span class="id">exists</span> 2; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#Zdivides_trans">Zdivides_trans</a></span> <span class="kwd">with</span> 8; <span class="tactic">auto</span>. <span class="id">exists</span> 4; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (4 &lt;= <span class="id">sz</span> -&gt; (4 | <span class="id">n</span>)). <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zle">zle</a></span> <span class="id">sz</span> 1). <span class="id">omegaContradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zle">zle</a></span> <span class="id">sz</span> 2). <span class="id">omegaContradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zle">zle</a></span> <span class="id">sz</span> 4). <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#Zdivides_trans">Zdivides_trans</a></span> <span class="kwd">with</span> 8; <span class="tactic">auto</span>. <span class="id">exists</span> 2; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (8 &lt;= <span class="id">sz</span> -&gt; (8 | <span class="id">n</span>)). <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zle">zle</a></span> <span class="id">sz</span> 1). <span class="id">omegaContradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zle">zle</a></span> <span class="id">sz</span> 2). <span class="id">omegaContradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zle">zle</a></span> <span class="id">sz</span> 4). <span class="id">omegaContradiction</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">chunk</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_1_l">Z.divide_1_l</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_1_l">Z.divide_1_l</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H2</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H2</span>; <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Preservation by external calls </div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="INLINING.CORELEMMA.EXTCALL">EXTCALL</a></span>.<br/>
<br/>
<span class="kwd">Variables</span> <span class="id"><a name="INLINING.CORELEMMA.EXTCALL.F1">F1</a></span> <span class="id"><a name="INLINING.CORELEMMA.EXTCALL.F2">F2</a></span>: <span class="id"><a href="compcert.common.Values.html#meminj">meminj</a></span>.<br/>
<span class="kwd">Variables</span> <span class="id"><a name="INLINING.CORELEMMA.EXTCALL.m1">m1</a></span> <span class="id"><a name="INLINING.CORELEMMA.EXTCALL.m2">m2</a></span> <span class="id">m1</span>' <span class="id">m2</span>': <span class="id"><a href="compcert.common.Memory.html#mem">mem</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="INLINING.CORELEMMA.EXTCALL.MAXPERM">MAXPERM</a></span>: <span class="kwd">forall</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">p</span>, <span class="id"><a href="compcert.common.Memory.html#Mem.valid_block">Mem.valid_block</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.EXTCALL.m1">m1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> -&gt; <span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.EXTCALL.m2">m2</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.common.Memtype.html#Max">Max</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#p">p</a></span> -&gt; <span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.EXTCALL.m1">m1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.common.Memtype.html#Max">Max</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#p">p</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id">MAXPERM</span>': <span class="kwd">forall</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">p</span>, <span class="id"><a href="compcert.common.Memory.html#Mem.valid_block">Mem.valid_block</a></span> <span class="id">m1</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> -&gt; <span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id">m2</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.common.Memtype.html#Max">Max</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#p">p</a></span> -&gt; <span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id">m1</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#b">b</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.common.Memtype.html#Max">Max</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#p">p</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="INLINING.CORELEMMA.EXTCALL.UNCHANGED">UNCHANGED</a></span>: <span class="id"><a href="compcert.common.Memory.html#Mem.unchanged_on">Mem.unchanged_on</a></span> (<span class="id"><a href="compcert.common.Events.html#loc_out_of_reach">loc_out_of_reach</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.EXTCALL.F1">F1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.EXTCALL.m1">m1</a></span>) <span class="id">m1</span>' <span class="id">m2</span>'.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="INLINING.CORELEMMA.EXTCALL.INJ">INJ</a></span>: <span class="id"><a href="compcert.common.Memory.html#Mem.inject">Mem.inject</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.EXTCALL.F1">F1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.EXTCALL.m1">m1</a></span> <span class="id">m1</span>'.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="INLINING.CORELEMMA.EXTCALL.INCR">INCR</a></span>: <span class="id"><a href="compcert.common.Values.html#inject_incr">inject_incr</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.EXTCALL.F1">F1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.EXTCALL.F2">F2</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="INLINING.CORELEMMA.EXTCALL.SEP">SEP</a></span>: <span class="id"><a href="compcert.common.Events.html#inject_separated">inject_separated</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.EXTCALL.F1">F1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.EXTCALL.F2">F2</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.EXTCALL.m1">m1</a></span> <span class="id">m1</span>'.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="match_stacks_extcall">match_stacks_extcall</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">stk</span> <span class="id">stk</span>' <span class="id">bound</span> <span class="id">sm0</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.EXTCALL.F1">F1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.EXTCALL.m1">m1</a></span> <span class="id">m1</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#bound">bound</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#bound">bound</a></span> (<span class="id"><a href="compcert.common.Memory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">m1</span>') -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.EXTCALL.F2">F2</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.EXTCALL.m2">m2</a></span> <span class="id">m2</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#bound">bound</a></span><br/>
<span class="kwd">with</span> <span class="id"><a name="match_stacks_inside_extcall">match_stacks_inside_extcall</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">stk</span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id">ctx</span> <span class="id">sp</span>' <span class="id">rs</span>' <span class="id">sm0</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside">match_stacks_inside</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.EXTCALL.F1">F1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.EXTCALL.m1">m1</a></span> <span class="id">m1</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id">sp</span>' <span class="id">rs</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#Plt">Plt</a></span> <span class="id">sp</span>' (<span class="id"><a href="compcert.common.Memory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">m1</span>') -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside">match_stacks_inside</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.EXTCALL.F2">F2</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.EXTCALL.m2">m2</a></span> <span class="id">m2</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id">sp</span>' <span class="id">rs</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2790')">Proof.</div>
<div class="proofscript" id="proof2790">
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_nil">match_stacks_nil</a></span> <span class="kwd">with</span> <span class="id">bound1</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Events.html#symbols_inject_incr">symbols_inject_incr</a></span>; <span class="tactic">eauto</span>; <span class="id">i</span>; <span class="tactic">destruct</span> (<span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.EXTCALL.F1">F1</a></span> <span class="id">b</span>) <span class="id">eqn</span>:<span class="id">T</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="tactic">by</span> (<span class="tactic">destruct</span> <span class="id">p</span>; <span class="id">exploit</span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.EXTCALL.INCR">INCR</a></span>; <span class="tactic">eauto</span>; <span class="id">i</span>; <span class="id">clarify</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">inv</span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.SECOMPATSRC">SECOMPATSRC</a></span>. <span class="tactic">rewrite</span> <span class="id">NB</span> <span class="kwd">in</span> *. <span class="id">inv</span> <span class="id">MG</span>. <span class="id">exploit</span> <span class="id">DOMAIN</span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exploit</span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.EXTCALL.SEP">SEP</a></span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">des</span>. <span class="id">clarify</span>. <span class="id">inv</span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.SECOMPATTGT">SECOMPATTGT</a></span>. <span class="tactic">rewrite</span> <span class="id">NB</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.MATCH_GENV">MATCH_GENV</a></span>. <span class="tactic">rewrite</span> <span class="id">mge_next</span> <span class="kwd">in</span> *. <span class="tactic">unfold</span> <span class="id"><a href="compcert.common.Memory.html#Mem.valid_block">Mem.valid_block</a></span> <span class="kwd">in</span> *. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">MG</span>. <span class="id">constructor</span>; <span class="tactic">intros</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.EXTCALL.F1">F1</a></span> <span class="id">b1</span>) <span class="kwd">as</span> [[<span class="id">b2</span>' <span class="id">delta</span>']|] <span class="id">eqn</span>:?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.EXTCALL.INCR">INCR</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> <span class="id">EQ</span>; <span class="tactic">rewrite</span> <span class="id">H0</span> <span class="kwd">in</span> <span class="id">EQ</span>; <span class="id">inv</span> <span class="id">EQ</span>. <span class="tactic">eapply</span> <span class="id">IMAGE</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.EXTCALL.SEP">SEP</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">A</span> <span class="id">B</span>]. <span class="tactic">elim</span> <span class="id">B</span>. <span class="tactic">red</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_cons">match_stacks_cons</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">match_stacks_inside_extcall</span>; <span class="tactic">eauto</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs_incr">agree_regs_incr</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#range_private_extcall">range_private_extcall</a></span>; <span class="tactic">eauto</span>. <span class="tactic">red</span>; <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id">SSZ2</span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id">MAXPERM</span>'; <span class="tactic">auto</span>. <span class="tactic">red</span>; <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_untailcall">match_stacks_untailcall</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">match_stacks_inside_extcall</span>; <span class="tactic">eauto</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#range_private_extcall">range_private_extcall</a></span>; <span class="tactic">eauto</span>. <span class="tactic">red</span>; <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id">SSZ2</span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id">MAXPERM</span>'; <span class="tactic">auto</span>. <span class="tactic">red</span>; <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_base">match_stacks_inside_base</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">match_stacks_extcall</span>; <span class="tactic">eauto</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_inlined">match_stacks_inside_inlined</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs_incr">agree_regs_incr</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#range_private_extcall">range_private_extcall</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.EXTCALL">EXTCALL</a></span>.<br/>
<br/>
<div class="doc">Change of context corresponding to an inlined tailcall </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="align_unchanged">align_unchanged</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> <span class="id">amount</span>, <span class="id"><a href="compcert.backend.Inliningproof.html#amount">amount</a></span> &gt; 0 -&gt; (<span class="id"><a href="compcert.backend.Inliningproof.html#amount">amount</a></span> | <span class="id"><a href="compcert.backend.Inliningproof.html#n">n</a></span>) -&gt; <span class="id"><a href="compcert.lib.Coqlib.html#align">align</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#n">n</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#amount">amount</a></span> = <span class="id"><a href="compcert.backend.Inliningproof.html#n">n</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2791')">Proof.</div>
<div class="proofscript" id="proof2791">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H0</span> <span class="kwd">as</span> [<span class="id">p</span> <span class="id">EQ</span>]. <span class="tactic">subst</span> <span class="id">n</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.lib.Coqlib.html#align">align</a></span>. <span class="id">decEq</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#Zdiv_unique">Zdiv_unique</a></span> <span class="kwd">with</span> (<span class="id">b</span> := <span class="id">amount</span> - 1). <span class="tactic">omega</span>. <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="match_stacks_inside_inlined_tailcall">match_stacks_inside_inlined_tailcall</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">fenv</span> <span class="id">F</span> <span class="id">m</span> <span class="id">m</span>' <span class="id">stk</span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id">ctx</span> <span class="id">sp</span>' <span class="id">rs</span>' <span class="id">ctx</span>' <span class="id">f</span> <span class="id">sm0</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside">match_stacks_inside</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id">sp</span>' <span class="id">rs</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#context_below">context_below</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id">ctx</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#context_stack_tailcall">context_stack_tailcall</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#f">f</a></span> <span class="id">ctx</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id">ctx</span>'.(<span class="id"><a href="compcert.backend.Inlining.html#retinfo">retinfo</a></span>) = <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#retinfo">retinfo</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#range_private">range_private</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id">sp</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span>) <span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">MYDISJ</span>: <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span>.(<span class="id"><a href="compcert.common.SimMemInj.html#tgt_external">SimMemInj.tgt_external</a></span>) /2\ (<span class="kwd">fun</span> <span class="id">blk</span> <span class="id">_</span> =&gt; <span class="id">sp</span>' = <span class="id"><a href="compcert.backend.Inliningproof.html#blk">blk</a></span>) &lt;2= <span class="id">bot2</span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#tr_funbody">tr_funbody</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#fenv">fenv</a></span> <span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span>) <span class="id">ctx</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#f">f</a></span> <span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_code">fn_code</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside">match_stacks_inside</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id">ctx</span>' <span class="id">sp</span>' <span class="id">rs</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2792')">Proof.</div>
<div class="proofscript" id="proof2792">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;base&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_base">match_stacks_inside_base</a></span>; <span class="tactic">eauto</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span>. <span class="tactic">rewrite</span> <span class="id">DSTK</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#align_unchanged">align_unchanged</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningspec.html#min_alignment_pos">min_alignment_pos</a></span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_0_r">Z.divide_0_r</a></span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;inlined&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span> <span class="id">ctx</span> &lt;= <span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span> <span class="id">ctx</span>'). <span class="tactic">rewrite</span> <span class="id">H1</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#align_le">align_le</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningspec.html#min_alignment_pos">min_alignment_pos</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_inlined">match_stacks_inside_inlined</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> <span class="id">ofs</span> (<span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span> <span class="id">ctx</span>)). <span class="tactic">apply</span> <span class="id">PAD</span>; <span class="tactic">omega</span>. <span class="tactic">apply</span> <span class="id">H3</span>. <span class="id">inv</span> <span class="id">H4</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Inliningspec.html#context_below">context_below</a></span> <span class="kwd">in</span> *. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Inliningspec.html#context_stack_call">context_stack_call</a></span> <span class="kwd">in</span> *. <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<h2> Relating states </h2>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="match_states">match_states</a></span>: <span class="id"><a href="compcert.backend.RTL.html#state">RTL.state</a></span> -&gt; <span class="id"><a href="compcert.backend.RTL.html#state">RTL.state</a></span> -&gt; <span class="id">SimMemInj.t</span>' -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="match_regular_states">match_regular_states</a></span>: <span class="kwd">forall</span> <span class="id">stk</span> <span class="id">f</span> <span class="id">sp</span> <span class="id">pc</span> <span class="id">rs</span> <span class="id">m</span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id">sp</span>' <span class="id">rs</span>' <span class="id">m</span>' <span class="id">F</span> <span class="id">fenv</span> <span class="id">ctx</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sm0</span> (<span class="id">MCOMPAT</span>: <span class="id"><a href="compcert.common.SimMemInj.html#mcompat">SimMemInj.mcompat</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">MWF</span>: <span class="id">SimMemInj.wf</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">MS</span>: <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside">match_stacks_inside</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id">sp</span>' <span class="id">rs</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">COMPAT</span>: <span class="id"><a href="compcert.backend.Inliningspec.html#fenv_compat">fenv_compat</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.prog">prog</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#fenv">fenv</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FB</span>: <span class="id"><a href="compcert.backend.Inliningspec.html#tr_funbody">tr_funbody</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#fenv">fenv</a></span> <span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span>) <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#f">f</a></span> <span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_code">fn_code</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">AG</span>: <span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rs">rs</a></span> <span class="id">rs</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SP</span>: <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id">sp</span>', <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">MINJ</span>: <span class="id"><a href="compcert.common.Memory.html#Mem.inject">Mem.inject</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">VB</span>: <span class="id"><a href="compcert.common.Memory.html#Mem.valid_block">Mem.valid_block</a></span> <span class="id">m</span>' <span class="id">sp</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">PRIV</span>: <span class="id"><a href="compcert.backend.Inliningproof.html#range_private">range_private</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id">sp</span>' (<span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span>) + <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#mstk">mstk</a></span>)) <span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SSZ1</span>: 0 &lt;= <span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span>) &lt; <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.max_unsigned">Ptrofs.max_unsigned</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SSZ2</span>: <span class="kwd">forall</span> <span class="id">ofs</span>, <span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id">m</span>' <span class="id">sp</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.common.Memtype.html#Max">Max</a></span> <span class="id"><a href="compcert.common.Memtype.html#Nonempty">Nonempty</a></span> -&gt; 0 &lt;= <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> &lt;= <span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_states">match_states</a></span> (<span class="id"><a href="compcert.backend.RTL.html#State">State</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#f">f</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#sp">sp</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="compcert.backend.Inliningproof.html#pc">pc</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rs">rs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.RTL.html#State">State</a></span> <span class="id">stk</span>' <span class="id">f</span>' (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">sp</span>' <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) (<span class="id"><a href="compcert.backend.Inlining.html#spc">spc</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#pc">pc</a></span>) <span class="id">rs</span>' <span class="id">m</span>') <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="match_call_states">match_call_states</a></span>: <span class="kwd">forall</span> <span class="id">stk</span> <span class="id">fptr</span> <span class="id">sg</span> <span class="id">tfptr</span> <span class="id">args</span> <span class="id">m</span> <span class="id">stk</span>' <span class="id">args</span>' <span class="id">m</span>' <span class="id">F</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sm0</span> (<span class="id">MCOMPAT</span>: <span class="id"><a href="compcert.common.SimMemInj.html#mcompat">SimMemInj.mcompat</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">MWF</span>: <span class="id">SimMemInj.wf</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">MS</span>: <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' (<span class="id"><a href="compcert.common.Memory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">m</span>'))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FPTR</span>: <span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#fptr">fptr</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#tfptr">tfptr</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">VINJ</span>: <span class="id"><a href="compcert.common.Values.html#Val.inject_list">Val.inject_list</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#args">args</a></span> <span class="id">args</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">MINJ</span>: <span class="id"><a href="compcert.common.Memory.html#Mem.inject">Mem.inject</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>'),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_states">match_states</a></span> (<span class="id"><a href="compcert.backend.RTL.html#Callstate">Callstate</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#fptr">fptr</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#sg">sg</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#args">args</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.RTL.html#Callstate">Callstate</a></span> <span class="id">stk</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#tfptr">tfptr</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#sg">sg</a></span> <span class="id">args</span>' <span class="id">m</span>') <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="match_call_regular_states">match_call_regular_states</a></span>: <span class="kwd">forall</span> <span class="id">stk</span> <span class="id">fptr</span> <span class="id">sg</span> <span class="id">f</span> <span class="id">vargs</span> <span class="id">m</span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id">sp</span>' <span class="id">rs</span>' <span class="id">m</span>' <span class="id">F</span> <span class="id">fenv</span> <span class="id">ctx</span> <span class="id">ctx</span>' <span class="id">pc</span>' <span class="id">pc1</span>' <span class="id">rargs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sm0</span> (<span class="id">MCOMPAT</span>: <span class="id"><a href="compcert.common.SimMemInj.html#mcompat">SimMemInj.mcompat</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">MWF</span>: <span class="id">SimMemInj.wf</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">MS</span>: <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside">match_stacks_inside</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id">sp</span>' <span class="id">rs</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FPTR</span>: <span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_funct">Genv.find_funct</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.ge">ge</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#fptr">fptr</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="compcert.common.AST.html#Internal">Internal</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#f">f</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">COMPAT</span>: <span class="id"><a href="compcert.backend.Inliningspec.html#fenv_compat">fenv_compat</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.prog">prog</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#fenv">fenv</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FB</span>: <span class="id"><a href="compcert.backend.Inliningspec.html#tr_funbody">tr_funbody</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#fenv">fenv</a></span> <span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span>) <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#f">f</a></span> <span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_code">fn_code</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">BELOW</span>: <span class="id"><a href="compcert.backend.Inliningspec.html#context_below">context_below</a></span> <span class="id">ctx</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">NOP</span>: <span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_code">fn_code</a></span>)!<span class="id">pc</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="compcert.backend.RTL.html#Inop">Inop</a></span> <span class="id">pc1</span>'))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">MOVES</span>: <span class="id"><a href="compcert.backend.Inliningspec.html#tr_moves">tr_moves</a></span> <span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_code">fn_code</a></span>) <span class="id">pc1</span>' (<span class="id"><a href="compcert.backend.Inlining.html#sregs">sregs</a></span> <span class="id">ctx</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#rargs">rargs</a></span>) (<span class="id"><a href="compcert.backend.Inlining.html#sregs">sregs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#f">f</a></span>.(<span class="id"><a href="compcert.backend.RTL.html#fn_params">fn_params</a></span>)) (<span class="id"><a href="compcert.backend.Inlining.html#spc">spc</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#f">f</a></span>.(<span class="id"><a href="compcert.backend.RTL.html#fn_entrypoint">fn_entrypoint</a></span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">VINJ</span>: <span class="id"><a href="compcert.lib.Coqlib.html#list_forall2">list_forall2</a></span> (<span class="id"><a href="compcert.backend.Inliningproof.html#val_reg_charact">val_reg_charact</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id">ctx</span>' <span class="id">rs</span>') <span class="id"><a href="compcert.backend.Inliningproof.html#vargs">vargs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rargs">rargs</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">MINJ</span>: <span class="id"><a href="compcert.common.Memory.html#Mem.inject">Mem.inject</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">VB</span>: <span class="id"><a href="compcert.common.Memory.html#Mem.valid_block">Mem.valid_block</a></span> <span class="id">m</span>' <span class="id">sp</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">PRIV</span>: <span class="id"><a href="compcert.backend.Inliningproof.html#range_private">range_private</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id">sp</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span>) <span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SSZ1</span>: 0 &lt;= <span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span>) &lt; <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.max_unsigned">Ptrofs.max_unsigned</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SSZ2</span>: <span class="kwd">forall</span> <span class="id">ofs</span>, <span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id">m</span>' <span class="id">sp</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.common.Memtype.html#Max">Max</a></span> <span class="id"><a href="compcert.common.Memtype.html#Nonempty">Nonempty</a></span> -&gt; 0 &lt;= <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> &lt;= <span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_states">match_states</a></span> (<span class="id"><a href="compcert.backend.RTL.html#Callstate">Callstate</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#fptr">fptr</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#sg">sg</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#vargs">vargs</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.RTL.html#State">State</a></span> <span class="id">stk</span>' <span class="id">f</span>' (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">sp</span>' <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id">pc</span>' <span class="id">rs</span>' <span class="id">m</span>') <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="match_return_states">match_return_states</a></span>: <span class="kwd">forall</span> <span class="id">stk</span> <span class="id">v</span> <span class="id">m</span> <span class="id">stk</span>' <span class="id">v</span>' <span class="id">m</span>' <span class="id">F</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sm0</span> (<span class="id">MCOMPAT</span>: <span class="id"><a href="compcert.common.SimMemInj.html#mcompat">SimMemInj.mcompat</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">MWF</span>: <span class="id">SimMemInj.wf</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">MS</span>: <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' (<span class="id"><a href="compcert.common.Memory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">m</span>'))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">VINJ</span>: <span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#v">v</a></span> <span class="id">v</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">MINJ</span>: <span class="id"><a href="compcert.common.Memory.html#Mem.inject">Mem.inject</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>'),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_states">match_states</a></span> (<span class="id"><a href="compcert.backend.RTL.html#Returnstate">Returnstate</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#v">v</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.RTL.html#Returnstate">Returnstate</a></span> <span class="id">stk</span>' <span class="id">v</span>' <span class="id">m</span>') <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="match_return_regular_states">match_return_regular_states</a></span>: <span class="kwd">forall</span> <span class="id">stk</span> <span class="id">v</span> <span class="id">m</span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id">sp</span>' <span class="id">rs</span>' <span class="id">m</span>' <span class="id">F</span> <span class="id">ctx</span> <span class="id">pc</span>' <span class="id">or</span> <span class="id">rinfo</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sm0</span> (<span class="id">MCOMPAT</span>: <span class="id"><a href="compcert.common.SimMemInj.html#mcompat">SimMemInj.mcompat</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">MWF</span>: <span class="id">SimMemInj.wf</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">MS</span>: <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside">match_stacks_inside</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id">stk</span>' <span class="id">f</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id">sp</span>' <span class="id">rs</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">RET</span>: <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#retinfo">retinfo</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rinfo">rinfo</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">AT</span>: <span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_code">fn_code</a></span>)!<span class="id">pc</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="compcert.backend.Inlining.html#inline_return">inline_return</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#or">or</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#rinfo">rinfo</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">VINJ</span>: <span class="kwd">match</span> <span class="id"><a href="compcert.backend.Inliningproof.html#or">or</a></span> <span class="kwd">with</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="compcert.backend.Inliningproof.html#v">v</a></span> = <span class="id"><a href="compcert.common.Values.html#Vundef">Vundef</a></span> | <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">r</span> =&gt; <span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#v">v</a></span> <span class="id">rs</span>'#(<span class="id"><a href="compcert.backend.Inlining.html#sreg">sreg</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span> <span class="id">r</span>) <span class="kwd">end</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">MINJ</span>: <span class="id"><a href="compcert.common.Memory.html#Mem.inject">Mem.inject</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">VB</span>: <span class="id"><a href="compcert.common.Memory.html#Mem.valid_block">Mem.valid_block</a></span> <span class="id">m</span>' <span class="id">sp</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">PRIV</span>: <span class="id"><a href="compcert.backend.Inliningproof.html#range_private">range_private</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#F">F</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span> <span class="id">m</span>' <span class="id">sp</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span>) <span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SSZ1</span>: 0 &lt;= <span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span>) &lt; <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.max_unsigned">Ptrofs.max_unsigned</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SSZ2</span>: <span class="kwd">forall</span> <span class="id">ofs</span>, <span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id">m</span>' <span class="id">sp</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.common.Memtype.html#Max">Max</a></span> <span class="id"><a href="compcert.common.Memtype.html#Nonempty">Nonempty</a></span> -&gt; 0 &lt;= <span class="id"><a href="compcert.backend.Inliningproof.html#ofs">ofs</a></span> &lt;= <span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningproof.html#match_states">match_states</a></span> (<span class="id"><a href="compcert.backend.RTL.html#Returnstate">Returnstate</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#stk">stk</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#v">v</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#m">m</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.RTL.html#State">State</a></span> <span class="id">stk</span>' <span class="id">f</span>' (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">sp</span>' <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id">pc</span>' <span class="id">rs</span>' <span class="id">m</span>') <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span>.<br/>
<br/>
<h2> Forward simulation </h2>
<br/>
<span class="kwd">Definition</span> <span class="kwd">measure</span> (<span class="id">S</span>: <span class="id"><a href="compcert.backend.RTL.html#state">RTL.state</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.backend.Inliningproof.html#S">S</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.RTL.html#State">State</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> =&gt; 1%<span class="id">nat</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.RTL.html#Callstate">Callstate</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> =&gt; 0%<span class="id">nat</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.RTL.html#Returnstate">Returnstate</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> =&gt; 0%<span class="id">nat</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="tr_funbody_inv">tr_funbody_inv</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">fenv</span> <span class="id">sz</span> <span class="id">cts</span> <span class="id">f</span> <span class="id">c</span> <span class="id">pc</span> <span class="id">i</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#tr_funbody">tr_funbody</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#fenv">fenv</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#sz">sz</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#cts">cts</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#f">f</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#c">c</a></span> -&gt; <span class="id"><a href="compcert.backend.Inliningproof.html#f">f</a></span>.(<span class="id"><a href="compcert.backend.RTL.html#fn_code">fn_code</a></span>)!<span class="id"><a href="compcert.backend.Inliningproof.html#pc">pc</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#i">i</a></span> -&gt; <span class="id"><a href="compcert.backend.Inliningspec.html#tr_instr">tr_instr</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#fenv">fenv</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#sz">sz</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#cts">cts</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#pc">pc</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#i">i</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#c">c</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2793')">Proof.</div>
<div class="proofscript" id="proof2793">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="step_simulation">step_simulation</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">S1</span> <span class="id">t</span> <span class="id">S2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.RTL.html#step">step</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.se">se</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.ge">ge</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#S1">S1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#t">t</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#S2">S2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">S1</span>' <span class="id">sm0</span> (<span class="id">MS</span>: <span class="id"><a href="compcert.backend.Inliningproof.html#match_states">match_states</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#S1">S1</a></span> <span class="id">S1</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span>),<br/>
&nbsp;&nbsp;(<span class="id">exists</span> <span class="id">S2</span>', <span class="id"><a href="compcert.common.Smallstep.html#plus">plus</a></span> <span class="id"><a href="compcert.backend.RTL.html#step">step</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.tse">tse</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.tge">tge</a></span> <span class="id">S1</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#t">t</a></span> <span class="id">S2</span>' /\ <span class="id">exists</span> <span class="id">sm1</span>, <span class="id"><a href="compcert.backend.Inliningproof.html#match_states">match_states</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#S2">S2</a></span> <span class="id">S2</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sm1">sm1</a></span> /\ &lt;&lt;<span class="id">MLE</span>: <span class="id">SimMemInj.le</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#sm1">sm1</a></span>&gt;&gt;)<br/>
&nbsp;&nbsp;\/ (<span class="kwd">measure</span> <span class="id"><a href="compcert.backend.Inliningproof.html#S2">S2</a></span> &lt; <span class="kwd">measure</span> <span class="id"><a href="compcert.backend.Inliningproof.html#S1">S1</a></span> /\ <span class="id"><a href="compcert.backend.Inliningproof.html#t">t</a></span> = <span class="id"><a href="compcert.common.Events.html#E0">E0</a></span> /\ <span class="id">exists</span> <span class="id">sm1</span>, <span class="id"><a href="compcert.backend.Inliningproof.html#match_states">match_states</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#S2">S2</a></span> <span class="id">S1</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sm1">sm1</a></span> /\ &lt;&lt;<span class="id">MLE</span>: <span class="id">SimMemInj.le</span>' <span class="id"><a href="compcert.backend.Inliningproof.html#sm0">sm0</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#sm1">sm1</a></span>&gt;&gt;)%<span class="id">nat</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2794')">Proof.</div>
<div class="proofscript" id="proof2794">
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">intros</span>; <span class="id">inv</span> <span class="id">MS</span>.<br/>
<br/>
- <span class="comment">(*&nbsp;nop&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Inliningproof.html#tr_funbody_inv">tr_funbody_inv</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> <span class="id">TR</span>; <span class="id">inv</span> <span class="id">TR</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.RTL.html#exec_Inop">exec_Inop</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">SimMemInj.spl</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
<br/>
- <span class="comment">(*&nbsp;op&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Inliningproof.html#tr_funbody_inv">tr_funbody_inv</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> <span class="id">TR</span>; <span class="id">inv</span> <span class="id">TR</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.x86.Op.html#eval_operation_inject">eval_operation_inject</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_globals">match_stacks_inside_globals</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexact</span> <span class="id">SP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (2 := <span class="id">rs</span>##<span class="id">args</span>). <span class="id">instantiate</span> (1 := <span class="id">rs</span>'##(<span class="id"><a href="compcert.backend.Inlining.html#sregs">sregs</a></span> <span class="id">ctx</span> <span class="id">args</span>)). <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_val_regs">agree_val_regs</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexact</span> <span class="id">MINJ</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">fold</span> (<span class="id"><a href="compcert.backend.Inlining.html#sop">sop</a></span> <span class="id">ctx</span> <span class="id">op</span>). <span class="tactic">intros</span> [<span class="id">v</span>' [<span class="id">A</span> <span class="id">B</span>]].<br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.RTL.html#exec_Iop">exec_Iop</a></span>; <span class="tactic">eauto</span>. <span class="id">erewrite</span> <span class="id"><a href="compcert.x86.Op.html#eval_operation_preserved">eval_operation_preserved</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">exact</span> <span class="id"><a href="compcert.backend.Inliningproof.html#symbols_preserved">symbols_preserved</a></span>.<br/>
&nbsp;&nbsp;<span class="id">SimMemInj.spl</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_set_reg">match_stacks_inside_set_reg</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_set_reg">agree_set_reg</a></span>; <span class="tactic">auto</span>.<br/>
<br/>
- <span class="comment">(*&nbsp;load&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Inliningproof.html#tr_funbody_inv">tr_funbody_inv</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> <span class="id">TR</span>; <span class="id">inv</span> <span class="id">TR</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.x86.Op.html#eval_addressing_inject">eval_addressing_inject</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_globals">match_stacks_inside_globals</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexact</span> <span class="id">SP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (2 := <span class="id">rs</span>##<span class="id">args</span>). <span class="id">instantiate</span> (1 := <span class="id">rs</span>'##(<span class="id"><a href="compcert.backend.Inlining.html#sregs">sregs</a></span> <span class="id">ctx</span> <span class="id">args</span>)). <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_val_regs">agree_val_regs</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">fold</span> (<span class="id"><a href="compcert.backend.Inlining.html#saddr">saddr</a></span> <span class="id">ctx</span> <span class="id">addr</span>). <span class="tactic">intros</span> [<span class="id">a</span>' [<span class="id">P</span> <span class="id">Q</span>]].<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Memory.html#Mem.loadv_inject">Mem.loadv_inject</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">v</span>' [<span class="id">U</span> <span class="id">V</span>]].<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="compcert.x86.Op.html#eval_addressing">eval_addressing</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.tge">tge</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">sp</span>' <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) (<span class="id"><a href="compcert.backend.Inlining.html#saddr">saddr</a></span> <span class="id">ctx</span> <span class="id">addr</span>) <span class="id">rs</span>' ## (<span class="id"><a href="compcert.backend.Inlining.html#sregs">sregs</a></span> <span class="id">ctx</span> <span class="id">args</span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">a</span>').<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">P</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.x86.Op.html#eval_addressing_preserved">eval_addressing_preserved</a></span>. <span class="tactic">exact</span> <span class="id"><a href="compcert.backend.Inliningproof.html#symbols_preserved">symbols_preserved</a></span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.RTL.html#exec_Iload">exec_Iload</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">SimMemInj.spl</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_set_reg">match_stacks_inside_set_reg</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_set_reg">agree_set_reg</a></span>; <span class="tactic">auto</span>.<br/>
<br/>
- <span class="comment">(*&nbsp;store&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">MCOMPAT</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.backend.Inliningproof.html#tr_funbody_inv">tr_funbody_inv</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> <span class="id">TR</span>; <span class="id">inv</span> <span class="id">TR</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.x86.Op.html#eval_addressing_inject">eval_addressing_inject</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_globals">match_stacks_inside_globals</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexact</span> <span class="id">SP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (2 := <span class="id">rs</span>##<span class="id">args</span>). <span class="id">instantiate</span> (1 := <span class="id">rs</span>'##(<span class="id"><a href="compcert.backend.Inlining.html#sregs">sregs</a></span> <span class="id">ctx</span> <span class="id">args</span>)). <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_val_regs">agree_val_regs</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">fold</span> <span class="id"><a href="compcert.backend.Inlining.html#saddr">saddr</a></span>. <span class="tactic">intros</span> [<span class="id">a</span>' [<span class="id">P</span> <span class="id">Q</span>]].<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.SimMemInj.html#storev_mapped">SimMemInj.storev_mapped</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_val_reg">agree_val_reg</a></span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">des</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Memory.html#Mem.storev_mapped_inject">Mem.storev_mapped_inject</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_val_reg">agree_val_reg</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">m1</span>' [<span class="id">U</span> <span class="id">V</span>]].<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="compcert.x86.Op.html#eval_addressing">eval_addressing</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA.tge">tge</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">sp</span>' <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) (<span class="id"><a href="compcert.backend.Inlining.html#saddr">saddr</a></span> <span class="id">ctx</span> <span class="id">addr</span>) <span class="id">rs</span>' ## (<span class="id"><a href="compcert.backend.Inlining.html#sregs">sregs</a></span> <span class="id">ctx</span> <span class="id">args</span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">a</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">P</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.x86.Op.html#eval_addressing_preserved">eval_addressing_preserved</a></span>. <span class="tactic">exact</span> <span class="id"><a href="compcert.backend.Inliningproof.html#symbols_preserved">symbols_preserved</a></span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.RTL.html#exec_Istore">exec_Istore</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">a</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H1</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">a</span>'; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">U</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">sm1</span>; <span class="id">esplits</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;{ <span class="id">SimMemInj.compat_tac</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_store">match_stacks_inside_store</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_le">match_stacks_inside_le</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.store_valid_block_1">Mem.store_valid_block_1</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#range_private_invariant">range_private_invariant</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_store_2">Mem.perm_store_2</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_store_1">Mem.perm_store_1</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id">SSZ2</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_store_2">Mem.perm_store_2</a></span>; <span class="tactic">eauto</span>.<br/>
<br/>
- <span class="comment">(*&nbsp;call&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_globalenvs">match_stacks_inside_globalenvs</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">bound</span> <span class="id">G</span>].<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Inliningproof.html#find_function_ptr_agree">find_function_ptr_agree</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">tfptr</span> &amp; <span class="id">A</span> &amp; <span class="id">B</span>).<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Inliningproof.html#tr_funbody_inv">tr_funbody_inv</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> <span class="id">TR</span>; <span class="id">inv</span> <span class="id">TR</span>.<br/>
+ <span class="comment">(*&nbsp;not&nbsp;inlined&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.RTL.html#exec_Icall">exec_Icall</a></span>; <span class="tactic">eauto</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">SimMemInj.spl</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_cons">match_stacks_cons</a></span>; <span class="tactic">eauto</span>; <span class="tactic">try</span> (<span class="tactic">by</span> <span class="id">inv</span> <span class="id">MS0</span>; <span class="id">ss</span>).<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">FPTR</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_val_regs">agree_val_regs</a></span>; <span class="tactic">eauto</span>.<br/>
+ <span class="comment">(*&nbsp;inlined&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Inliningproof.html#find_inlined_function">find_inlined_function</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">FFPTR</span>.<br/>
&nbsp;&nbsp;<span class="id">right</span>; <span class="tactic">split</span>. <span class="tactic">simpl</span>; <span class="tactic">omega</span>. <span class="tactic">split</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">SimMemInj.spl</span>. <span class="tactic">inversion</span> <span class="id">FPTR</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_inlined">match_stacks_inside_inlined</a></span>; <span class="tactic">eauto</span>; <span class="tactic">try</span> (<span class="tactic">by</span> <span class="id">inv</span> <span class="id">MS0</span>; <span class="id">ss</span>).<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id">PRIV</span>. <span class="id">inv</span> <span class="id">H13</span>. <span class="tactic">destruct</span> <span class="id">H16</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_val_regs_gen">agree_val_regs_gen</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="tactic">apply</span> <span class="id">PRIV</span>. <span class="tactic">destruct</span> <span class="id">H16</span>. <span class="tactic">omega</span>.<br/>
<br/>
- <span class="comment">(*&nbsp;tailcall&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">H1</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_globalenvs">match_stacks_inside_globalenvs</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">bound</span> <span class="id">G</span>].<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Inliningproof.html#find_function_ptr_agree">find_function_ptr_agree</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">tfptr</span> &amp; <span class="id">A</span> &amp; <span class="id">B</span>).<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">PRIV</span>': <span class="id"><a href="compcert.backend.Inliningproof.html#range_private">range_private</a></span> <span class="id">F</span> <span class="id">m</span>' <span class="id">m</span>'0 <span class="id">sp</span>' (<span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span> <span class="id">ctx</span>) <span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span>)).<br/>
&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#range_private_free_left">range_private_free_left</a></span>; <span class="tactic">eauto</span>. <span class="id">inv</span> <span class="id">FB</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">H4</span>. <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Inliningproof.html#tr_funbody_inv">tr_funbody_inv</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> <span class="id">TR</span>; <span class="id">inv</span> <span class="id">TR</span>.<br/>
+ <span class="comment">(*&nbsp;within&nbsp;the&nbsp;original&nbsp;function&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">MS0</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">X</span>: { <span class="id">m1</span>' | <span class="id"><a href="compcert.common.Memory.html#Mem.free">Mem.free</a></span> <span class="id">m</span>'0 <span class="id">sp</span>' 0 (<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span> <span class="id">f</span>') = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m1</span>'}).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.range_perm_free">Mem.range_perm_free</a></span>. <span class="tactic">red</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> <span class="id">ofs</span> <span class="id">f</span>.(<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> <span class="id">ofs</span> <span class="kwd">with</span> (<span class="id">ofs</span> + <span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span> <span class="id">ctx</span>) <span class="tactic">by</span> <span class="tactic">omega</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_inject">Mem.perm_inject</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.free_range_perm">Mem.free_range_perm</a></span>; <span class="tactic">eauto</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">FB</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#range_private_perms">range_private_perms</a></span>; <span class="tactic">eauto</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">X</span> <span class="kwd">as</span> [<span class="id">m1</span>' <span class="id">FREE</span>].<br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.RTL.html#exec_Itailcall">exec_Itailcall</a></span>; <span class="tactic">eauto</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">MCOMPAT</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.common.SimMemInj.html#free_left">SimMemInj.free_left</a></span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">des</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.SimMemInj.html#free_right">SimMemInj.free_right</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;{ <span class="tactic">rewrite</span> <span class="id">MTGT</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;{ <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#range_private_tgt_private">range_private_tgt_private</a></span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">DSTK</span>; <span class="id">ss</span>. <span class="id">rpapply</span> <span class="id">PRIV</span>'; <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;{ <span class="id">ii</span>. <span class="tactic">eapply</span> <span class="id">DISJ</span>; <span class="tactic">eauto</span>. <span class="id">inv</span> <span class="id">MLE</span>. <span class="tactic">rewrite</span> <span class="id">TGTPARENTEQ</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="id">i</span>; <span class="id">des</span>. <span class="id">SimMemInj.spl_exact</span> <span class="id">sm2</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;{ <span class="id">instantiate</span> (1:= <span class="id">sm0</span>.(<span class="id"><a href="compcert.common.SimMemInj.html#inj">SimMemInj.inj</a></span>)). <span class="id">SimMemInj.compat_tac</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_bound">match_stacks_bound</a></span> <span class="kwd">with</span> (<span class="id">bound</span> := <span class="id">sp</span>').<br/>
&nbsp;&nbsp;<span class="tactic">do</span> 2 (<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_le">match_stacks_le</a></span>; <span class="tactic">eauto</span>).<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_invariant">match_stacks_invariant</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_free_3">Mem.perm_free_3</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_free_1">Mem.perm_free_1</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_free_3">Mem.perm_free_3</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="compcert.common.Memory.html#Mem.nextblock_free">Mem.nextblock_free</a></span>; <span class="tactic">eauto</span>. <span class="tactic">red</span> <span class="kwd">in</span> <span class="id">VB</span>; <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">FPTR</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_val_regs">agree_val_regs</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.free_right_inject">Mem.free_right_inject</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.free_left_inject">Mem.free_left_inject</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;show&nbsp;that&nbsp;no&nbsp;valid&nbsp;location&nbsp;points&nbsp;into&nbsp;the&nbsp;stack&nbsp;block&nbsp;being&nbsp;freed&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id">DSTK</span> <span class="kwd">in</span> <span class="id">PRIV</span>'. <span class="id">exploit</span> (<span class="id">PRIV</span>' (<span class="id">ofs</span> + <span class="id">delta</span>)). <span class="tactic">omega</span>. <span class="tactic">intros</span> [<span class="id">P</span> <span class="id">Q</span>].<br/>
&nbsp;&nbsp;<span class="id">eelim</span> <span class="id">Q</span>; <span class="tactic">eauto</span>. <span class="tactic">replace</span> (<span class="id">ofs</span> + <span class="id">delta</span> - <span class="id">delta</span>) <span class="kwd">with</span> <span class="id">ofs</span> <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_max">Mem.perm_max</a></span> <span class="kwd">with</span> <span class="id">k</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_implies">Mem.perm_implies</a></span> <span class="kwd">with</span> <span class="id">p</span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
+ <span class="comment">(*&nbsp;turned&nbsp;into&nbsp;a&nbsp;call&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.RTL.html#exec_Icall">exec_Icall</a></span>; <span class="tactic">eauto</span>. <span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">MCOMPAT</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.common.SimMemInj.html#free_left">SimMemInj.free_left</a></span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">des</span>. <span class="id">SimMemInj.spl_exact</span> <span class="id">sm1</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;{ <span class="id">instantiate</span> (1:= <span class="id">sm0</span>.(<span class="id"><a href="compcert.common.SimMemInj.html#inj">SimMemInj.inj</a></span>)). <span class="id">SimMemInj.compat_tac</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_untailcall">match_stacks_untailcall</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_le">match_stacks_inside_le</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_invariant">match_stacks_inside_invariant</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_free_3">Mem.perm_free_3</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">MLE</span>. <span class="id">inv</span> <span class="id">MS0</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="tactic">congruence</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">FPTR</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_val_regs">agree_val_regs</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.free_left_inject">Mem.free_left_inject</a></span>; <span class="tactic">eauto</span>.<br/>
+ <span class="comment">(*&nbsp;inlined&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Inliningproof.html#find_inlined_function">find_inlined_function</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">FFPTR</span>.<br/>
&nbsp;&nbsp;<span class="id">right</span>; <span class="tactic">split</span>. <span class="tactic">simpl</span>; <span class="tactic">omega</span>. <span class="tactic">split</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">MCOMPAT</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.common.SimMemInj.html#free_left">SimMemInj.free_left</a></span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">des</span>. <span class="id">SimMemInj.spl_exact</span> <span class="id">sm1</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;{ <span class="id">instantiate</span> (1:= <span class="id">sm0</span>.(<span class="id"><a href="compcert.common.SimMemInj.html#inj">SimMemInj.inj</a></span>)). <span class="id">SimMemInj.compat_tac</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_inlined_tailcall">match_stacks_inside_inlined_tailcall</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_le">match_stacks_inside_le</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_invariant">match_stacks_inside_invariant</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_free_3">Mem.perm_free_3</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">MLE</span>. <span class="id">inv</span> <span class="id">MS0</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="tactic">congruence</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">FPTR</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_val_regs_gen">agree_val_regs_gen</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.free_left_inject">Mem.free_left_inject</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="tactic">apply</span> <span class="id">PRIV</span>'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span> <span class="id">ctx</span> &lt;= <span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span> <span class="id">ctx</span>'). <span class="tactic">red</span> <span class="kwd">in</span> <span class="id">H14</span>; <span class="tactic">rewrite</span> <span class="id">H14</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#align_le">align_le</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningspec.html#min_alignment_pos">min_alignment_pos</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
<br/>
- <span class="comment">(*&nbsp;builtin&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Inliningproof.html#tr_funbody_inv">tr_funbody_inv</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> <span class="id">TR</span>; <span class="id">inv</span> <span class="id">TR</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_globalenvs">match_stacks_inside_globalenvs</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">bound</span> <span class="id">MG</span>].<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_symbols_inject">match_stacks_inside_symbols_inject</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">SYMBINJ</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Inliningproof.html#tr_builtin_args">tr_builtin_args</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">vargs</span>' &amp; <span class="id">P</span> &amp; <span class="id">Q</span>).<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Events.html#external_call_mem_inject_gen">external_call_mem_inject_gen</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">F1</span> [<span class="id">v1</span> [<span class="id">m1</span>' [<span class="id">A</span> [<span class="id">B</span> [<span class="id">C</span> [<span class="id">D</span> [<span class="id">E</span> [<span class="id">J</span> <span class="id">K</span>]]]]]]]]].<br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.RTL.html#exec_Ibuiltin">exec_Ibuiltin</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.SimMemInj.html#external_call">SimMemInj.external_call</a></span>; <span class="tactic">try</span> <span class="tactic">by</span> (<span class="id">inv</span> <span class="id">MCOMPAT</span>; <span class="tactic">eauto</span>). <span class="id">i</span>; <span class="id">des</span>. <span class="id">SimMemInj.spl_exact</span> <span class="id">sm1</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">instantiate</span> (1 := <span class="id">F1</span>). <span class="id">SimMemInj.compat_tac</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_set_res">match_stacks_inside_set_res</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_extcall">match_stacks_inside_extcall</a></span> <span class="kwd">with</span> (<span class="id">F1</span> := <span class="id">F</span>) (<span class="id">F2</span> := <span class="id">F1</span>) (<span class="id">m1</span> := <span class="id">m</span>) (<span class="id">m1</span>' := <span class="id">m</span>'0); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Events.html#external_call_max_perm">external_call_max_perm</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Events.html#external_call_max_perm">external_call_max_perm</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_le">match_stacks_inside_le</a></span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">eauto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">res</span>; <span class="tactic">simpl</span>; [<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_set_reg">agree_set_reg</a></span>;<span class="tactic">auto</span>|<span class="id">idtac</span>|<span class="id">idtac</span>]; <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs_incr">agree_regs_incr</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Events.html#external_call_valid_block">external_call_valid_block</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#range_private_extcall">range_private_extcall</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Events.html#external_call_max_perm">external_call_max_perm</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id">SSZ2</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Events.html#external_call_max_perm">external_call_max_perm</a></span>; <span class="tactic">eauto</span>.<br/>
<br/>
- <span class="comment">(*&nbsp;cond&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Inliningproof.html#tr_funbody_inv">tr_funbody_inv</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> <span class="id">TR</span>; <span class="id">inv</span> <span class="id">TR</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="compcert.x86.Op.html#eval_condition">eval_condition</a></span> <span class="id">cond</span> <span class="id">rs</span>'##(<span class="id"><a href="compcert.backend.Inlining.html#sregs">sregs</a></span> <span class="id">ctx</span> <span class="id">args</span>) <span class="id">m</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">b</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.x86.Op.html#eval_condition_inject">eval_condition_inject</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_val_regs">agree_val_regs</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.RTL.html#exec_Icond">exec_Icond</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">SimMemInj.spl</span>. <span class="tactic">destruct</span> <span class="id">b</span>; <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
<br/>
- <span class="comment">(*&nbsp;jumptable&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Inliningproof.html#tr_funbody_inv">tr_funbody_inv</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> <span class="id">TR</span>; <span class="id">inv</span> <span class="id">TR</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id">F</span> <span class="id">rs</span>#<span class="id">arg</span> <span class="id">rs</span>'#(<span class="id"><a href="compcert.backend.Inlining.html#sreg">sreg</a></span> <span class="id">ctx</span> <span class="id">arg</span>)). <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_val_reg">agree_val_reg</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H0</span> <span class="kwd">in</span> <span class="id">H2</span>; <span class="id">inv</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.RTL.html#exec_Ijumptable">exec_Ijumptable</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#list_nth_z_map">list_nth_z_map</a></span>. <span class="tactic">rewrite</span> <span class="id">H1</span>. <span class="tactic">simpl</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id">SimMemInj.spl</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
<br/>
- <span class="comment">(*&nbsp;return&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Inliningproof.html#tr_funbody_inv">tr_funbody_inv</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> <span class="id">TR</span>; <span class="id">inv</span> <span class="id">TR</span>.<br/>
+ <span class="comment">(*&nbsp;not&nbsp;inlined&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">PRIV</span>': <span class="id"><a href="compcert.backend.Inliningproof.html#range_private">range_private</a></span> <span class="id">F</span> <span class="id">m</span>' <span class="id">m</span>'0 <span class="id">sp</span>' (<span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span> <span class="id">ctx</span>) <span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span>)).<br/>
&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#range_private_free_left">range_private_free_left</a></span>; <span class="tactic">eauto</span>. <span class="id">inv</span> <span class="id">FB</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">H4</span>. <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">MS0</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">X</span>: { <span class="id">m1</span>' | <span class="id"><a href="compcert.common.Memory.html#Mem.free">Mem.free</a></span> <span class="id">m</span>'0 <span class="id">sp</span>' 0 (<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span> <span class="id">f</span>') = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m1</span>'}).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.range_perm_free">Mem.range_perm_free</a></span>. <span class="tactic">red</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> <span class="id">ofs</span> <span class="id">f</span>.(<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> <span class="id">ofs</span> <span class="kwd">with</span> (<span class="id">ofs</span> + <span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span> <span class="id">ctx</span>) <span class="tactic">by</span> <span class="tactic">omega</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_inject">Mem.perm_inject</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.free_range_perm">Mem.free_range_perm</a></span>; <span class="tactic">eauto</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">FB</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#range_private_perms">range_private_perms</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="compcert.lib.Coqlib.html#Zmax_spec">Zmax_spec</a></span> (<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span> <span class="id">f</span>) 0). <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> 0 (<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span> <span class="id">f</span>)); <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">X</span> <span class="kwd">as</span> [<span class="id">m1</span>' <span class="id">FREE</span>].<br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.RTL.html#exec_Ireturn">exec_Ireturn</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">MCOMPAT</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.common.SimMemInj.html#free_left">SimMemInj.free_left</a></span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">des</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.common.SimMemInj.html#free_right">SimMemInj.free_right</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;{ <span class="tactic">rewrite</span> <span class="id">MTGT</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;{ <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#range_private_tgt_private">range_private_tgt_private</a></span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">DSTK</span>; <span class="id">ss</span>. <span class="id">rpapply</span> <span class="id">PRIV</span>'; <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;{ <span class="id">ii</span>. <span class="tactic">eapply</span> <span class="id">DISJ</span>; <span class="tactic">eauto</span>. <span class="id">inv</span> <span class="id">MLE</span>. <span class="tactic">rewrite</span> <span class="id">TGTPARENTEQ</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="id">i</span>; <span class="id">des</span>. <span class="id">SimMemInj.spl_exact</span> <span class="id">sm2</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;{ <span class="id">instantiate</span> (1:= <span class="id">sm0</span>.(<span class="id"><a href="compcert.common.SimMemInj.html#inj">SimMemInj.inj</a></span>)). <span class="id">SimMemInj.compat_tac</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_bound">match_stacks_bound</a></span> <span class="kwd">with</span> (<span class="id">bound</span> := <span class="id">sp</span>').<br/>
&nbsp;&nbsp;<span class="tactic">do</span> 2 (<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_le">match_stacks_le</a></span>; <span class="tactic">eauto</span>).<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_invariant">match_stacks_invariant</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_free_3">Mem.perm_free_3</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_free_1">Mem.perm_free_1</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_free_3">Mem.perm_free_3</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="compcert.common.Memory.html#Mem.nextblock_free">Mem.nextblock_free</a></span>; <span class="tactic">eauto</span>. <span class="tactic">red</span> <span class="kwd">in</span> <span class="id">VB</span>; <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">or</span>; <span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_val_reg">agree_val_reg</a></span>; <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.free_right_inject">Mem.free_right_inject</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.free_left_inject">Mem.free_left_inject</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;show&nbsp;that&nbsp;no&nbsp;valid&nbsp;location&nbsp;points&nbsp;into&nbsp;the&nbsp;stack&nbsp;block&nbsp;being&nbsp;freed&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">inversion</span> <span class="id">FB</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">DSTK</span> <span class="kwd">in</span> <span class="id">PRIV</span>'. <span class="id">exploit</span> (<span class="id">PRIV</span>' (<span class="id">ofs</span> + <span class="id">delta</span>)). <span class="tactic">omega</span>. <span class="tactic">intros</span> [<span class="id">A</span> <span class="id">B</span>].<br/>
&nbsp;&nbsp;<span class="id">eelim</span> <span class="id">B</span>; <span class="tactic">eauto</span>. <span class="tactic">replace</span> (<span class="id">ofs</span> + <span class="id">delta</span> - <span class="id">delta</span>) <span class="kwd">with</span> <span class="id">ofs</span> <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_max">Mem.perm_max</a></span> <span class="kwd">with</span> <span class="id">k</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_implies">Mem.perm_implies</a></span> <span class="kwd">with</span> <span class="id">p</span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
<br/>
+ <span class="comment">(*&nbsp;inlined&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">right</span>. <span class="tactic">split</span>. <span class="tactic">simpl</span>. <span class="tactic">omega</span>. <span class="tactic">split</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">MCOMPAT</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.common.SimMemInj.html#free_left">SimMemInj.free_left</a></span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">des</span>.<br/>
&nbsp;&nbsp;<span class="id">SimMemInj.spl_exact</span> <span class="id">sm1</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;{ <span class="id">instantiate</span> (1:= <span class="id">sm0</span>.(<span class="id"><a href="compcert.common.SimMemInj.html#inj">SimMemInj.inj</a></span>)). <span class="id">SimMemInj.compat_tac</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_le">match_stacks_inside_le</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_invariant">match_stacks_inside_invariant</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_free_3">Mem.perm_free_3</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">or</span>; <span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_val_reg">agree_val_reg</a></span>; <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.free_left_inject">Mem.free_left_inject</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">FB</span>. <span class="tactic">rewrite</span> <span class="id">H4</span> <span class="kwd">in</span> <span class="id">PRIV</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#range_private_free_left">range_private_free_left</a></span>; <span class="tactic">eauto</span>.<br/>
<br/>
- <span class="comment">(*&nbsp;internal&nbsp;function,&nbsp;not&nbsp;inlined&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Inliningproof.html#functions_injected">functions_injected</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_globalenvs">match_stacks_globalenvs</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">cunit</span> &amp; <span class="id">fd</span>' &amp; <span class="id">TFPTR</span> &amp; <span class="id">FD</span> &amp; <span class="id">LINK</span>). <span class="id">des</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">A</span>: <span class="id">exists</span> <span class="id">f</span>', <span class="id"><a href="compcert.backend.Inliningspec.html#tr_function">tr_function</a></span> <span class="id">cunit</span> <span class="id">f</span> <span class="id">f</span>' /\ <span class="id">fd</span>' = <span class="id"><a href="compcert.common.AST.html#Internal">Internal</a></span> <span class="id">f</span>').<br/>
&nbsp;&nbsp;{ <span class="id">Errors.monadInv</span> <span class="id">FD</span>. <span class="id">exists</span> <span class="id">x</span>. <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningspec.html#transf_function_spec">transf_function_spec</a></span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">A</span> <span class="kwd">as</span> [<span class="id">f</span>' [<span class="id">TR1</span> <span class="id">EQ</span>]].<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">TR</span>: <span class="id"><a href="compcert.backend.Inliningspec.html#tr_function">tr_function</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.prog">prog</a></span> <span class="id">f</span> <span class="id">f</span>').<br/>
&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningspec.html#tr_function_linkorder">tr_function_linkorder</a></span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">TR</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Memory.html#Mem.alloc_parallel_inject">Mem.alloc_parallel_inject</a></span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.le_refl">Z.le_refl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (1 := <span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span> <span class="id">f</span>'). <span class="id">inv</span> <span class="id">H1</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">F</span>' [<span class="id">m1</span>' [<span class="id">sp</span>' [<span class="id">A</span> [<span class="id">B</span> [<span class="id">C</span> [<span class="id">D</span> <span class="id">E</span>]]]]]]].<br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.RTL.html#exec_function_internal">exec_function_internal</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H6</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.common.SimMemInj.html#alloc_parallel">SimMemInj.alloc_parallel</a></span>; <span class="tactic">eauto</span>. { <span class="id">inv</span> <span class="id">MCOMPAT</span>; <span class="tactic">eauto</span>. } <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.le_refl">Z.le_refl</a></span>.<br/>
&nbsp;&nbsp;<span class="id">instantiate</span> (1 := <span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span> <span class="id">f</span>'). <span class="id">inv</span> <span class="id">H1</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">SM</span>. <span class="id">desH</span> <span class="id">SM</span>. <span class="id">SimMemInj.spl_exact</span> <span class="id">sm1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">INJEQ</span>: <span class="id">F</span>' = <span class="id">sm1</span>.(<span class="id"><a href="compcert.common.SimMemInj.html#inj">SimMemInj.inj</a></span>)).<br/>
&nbsp;&nbsp;{ <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Axioms.html#functional_extensionality">Axioms.functional_extensionality</a></span>. <span class="id">i</span>. <span class="id">inv</span> <span class="id">MCOMPAT</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.Values.html#eq_block">eq_block</a></span> <span class="id">x</span> <span class="id">stk</span>); <span class="id">clarify</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">E</span>; <span class="id">ss</span>. <span class="tactic">rewrite</span> <span class="id">INJ0</span>; <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>. { <span class="id">inv</span> <span class="id">MCOMPAT</span>; <span class="id">ss</span>. <span class="id">SimMemInj.compat_tac</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_base">match_stacks_inside_base</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">SP</span>: <span class="id">sp</span>' = <span class="id"><a href="compcert.common.Memory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">m</span>'0) <span class="tactic">by</span> (<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.alloc_result">Mem.alloc_result</a></span>; <span class="tactic">eauto</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">SP</span> <span class="kwd">in</span> <span class="id">MS0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_le">match_stacks_le</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_invariant">match_stacks_invariant</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.Values.html#eq_block">eq_block</a></span> <span class="id">b1</span> <span class="id">stk</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">b1</span>. <span class="tactic">rewrite</span> <span class="id">D</span> <span class="kwd">in</span> <span class="id">H8</span>; <span class="id">inv</span> <span class="id">H8</span>. <span class="id">eelim</span> <span class="id"><a href="compcert.lib.Coqlib.html#Plt_strict">Plt_strict</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">E</span> <span class="kwd">in</span> <span class="id">H8</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_alloc_inv">Mem.perm_alloc_inv</a></span>. <span class="id">eexact</span> <span class="id">H</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.Values.html#eq_block">eq_block</a></span> <span class="id">b1</span> <span class="id">stk</span>); <span class="tactic">intros</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">b1</span>. <span class="tactic">rewrite</span> <span class="id">D</span> <span class="kwd">in</span> <span class="id">H8</span>; <span class="id">inv</span> <span class="id">H8</span>. <span class="id">eelim</span> <span class="id"><a href="compcert.lib.Coqlib.html#Plt_strict">Plt_strict</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_alloc_1">Mem.perm_alloc_1</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_alloc_inv">Mem.perm_alloc_inv</a></span>. <span class="id">eexact</span> <span class="id">A</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#dec_eq_false">dec_eq_false</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">MLE</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">TGTPARENTEQ</span>. <span class="id">ii</span>. <span class="id">des</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Memory.html#Mem.alloc_result">Mem.alloc_result</a></span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">MWF</span>. <span class="tactic">eapply</span> <span class="id">TGTEXT</span> <span class="kwd">in</span> <span class="id">PR</span>. <span class="id">r</span> <span class="kwd">in</span> <span class="id">PR</span>. <span class="id">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.common.SimMemInj.html#valid_blocks">SimMemInj.valid_blocks</a></span>, <span class="id"><a href="compcert.common.Memory.html#Mem.valid_block">Mem.valid_block</a></span> <span class="kwd">in</span> *. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">MWF</span>. <span class="id">inv</span> <span class="id">MCOMPAT</span>. <span class="id">ss</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">MLE</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">TGTPARENTEQNB</span>. <span class="id">etransitivity</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Memory.html#Mem.alloc_result">Mem.alloc_result</a></span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">clarify</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H5</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs_init_regs">agree_regs_init_regs</a></span>. <span class="tactic">eauto</span>. <span class="tactic">auto</span>. <span class="id">inv</span> <span class="id">H1</span>; <span class="tactic">auto</span>. <span class="tactic">congruence</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.valid_new_block">Mem.valid_new_block</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_alloc_2">Mem.perm_alloc_2</a></span>; <span class="tactic">eauto</span>. <span class="id">inv</span> <span class="id">H1</span>; <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_alloc_inv">Mem.perm_alloc_inv</a></span>. <span class="id">eexact</span> <span class="id">H</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.Values.html#eq_block">eq_block</a></span> <span class="id">b</span> <span class="id">stk</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">subst</span>. <span class="tactic">rewrite</span> <span class="id">D</span> <span class="kwd">in</span> <span class="id">H9</span>; <span class="id">inv</span> <span class="id">H9</span>. <span class="id">inv</span> <span class="id">H1</span>; <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">E</span> <span class="kwd">in</span> <span class="id">H9</span>; <span class="tactic">auto</span>. <span class="id">eelim</span> <span class="id"><a href="compcert.common.Memory.html#Mem.fresh_block_alloc">Mem.fresh_block_alloc</a></span>. <span class="id">eexact</span> <span class="id">A</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.mi_mappedblocks">Mem.mi_mappedblocks</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_alloc_inv">Mem.perm_alloc_inv</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;{ <span class="id">erewrite</span> <span class="id"><a href="compcert.common.SimMemInj.html#mcompat_tgt">SimMemInj.mcompat_tgt</a></span> <span class="kwd">in</span> <span class="id">ALCTGT</span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id">ALCTGT</span> <span class="kwd">in</span> *. <span class="id">clarify</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#dec_eq_true">dec_eq_true</a></span>. <span class="tactic">omega</span>.<br/>
<br/>
- <span class="comment">(*&nbsp;internal&nbsp;function,&nbsp;inlined&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">TMP</span>: <span class="id">exists</span> <span class="id">cunit</span> <span class="id">fd</span>', &lt;&lt;<span class="id">LINK</span>: <span class="id"><a href="compcert.common.Linking.html#linkorder">linkorder</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#cunit">cunit</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.prog">prog</a></span>&gt;&gt; /\ &lt;&lt;<span class="id">FD</span>: <span class="id"><a href="compcert.backend.Inlining.html#transf_fundef">transf_fundef</a></span> (<span class="id"><a href="compcert.backend.Inlining.html#funenv_program">funenv_program</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#cunit">cunit</a></span>) (<span class="id"><a href="compcert.common.AST.html#Internal">Internal</a></span> <span class="id">f</span>) = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id">fd</span>'&gt;&gt;).<br/>
&nbsp;&nbsp;{ <span class="id">exploit</span> <span class="id"><a href="compcert.backend.Inliningproof.html#functions_translated">functions_translated</a></span>; <span class="tactic">try</span> <span class="tactic">apply</span> <span class="id">FPTR</span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">des</span>. <span class="id">esplits</span>; <span class="tactic">eauto</span>. } <span class="id">desH</span> <span class="id">TMP</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">FB</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Memory.html#Mem.alloc_left_mapped_inject">Mem.alloc_left_mapped_inject</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;sp'&nbsp;is&nbsp;valid&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (1 := <span class="id">sp</span>'). <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;offset&nbsp;is&nbsp;representable&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (1 := <span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span> <span class="id">ctx</span>). <span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.le_max_r">Z.le_max_r</a></span> (<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span> <span class="id">f</span>) 0). <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;size&nbsp;of&nbsp;target&nbsp;block&nbsp;is&nbsp;representable&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">right</span>. <span class="id">exploit</span> <span class="id">SSZ2</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>. <span class="id">inv</span> <span class="id">FB</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;we&nbsp;have&nbsp;full&nbsp;permissions&nbsp;on&nbsp;sp'&nbsp;at&nbsp;and&nbsp;above&nbsp;dstk&nbsp;ctx&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_cur">Mem.perm_cur</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_implies">Mem.perm_implies</a></span> <span class="kwd">with</span> <span class="id"><a href="compcert.common.Memtype.html#Freeable">Freeable</a></span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#range_private_perms">range_private_perms</a></span>; <span class="tactic">eauto</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;offset&nbsp;is&nbsp;aligned&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span> <span class="id">f</span> - 0) <span class="kwd">with</span> (<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span> <span class="id">f</span>) <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">FB</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#min_alignment_sound">min_alignment_sound</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;nobody&nbsp;maps&nbsp;to&nbsp;(sp,&nbsp;dstk&nbsp;ctx...)&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> (<span class="id">PRIV</span> (<span class="id">ofs</span> + <span class="id">delta</span>')); <span class="tactic">eauto</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">A</span> <span class="id">B</span>]. <span class="id">eelim</span> <span class="id">B</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">ofs</span> + <span class="id">delta</span>' - <span class="id">delta</span>') <span class="kwd">with</span> <span class="id">ofs</span> <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_max">Mem.perm_max</a></span> <span class="kwd">with</span> <span class="id">k</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_implies">Mem.perm_implies</a></span> <span class="kwd">with</span> <span class="id">p</span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">F</span>' [<span class="id">A</span> [<span class="id">B</span> [<span class="id">C</span> <span class="id">D</span>]]]].<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Inliningproof.html#tr_moves_init_regs">tr_moves_init_regs</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">rs</span>'' [<span class="id">P</span> [<span class="id">Q</span> <span class="id">R</span>]]].<br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_left">plus_left</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.RTL.html#exec_Inop">exec_Inop</a></span>; <span class="tactic">eauto</span>. <span class="id">eexact</span> <span class="id">P</span>. <span class="id">traceEq</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">MLE</span>: <span class="id">SimMemInj.le</span>' <span class="id">sm0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.common.SimMemInj.html#mk">SimMemInj.mk</a></span> <span class="id">m</span>' <span class="id">m</span>'0 <span class="id">F</span>' <span class="id">sm0</span>.(<span class="id"><a href="compcert.common.SimMemInj.html#src_external">SimMemInj.src_external</a></span>) <span class="id">sm0</span>.(<span class="id"><a href="compcert.common.SimMemInj.html#tgt_external">SimMemInj.tgt_external</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sm0</span>.(<span class="id"><a href="compcert.common.SimMemInj.html#src_parent_nb">SimMemInj.src_parent_nb</a></span>) <span class="id">sm0</span>.(<span class="id"><a href="compcert.common.SimMemInj.html#tgt_parent_nb">SimMemInj.tgt_parent_nb</a></span>) <span class="id">sm0</span>.(<span class="id"><a href="compcert.common.SimMemInj.html#src_ge_nb">SimMemInj.src_ge_nb</a></span>) <span class="id">sm0</span>.(<span class="id"><a href="compcert.common.SimMemInj.html#tgt_ge_nb">SimMemInj.tgt_ge_nb</a></span>))).<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">MCOMPAT</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">FROZEN</span>: <span class="id"><a href="compcert.common.SimMemInj.html#frozen">SimMemInj.frozen</a></span> (<span class="id"><a href="compcert.common.SimMemInj.html#inj">SimMemInj.inj</a></span> <span class="id">sm0</span>) <span class="id">F</span>' (<span class="id"><a href="compcert.common.SimMemInj.html#src_parent_nb">SimMemInj.src_parent_nb</a></span> <span class="id">sm0</span>) (<span class="id"><a href="compcert.common.SimMemInj.html#tgt_parent_nb">SimMemInj.tgt_parent_nb</a></span> <span class="id">sm0</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ - <span class="id">econs</span>; <span class="id">ss</span>; <span class="tactic">eauto</span>. <span class="id">ii</span>. <span class="id">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">b_src</span> = <span class="id">stk</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#NNPP">Classical_Prop.NNPP</a></span>. <span class="id">ii</span>. <span class="tactic">rewrite</span> <span class="id">D</span> <span class="kwd">in</span> <span class="id">NEW0</span>; <span class="id">ss</span>. <span class="id">clarify</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">clarify</span>. <span class="id">esplits</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">inv</span> <span class="id">MWF</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.common.Memory.html#Mem.alloc_result">Mem.alloc_result</a></span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">inv</span> <span class="id">MS0</span>; <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econs</span>; <span class="id">ss</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.alloc_unchanged_on">Mem.alloc_unchanged_on</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.unchanged_on_refl">Mem.unchanged_on_refl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.SimMemInj.html#frozen_shortened">SimMemInj.frozen_shortened</a></span>; <span class="tactic">eauto</span>; <span class="tactic">try</span> <span class="tactic">apply</span> <span class="id">MWF</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">ii</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_alloc_4">Mem.perm_alloc_4</a></span>; <span class="tactic">eauto</span>. <span class="id">ii</span>. <span class="tactic">subst</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.fresh_block_alloc">Mem.fresh_block_alloc</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id">SimMemInj.spl_approx</span> <span class="id">sm0</span>. <span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;{ <span class="id">SimMemInj.compat_tac</span>. }<br/>
&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">MCOMPAT</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">MWF</span>. <span class="id">econs</span>; <span class="id">ss</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">etransitivity</span>; <span class="tactic">eauto</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.common.SimMemInj.html#src_private">SimMemInj.src_private</a></span>. <span class="id">ss</span>. <span class="id">ii</span>; <span class="id">des</span>. <span class="id">esplits</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">red</span> <span class="kwd">in</span> <span class="id">PR</span>. <span class="tactic">red</span>. <span class="tactic">rewrite</span> <span class="id">D</span>; <span class="tactic">eauto</span>. <span class="id">ii</span>; <span class="id">clarify</span>. <span class="tactic">red</span> <span class="kwd">in</span> <span class="id">PR0</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.fresh_block_alloc">Mem.fresh_block_alloc</a></span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">unfold</span> <span class="id"><a href="compcert.common.SimMemInj.html#valid_blocks">SimMemInj.valid_blocks</a></span> <span class="kwd">in</span> *. <span class="tactic">clear</span> - <span class="id">H</span> <span class="id">PR0</span>. <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">unfold</span> <span class="id"><a href="compcert.common.SimMemInj.html#tgt_private">SimMemInj.tgt_private</a></span>. <span class="id">ss</span>. <span class="id">ii</span>; <span class="id">des</span>. <span class="id">esplits</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">ii</span>. <span class="tactic">assert</span> (<span class="id">b0</span> &lt;&gt; <span class="id">stk</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">ii</span>. <span class="id">clarify</span>; <span class="id">inv</span> <span class="id">MS0</span>; <span class="tactic">eapply</span> <span class="id">DISJ</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rr</span> <span class="kwd">in</span> <span class="id">TGTEXT</span>. <span class="id">specialize</span> (<span class="id">TGTEXT</span> <span class="id">x0</span> <span class="id">x1</span> <span class="id">PR</span>). <span class="id">des</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">TGTEXT</span>; <span class="tactic">eauto</span>; [<span class="id">erewrite</span> &lt;-<span class="id">D</span>|]; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id">TGTEXT</span> <span class="kwd">in</span> <span class="id">PR</span>. <span class="tactic">red</span> <span class="kwd">in</span> <span class="id">PR</span>. <span class="id">des</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">etransitivity</span>; <span class="tactic">eauto</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.common.Memory.html#Mem.nextblock_alloc">Mem.nextblock_alloc</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">NB</span>. <span class="tactic">rewrite</span> <span class="id">NB</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_alloc_left">match_stacks_inside_alloc_left</a></span>; <span class="tactic">try</span> <span class="tactic">apply</span> <span class="id">MS0</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_le">match_stacks_inside_le</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_invariant">match_stacks_inside_invariant</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eauto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_regs_incr">agree_regs_incr</a></span> <span class="kwd">with</span> <span class="id">F</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H2</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#range_private_alloc_left">range_private_alloc_left</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
<br/>
- <span class="comment">(*&nbsp;external&nbsp;function&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Inliningproof.html#functions_injected">functions_injected</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_globalenvs">match_stacks_globalenvs</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">cunit</span> &amp; <span class="id">fd</span>' &amp; <span class="id">TFPTR</span> &amp; <span class="id">FD</span> &amp; <span class="id">LINK</span>). <span class="id">des</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_globalenvs">match_stacks_globalenvs</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">bound</span> <span class="id">MG</span>].<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_symbols_inject">match_stacks_symbols_inject</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">SYMBINJ</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Events.html#external_call_mem_inject_gen">external_call_mem_inject_gen</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">F1</span> [<span class="id">v1</span> [<span class="id">m1</span>' [<span class="id">A</span> [<span class="id">B</span> [<span class="id">C</span> [<span class="id">D</span> [<span class="id">E</span> [<span class="id">J</span> <span class="id">K</span>]]]]]]]]].<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">FD</span>. <span class="id">inv</span> <span class="id">FD</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.RTL.html#exec_function_external">exec_function_external</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.SimMemInj.html#external_call">SimMemInj.external_call</a></span>; <span class="tactic">try</span> <span class="tactic">by</span> (<span class="id">inv</span> <span class="id">MCOMPAT</span>; <span class="tactic">eauto</span>). <span class="id">i</span>; <span class="id">des</span>. <span class="id">SimMemInj.spl_exact</span> <span class="id">sm1</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">instantiate</span> (1 := <span class="id">F1</span>). <span class="id">SimMemInj.compat_tac</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_bound">match_stacks_bound</a></span> <span class="kwd">with</span> (<span class="id"><a href="compcert.common.Memory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">m</span>'0).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_extcall">match_stacks_extcall</a></span> <span class="kwd">with</span> (<span class="id">F1</span> := <span class="id">F</span>) (<span class="id">F2</span> := <span class="id">F1</span>) (<span class="id">m1</span> := <span class="id">m</span>) (<span class="id">m1</span>' := <span class="id">m</span>'0); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Events.html#external_call_max_perm">external_call_max_perm</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Events.html#external_call_max_perm">external_call_max_perm</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_le">match_stacks_le</a></span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">xomega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Events.html#external_call_nextblock">external_call_nextblock</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
- <span class="id">clarify</span>.<br/>
<br/>
- <span class="comment">(*&nbsp;return&nbsp;fron&nbsp;noninlined&nbsp;function&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">MS0</span>.<br/>
+ <span class="comment">(*&nbsp;normal&nbsp;case&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.RTL.html#exec_return">exec_return</a></span>.<br/>
&nbsp;&nbsp;<span class="id">SimMemInj.spl</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_set_reg">match_stacks_inside_set_reg</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_set_reg">agree_set_reg</a></span>; <span class="tactic">auto</span>.<br/>
+ <span class="comment">(*&nbsp;untailcall&nbsp;case&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">MS</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">RET</span> <span class="kwd">in</span> <span class="id">RET0</span>; <span class="id">inv</span> <span class="id">RET0</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.RTL.html#exec_return">exec_return</a></span>.<br/>
&nbsp;&nbsp;<span class="id">SimMemInj.spl</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_regular_states">match_regular_states</a></span>. <span class="tactic">eauto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_set_reg">match_stacks_inside_set_reg</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eauto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_set_reg">agree_set_reg</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> <span class="id">ofs</span> (<span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span> <span class="id">ctx</span>)). <span class="tactic">apply</span> <span class="id">PAD</span>; <span class="tactic">omega</span>. <span class="tactic">apply</span> <span class="id">PRIV</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
<br/>
- <span class="comment">(*&nbsp;return&nbsp;from&nbsp;inlined&nbsp;function&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">MS0</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>. <span class="tactic">rewrite</span> <span class="id">RET0</span> <span class="kwd">in</span> <span class="id">RET</span>; <span class="id">inv</span> <span class="id">RET</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Inlining.html#inline_return">inline_return</a></span> <span class="kwd">in</span> <span class="id">AT</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">PRIV</span>': <span class="id"><a href="compcert.backend.Inliningproof.html#range_private">range_private</a></span> <span class="id">F</span> <span class="id">m</span> <span class="id">m</span>' <span class="id">sp</span>' (<span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span> <span class="id">ctx</span>' + <span class="id"><a href="compcert.backend.Inlining.html#mstk">mstk</a></span> <span class="id">ctx</span>') <span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> <span class="id">ofs</span> (<span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span> <span class="id">ctx</span>)). <span class="tactic">apply</span> <span class="id">PAD</span>. <span class="tactic">omega</span>. <span class="tactic">apply</span> <span class="id">PRIV</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">or</span>.<br/>
+ <span class="comment">(*&nbsp;with&nbsp;a&nbsp;result&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.RTL.html#exec_Iop">exec_Iop</a></span>; <span class="tactic">eauto</span>. <span class="tactic">simpl</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id">SimMemInj.spl</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_set_reg">match_stacks_inside_set_reg</a></span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#agree_set_reg">agree_set_reg</a></span>; <span class="tactic">auto</span>.<br/>
+ <span class="comment">(*&nbsp;without&nbsp;a&nbsp;result&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.RTL.html#exec_Inop">exec_Inop</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">SimMemInj.spl</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">subst</span> <span class="id">vres</span>. <span class="tactic">apply</span> <span class="id">agree_set_reg_undef</span>'; <span class="tactic">auto</span>.<br/>
<span class="id">Unshelve</span>.<br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="tactic">by</span> (<span class="tactic">try</span> <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.SimMemInj.html#inject_separated_frozen">SimMemInj.inject_separated_frozen</a></span>; <span class="tactic">eauto</span>).<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.CORELEMMA">CORELEMMA</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="INLINING.WHOLE">WHOLE</a></span>.<br/>
<br/>
<span class="kwd">Let</span> <span class="id"><a name="INLINING.WHOLE.ge">ge</a></span> := <span class="id"><a href="compcert.common.Globalenvs.html#Genv.globalenv">Genv.globalenv</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.prog">prog</a></span>.<br/>
<span class="kwd">Let</span> <span class="id"><a name="INLINING.WHOLE.tge">tge</a></span> := <span class="id"><a href="compcert.common.Globalenvs.html#Genv.globalenv">Genv.globalenv</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.tprog">tprog</a></span>.<br/>
<br/>
<span class="kwd">Let</span> <span class="id"><a name="INLINING.WHOLE.MATCH_GENV">MATCH_GENV</a></span>: <span class="id"><a href="compcert.common.Globalenvs.html#Genv.match_genvs">Genv.match_genvs</a></span> (<span class="id"><a href="compcert.common.Linking.html#match_globdef">match_globdef</a></span> (<span class="kwd">fun</span> <span class="id">cunit</span> <span class="id">f</span> <span class="id">tf</span> =&gt; <span class="id"><a href="compcert.backend.Inlining.html#transf_fundef">transf_fundef</a></span> (<span class="id"><a href="compcert.backend.Inlining.html#funenv_program">funenv_program</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#cunit">cunit</a></span>) <span class="id"><a href="compcert.backend.Inliningproof.html#f">f</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#tf">tf</a></span>) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.prog">prog</a></span>) <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.WHOLE.ge">ge</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.WHOLE.tge">tge</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2795')">Proof.</div>
<div class="proofscript" id="proof2795">
 <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Globalenvs.html#Genv.globalenvs_match">Genv.globalenvs_match</a></span>; <span class="tactic">auto</span>. Qed.</div>
<br/>
<span class="kwd">Let</span> <span class="id"><a name="INLINING.WHOLE.GENV_COMPAT">GENV_COMPAT</a></span>: <span class="id"><a href="compcert.common.Globalenvs.html#genv_compat">genv_compat</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.WHOLE.ge">ge</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.prog">prog</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2796')">Proof.</div>
<div class="proofscript" id="proof2796">
 <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Globalenvs.html#genv_compat_match">genv_compat_match</a></span>. Qed.</div>
<br/>
<span class="kwd">Let</span> <span class="id"><a name="INLINING.WHOLE.match_states">match_states</a></span> := <span class="id"><a href="compcert.backend.Inliningproof.html#match_states">match_states</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.WHOLE.ge">ge</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.WHOLE.tge">tge</a></span>.<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="transf_initial_states">transf_initial_states</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">st1</span>, <span class="id"><a href="compcert.backend.RTL.html#initial_state">initial_state</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.prog">prog</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#st1">st1</a></span> -&gt; <span class="id">exists</span> <span class="id">st2</span>, <span class="id"><a href="compcert.backend.RTL.html#initial_state">initial_state</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.tprog">tprog</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#st2">st2</a></span> /\ <span class="id">exists</span> <span class="id">sm</span>, <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.WHOLE.match_states">match_states</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.WHOLE.ge">ge</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#st1">st1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#st2">st2</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#sm">sm</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2797')">Proof.</div>
<div class="proofscript" id="proof2797">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">eexists</span> (<span class="id"><a href="compcert.backend.RTL.html#Callstate">Callstate</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id">m0</span>); <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> (<span class="id"><a href="compcert.common.Globalenvs.html#Genv.init_mem_match">Genv.init_mem_match</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.TRANSF">TRANSF</a></span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="compcert.backend.Inliningproof.html#symbols_preserved">symbols_preserved</a></span>; <span class="tactic">eauto</span>. <span class="tactic">replace</span> (<span class="id"><a href="compcert.common.AST.html#prog_main">prog_main</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.tprog">tprog</a></span>) <span class="kwd">with</span> (<span class="id"><a href="compcert.common.AST.html#prog_main">prog_main</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.prog">prog</a></span>). <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span>; <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Linking.html#match_program_main">match_program_main</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="compcert.common.SimMemInj.html#mk">SimMemInj.mk</a></span> <span class="id">m0</span> <span class="id">m0</span> (<span class="id"><a href="compcert.common.Memory.html#Mem.flat_inj">Mem.flat_inj</a></span> (<span class="id"><a href="compcert.common.Memory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">m0</span>)) <span class="id">bot2</span> <span class="id">bot2</span> 1%<span class="id">positive</span> 1%<span class="id">positive</span> 1%<span class="id">positive</span> 1%<span class="id">positive</span>).<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;{ <span class="id">SimMemInj.compat_tac</span>. }<br/>
&nbsp;&nbsp;{ <span class="id">econs</span>; <span class="id">ss</span>; <span class="tactic">eauto</span>; <span class="tactic">try</span> <span class="id">xomega</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Globalenvs.html#Genv.initmem_inject">Genv.initmem_inject</a></span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="id">s</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_nil">match_stacks_nil</a></span> <span class="kwd">with</span> (<span class="id"><a href="compcert.common.Memory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">m0</span>).<br/>
&nbsp;&nbsp;{ <span class="id">erewrite</span> &lt;- <span class="id"><a href="compcert.common.Globalenvs.html#Genv.init_mem_genv_next">Genv.init_mem_genv_next</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> (<span class="id"><a href="compcert.common.Events.html#init_symbols_inject">init_symbols_inject</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.WHOLE.MATCH_GENV">MATCH_GENV</a></span>). }<br/>
&nbsp;&nbsp;{ <span class="id">erewrite</span> &lt;- <span class="id"><a href="compcert.common.Globalenvs.html#Genv.init_mem_genv_next">Genv.init_mem_genv_next</a></span>; <span class="tactic">eauto</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Inliningproof.html#ge">ge</a></span>. <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.common.Memory.html#Mem.flat_inj">Mem.flat_inj</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#pred_dec_true">pred_dec_true</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.common.Memory.html#Mem.flat_inj">Mem.flat_inj</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#plt">plt</a></span> <span class="id">b1</span> (<span class="id"><a href="compcert.common.Memory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">m0</span>)); <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_symbol_not_fresh">Genv.find_symbol_not_fresh</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_funct_ptr_not_fresh">Genv.find_funct_ptr_not_fresh</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_var_info_not_fresh">Genv.find_var_info_not_fresh</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#Ple_refl">Ple_refl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">unfold</span> <span class="id"><a href="compcert.common.Memory.html#Mem.flat_inj">Mem.flat_inj</a></span>. <span class="id">exploit</span> <span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_symbol_not_fresh">Genv.find_symbol_not_fresh</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">P</span>. <span class="id">econs</span>; <span class="id">ss</span>; <span class="id">des_ifs</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.add_zero_l">Ptrofs.add_zero_l</a></span>. <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Globalenvs.html#Genv.initmem_inject">Genv.initmem_inject</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="transf_final_states">transf_final_states</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">st1</span> <span class="id">st2</span> <span class="id">r</span>,<br/>
&nbsp;&nbsp;(<span class="id">exists</span> <span class="id">sm</span>, <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.WHOLE.match_states">match_states</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.WHOLE.ge">ge</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#st1">st1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#st2">st2</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#sm">sm</a></span>) -&gt; <span class="id"><a href="compcert.backend.RTL.html#final_state">final_state</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#st1">st1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span> -&gt; <span class="id"><a href="compcert.backend.RTL.html#final_state">final_state</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#st2">st2</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#r">r</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2798')">Proof.</div>
<div class="proofscript" id="proof2798">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">des</span>. <span class="id">inv</span> <span class="id">H0</span>. <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_empty">match_stacks_empty</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> <span class="id">EQ</span>; <span class="tactic">subst</span>. <span class="id">inv</span> <span class="id">VINJ</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Inliningproof.html#match_stacks_inside_empty">match_stacks_inside_empty</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">A</span> <span class="id">B</span>]. <span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="transf_program_correct">transf_program_correct</a></span>:<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Smallstep.html#forward_simulation">forward_simulation</a></span> (<span class="id"><a href="compcert.backend.RTL.html#semantics">semantics</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.prog">prog</a></span>) (<span class="id"><a href="compcert.backend.RTL.html#semantics">semantics</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.tprog">tprog</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2799')">Proof.</div>
<div class="proofscript" id="proof2799">
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#forward_simulation_star">forward_simulation_star</a></span> <span class="kwd">with</span> (<span class="id">match_states</span> := <span class="kwd">fun</span> <span class="id">s1</span> <span class="id">s2</span> =&gt; <span class="id">exists</span> <span class="id">sm</span>, <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.WHOLE.match_states">match_states</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.WHOLE.ge">ge</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#s1">s1</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#s2">s2</a></span> <span class="id"><a href="compcert.backend.Inliningproof.html#sm">sm</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningproof.html#senv_preserved">senv_preserved</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">eexact</span> <span class="id"><a href="compcert.backend.Inliningproof.html#transf_initial_states">transf_initial_states</a></span>.<br/>
&nbsp;&nbsp;<span class="id">eexact</span> <span class="id"><a href="compcert.backend.Inliningproof.html#transf_final_states">transf_final_states</a></span>.<br/>
&nbsp;&nbsp;{ <span class="id">i</span>. <span class="id">des</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.backend.Inliningproof.html#step_simulation">step_simulation</a></span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">des</span>; <span class="tactic">eauto</span>. }<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING.WHOLE">WHOLE</a></span>.<br/>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.backend.Inliningproof.html#INLINING">INLINING</a></span>.<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</div>
</body>
</html>
