
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module Asmgenproof0</title>
<meta name="description" content="Documentation of Coq module Asmgenproof0" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module Asmgenproof0</h1>
<div class="coq">
<br/>
<div class="doc">Correctness proof for Asm generation: machine-independent framework </div>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.lib.Coqlib.html">Coqlib</a></span>.<br/>
<span class="kwd">Require</span> <span class="id"><a href="compcert.lib.Intv.html">Intv</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.common.AST.html">AST</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.common.Errors.html">Errors</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.lib.Integers.html">Integers</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.lib.Floats.html">Floats</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.common.Values.html">Values</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.common.Memory.html">Memory</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.common.Globalenvs.html">Globalenvs</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.common.Events.html">Events</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.common.Smallstep.html">Smallstep</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.backend.Locations.html">Locations</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.backend.Mach.html">Mach</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.x86.Asm.html">Asm</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.x86.Asmgen.html">Asmgen</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.backend.Conventions.html">Conventions</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.lib.sflib.html">sflib</a></span>.<br/>
<br/>
<h1> Processor registers and register states </h1>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Extern</span> 2 (<span class="id">_</span> &lt;&gt; <span class="id">_</span>) =&gt; <span class="tactic">congruence</span>: <span class="id">asmgen</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="ireg_of_eq">ireg_of_eq</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span> <span class="id">r</span>', <span class="id"><a href="compcert.x86.Asmgen.html#ireg_of">ireg_of</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#r">r</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id">r</span>' -&gt; <span class="id"><a href="compcert.x86.Asm.html#preg_of">preg_of</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#r">r</a></span> = <span class="id"><a href="compcert.x86.Asm.html#IR">IR</a></span> <span class="id">r</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4100')">Proof.</div>
<div class="proofscript" id="proof4100">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.x86.Asmgen.html#ireg_of">ireg_of</a></span>; <span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.x86.Asm.html#preg_of">preg_of</a></span> <span class="id">r</span>); <span class="id">inv</span> <span class="id">H</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="freg_of_eq">freg_of_eq</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span> <span class="id">r</span>', <span class="id"><a href="compcert.x86.Asmgen.html#freg_of">freg_of</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#r">r</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id">r</span>' -&gt; <span class="id"><a href="compcert.x86.Asm.html#preg_of">preg_of</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#r">r</a></span> = <span class="id"><a href="compcert.x86.Asm.html#FR">FR</a></span> <span class="id">r</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4101')">Proof.</div>
<div class="proofscript" id="proof4101">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.x86.Asmgen.html#freg_of">freg_of</a></span>; <span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.x86.Asm.html#preg_of">preg_of</a></span> <span class="id">r</span>); <span class="id">inv</span> <span class="id">H</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="preg_of_injective">preg_of_injective</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r1</span> <span class="id">r2</span>, <span class="id"><a href="compcert.x86.Asm.html#preg_of">preg_of</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#r1">r1</a></span> = <span class="id"><a href="compcert.x86.Asm.html#preg_of">preg_of</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#r2">r2</a></span> -&gt; <span class="id"><a href="compcert.backend.Asmgenproof0.html#r1">r1</a></span> = <span class="id"><a href="compcert.backend.Asmgenproof0.html#r2">r2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4102')">Proof.</div>
<div class="proofscript" id="proof4102">
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">r1</span>; <span class="tactic">destruct</span> <span class="id">r2</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>; <span class="tactic">reflexivity</span> || <span class="tactic">discriminate</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="preg_of_data">preg_of_data</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span>, <span class="id"><a href="compcert.x86.Asm.html#data_preg">data_preg</a></span> (<span class="id"><a href="compcert.x86.Asm.html#preg_of">preg_of</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#r">r</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4103')">Proof.</div>
<div class="proofscript" id="proof4103">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">r</span>; <span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">preg_of_data</span>: <span class="id">asmgen</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="data_diff">data_diff</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span> <span class="id">r</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.x86.Asm.html#data_preg">data_preg</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#r">r</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt; <span class="id"><a href="compcert.x86.Asm.html#data_preg">data_preg</a></span> <span class="id">r</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> -&gt; <span class="id"><a href="compcert.backend.Asmgenproof0.html#r">r</a></span> &lt;&gt; <span class="id">r</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4104')">Proof.</div>
<div class="proofscript" id="proof4104">
&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
Qed.</div>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">data_diff</span>: <span class="id">asmgen</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="preg_of_not_SP">preg_of_not_SP</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span>, <span class="id"><a href="compcert.x86.Asm.html#preg_of">preg_of</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#r">r</a></span> &lt;&gt; <span class="id"><a href="compcert.x86.Asm.html#SP">SP</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4105')">Proof.</div>
<div class="proofscript" id="proof4105">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.x86.Asm.html#preg_of">preg_of</a></span>; <span class="tactic">destruct</span> <span class="id">r</span>; <span class="tactic">simpl</span>; <span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="preg_of_not_PC">preg_of_not_PC</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span>, <span class="id"><a href="compcert.x86.Asm.html#preg_of">preg_of</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#r">r</a></span> &lt;&gt; <span class="id"><a href="compcert.x86.Asm.html#PC">PC</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4106')">Proof.</div>
<div class="proofscript" id="proof4106">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#data_diff">data_diff</a></span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">asmgen</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">preg_of_not_SP</span> <span class="id">preg_of_not_PC</span>: <span class="id">asmgen</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="nextinstr_pc">nextinstr_pc</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">rs</span>, (<span class="id"><a href="compcert.x86.Asm.html#nextinstr">nextinstr</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span>)#<span class="id"><a href="compcert.x86.Asm.html#PC">PC</a></span> = <span class="id"><a href="compcert.common.Values.html#Val.offset_ptr">Val.offset_ptr</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span>#<span class="id"><a href="compcert.x86.Asm.html#PC">PC</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.one">Ptrofs.one</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4107')">Proof.</div>
<div class="proofscript" id="proof4107">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.x86.Asm.html#Pregmap.gss">Pregmap.gss</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="nextinstr_inv">nextinstr_inv</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span> <span class="id">rs</span>, <span class="id"><a href="compcert.backend.Asmgenproof0.html#r">r</a></span> &lt;&gt; <span class="id"><a href="compcert.x86.Asm.html#PC">PC</a></span> -&gt; (<span class="id"><a href="compcert.x86.Asm.html#nextinstr">nextinstr</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span>)#<span class="id"><a href="compcert.backend.Asmgenproof0.html#r">r</a></span> = <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span>#<span class="id"><a href="compcert.backend.Asmgenproof0.html#r">r</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4108')">Proof.</div>
<div class="proofscript" id="proof4108">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.x86.Asm.html#nextinstr">nextinstr</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.x86.Asm.html#Pregmap.gso">Pregmap.gso</a></span>. <span class="tactic">red</span>; <span class="tactic">intro</span>; <span class="tactic">subst</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="nextinstr_inv1">nextinstr_inv1</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span> <span class="id">rs</span>, <span class="id"><a href="compcert.x86.Asm.html#data_preg">data_preg</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#r">r</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt; (<span class="id"><a href="compcert.x86.Asm.html#nextinstr">nextinstr</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span>)#<span class="id"><a href="compcert.backend.Asmgenproof0.html#r">r</a></span> = <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span>#<span class="id"><a href="compcert.backend.Asmgenproof0.html#r">r</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4109')">Proof.</div>
<div class="proofscript" id="proof4109">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#nextinstr_inv">nextinstr_inv</a></span>. <span class="tactic">red</span>; <span class="tactic">intro</span>; <span class="tactic">subst</span>; <span class="tactic">discriminate</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="nextinstr_set_preg">nextinstr_set_preg</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">rs</span> <span class="id">m</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.x86.Asm.html#nextinstr">nextinstr</a></span> (<span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span>#(<span class="id"><a href="compcert.x86.Asm.html#preg_of">preg_of</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#m">m</a></span>) &lt;- <span class="id"><a href="compcert.backend.Asmgenproof0.html#v">v</a></span>))#<span class="id"><a href="compcert.x86.Asm.html#PC">PC</a></span> = <span class="id"><a href="compcert.common.Values.html#Val.offset_ptr">Val.offset_ptr</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span>#<span class="id"><a href="compcert.x86.Asm.html#PC">PC</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.one">Ptrofs.one</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4110')">Proof.</div>
<div class="proofscript" id="proof4110">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.x86.Asm.html#nextinstr">nextinstr</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.x86.Asm.html#Pregmap.gss">Pregmap.gss</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.x86.Asm.html#Pregmap.gso">Pregmap.gso</a></span>. <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#not_eq_sym">not_eq_sym</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#preg_of_not_PC">preg_of_not_PC</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="undef_regs_other">undef_regs_other</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span> <span class="id">rl</span> <span class="id">rs</span>,<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">r</span>', <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">r</span>' <span class="id"><a href="compcert.backend.Asmgenproof0.html#rl">rl</a></span> -&gt; <span class="id"><a href="compcert.backend.Asmgenproof0.html#r">r</a></span> &lt;&gt; <span class="id">r</span>') -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.x86.Asm.html#undef_regs">undef_regs</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rl">rl</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#r">r</a></span> = <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#r">r</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4111')">Proof.</div>
<div class="proofscript" id="proof4111">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">rl</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHrl</span> <span class="tactic">by</span> <span class="tactic">auto</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.x86.Asm.html#Pregmap.gso">Pregmap.gso</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="preg_notin">preg_notin</a></span> (<span class="id">r</span>: <span class="id"><a href="compcert.x86.Asm.html#preg">preg</a></span>) (<span class="id">rl</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.x86.Machregs.html#mreg">mreg</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rl">rl</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span><br/>
&nbsp;&nbsp;| <span class="id">r1</span> :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; <span class="id"><a href="compcert.backend.Asmgenproof0.html#r">r</a></span> &lt;&gt; <span class="id"><a href="compcert.x86.Asm.html#preg_of">preg_of</a></span> <span class="id">r1</span><br/>
&nbsp;&nbsp;| <span class="id">r1</span> :: <span class="id">rl</span> =&gt; <span class="id"><a href="compcert.backend.Asmgenproof0.html#r">r</a></span> &lt;&gt; <span class="id"><a href="compcert.x86.Asm.html#preg_of">preg_of</a></span> <span class="id">r1</span> /\ <span class="id"><a href="compcert.backend.Asmgenproof0.html#preg_notin">preg_notin</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#r">r</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rl">rl</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="preg_notin_charact">preg_notin_charact</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span> <span class="id">rl</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#preg_notin">preg_notin</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#r">r</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rl">rl</a></span> &lt;-&gt; (<span class="kwd">forall</span> <span class="id">mr</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#mr">mr</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rl">rl</a></span> -&gt; <span class="id"><a href="compcert.backend.Asmgenproof0.html#r">r</a></span> &lt;&gt; <span class="id"><a href="compcert.x86.Asm.html#preg_of">preg_of</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#mr">mr</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4112')">Proof.</div>
<div class="proofscript" id="proof4112">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">rl</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">rl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">split</span>. <span class="tactic">intros</span>. <span class="tactic">intuition</span> <span class="tactic">congruence</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHrl</span>. <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">A</span> <span class="id">B</span>]. <span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H</span>. <span class="tactic">congruence</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="undef_regs_other_2">undef_regs_other_2</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span> <span class="id">rl</span> <span class="id">rs</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#preg_notin">preg_notin</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#r">r</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rl">rl</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.x86.Asm.html#undef_regs">undef_regs</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="compcert.x86.Asm.html#preg_of">preg_of</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rl">rl</a></span>) <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#r">r</a></span> = <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#r">r</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4113')">Proof.</div>
<div class="proofscript" id="proof4113">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#undef_regs_other">undef_regs_other</a></span>. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.lib.Coqlib.html#list_in_map_inv">list_in_map_inv</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">mr</span> [<span class="id">A</span> <span class="id">B</span>]]. <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#preg_notin_charact">preg_notin_charact</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<h1> Agreement between Mach registers and processor registers </h1>
<br/>
<span class="kwd">Record</span> <span class="id"><a name="agree">agree</a></span> (<span class="id">ms</span>: <span class="id"><a href="compcert.backend.Mach.html#regset">Mach.regset</a></span>) (<span class="id">sp</span>: <span class="id"><a href="compcert.common.Values.html#val">val</a></span>) (<span class="id">rs</span>: <span class="id"><a href="compcert.x86.Asm.html#regset">Asm.regset</a></span>) : <span class="kwd">Prop</span> := <span class="id"><a name="mkagree">mkagree</a></span> {<br/>
&nbsp;&nbsp;<span class="id"><a name="agree_sp">agree_sp</a></span>: <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span>#<span class="id"><a href="compcert.x86.Asm.html#SP">SP</a></span> = <span class="id"><a href="compcert.backend.Asmgenproof0.html#sp">sp</a></span>;<br/>
&nbsp;&nbsp;<span class="id"><a name="agree_sp_def">agree_sp_def</a></span>: <span class="id"><a href="compcert.backend.Asmgenproof0.html#sp">sp</a></span> &lt;&gt; <span class="id"><a href="compcert.common.Values.html#Vundef">Vundef</a></span>;<br/>
&nbsp;&nbsp;<span class="id"><a name="agree_mregs">agree_mregs</a></span>: <span class="kwd">forall</span> <span class="id">r</span>: <span class="id"><a href="compcert.x86.Machregs.html#mreg">mreg</a></span>, <span class="id"><a href="compcert.common.Values.html#Val.lessdef">Val.lessdef</a></span> (<span class="id"><a href="compcert.backend.Asmgenproof0.html#ms">ms</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#r">r</a></span>) (<span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span>#(<span class="id"><a href="compcert.x86.Asm.html#preg_of">preg_of</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#r">r</a></span>))<br/>
}.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="preg_val">preg_val</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ms</span> <span class="id">sp</span> <span class="id">rs</span> <span class="id">r</span>, <span class="id"><a href="compcert.backend.Asmgenproof0.html#agree">agree</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ms">ms</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span> -&gt; <span class="id"><a href="compcert.common.Values.html#Val.lessdef">Val.lessdef</a></span> (<span class="id"><a href="compcert.backend.Asmgenproof0.html#ms">ms</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#r">r</a></span>) <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span>#(<span class="id"><a href="compcert.x86.Asm.html#preg_of">preg_of</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#r">r</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4114')">Proof.</div>
<div class="proofscript" id="proof4114">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="preg_vals">preg_vals</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ms</span> <span class="id">sp</span> <span class="id">rs</span>, <span class="id"><a href="compcert.backend.Asmgenproof0.html#agree">agree</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ms">ms</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span>, <span class="id"><a href="compcert.common.Values.html#Val.lessdef_list">Val.lessdef_list</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ms">ms</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#l">l</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="compcert.x86.Asm.html#preg_of">preg_of</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#l">l</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4115')">Proof.</div>
<div class="proofscript" id="proof4115">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>. <span class="id">constructor</span>. <span class="id">constructor</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#preg_val">preg_val</a></span>; <span class="tactic">eauto</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sp_val">sp_val</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ms</span> <span class="id">sp</span> <span class="id">rs</span>, <span class="id"><a href="compcert.backend.Asmgenproof0.html#agree">agree</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ms">ms</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span> -&gt; <span class="id"><a href="compcert.backend.Asmgenproof0.html#sp">sp</a></span> = <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span>#<span class="id"><a href="compcert.x86.Asm.html#SP">SP</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4116')">Proof.</div>
<div class="proofscript" id="proof4116">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="ireg_val">ireg_val</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ms</span> <span class="id">sp</span> <span class="id">rs</span> <span class="id">r</span> <span class="id">r</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#agree">agree</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ms">ms</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.x86.Asmgen.html#ireg_of">ireg_of</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#r">r</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id">r</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Values.html#Val.lessdef">Val.lessdef</a></span> (<span class="id"><a href="compcert.backend.Asmgenproof0.html#ms">ms</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#r">r</a></span>) <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span>#<span class="id">r</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4117')">Proof.</div>
<div class="proofscript" id="proof4117">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="compcert.backend.Asmgenproof0.html#ireg_of_eq">ireg_of_eq</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">H0</span>). <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#preg_val">preg_val</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="freg_val">freg_val</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ms</span> <span class="id">sp</span> <span class="id">rs</span> <span class="id">r</span> <span class="id">r</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#agree">agree</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ms">ms</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.x86.Asmgen.html#freg_of">freg_of</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#r">r</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id">r</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Values.html#Val.lessdef">Val.lessdef</a></span> (<span class="id"><a href="compcert.backend.Asmgenproof0.html#ms">ms</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#r">r</a></span>) (<span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span>#<span class="id">r</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4118')">Proof.</div>
<div class="proofscript" id="proof4118">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="compcert.backend.Asmgenproof0.html#freg_of_eq">freg_of_eq</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">H0</span>). <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#preg_val">preg_val</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_exten">agree_exten</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ms</span> <span class="id">sp</span> <span class="id">rs</span> <span class="id">rs</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#agree">agree</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ms">ms</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">r</span>, <span class="id"><a href="compcert.x86.Asm.html#data_preg">data_preg</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#r">r</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt; <span class="id">rs</span>'#<span class="id"><a href="compcert.backend.Asmgenproof0.html#r">r</a></span> = <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span>#<span class="id"><a href="compcert.backend.Asmgenproof0.html#r">r</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#agree">agree</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ms">ms</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#sp">sp</a></span> <span class="id">rs</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4119')">Proof.</div>
<div class="proofscript" id="proof4119">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H</span>. <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H0</span>; <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id">H0</span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#preg_of_data">preg_of_data</a></span>.<br/>
Qed.</div>
<br/>
<div class="doc">Preservation of register agreement under various assignments. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_set_mreg">agree_set_mreg</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ms</span> <span class="id">sp</span> <span class="id">rs</span> <span class="id">r</span> <span class="id">v</span> <span class="id">rs</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#agree">agree</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ms">ms</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Values.html#Val.lessdef">Val.lessdef</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#v">v</a></span> (<span class="id">rs</span>'#(<span class="id"><a href="compcert.x86.Asm.html#preg_of">preg_of</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#r">r</a></span>)) -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">r</span>', <span class="id"><a href="compcert.x86.Asm.html#data_preg">data_preg</a></span> <span class="id">r</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt; <span class="id">r</span>' &lt;&gt; <span class="id"><a href="compcert.x86.Asm.html#preg_of">preg_of</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#r">r</a></span> -&gt; <span class="id">rs</span>'#<span class="id">r</span>' = <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span>#<span class="id">r</span>') -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#agree">agree</a></span> (<span class="id"><a href="compcert.backend.Mach.html#Regmap.set">Regmap.set</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#r">r</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#v">v</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ms">ms</a></span>) <span class="id"><a href="compcert.backend.Asmgenproof0.html#sp">sp</a></span> <span class="id">rs</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4120')">Proof.</div>
<div class="proofscript" id="proof4120">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H</span>. <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#not_eq_sym">not_eq_sym</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#preg_of_not_SP">preg_of_not_SP</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Mach.html#Regmap.set">Regmap.set</a></span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.backend.Mach.html#RegEq.eq">RegEq.eq</a></span> <span class="id">r0</span> <span class="id">r</span>). <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H1</span>. <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#preg_of_data">preg_of_data</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="tactic">elim</span> <span class="id">n</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#preg_of_injective">preg_of_injective</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Corollary</span> <span class="id"><a name="agree_set_mreg_parallel">agree_set_mreg_parallel</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ms</span> <span class="id">sp</span> <span class="id">rs</span> <span class="id">r</span> <span class="id">v</span> <span class="id">v</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#agree">agree</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ms">ms</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Values.html#Val.lessdef">Val.lessdef</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#v">v</a></span> <span class="id">v</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#agree">agree</a></span> (<span class="id"><a href="compcert.backend.Mach.html#Regmap.set">Regmap.set</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#r">r</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#v">v</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ms">ms</a></span>) <span class="id"><a href="compcert.backend.Asmgenproof0.html#sp">sp</a></span> (<span class="id"><a href="compcert.x86.Asm.html#Pregmap.set">Pregmap.set</a></span> (<span class="id"><a href="compcert.x86.Asm.html#preg_of">preg_of</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#r">r</a></span>) <span class="id">v</span>' <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4121')">Proof.</div>
<div class="proofscript" id="proof4121">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#agree_set_mreg">agree_set_mreg</a></span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.x86.Asm.html#Pregmap.gss">Pregmap.gss</a></span>; <span class="tactic">auto</span>. <span class="tactic">intros</span>; <span class="tactic">apply</span> <span class="id"><a href="compcert.x86.Asm.html#Pregmap.gso">Pregmap.gso</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_set_other">agree_set_other</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ms</span> <span class="id">sp</span> <span class="id">rs</span> <span class="id">r</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#agree">agree</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ms">ms</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.x86.Asm.html#data_preg">data_preg</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#r">r</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#agree">agree</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ms">ms</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#sp">sp</a></span> (<span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span>#<span class="id"><a href="compcert.backend.Asmgenproof0.html#r">r</a></span> &lt;- <span class="id"><a href="compcert.backend.Asmgenproof0.html#v">v</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4122')">Proof.</div>
<div class="proofscript" id="proof4122">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#agree_exten">agree_exten</a></span> <span class="kwd">with</span> <span class="id">rs</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.x86.Asm.html#Pregmap.gso">Pregmap.gso</a></span>. <span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_nextinstr">agree_nextinstr</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ms</span> <span class="id">sp</span> <span class="id">rs</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#agree">agree</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ms">ms</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span> -&gt; <span class="id"><a href="compcert.backend.Asmgenproof0.html#agree">agree</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ms">ms</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#sp">sp</a></span> (<span class="id"><a href="compcert.x86.Asm.html#nextinstr">nextinstr</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4123')">Proof.</div>
<div class="proofscript" id="proof4123">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.x86.Asm.html#nextinstr">nextinstr</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#agree_set_other">agree_set_other</a></span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_set_pair">agree_set_pair</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">sp</span> <span class="id">p</span> <span class="id">v</span> <span class="id">v</span>' <span class="id">ms</span> <span class="id">rs</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#agree">agree</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ms">ms</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Values.html#Val.lessdef">Val.lessdef</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#v">v</a></span> <span class="id">v</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#agree">agree</a></span> (<span class="id"><a href="compcert.backend.Mach.html#set_pair">Mach.set_pair</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#p">p</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#v">v</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ms">ms</a></span>) <span class="id"><a href="compcert.backend.Asmgenproof0.html#sp">sp</a></span> (<span class="id"><a href="compcert.x86.Asm.html#set_pair">set_pair</a></span> (<span class="id"><a href="compcert.common.AST.html#map_rpair">map_rpair</a></span> <span class="id"><a href="compcert.x86.Asm.html#preg_of">preg_of</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#p">p</a></span>) <span class="id">v</span>' <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4124')">Proof.</div>
<div class="proofscript" id="proof4124">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">p</span>; <span class="tactic">simpl</span>.<br/>
- <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#agree_set_mreg_parallel">agree_set_mreg_parallel</a></span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#agree_set_mreg_parallel">agree_set_mreg_parallel</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#agree_set_mreg_parallel">agree_set_mreg_parallel</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Values.html#Val.hiword_lessdef">Val.hiword_lessdef</a></span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Values.html#Val.loword_lessdef">Val.loword_lessdef</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_undef_nondata_regs">agree_undef_nondata_regs</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ms</span> <span class="id">sp</span> <span class="id">rl</span> <span class="id">rs</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#agree">agree</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ms">ms</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">r</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#r">r</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rl">rl</a></span> -&gt; <span class="id"><a href="compcert.x86.Asm.html#data_preg">data_preg</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#r">r</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#agree">agree</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ms">ms</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#sp">sp</a></span> (<span class="id"><a href="compcert.x86.Asm.html#undef_regs">undef_regs</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rl">rl</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4125')">Proof.</div>
<div class="proofscript" id="proof4125">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">rl</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHrl</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#agree_exten">agree_exten</a></span> <span class="kwd">with</span> <span class="id">rs</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.x86.Asm.html#Pregmap.gso">Pregmap.gso</a></span>. <span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="compcert.x86.Asm.html#data_preg">data_preg</a></span> <span class="id">a</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>) <span class="tactic">by</span> <span class="tactic">auto</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id">H0</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_undef_regs">agree_undef_regs</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ms</span> <span class="id">sp</span> <span class="id">rl</span> <span class="id">rs</span> <span class="id">rs</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#agree">agree</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ms">ms</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">r</span>', <span class="id"><a href="compcert.x86.Asm.html#data_preg">data_preg</a></span> <span class="id">r</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt; <span class="id"><a href="compcert.backend.Asmgenproof0.html#preg_notin">preg_notin</a></span> <span class="id">r</span>' <span class="id"><a href="compcert.backend.Asmgenproof0.html#rl">rl</a></span> -&gt; <span class="id">rs</span>'#<span class="id">r</span>' = <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span>#<span class="id">r</span>') -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#agree">agree</a></span> (<span class="id"><a href="compcert.backend.Mach.html#undef_regs">Mach.undef_regs</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rl">rl</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ms">ms</a></span>) <span class="id"><a href="compcert.backend.Asmgenproof0.html#sp">sp</a></span> <span class="id">rs</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4126')">Proof.</div>
<div class="proofscript" id="proof4126">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H</span>. <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">agree_sp0</span>. <span class="tactic">apply</span> <span class="id">H0</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#preg_notin_charact">preg_notin_charact</a></span>. <span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#not_eq_sym">not_eq_sym</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#preg_of_not_SP">preg_of_not_SP</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In_dec">In_dec</a></span> <span class="id"><a href="compcert.x86.Machregs.html#mreg_eq">mreg_eq</a></span> <span class="id">r</span> <span class="id">rl</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Mach.html#undef_regs_same">Mach.undef_regs_same</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Mach.html#undef_regs_other">Mach.undef_regs_other</a></span>; <span class="tactic">auto</span>. <span class="tactic">rewrite</span> <span class="id">H0</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#preg_of_data">preg_of_data</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#preg_notin_charact">preg_notin_charact</a></span>. <span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">elim</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#preg_of_injective">preg_of_injective</a></span>; <span class="tactic">eauto</span>. <span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_undef_regs2">agree_undef_regs2</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ms</span> <span class="id">sp</span> <span class="id">rl</span> <span class="id">rs</span> <span class="id">rs</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#agree">agree</a></span> (<span class="id"><a href="compcert.backend.Mach.html#undef_regs">Mach.undef_regs</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rl">rl</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ms">ms</a></span>) <span class="id"><a href="compcert.backend.Asmgenproof0.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">r</span>', <span class="id"><a href="compcert.x86.Asm.html#data_preg">data_preg</a></span> <span class="id">r</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt; <span class="id"><a href="compcert.backend.Asmgenproof0.html#preg_notin">preg_notin</a></span> <span class="id">r</span>' <span class="id"><a href="compcert.backend.Asmgenproof0.html#rl">rl</a></span> -&gt; <span class="id">rs</span>'#<span class="id">r</span>' = <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span>#<span class="id">r</span>') -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#agree">agree</a></span> (<span class="id"><a href="compcert.backend.Mach.html#undef_regs">Mach.undef_regs</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rl">rl</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ms">ms</a></span>) <span class="id"><a href="compcert.backend.Asmgenproof0.html#sp">sp</a></span> <span class="id">rs</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4127')">Proof.</div>
<div class="proofscript" id="proof4127">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H</span>. <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">agree_sp0</span>. <span class="tactic">apply</span> <span class="id">H0</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#preg_notin_charact">preg_notin_charact</a></span>. <span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#not_eq_sym">not_eq_sym</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#preg_of_not_SP">preg_of_not_SP</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In_dec">In_dec</a></span> <span class="id"><a href="compcert.x86.Machregs.html#mreg_eq">mreg_eq</a></span> <span class="id">r</span> <span class="id">rl</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Mach.html#undef_regs_same">Mach.undef_regs_same</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H0</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#preg_of_data">preg_of_data</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#preg_notin_charact">preg_notin_charact</a></span>. <span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">elim</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#preg_of_injective">preg_of_injective</a></span>; <span class="tactic">eauto</span>. <span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_set_undef_mreg">agree_set_undef_mreg</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ms</span> <span class="id">sp</span> <span class="id">rs</span> <span class="id">r</span> <span class="id">v</span> <span class="id">rl</span> <span class="id">rs</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#agree">agree</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ms">ms</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Values.html#Val.lessdef">Val.lessdef</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#v">v</a></span> (<span class="id">rs</span>'#(<span class="id"><a href="compcert.x86.Asm.html#preg_of">preg_of</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#r">r</a></span>)) -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">r</span>', <span class="id"><a href="compcert.x86.Asm.html#data_preg">data_preg</a></span> <span class="id">r</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt; <span class="id">r</span>' &lt;&gt; <span class="id"><a href="compcert.x86.Asm.html#preg_of">preg_of</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#r">r</a></span> -&gt; <span class="id"><a href="compcert.backend.Asmgenproof0.html#preg_notin">preg_notin</a></span> <span class="id">r</span>' <span class="id"><a href="compcert.backend.Asmgenproof0.html#rl">rl</a></span> -&gt; <span class="id">rs</span>'#<span class="id">r</span>' = <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span>#<span class="id">r</span>') -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#agree">agree</a></span> (<span class="id"><a href="compcert.backend.Mach.html#Regmap.set">Regmap.set</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#r">r</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#v">v</a></span> (<span class="id"><a href="compcert.backend.Mach.html#undef_regs">Mach.undef_regs</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rl">rl</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ms">ms</a></span>)) <span class="id"><a href="compcert.backend.Asmgenproof0.html#sp">sp</a></span> <span class="id">rs</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4128')">Proof.</div>
<div class="proofscript" id="proof4128">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#agree_set_mreg">agree_set_mreg</a></span> <span class="kwd">with</span> (<span class="id">rs</span>'#(<span class="id"><a href="compcert.x86.Asm.html#preg_of">preg_of</a></span> <span class="id">r</span>) &lt;- (<span class="id">rs</span>#(<span class="id"><a href="compcert.x86.Asm.html#preg_of">preg_of</a></span> <span class="id">r</span>))); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#agree_undef_regs">agree_undef_regs</a></span> <span class="kwd">with</span> <span class="id">rs</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.x86.Asm.html#Pregmap.set">Pregmap.set</a></span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.x86.Asm.html#PregEq.eq">PregEq.eq</a></span> <span class="id">r</span>' (<span class="id"><a href="compcert.x86.Asm.html#preg_of">preg_of</a></span> <span class="id">r</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">congruence</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.x86.Asm.html#Pregmap.gso">Pregmap.gso</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_undef_caller_save_regs">agree_undef_caller_save_regs</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ms</span> <span class="id">sp</span> <span class="id">rs</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#agree">agree</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ms">ms</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#agree">agree</a></span> (<span class="id"><a href="compcert.backend.Mach.html#undef_caller_save_regs">Mach.undef_caller_save_regs</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ms">ms</a></span>) <span class="id"><a href="compcert.backend.Asmgenproof0.html#sp">sp</a></span> (<span class="id"><a href="compcert.x86.Asm.html#undef_caller_save_regs">Asm.undef_caller_save_regs</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4129')">Proof.</div>
<div class="proofscript" id="proof4129">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Mach.html#undef_caller_save_regs">Mach.undef_caller_save_regs</a></span>, <span class="id"><a href="compcert.x86.Asm.html#undef_caller_save_regs">Asm.undef_caller_save_regs</a></span>; <span class="tactic">split</span>.<br/>
- <span class="tactic">unfold</span> <span class="id"><a href="compcert.lib.Coqlib.html#proj_sumbool">proj_sumbool</a></span>; <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#dec_eq_true">dec_eq_true</a></span>. <span class="tactic">auto</span>.<br/>
- <span class="tactic">auto</span>.<br/>
- <span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.lib.Coqlib.html#proj_sumbool">proj_sumbool</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#dec_eq_false">dec_eq_false</a></span> <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#preg_of_not_SP">preg_of_not_SP</a></span>). <br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_dec">in_dec</a></span> <span class="id"><a href="compcert.x86.Asm.html#preg_eq">preg_eq</a></span> (<span class="id"><a href="compcert.x86.Asm.html#preg_of">preg_of</a></span> <span class="id">r</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> <span class="id"><a href="compcert.x86.Asm.html#preg_of">preg_of</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#filter">List.filter</a></span> <span class="id"><a href="compcert.x86.Conventions1.html#is_callee_save">is_callee_save</a></span> <span class="id"><a href="compcert.x86.Machregs.html#all_mregs">all_mregs</a></span>))); <span class="tactic">simpl</span>.<br/>
+ <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#list_in_map_inv">list_in_map_inv</a></span> <span class="kwd">in</span> <span class="id">i</span>. <span class="tactic">destruct</span> <span class="id">i</span> <span class="kwd">as</span> (<span class="id">mr</span> &amp; <span class="id">A</span> &amp; <span class="id">B</span>). <br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">r</span> = <span class="id">mr</span>) <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#preg_of_injective">preg_of_injective</a></span>; <span class="tactic">auto</span>). <span class="tactic">subst</span> <span class="id">mr</span>; <span class="tactic">clear</span> <span class="id">A</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#filter_In">List.filter_In</a></span> <span class="kwd">in</span> <span class="id">B</span>. <span class="tactic">destruct</span> <span class="id">B</span> <span class="kwd">as</span> [<span class="id">C</span> <span class="id">D</span>]. <span class="tactic">rewrite</span> <span class="id">D</span>. <span class="tactic">auto</span>.<br/>
+ <span class="tactic">destruct</span> (<span class="id"><a href="compcert.x86.Conventions1.html#is_callee_save">is_callee_save</a></span> <span class="id">r</span>) <span class="id">eqn</span>:<span class="id">CS</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">n</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_map">List.in_map</a></span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#filter_In">List.filter_In</a></span>. <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="compcert.x86.Machregs.html#all_mregs_complete">all_mregs_complete</a></span>. <br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_change_sp">agree_change_sp</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ms</span> <span class="id">sp</span> <span class="id">rs</span> <span class="id">sp</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#agree">agree</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ms">ms</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span> -&gt; <span class="id">sp</span>' &lt;&gt; <span class="id"><a href="compcert.common.Values.html#Vundef">Vundef</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#agree">agree</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ms">ms</a></span> <span class="id">sp</span>' (<span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span>#<span class="id"><a href="compcert.x86.Asm.html#SP">SP</a></span> &lt;- <span class="id">sp</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4130')">Proof.</div>
<div class="proofscript" id="proof4130">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.x86.Asm.html#Pregmap.gso">Pregmap.gso</a></span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">asmgen</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Connection between Mach and Asm calling conventions for external
    functions. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="extcall_arg_match">extcall_arg_match</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ms</span> <span class="id">sp</span> <span class="id">rs</span> <span class="id">m</span> <span class="id">m</span>' <span class="id">l</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#agree">agree</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ms">ms</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Memory.html#Mem.extends">Mem.extends</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#m">m</a></span> <span class="id">m</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Mach.html#extcall_arg">Mach.extcall_arg</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ms">ms</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#m">m</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#l">l</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#v">v</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v</span>', <span class="id"><a href="compcert.x86.Asm.html#extcall_arg">Asm.extcall_arg</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Asmgenproof0.html#l">l</a></span> <span class="id">v</span>' /\ <span class="id"><a href="compcert.common.Values.html#Val.lessdef">Val.lessdef</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#v">v</a></span> <span class="id">v</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4131')">Proof.</div>
<div class="proofscript" id="proof4131">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id">rs</span>#(<span class="id"><a href="compcert.x86.Asm.html#preg_of">preg_of</a></span> <span class="id">r</span>)); <span class="tactic">split</span>. <span class="id">constructor</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#preg_val">preg_val</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Mach.html#load_stack">load_stack</a></span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Memory.html#Mem.loadv_extends">Mem.loadv_extends</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">v</span>' [<span class="id">A</span> <span class="id">B</span>]].<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="compcert.backend.Asmgenproof0.html#sp_val">sp_val</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H</span>) <span class="kwd">in</span> <span class="id">A</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v</span>'; <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="tactic">eauto</span>. <span class="tactic">assumption</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="extcall_arg_pair_match">extcall_arg_pair_match</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ms</span> <span class="id">sp</span> <span class="id">rs</span> <span class="id">m</span> <span class="id">m</span>' <span class="id">p</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#agree">agree</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ms">ms</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Memory.html#Mem.extends">Mem.extends</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#m">m</a></span> <span class="id">m</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Mach.html#extcall_arg_pair">Mach.extcall_arg_pair</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ms">ms</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#m">m</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#p">p</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#v">v</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v</span>', <span class="id"><a href="compcert.x86.Asm.html#extcall_arg_pair">Asm.extcall_arg_pair</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Asmgenproof0.html#p">p</a></span> <span class="id">v</span>' /\ <span class="id"><a href="compcert.common.Values.html#Val.lessdef">Val.lessdef</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#v">v</a></span> <span class="id">v</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4132')">Proof.</div>
<div class="proofscript" id="proof4132">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H1</span>.<br/>
- <span class="id">exploit</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#extcall_arg_match">extcall_arg_match</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">v</span>' &amp; <span class="id">A</span> &amp; <span class="id">B</span>). <span class="id">exists</span> <span class="id">v</span>'; <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
- <span class="id">exploit</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#extcall_arg_match">extcall_arg_match</a></span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="id">eexact</span> <span class="id">H2</span>. <span class="tactic">intros</span> (<span class="id">v1</span> &amp; <span class="id">A1</span> &amp; <span class="id">B1</span>).<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#extcall_arg_match">extcall_arg_match</a></span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="id">eexact</span> <span class="id">H3</span>. <span class="tactic">intros</span> (<span class="id">v2</span> &amp; <span class="id">A2</span> &amp; <span class="id">B2</span>).<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="compcert.common.Values.html#Val.longofwords">Val.longofwords</a></span> <span class="id">v1</span> <span class="id">v2</span>); <span class="tactic">split</span>. <span class="id">constructor</span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Values.html#Val.longofwords_lessdef">Val.longofwords_lessdef</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="extcall_args_match">extcall_args_match</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ms</span> <span class="id">sp</span> <span class="id">rs</span> <span class="id">m</span> <span class="id">m</span>', <span class="id"><a href="compcert.backend.Asmgenproof0.html#agree">agree</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ms">ms</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span> -&gt; <span class="id"><a href="compcert.common.Memory.html#Mem.extends">Mem.extends</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#m">m</a></span> <span class="id">m</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ll</span> <span class="id">vl</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#list_forall2">list_forall2</a></span> (<span class="id"><a href="compcert.backend.Mach.html#extcall_arg_pair">Mach.extcall_arg_pair</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ms">ms</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#m">m</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#sp">sp</a></span>) <span class="id"><a href="compcert.backend.Asmgenproof0.html#ll">ll</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#vl">vl</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">vl</span>', <span class="id"><a href="compcert.lib.Coqlib.html#list_forall2">list_forall2</a></span> (<span class="id"><a href="compcert.x86.Asm.html#extcall_arg_pair">Asm.extcall_arg_pair</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span> <span class="id">m</span>') <span class="id"><a href="compcert.backend.Asmgenproof0.html#ll">ll</a></span> <span class="id">vl</span>' /\ <span class="id"><a href="compcert.common.Values.html#Val.lessdef_list">Val.lessdef_list</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#vl">vl</a></span> <span class="id">vl</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4133')">Proof.</div>
<div class="proofscript" id="proof4133">
&nbsp;&nbsp;<span class="tactic">induction</span> 3; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id"><a href="compcert.common.Values.html#val">val</a></span>); <span class="tactic">split</span>. <span class="id">constructor</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#extcall_arg_pair_match">extcall_arg_pair_match</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">v1</span>' [<span class="id">A</span> <span class="id">B</span>]].<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">IHlist_forall2</span> <span class="kwd">as</span> [<span class="id">vl</span>' [<span class="id">C</span> <span class="id">D</span>]].<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id">v1</span>' :: <span class="id">vl</span>'); <span class="tactic">split</span>; <span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="extcall_arguments_match">extcall_arguments_match</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ms</span> <span class="id">m</span> <span class="id">m</span>' <span class="id">sp</span> <span class="id">rs</span> <span class="id">sg</span> <span class="id">args</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#agree">agree</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ms">ms</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span> -&gt; <span class="id"><a href="compcert.common.Memory.html#Mem.extends">Mem.extends</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#m">m</a></span> <span class="id">m</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Mach.html#extcall_arguments">Mach.extcall_arguments</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ms">ms</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#m">m</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#sg">sg</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#args">args</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">args</span>', <span class="id"><a href="compcert.x86.Asm.html#extcall_arguments">Asm.extcall_arguments</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Asmgenproof0.html#sg">sg</a></span> <span class="id">args</span>' /\ <span class="id"><a href="compcert.common.Values.html#Val.lessdef_list">Val.lessdef_list</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#args">args</a></span> <span class="id">args</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4134')">Proof.</div>
<div class="proofscript" id="proof4134">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Mach.html#extcall_arguments">Mach.extcall_arguments</a></span>, <span class="id"><a href="compcert.x86.Asm.html#extcall_arguments">Asm.extcall_arguments</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#extcall_args_match">extcall_args_match</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Translation of arguments and results to builtins. </div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="builtin_arg_match">builtin_arg_match</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ge</span> (<span class="id">rs</span>: <span class="id"><a href="compcert.x86.Asm.html#regset">regset</a></span>) <span class="id">sp</span> <span class="id">m</span> <span class="id">a</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Events.html#eval_builtin_arg">eval_builtin_arg</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ge">ge</a></span> (<span class="kwd">fun</span> <span class="id">r</span> =&gt; <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span> (<span class="id"><a href="compcert.x86.Asm.html#preg_of">preg_of</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#r">r</a></span>)) <span class="id"><a href="compcert.backend.Asmgenproof0.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#m">m</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#a">a</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#v">v</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Events.html#eval_builtin_arg">eval_builtin_arg</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ge">ge</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#m">m</a></span> (<span class="id"><a href="compcert.common.AST.html#map_builtin_arg">map_builtin_arg</a></span> <span class="id"><a href="compcert.x86.Asm.html#preg_of">preg_of</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#a">a</a></span>) <span class="id"><a href="compcert.backend.Asmgenproof0.html#v">v</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4135')">Proof.</div>
<div class="proofscript" id="proof4135">
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">simpl</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">barg</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="builtin_args_match">builtin_args_match</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ge</span> <span class="id">ms</span> <span class="id">sp</span> <span class="id">rs</span> <span class="id">m</span> <span class="id">m</span>', <span class="id"><a href="compcert.backend.Asmgenproof0.html#agree">agree</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ms">ms</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span> -&gt; <span class="id"><a href="compcert.common.Memory.html#Mem.extends">Mem.extends</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#m">m</a></span> <span class="id">m</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">al</span> <span class="id">vl</span>, <span class="id"><a href="compcert.common.Events.html#eval_builtin_args">eval_builtin_args</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ge">ge</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ms">ms</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#m">m</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#al">al</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#vl">vl</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">vl</span>', <span class="id"><a href="compcert.common.Events.html#eval_builtin_args">eval_builtin_args</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ge">ge</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#sp">sp</a></span> <span class="id">m</span>' (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="id"><a href="compcert.common.AST.html#map_builtin_arg">map_builtin_arg</a></span> <span class="id"><a href="compcert.x86.Asm.html#preg_of">preg_of</a></span>) <span class="id"><a href="compcert.backend.Asmgenproof0.html#al">al</a></span>) <span class="id">vl</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="compcert.common.Values.html#Val.lessdef_list">Val.lessdef_list</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#vl">vl</a></span> <span class="id">vl</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4136')">Proof.</div>
<div class="proofscript" id="proof4136">
&nbsp;&nbsp;<span class="tactic">induction</span> 3; <span class="tactic">intros</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id"><a href="compcert.common.Values.html#val">val</a></span>); <span class="tactic">split</span>; <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> (@<span class="id"><a href="compcert.common.Events.html#eval_builtin_arg_lessdef">eval_builtin_arg_lessdef</a></span> <span class="id">_</span> <span class="id">ge</span> <span class="id">ms</span> (<span class="kwd">fun</span> <span class="id">r</span> =&gt; <span class="id">rs</span> (<span class="id"><a href="compcert.x86.Asm.html#preg_of">preg_of</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#r">r</a></span>))); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#preg_val">preg_val</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">v1</span>' &amp; <span class="id">A</span> &amp; <span class="id">B</span>).<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">IHlist_forall2</span> <span class="kwd">as</span> [<span class="id">vl</span>' [<span class="id">C</span> <span class="id">D</span>]].<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id">v1</span>' :: <span class="id">vl</span>'); <span class="tactic">split</span>; <span class="id">constructor</span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#builtin_arg_match">builtin_arg_match</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_set_res">agree_set_res</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">res</span> <span class="id">ms</span> <span class="id">sp</span> <span class="id">rs</span> <span class="id">v</span> <span class="id">v</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#agree">agree</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ms">ms</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Values.html#Val.lessdef">Val.lessdef</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#v">v</a></span> <span class="id">v</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#agree">agree</a></span> (<span class="id"><a href="compcert.backend.Mach.html#set_res">Mach.set_res</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#res">res</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#v">v</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ms">ms</a></span>) <span class="id"><a href="compcert.backend.Asmgenproof0.html#sp">sp</a></span> (<span class="id"><a href="compcert.x86.Asm.html#set_res">Asm.set_res</a></span> (<span class="id"><a href="compcert.common.AST.html#map_builtin_res">map_builtin_res</a></span> <span class="id"><a href="compcert.x86.Asm.html#preg_of">preg_of</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#res">res</a></span>) <span class="id">v</span>' <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4137')">Proof.</div>
<div class="proofscript" id="proof4137">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">res</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
- <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#agree_set_mreg">agree_set_mreg</a></span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.x86.Asm.html#Pregmap.gss">Pregmap.gss</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.x86.Asm.html#Pregmap.gso">Pregmap.gso</a></span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">auto</span>.<br/>
- <span class="tactic">apply</span> <span class="id">IHres2</span>. <span class="tactic">apply</span> <span class="id">IHres1</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Values.html#Val.hiword_lessdef">Val.hiword_lessdef</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Values.html#Val.loword_lessdef">Val.loword_lessdef</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="set_res_other">set_res_other</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span> <span class="id">res</span> <span class="id">v</span> <span class="id">rs</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.x86.Asm.html#data_preg">data_preg</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#r">r</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.x86.Asm.html#set_res">set_res</a></span> (<span class="id"><a href="compcert.common.AST.html#map_builtin_res">map_builtin_res</a></span> <span class="id"><a href="compcert.x86.Asm.html#preg_of">preg_of</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#res">res</a></span>) <span class="id"><a href="compcert.backend.Asmgenproof0.html#v">v</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#r">r</a></span> = <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#r">r</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4138')">Proof.</div>
<div class="proofscript" id="proof4138">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">res</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
- <span class="tactic">apply</span> <span class="id"><a href="compcert.x86.Asm.html#Pregmap.gso">Pregmap.gso</a></span>. <span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="tactic">subst</span> <span class="id">r</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#preg_of_data">preg_of_data</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">discriminate</span>.<br/>
- <span class="tactic">auto</span>.<br/>
- <span class="tactic">rewrite</span> <span class="id">IHres2</span>, <span class="id">IHres1</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<h1> Correspondence between Mach code and Asm code </h1>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="find_instr_in">find_instr_in</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">c</span> <span class="id">pos</span> <span class="id">i</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.x86.Asm.html#find_instr">find_instr</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#pos">pos</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c">c</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#i">i</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#i">i</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c">c</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4139')">Proof.</div>
<div class="proofscript" id="proof4139">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">c</span>; <span class="tactic">simpl</span>. <span class="tactic">intros</span>; <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> <span class="id">i</span>. <span class="tactic">case</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zeq">zeq</a></span> <span class="id">pos</span> 0); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="tactic">congruence</span>. <span class="id">right</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">The ``code tail'' of an instruction list <span class="bracket"><span class="id">c</span></span> is the list of instructions
  starting at PC <span class="bracket"><span class="id">pos</span></span>. </div>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="code_tail">code_tail</a></span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="compcert.x86.Asm.html#code">code</a></span> -&gt; <span class="id"><a href="compcert.x86.Asm.html#code">code</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="code_tail_0">code_tail_0</a></span>: <span class="kwd">forall</span> <span class="id">c</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#code_tail">code_tail</a></span> 0 <span class="id"><a href="compcert.backend.Asmgenproof0.html#c">c</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c">c</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="code_tail_S">code_tail_S</a></span>: <span class="kwd">forall</span> <span class="id">pos</span> <span class="id">i</span> <span class="id">c1</span> <span class="id">c2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#code_tail">code_tail</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#pos">pos</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c1">c1</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c2">c2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#code_tail">code_tail</a></span> (<span class="id"><a href="compcert.backend.Asmgenproof0.html#pos">pos</a></span> + 1) (<span class="id"><a href="compcert.backend.Asmgenproof0.html#i">i</a></span> :: <span class="id"><a href="compcert.backend.Asmgenproof0.html#c1">c1</a></span>) <span class="id"><a href="compcert.backend.Asmgenproof0.html#c2">c2</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="code_tail_pos">code_tail_pos</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">pos</span> <span class="id">c1</span> <span class="id">c2</span>, <span class="id"><a href="compcert.backend.Asmgenproof0.html#code_tail">code_tail</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#pos">pos</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c1">c1</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c2">c2</a></span> -&gt; <span class="id"><a href="compcert.backend.Asmgenproof0.html#pos">pos</a></span> &gt;= 0.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4140')">Proof.</div>
<div class="proofscript" id="proof4140">
&nbsp;&nbsp;<span class="tactic">induction</span> 1. <span class="tactic">omega</span>. <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="find_instr_tail">find_instr_tail</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">c1</span> <span class="id">i</span> <span class="id">c2</span> <span class="id">pos</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#code_tail">code_tail</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#pos">pos</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c1">c1</a></span> (<span class="id"><a href="compcert.backend.Asmgenproof0.html#i">i</a></span> :: <span class="id"><a href="compcert.backend.Asmgenproof0.html#c2">c2</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.x86.Asm.html#find_instr">find_instr</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#pos">pos</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c1">c1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#i">i</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4141')">Proof.</div>
<div class="proofscript" id="proof4141">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">c1</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zeq">zeq</a></span> <span class="id">pos</span> 0). <span class="tactic">subst</span> <span class="id">pos</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>. <span class="tactic">auto</span>. <span class="tactic">generalize</span> (<span class="id"><a href="compcert.backend.Asmgenproof0.html#code_tail_pos">code_tail_pos</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H4</span>). <span class="tactic">intro</span>. <span class="id">omegaContradiction</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>. <span class="tactic">congruence</span>. <span class="tactic">replace</span> (<span class="id">pos0</span> + 1 - 1) <span class="kwd">with</span> <span class="id">pos0</span> <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="code_tail_bounds_1">code_tail_bounds_1</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">fn</span> <span class="id">ofs</span> <span class="id">c</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#code_tail">code_tail</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#fn">fn</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c">c</a></span> -&gt; 0 &lt;= <span class="id"><a href="compcert.backend.Asmgenproof0.html#ofs">ofs</a></span> &lt;= <span class="id"><a href="compcert.lib.Coqlib.html#list_length_z">list_length_z</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#fn">fn</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4142')">Proof.</div>
<div class="proofscript" id="proof4142">
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">intros</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="compcert.lib.Coqlib.html#list_length_z_pos">list_length_z_pos</a></span> <span class="id">c</span>). <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#list_length_z_cons">list_length_z_cons</a></span>. <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="code_tail_bounds_2">code_tail_bounds_2</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">fn</span> <span class="id">ofs</span> <span class="id">i</span> <span class="id">c</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#code_tail">code_tail</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#fn">fn</a></span> (<span class="id"><a href="compcert.backend.Asmgenproof0.html#i">i</a></span> :: <span class="id"><a href="compcert.backend.Asmgenproof0.html#c">c</a></span>) -&gt; 0 &lt;= <span class="id"><a href="compcert.backend.Asmgenproof0.html#ofs">ofs</a></span> &lt; <span class="id"><a href="compcert.lib.Coqlib.html#list_length_z">list_length_z</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#fn">fn</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4143')">Proof.</div>
<div class="proofscript" id="proof4143">
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">ofs</span> <span class="id">fn</span> <span class="id">c</span>, <span class="id"><a href="compcert.backend.Asmgenproof0.html#code_tail">code_tail</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#fn">fn</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c">c</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">i</span> <span class="id">c</span>', <span class="id"><a href="compcert.backend.Asmgenproof0.html#c">c</a></span> = <span class="id"><a href="compcert.backend.Asmgenproof0.html#i">i</a></span> :: <span class="id">c</span>' -&gt; 0 &lt;= <span class="id"><a href="compcert.backend.Asmgenproof0.html#ofs">ofs</a></span> &lt; <span class="id"><a href="compcert.lib.Coqlib.html#list_length_z">list_length_z</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#fn">fn</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">intros</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#list_length_z_cons">list_length_z_cons</a></span>. <span class="tactic">generalize</span> (<span class="id"><a href="compcert.lib.Coqlib.html#list_length_z_pos">list_length_z_pos</a></span> <span class="id">c</span>'). <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#list_length_z_cons">list_length_z_cons</a></span>. <span class="tactic">generalize</span> (<span class="id">IHcode_tail</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H0</span>). <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="code_tail_next">code_tail_next</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">fn</span> <span class="id">ofs</span> <span class="id">i</span> <span class="id">c</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#code_tail">code_tail</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#fn">fn</a></span> (<span class="id"><a href="compcert.backend.Asmgenproof0.html#i">i</a></span> :: <span class="id"><a href="compcert.backend.Asmgenproof0.html#c">c</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#code_tail">code_tail</a></span> (<span class="id"><a href="compcert.backend.Asmgenproof0.html#ofs">ofs</a></span> + 1) <span class="id"><a href="compcert.backend.Asmgenproof0.html#fn">fn</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c">c</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4144')">Proof.</div>
<div class="proofscript" id="proof4144">
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">ofs</span> <span class="id">fn</span> <span class="id">c</span>, <span class="id"><a href="compcert.backend.Asmgenproof0.html#code_tail">code_tail</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#fn">fn</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c">c</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">i</span> <span class="id">c</span>', <span class="id"><a href="compcert.backend.Asmgenproof0.html#c">c</a></span> = <span class="id"><a href="compcert.backend.Asmgenproof0.html#i">i</a></span> :: <span class="id">c</span>' -&gt; <span class="id"><a href="compcert.backend.Asmgenproof0.html#code_tail">code_tail</a></span> (<span class="id"><a href="compcert.backend.Asmgenproof0.html#ofs">ofs</a></span> + 1) <span class="id"><a href="compcert.backend.Asmgenproof0.html#fn">fn</a></span> <span class="id">c</span>').<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">c</span>. <span class="id">constructor</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="code_tail_next_int">code_tail_next_int</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">fn</span> <span class="id">ofs</span> <span class="id">i</span> <span class="id">c</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#list_length_z">list_length_z</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#fn">fn</a></span> &lt;= <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.max_unsigned">Ptrofs.max_unsigned</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#code_tail">code_tail</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ofs">ofs</a></span>) <span class="id"><a href="compcert.backend.Asmgenproof0.html#fn">fn</a></span> (<span class="id"><a href="compcert.backend.Asmgenproof0.html#i">i</a></span> :: <span class="id"><a href="compcert.backend.Asmgenproof0.html#c">c</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#code_tail">code_tail</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Ptrofs.add">Ptrofs.add</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ofs">ofs</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.one">Ptrofs.one</a></span>)) <span class="id"><a href="compcert.backend.Asmgenproof0.html#fn">fn</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c">c</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4145')">Proof.</div>
<div class="proofscript" id="proof4145">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.add_unsigned">Ptrofs.add_unsigned</a></span>, <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.unsigned_one">Ptrofs.unsigned_one</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.unsigned_repr">Ptrofs.unsigned_repr</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#code_tail_next">code_tail_next</a></span> <span class="kwd">with</span> <span class="id">i</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="compcert.backend.Asmgenproof0.html#code_tail_bounds_2">code_tail_bounds_2</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H0</span>). <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<div class="doc"><span class="bracket"><span class="id">transl_code_at_pc</span> <span class="id">pc</span> <span class="id">fb</span> <span class="id">f</span> <span class="id">c</span> <span class="id">ep</span> <span class="id">tf</span> <span class="id">tc</span></span> holds if the code pointer <span class="bracket"><span class="id">pc</span></span> points
  within the Asm code generated by translating Mach function <span class="bracket"><span class="id">f</span></span>,
  and <span class="bracket"><span class="id">tc</span></span> is the tail of the generated code at the position corresponding
  to the code pointer <span class="bracket"><span class="id">pc</span></span>. </div>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="transl_code_at_pc">transl_code_at_pc</a></span> (<span class="id">ge</span>: <span class="id"><a href="compcert.backend.Mach.html#genv">Mach.genv</a></span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Values.html#val">val</a></span> -&gt; <span class="id"><a href="compcert.common.Values.html#block">block</a></span> -&gt; <span class="id"><a href="compcert.backend.Mach.html#function">Mach.function</a></span> -&gt; <span class="id"><a href="compcert.backend.Mach.html#code">Mach.code</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> -&gt; <span class="id"><a href="compcert.x86.Asm.html#function">Asm.function</a></span> -&gt; <span class="id"><a href="compcert.x86.Asm.html#code">Asm.code</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id"><a name="transl_code_at_pc_intro">transl_code_at_pc_intro</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">f</span> <span class="id">c</span> <span class="id">ep</span> <span class="id">tf</span> <span class="id">tc</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_funct_ptr">Genv.find_funct_ptr</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ge">ge</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#b">b</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="compcert.common.AST.html#Internal">Internal</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#f">f</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.x86.Asmgen.html#transf_function">transf_function</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#f">f</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">Errors.OK</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#tf">tf</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.x86.Asmgen.html#transl_code">transl_code</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#f">f</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c">c</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ep">ep</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#tc">tc</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#code_tail">code_tail</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ofs">ofs</a></span>) (<span class="id"><a href="compcert.x86.Asm.html#fn_code">fn_code</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#tf">tf</a></span>) <span class="id"><a href="compcert.backend.Asmgenproof0.html#tc">tc</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#transl_code_at_pc">transl_code_at_pc</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ge">ge</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#b">b</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ofs">ofs</a></span>) <span class="id"><a href="compcert.backend.Asmgenproof0.html#b">b</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#f">f</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c">c</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ep">ep</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#tf">tf</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#tc">tc</a></span>.<br/>
<br/>
<div class="doc">Equivalence between <span class="bracket"><span class="id">transl_code</span></span> and <span class="bracket"><span class="id">transl_code</span>'</span>. </div>
<br/>
<span class="kwd">Local</span> <span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">error_monad_scope</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="transl_code_rec_transl_code">transl_code_rec_transl_code</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">il</span> <span class="id">ep</span> <span class="id">k</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.x86.Asmgen.html#transl_code_rec">transl_code_rec</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#f">f</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#il">il</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ep">ep</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#k">k</a></span> = (<span class="tactic">do</span> <span class="id">c</span> &lt;- <span class="id"><a href="compcert.x86.Asmgen.html#transl_code">transl_code</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#f">f</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#il">il</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ep">ep</a></span>; <span class="id"><a href="compcert.backend.Asmgenproof0.html#k">k</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c">c</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4146')">Proof.</div>
<div class="proofscript" id="proof4146">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">il</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHil</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.x86.Asmgen.html#transl_code">transl_code</a></span> <span class="id">f</span> <span class="id">il</span> (<span class="id"><a href="compcert.x86.Asmgen.html#it1_is_parent">it1_is_parent</a></span> <span class="id">ep</span> <span class="id">a</span>)); <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id">transl_code</span>'<span class="id">_transl_code</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">il</span> <span class="id">ep</span>,<br/>
&nbsp;&nbsp;<span class="id">transl_code</span>' <span class="id"><a href="compcert.backend.Asmgenproof0.html#f">f</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#il">il</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ep">ep</a></span> = <span class="id"><a href="compcert.x86.Asmgen.html#transl_code">transl_code</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#f">f</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#il">il</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ep">ep</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4147')">Proof.</div>
<div class="proofscript" id="proof4147">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id">transl_code</span>'. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#transl_code_rec_transl_code">transl_code_rec_transl_code</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.x86.Asmgen.html#transl_code">transl_code</a></span> <span class="id">f</span> <span class="id">il</span> <span class="id">ep</span>); <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Predictor for return addresses in generated Asm code.
  The <span class="bracket"><span class="id">return_address_offset</span></span> predicate defined here is used in the
  semantics for Mach to determine the return addresses that are
  stored in activation records. </div>
<br/>
<div class="doc">Consider a Mach function <span class="bracket"><span class="id">f</span></span> and a sequence <span class="bracket"><span class="id">c</span></span> of Mach instructions
  representing the Mach code that remains to be executed after a
  function call returns.  The predicate <span class="bracket"><span class="id">return_address_offset</span> <span class="id">f</span> <span class="id">c</span> <span class="id">ofs</span></span>
  holds if <span class="bracket"><span class="id">ofs</span></span> is the integer offset of the PPC instruction
  following the call in the Asm code obtained by translating the
  code of <span class="bracket"><span class="id">f</span></span>. Graphically:
<pre>
     Mach function f    |--------- Mcall ---------|
         Mach code c    |                |--------|
                        |                 \        \
                        |                  \        \
                        |                   \        \
     Asm code           |                    |--------|
     Asm function       |------------- Pcall ---------|

                        &lt;-------- ofs -------&gt;</pre>
</div>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="return_address_offset">return_address_offset</a></span> (<span class="id">f</span>: <span class="id"><a href="compcert.backend.Mach.html#function">Mach.function</a></span>) (<span class="id">c</span>: <span class="id"><a href="compcert.backend.Mach.html#code">Mach.code</a></span>) (<span class="id">ofs</span>: <span class="id"><a href="compcert.lib.Integers.html#ptrofs">ptrofs</a></span>) : <span class="kwd">Prop</span> :=<br/>
| <span class="id"><a name="return_address_offset_intro">return_address_offset_intro</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">tf</span> <span class="id">tc</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">TF</span>: <span class="id"><a href="compcert.x86.Asmgen.html#transf_function">transf_function</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#f">f</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#tf">tf</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">TC</span>: <span class="id"><a href="compcert.x86.Asmgen.html#transl_code">transl_code</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#f">f</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c">c</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#tc">tc</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">TL</span>: <span class="id"><a href="compcert.backend.Asmgenproof0.html#code_tail">code_tail</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ofs">ofs</a></span>) (<span class="id"><a href="compcert.x86.Asm.html#fn_code">fn_code</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#tf">tf</a></span>) <span class="id"><a href="compcert.backend.Asmgenproof0.html#tc">tc</a></span>).<br/>
<br/>
<div class="doc">We now show that such an offset always exists if the Mach code <span class="bracket"><span class="id">c</span></span>
  is a suffix of <span class="bracket"><span class="id">f</span>.(<span class="id">fn_code</span>)</span>.  This holds because the translation
  from Mach to PPC is compositional: each Mach instruction becomes
  zero, one or several PPC instructions, but the order of instructions
  is preserved. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="is_tail_code_tail">is_tail_code_tail</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">c1</span> <span class="id">c2</span>, <span class="id"><a href="compcert.lib.Coqlib.html#is_tail">is_tail</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c1">c1</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c2">c2</a></span> -&gt; <span class="id">exists</span> <span class="id">ofs</span>, <span class="id"><a href="compcert.backend.Asmgenproof0.html#code_tail">code_tail</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c2">c2</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c1">c1</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4148')">Proof.</div>
<div class="proofscript" id="proof4148">
&nbsp;&nbsp;<span class="tactic">induction</span> 1. <span class="id">exists</span> 0; <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">IHis_tail</span> <span class="kwd">as</span> [<span class="id">ofs</span> <span class="id">CT</span>]. <span class="id">exists</span> (<span class="id">ofs</span> + 1); <span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="RETADDR_EXISTS">RETADDR_EXISTS</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="RETADDR_EXISTS.f">f</a></span>: <span class="id"><a href="compcert.backend.Mach.html#function">Mach.function</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="RETADDR_EXISTS.tf">tf</a></span>: <span class="id"><a href="compcert.x86.Asm.html#function">Asm.function</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="RETADDR_EXISTS.transf_function_success">transf_function_success</a></span>: <span class="id"><a href="compcert.x86.Asmgen.html#transf_function">transf_function</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#RETADDR_EXISTS.f">f</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#RETADDR_EXISTS.tf">tf</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="RETADDR_EXISTS.transl_instr_tail">transl_instr_tail</a></span>: <span class="kwd">forall</span> <span class="id">i</span> <span class="id">ep</span> <span class="id">k</span> <span class="id">c</span>, <span class="id"><a href="compcert.x86.Asmgen.html#transl_instr">transl_instr</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#RETADDR_EXISTS.f">f</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#i">i</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ep">ep</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#k">k</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c">c</a></span> -&gt; <span class="id"><a href="compcert.lib.Coqlib.html#is_tail">is_tail</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#k">k</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c">c</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="RETADDR_EXISTS.transf_function_inv">transf_function_inv</a></span>:<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">tc</span>, <span class="id">exists</span> <span class="id">ep</span>, <span class="id"><a href="compcert.x86.Asmgen.html#transl_code">transl_code</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#RETADDR_EXISTS.f">f</a></span> (<span class="id"><a href="compcert.backend.Mach.html#fn_code">Mach.fn_code</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#RETADDR_EXISTS.f">f</a></span>) <span class="id"><a href="compcert.backend.Asmgenproof0.html#ep">ep</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#tc">tc</a></span> /\ <span class="id"><a href="compcert.lib.Coqlib.html#is_tail">is_tail</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#tc">tc</a></span> (<span class="id"><a href="compcert.x86.Asm.html#fn_code">fn_code</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#RETADDR_EXISTS.tf">tf</a></span>).<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="RETADDR_EXISTS.transf_function_len">transf_function_len</a></span>: <span class="id"><a href="compcert.lib.Coqlib.html#list_length_z">list_length_z</a></span> (<span class="id"><a href="compcert.x86.Asm.html#fn_code">fn_code</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#RETADDR_EXISTS.tf">tf</a></span>) &lt;= <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.max_unsigned">Ptrofs.max_unsigned</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="transl_code_tail">transl_code_tail</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">c1</span> <span class="id">c2</span>, <span class="id"><a href="compcert.lib.Coqlib.html#is_tail">is_tail</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c1">c1</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c2">c2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">tc2</span> <span class="id">ep2</span>, <span class="id"><a href="compcert.x86.Asmgen.html#transl_code">transl_code</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#RETADDR_EXISTS.f">f</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c2">c2</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ep2">ep2</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#tc2">tc2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">tc1</span>, <span class="id">exists</span> <span class="id">ep1</span>, <span class="id"><a href="compcert.x86.Asmgen.html#transl_code">transl_code</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#RETADDR_EXISTS.f">f</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c1">c1</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ep1">ep1</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#tc1">tc1</a></span> /\ <span class="id"><a href="compcert.lib.Coqlib.html#is_tail">is_tail</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#tc1">tc1</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#tc2">tc2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4149')">Proof.</div>
<div class="proofscript" id="proof4149">
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">tc2</span>; <span class="id">exists</span> <span class="id">ep2</span>; <span class="tactic">split</span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">coqlib</span>.<br/>
&nbsp;&nbsp;<span class="id">monadInv</span> <span class="id">H0</span>. <span class="id">exploit</span> <span class="id">IHis_tail</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">tc1</span> [<span class="id">ep1</span> [<span class="id">A</span> <span class="id">B</span>]]].<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">tc1</span>; <span class="id">exists</span> <span class="id">ep1</span>; <span class="tactic">split</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#is_tail_trans">is_tail_trans</a></span> <span class="kwd">with</span> <span class="id">x</span>. <span class="tactic">auto</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#RETADDR_EXISTS.transl_instr_tail">transl_instr_tail</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="return_address_exists">return_address_exists</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">sg</span> <span class="id">ros</span> <span class="id">c</span>, <span class="id"><a href="compcert.lib.Coqlib.html#is_tail">is_tail</a></span> (<span class="id"><a href="compcert.backend.Mach.html#Mcall">Mcall</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#sg">sg</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ros">ros</a></span> :: <span class="id"><a href="compcert.backend.Asmgenproof0.html#c">c</a></span>) <span class="id"><a href="compcert.backend.Asmgenproof0.html#RETADDR_EXISTS.f">f</a></span>.(<span class="id"><a href="compcert.backend.Mach.html#fn_code">Mach.fn_code</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">ra</span>, <span class="id"><a href="compcert.backend.Asmgenproof0.html#return_address_offset">return_address_offset</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#RETADDR_EXISTS.f">f</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c">c</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ra">ra</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4150')">Proof.</div>
<div class="proofscript" id="proof4150">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">hexploit</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#RETADDR_EXISTS.transf_function_inv">transf_function_inv</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">tc1</span> &amp; <span class="id">ep1</span> &amp; <span class="id">TR1</span> &amp; <span class="id">TL1</span>).<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#transl_code_tail">transl_code_tail</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">tc2</span> &amp; <span class="id">ep2</span> &amp; <span class="id">TR2</span> &amp; <span class="id">TL2</span>).<br/>
<span class="id">Opaque</span> <span class="id"><a href="compcert.x86.Asmgen.html#transl_instr">transl_instr</a></span>.<br/>
&nbsp;&nbsp;<span class="id">monadInv</span> <span class="id">TR2</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">TL3</span>: <span class="id"><a href="compcert.lib.Coqlib.html#is_tail">is_tail</a></span> <span class="id">x</span> (<span class="id"><a href="compcert.x86.Asm.html#fn_code">fn_code</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#RETADDR_EXISTS.tf">tf</a></span>)).<br/>
&nbsp;&nbsp;{ <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#is_tail_trans">is_tail_trans</a></span> <span class="kwd">with</span> <span class="id">tc1</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#is_tail_trans">is_tail_trans</a></span> <span class="kwd">with</span> <span class="id">tc2</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#RETADDR_EXISTS.transl_instr_tail">transl_instr_tail</a></span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#is_tail_code_tail">is_tail_code_tail</a></span>. <span class="id">eexact</span> <span class="id">TL3</span>. <span class="tactic">intros</span> [<span class="id">ofs</span> <span class="id">CT</span>].<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="compcert.lib.Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> <span class="id">ofs</span>). <span class="id">econs</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.unsigned_repr">Ptrofs.unsigned_repr</a></span>. <span class="id">esplits</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#code_tail_bounds_1">code_tail_bounds_1</a></span>; <span class="tactic">eauto</span>. <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#RETADDR_EXISTS">RETADDR_EXISTS</a></span>.<br/>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="code_tail_no_bigger">code_tail_no_bigger</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">pos</span> <span class="id">c1</span> <span class="id">c2</span>, <span class="id"><a href="compcert.backend.Asmgenproof0.html#code_tail">code_tail</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#pos">pos</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c1">c1</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c2">c2</a></span> -&gt; (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c2">c2</a></span> &lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#length">length</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c1">c1</a></span>)%<span class="id">nat</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4151')">Proof.</div>
<div class="proofscript" id="proof4151">
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">simpl</span>; <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="code_tail_unique">code_tail_unique</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">fn</span> <span class="id">c</span> <span class="id">pos</span> <span class="id">pos</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#code_tail">code_tail</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#pos">pos</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#fn">fn</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c">c</a></span> -&gt; <span class="id"><a href="compcert.backend.Asmgenproof0.html#code_tail">code_tail</a></span> <span class="id">pos</span>' <span class="id"><a href="compcert.backend.Asmgenproof0.html#fn">fn</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c">c</a></span> -&gt; <span class="id"><a href="compcert.backend.Asmgenproof0.html#pos">pos</a></span> = <span class="id">pos</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4152')">Proof.</div>
<div class="proofscript" id="proof4152">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">fn</span>; <span class="tactic">intros</span> <span class="id">until</span> <span class="id">pos</span>'; <span class="tactic">intros</span> <span class="id">ITA</span> <span class="id">CT</span>; <span class="id">inv</span> <span class="id">ITA</span>; <span class="id">inv</span> <span class="id">CT</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="compcert.backend.Asmgenproof0.html#code_tail_no_bigger">code_tail_no_bigger</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H3</span>); <span class="tactic">simpl</span>; <span class="tactic">intro</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="compcert.backend.Asmgenproof0.html#code_tail_no_bigger">code_tail_no_bigger</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H3</span>); <span class="tactic">simpl</span>; <span class="tactic">intro</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">f_equal</span>. <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="return_address_offset_correct">return_address_offset_correct</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ge</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">fb</span> <span class="id">f</span> <span class="id">c</span> <span class="id">tf</span> <span class="id">tc</span> <span class="id">ofs</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#transl_code_at_pc">transl_code_at_pc</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ge">ge</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#b">b</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ofs">ofs</a></span>) <span class="id"><a href="compcert.backend.Asmgenproof0.html#fb">fb</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#f">f</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c">c</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#tf">tf</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#tc">tc</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#return_address_offset">return_address_offset</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#f">f</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c">c</a></span> <span class="id">ofs</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id">ofs</span>' = <span class="id"><a href="compcert.backend.Asmgenproof0.html#ofs">ofs</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4153')">Proof.</div>
<div class="proofscript" id="proof4153">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="id">inv</span> <span class="id">H0</span>. <span class="tactic">rewrite</span> <span class="id">TF</span> <span class="kwd">in</span> *. <span class="id">clarify</span>. <span class="tactic">rewrite</span> <span class="id">TC</span> <span class="kwd">in</span> *. <span class="id">clarify</span>...<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#code_tail_unique">code_tail_unique</a></span>. <span class="id">eexact</span> <span class="id">H12</span>. <span class="id">eexact</span> <span class="id">TL</span>. <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="compcert.lib.Integers.html#Ptrofs.repr_unsigned">Ptrofs.repr_unsigned</a></span> <span class="id">ofs</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="compcert.lib.Integers.html#Ptrofs.repr_unsigned">Ptrofs.repr_unsigned</a></span> <span class="id">ofs</span>').<br/>
&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<div class="doc">The <span class="bracket"><span class="id">find_label</span></span> function returns the code tail starting at the
  given label.  A connection with <span class="bracket"><span class="id">code_tail</span></span> is then established. </div>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="find_label">find_label</a></span> (<span class="id">lbl</span>: <span class="id"><a href="compcert.x86.Asm.html#label">label</a></span>) (<span class="id">c</span>: <span class="id"><a href="compcert.x86.Asm.html#code">code</a></span>) {<span class="kwd">struct</span> <span class="id">c</span>} : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="compcert.x86.Asm.html#code">code</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c">c</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;| <span class="id">instr</span> :: <span class="id">c</span>' =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="compcert.x86.Asm.html#is_label">is_label</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#lbl">lbl</a></span> <span class="id">instr</span> <span class="kwd">then</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">c</span>' <span class="kwd">else</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#find_label">find_label</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#lbl">lbl</a></span> <span class="id">c</span>'<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="label_pos_code_tail">label_pos_code_tail</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">lbl</span> <span class="id">c</span> <span class="id">pos</span> <span class="id">c</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#find_label">find_label</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#lbl">lbl</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c">c</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">c</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">pos</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.x86.Asm.html#label_pos">label_pos</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#lbl">lbl</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#pos">pos</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c">c</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">pos</span>'<br/>
&nbsp;&nbsp;/\ <span class="id"><a href="compcert.backend.Asmgenproof0.html#code_tail">code_tail</a></span> (<span class="id">pos</span>' - <span class="id"><a href="compcert.backend.Asmgenproof0.html#pos">pos</a></span>) <span class="id"><a href="compcert.backend.Asmgenproof0.html#c">c</a></span> <span class="id">c</span>'<br/>
&nbsp;&nbsp;/\ <span class="id"><a href="compcert.backend.Asmgenproof0.html#pos">pos</a></span> &lt; <span class="id">pos</span>' &lt;= <span class="id"><a href="compcert.backend.Asmgenproof0.html#pos">pos</a></span> + <span class="id"><a href="compcert.lib.Coqlib.html#list_length_z">list_length_z</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c">c</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4154')">Proof.</div>
<div class="proofscript" id="proof4154">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">c</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">intros</span>. <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">intros</span> <span class="id">until</span> <span class="id">c</span>'.<br/>
&nbsp;&nbsp;<span class="tactic">case</span> (<span class="id"><a href="compcert.x86.Asm.html#is_label">is_label</a></span> <span class="id">lbl</span> <span class="id">a</span>).<br/>
&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">EQ</span>; <span class="tactic">injection</span> <span class="id">EQ</span>; <span class="tactic">intro</span>; <span class="tactic">subst</span> <span class="id">c</span>'.<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id">pos</span> + 1). <span class="tactic">split</span>. <span class="tactic">auto</span>. <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">pos</span> + 1 - <span class="id">pos</span>) <span class="kwd">with</span> (0 + 1) <span class="tactic">by</span> <span class="tactic">omega</span>. <span class="id">constructor</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#list_length_z_cons">list_length_z_cons</a></span>. <span class="tactic">generalize</span> (<span class="id"><a href="compcert.lib.Coqlib.html#list_length_z_pos">list_length_z_pos</a></span> <span class="id">c</span>). <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">generalize</span> (<span class="id">IHc</span> (<span class="id">pos</span> + 1) <span class="id">c</span>' <span class="id">H</span>). <span class="tactic">intros</span> [<span class="id">pos</span>' [<span class="id">A</span> [<span class="id">B</span> <span class="id">C</span>]]].<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">pos</span>'. <span class="tactic">split</span>. <span class="tactic">auto</span>. <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">pos</span>' - <span class="id">pos</span>) <span class="kwd">with</span> ((<span class="id">pos</span>' - (<span class="id">pos</span> + 1)) + 1) <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#list_length_z_cons">list_length_z_cons</a></span>. <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Helper lemmas to reason about
<ul>
<li>
 the "code is tail of" property
</li>
<li>
 correct translation of labels. </li>
</ul>
</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="tail_nolabel">tail_nolabel</a></span> (<span class="id">k</span> <span class="id">c</span>: <span class="id"><a href="compcert.x86.Asm.html#code">code</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#is_tail">is_tail</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#k">k</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c">c</a></span> /\ <span class="kwd">forall</span> <span class="id">lbl</span>, <span class="id"><a href="compcert.backend.Asmgenproof0.html#find_label">find_label</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#lbl">lbl</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c">c</a></span> = <span class="id"><a href="compcert.backend.Asmgenproof0.html#find_label">find_label</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#lbl">lbl</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#k">k</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="tail_nolabel_refl">tail_nolabel_refl</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">c</span>, <span class="id"><a href="compcert.backend.Asmgenproof0.html#tail_nolabel">tail_nolabel</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c">c</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c">c</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4155')">Proof.</div>
<div class="proofscript" id="proof4155">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#is_tail_refl">is_tail_refl</a></span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="tail_nolabel_trans">tail_nolabel_trans</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">c1</span> <span class="id">c2</span> <span class="id">c3</span>, <span class="id"><a href="compcert.backend.Asmgenproof0.html#tail_nolabel">tail_nolabel</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c2">c2</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c3">c3</a></span> -&gt; <span class="id"><a href="compcert.backend.Asmgenproof0.html#tail_nolabel">tail_nolabel</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c1">c1</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c2">c2</a></span> -&gt; <span class="id"><a href="compcert.backend.Asmgenproof0.html#tail_nolabel">tail_nolabel</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c1">c1</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c3">c3</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4156')">Proof.</div>
<div class="proofscript" id="proof4156">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H</span>; <span class="tactic">destruct</span> <span class="id">H0</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.lib.Coqlib.html#is_tail_trans">is_tail_trans</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id">H1</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="nolabel">nolabel</a></span> (<span class="id">i</span>: <span class="id"><a href="compcert.x86.Asm.html#instruction">instruction</a></span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#i">i</a></span> <span class="kwd">with</span> <span class="id"><a href="compcert.x86.Asm.html#Plabel">Plabel</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span> | <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span> <span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Extern</span> 1 (<span class="id"><a href="compcert.backend.Asmgenproof0.html#nolabel">nolabel</a></span> <span class="id">_</span>) =&gt; <span class="tactic">exact</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#I">I</a></span> : <span class="id">labels</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="tail_nolabel_cons">tail_nolabel_cons</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">i</span> <span class="id">c</span> <span class="id">k</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#nolabel">nolabel</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#i">i</a></span> -&gt; <span class="id"><a href="compcert.backend.Asmgenproof0.html#tail_nolabel">tail_nolabel</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#k">k</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c">c</a></span> -&gt; <span class="id"><a href="compcert.backend.Asmgenproof0.html#tail_nolabel">tail_nolabel</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#k">k</a></span> (<span class="id"><a href="compcert.backend.Asmgenproof0.html#i">i</a></span> :: <span class="id"><a href="compcert.backend.Asmgenproof0.html#c">c</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4157')">Proof.</div>
<div class="proofscript" id="proof4157">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H0</span>. <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">H1</span>. <span class="tactic">destruct</span> <span class="id">i</span>; <span class="tactic">reflexivity</span> || <span class="id">contradiction</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">tail_nolabel_refl</span>: <span class="id">labels</span>.<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">TailNoLabel</span> :=<br/>
&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">labels</span>;<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| [ |- <span class="id"><a href="compcert.backend.Asmgenproof0.html#tail_nolabel">tail_nolabel</a></span> <span class="id">_</span> (<span class="id">_</span> :: <span class="id">_</span>) ] =&gt; <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#tail_nolabel_cons">tail_nolabel_cons</a></span>; [<span class="tactic">auto</span>; <span class="tactic">exact</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#I">I</a></span> | <span class="id">TailNoLabel</span>]<br/>
&nbsp;&nbsp;| [ <span class="id">H</span>: <span class="id"><a href="compcert.common.Errors.html#Error">Error</a></span> <span class="id">_</span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id">_</span> |- <span class="id">_</span> ] =&gt; <span class="tactic">discriminate</span><br/>
&nbsp;&nbsp;| [ <span class="id">H</span>: <span class="id"><a href="compcert.common.Errors.html#assertion_failed">assertion_failed</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id">_</span> |- <span class="id">_</span> ] =&gt; <span class="tactic">discriminate</span><br/>
&nbsp;&nbsp;| [ <span class="id">H</span>: <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id">_</span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id">_</span> |- <span class="id">_</span> ] =&gt; <span class="id">inv</span> <span class="id">H</span>; <span class="id">TailNoLabel</span><br/>
&nbsp;&nbsp;| [ <span class="id">H</span>: <span class="id"><a href="compcert.common.Errors.html#bind">bind</a></span> <span class="id">_</span> <span class="id">_</span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id">_</span> |- <span class="id">_</span> ] =&gt; <span class="id">monadInv</span> <span class="id">H</span>;  <span class="id">TailNoLabel</span><br/>
&nbsp;&nbsp;| [ <span class="id">H</span>: (<span class="kwd">if</span> ?<span class="id">x</span> <span class="kwd">then</span> <span class="id">_</span> <span class="kwd">else</span> <span class="id">_</span>) = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id">_</span> |- <span class="id">_</span> ] =&gt; <span class="tactic">destruct</span> <span class="id">x</span>; <span class="id">TailNoLabel</span><br/>
&nbsp;&nbsp;| [ <span class="id">H</span>: <span class="kwd">match</span> ?<span class="id">x</span> <span class="kwd">with</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; <span class="id">_</span> | <span class="id">_</span> :: <span class="id">_</span> =&gt; <span class="id">_</span> <span class="kwd">end</span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id">_</span> |- <span class="id">_</span> ] =&gt; <span class="tactic">destruct</span> <span class="id">x</span>; <span class="id">TailNoLabel</span><br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">idtac</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="tail_nolabel_find_label">tail_nolabel_find_label</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">lbl</span> <span class="id">k</span> <span class="id">c</span>, <span class="id"><a href="compcert.backend.Asmgenproof0.html#tail_nolabel">tail_nolabel</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#k">k</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c">c</a></span> -&gt; <span class="id"><a href="compcert.backend.Asmgenproof0.html#find_label">find_label</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#lbl">lbl</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c">c</a></span> = <span class="id"><a href="compcert.backend.Asmgenproof0.html#find_label">find_label</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#lbl">lbl</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#k">k</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4158')">Proof.</div>
<div class="proofscript" id="proof4158">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="tail_nolabel_is_tail">tail_nolabel_is_tail</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">k</span> <span class="id">c</span>, <span class="id"><a href="compcert.backend.Asmgenproof0.html#tail_nolabel">tail_nolabel</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#k">k</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c">c</a></span> -&gt; <span class="id"><a href="compcert.lib.Coqlib.html#is_tail">is_tail</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#k">k</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c">c</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4159')">Proof.</div>
<div class="proofscript" id="proof4159">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<h1> Execution of straight-line code </h1>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="STRAIGHTLINE">STRAIGHTLINE</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="STRAIGHTLINE.se">se</a></span>: <span class="id"><a href="compcert.common.Globalenvs.html#Senv.t">Senv.t</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="STRAIGHTLINE.ge">ge</a></span>: <span class="id"><a href="compcert.x86.Asm.html#genv">genv</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="STRAIGHTLINE.fn">fn</a></span>: <span class="id"><a href="compcert.x86.Asm.html#function">function</a></span>.<br/>
<br/>
<div class="doc">Straight-line code is composed of processor instructions that execute
  in sequence (no branches, no function calls and returns).
  The following inductive predicate relates the machine states
  before and after executing a straight-line sequence of instructions.
  Instructions are taken from the first list instead of being fetched
  from memory. </div>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="exec_straight">exec_straight</a></span>: <span class="id"><a href="compcert.x86.Asm.html#code">code</a></span> -&gt; <span class="id"><a href="compcert.x86.Asm.html#regset">regset</a></span> -&gt; <span class="id"><a href="compcert.common.Memory.html#mem">mem</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.x86.Asm.html#code">code</a></span> -&gt; <span class="id"><a href="compcert.x86.Asm.html#regset">regset</a></span> -&gt; <span class="id"><a href="compcert.common.Memory.html#mem">mem</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="exec_straight_one">exec_straight_one</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">i1</span> <span class="id">c</span> <span class="id">rs1</span> <span class="id">m1</span> <span class="id">rs2</span> <span class="id">m2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.x86.Asm.html#exec_instr">exec_instr</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#STRAIGHTLINE.ge">ge</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#STRAIGHTLINE.fn">fn</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#i1">i1</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs1">rs1</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#m1">m1</a></span> = <span class="kwd">Next</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs2">rs2</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#rs2">rs2</a></span>#<span class="id"><a href="compcert.x86.Asm.html#PC">PC</a></span> = <span class="id"><a href="compcert.common.Values.html#Val.offset_ptr">Val.offset_ptr</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs1">rs1</a></span>#<span class="id"><a href="compcert.x86.Asm.html#PC">PC</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.one">Ptrofs.one</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#exec_straight">exec_straight</a></span> (<span class="id"><a href="compcert.backend.Asmgenproof0.html#i1">i1</a></span> :: <span class="id"><a href="compcert.backend.Asmgenproof0.html#c">c</a></span>) <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs1">rs1</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#m1">m1</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c">c</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs2">rs2</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#m2">m2</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="exec_straight_step">exec_straight_step</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">i</span> <span class="id">c</span> <span class="id">rs1</span> <span class="id">m1</span> <span class="id">rs2</span> <span class="id">m2</span> <span class="id">c</span>' <span class="id">rs3</span> <span class="id">m3</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.x86.Asm.html#exec_instr">exec_instr</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#STRAIGHTLINE.ge">ge</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#STRAIGHTLINE.fn">fn</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#i">i</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs1">rs1</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#m1">m1</a></span> = <span class="kwd">Next</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs2">rs2</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#rs2">rs2</a></span>#<span class="id"><a href="compcert.x86.Asm.html#PC">PC</a></span> = <span class="id"><a href="compcert.common.Values.html#Val.offset_ptr">Val.offset_ptr</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs1">rs1</a></span>#<span class="id"><a href="compcert.x86.Asm.html#PC">PC</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.one">Ptrofs.one</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#exec_straight">exec_straight</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c">c</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs2">rs2</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#m2">m2</a></span> <span class="id">c</span>' <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs3">rs3</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#m3">m3</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#exec_straight">exec_straight</a></span> (<span class="id"><a href="compcert.backend.Asmgenproof0.html#i">i</a></span> :: <span class="id"><a href="compcert.backend.Asmgenproof0.html#c">c</a></span>) <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs1">rs1</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#m1">m1</a></span> <span class="id">c</span>' <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs3">rs3</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#m3">m3</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="exec_straight_trans">exec_straight_trans</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">c1</span> <span class="id">rs1</span> <span class="id">m1</span> <span class="id">c2</span> <span class="id">rs2</span> <span class="id">m2</span> <span class="id">c3</span> <span class="id">rs3</span> <span class="id">m3</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#exec_straight">exec_straight</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c1">c1</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs1">rs1</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#m1">m1</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c2">c2</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs2">rs2</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#exec_straight">exec_straight</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c2">c2</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs2">rs2</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#m2">m2</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c3">c3</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs3">rs3</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#m3">m3</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#exec_straight">exec_straight</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c1">c1</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs1">rs1</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#m1">m1</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c3">c3</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs3">rs3</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#m3">m3</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4160')">Proof.</div>
<div class="proofscript" id="proof4160">
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#exec_straight_step">exec_straight_step</a></span> <span class="kwd">with</span> <span class="id">rs2</span> <span class="id">m2</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#exec_straight_step">exec_straight_step</a></span> <span class="kwd">with</span> <span class="id">rs2</span> <span class="id">m2</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="exec_straight_two">exec_straight_two</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">i1</span> <span class="id">i2</span> <span class="id">c</span> <span class="id">rs1</span> <span class="id">m1</span> <span class="id">rs2</span> <span class="id">m2</span> <span class="id">rs3</span> <span class="id">m3</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.x86.Asm.html#exec_instr">exec_instr</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#STRAIGHTLINE.ge">ge</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#STRAIGHTLINE.fn">fn</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#i1">i1</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs1">rs1</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#m1">m1</a></span> = <span class="kwd">Next</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs2">rs2</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.x86.Asm.html#exec_instr">exec_instr</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#STRAIGHTLINE.ge">ge</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#STRAIGHTLINE.fn">fn</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#i2">i2</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs2">rs2</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#m2">m2</a></span> = <span class="kwd">Next</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs3">rs3</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#m3">m3</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#rs2">rs2</a></span>#<span class="id"><a href="compcert.x86.Asm.html#PC">PC</a></span> = <span class="id"><a href="compcert.common.Values.html#Val.offset_ptr">Val.offset_ptr</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs1">rs1</a></span>#<span class="id"><a href="compcert.x86.Asm.html#PC">PC</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.one">Ptrofs.one</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#rs3">rs3</a></span>#<span class="id"><a href="compcert.x86.Asm.html#PC">PC</a></span> = <span class="id"><a href="compcert.common.Values.html#Val.offset_ptr">Val.offset_ptr</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs2">rs2</a></span>#<span class="id"><a href="compcert.x86.Asm.html#PC">PC</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.one">Ptrofs.one</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#exec_straight">exec_straight</a></span> (<span class="id"><a href="compcert.backend.Asmgenproof0.html#i1">i1</a></span> :: <span class="id"><a href="compcert.backend.Asmgenproof0.html#i2">i2</a></span> :: <span class="id"><a href="compcert.backend.Asmgenproof0.html#c">c</a></span>) <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs1">rs1</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#m1">m1</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c">c</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs3">rs3</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#m3">m3</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4161')">Proof.</div>
<div class="proofscript" id="proof4161">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#exec_straight_step">exec_straight_step</a></span> <span class="kwd">with</span> <span class="id">rs2</span> <span class="id">m2</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#exec_straight_one">exec_straight_one</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="exec_straight_three">exec_straight_three</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">i1</span> <span class="id">i2</span> <span class="id">i3</span> <span class="id">c</span> <span class="id">rs1</span> <span class="id">m1</span> <span class="id">rs2</span> <span class="id">m2</span> <span class="id">rs3</span> <span class="id">m3</span> <span class="id">rs4</span> <span class="id">m4</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.x86.Asm.html#exec_instr">exec_instr</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#STRAIGHTLINE.ge">ge</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#STRAIGHTLINE.fn">fn</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#i1">i1</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs1">rs1</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#m1">m1</a></span> = <span class="kwd">Next</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs2">rs2</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#m2">m2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.x86.Asm.html#exec_instr">exec_instr</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#STRAIGHTLINE.ge">ge</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#STRAIGHTLINE.fn">fn</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#i2">i2</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs2">rs2</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#m2">m2</a></span> = <span class="kwd">Next</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs3">rs3</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#m3">m3</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.x86.Asm.html#exec_instr">exec_instr</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#STRAIGHTLINE.ge">ge</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#STRAIGHTLINE.fn">fn</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#i3">i3</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs3">rs3</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#m3">m3</a></span> = <span class="kwd">Next</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs4">rs4</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#m4">m4</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#rs2">rs2</a></span>#<span class="id"><a href="compcert.x86.Asm.html#PC">PC</a></span> = <span class="id"><a href="compcert.common.Values.html#Val.offset_ptr">Val.offset_ptr</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs1">rs1</a></span>#<span class="id"><a href="compcert.x86.Asm.html#PC">PC</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.one">Ptrofs.one</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#rs3">rs3</a></span>#<span class="id"><a href="compcert.x86.Asm.html#PC">PC</a></span> = <span class="id"><a href="compcert.common.Values.html#Val.offset_ptr">Val.offset_ptr</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs2">rs2</a></span>#<span class="id"><a href="compcert.x86.Asm.html#PC">PC</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.one">Ptrofs.one</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#rs4">rs4</a></span>#<span class="id"><a href="compcert.x86.Asm.html#PC">PC</a></span> = <span class="id"><a href="compcert.common.Values.html#Val.offset_ptr">Val.offset_ptr</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs3">rs3</a></span>#<span class="id"><a href="compcert.x86.Asm.html#PC">PC</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.one">Ptrofs.one</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#exec_straight">exec_straight</a></span> (<span class="id"><a href="compcert.backend.Asmgenproof0.html#i1">i1</a></span> :: <span class="id"><a href="compcert.backend.Asmgenproof0.html#i2">i2</a></span> :: <span class="id"><a href="compcert.backend.Asmgenproof0.html#i3">i3</a></span> :: <span class="id"><a href="compcert.backend.Asmgenproof0.html#c">c</a></span>) <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs1">rs1</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#m1">m1</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c">c</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs4">rs4</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#m4">m4</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4162')">Proof.</div>
<div class="proofscript" id="proof4162">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#exec_straight_step">exec_straight_step</a></span> <span class="kwd">with</span> <span class="id">rs2</span> <span class="id">m2</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#exec_straight_two">exec_straight_two</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">The following lemmas show that straight-line executions
  (predicate <span class="bracket"><span class="id">exec_straight</span></span>) correspond to correct Asm executions. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="exec_straight_steps_1">exec_straight_steps_1</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">c</span> <span class="id">rs</span> <span class="id">m</span> <span class="id">c</span>' <span class="id">rs</span>' <span class="id">m</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#exec_straight">exec_straight</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c">c</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#m">m</a></span> <span class="id">c</span>' <span class="id">rs</span>' <span class="id">m</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#list_length_z">list_length_z</a></span> (<span class="id"><a href="compcert.x86.Asm.html#fn_code">fn_code</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#STRAIGHTLINE.fn">fn</a></span>) &lt;= <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.max_unsigned">Ptrofs.max_unsigned</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span> <span class="id">ofs</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span>#<span class="id"><a href="compcert.x86.Asm.html#PC">PC</a></span> = <span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#b">b</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ofs">ofs</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_funct_ptr">Genv.find_funct_ptr</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#STRAIGHTLINE.ge">ge</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#b">b</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="compcert.common.AST.html#Internal">Internal</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#STRAIGHTLINE.fn">fn</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#code_tail">code_tail</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ofs">ofs</a></span>) (<span class="id"><a href="compcert.x86.Asm.html#fn_code">fn_code</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#STRAIGHTLINE.fn">fn</a></span>) <span class="id"><a href="compcert.backend.Asmgenproof0.html#c">c</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Smallstep.html#plus">plus</a></span> <span class="id"><a href="compcert.x86.Asm.html#step">step</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#STRAIGHTLINE.se">se</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#STRAIGHTLINE.ge">ge</a></span> (<span class="id"><a href="compcert.x86.Asm.html#State">State</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#m">m</a></span>) <span class="id"><a href="compcert.common.Events.html#E0">E0</a></span> (<span class="id"><a href="compcert.x86.Asm.html#State">State</a></span> <span class="id">rs</span>' <span class="id">m</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4163')">Proof.</div>
<div class="proofscript" id="proof4163">
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one</a></span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#find_instr_tail">find_instr_tail</a></span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">plus_left</span>'.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#find_instr_tail">find_instr_tail</a></span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHexec_straight</span> <span class="kwd">with</span> <span class="id">b</span> (<span class="id"><a href="compcert.lib.Integers.html#Ptrofs.add">Ptrofs.add</a></span> <span class="id">ofs</span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.one">Ptrofs.one</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">rewrite</span> <span class="id">H0</span>. <span class="tactic">rewrite</span> <span class="id">H3</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#code_tail_next_int">code_tail_next_int</a></span> <span class="kwd">with</span> <span class="id">i</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">traceEq</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="exec_straight_steps_2">exec_straight_steps_2</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">c</span> <span class="id">rs</span> <span class="id">m</span> <span class="id">c</span>' <span class="id">rs</span>' <span class="id">m</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#exec_straight">exec_straight</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c">c</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#m">m</a></span> <span class="id">c</span>' <span class="id">rs</span>' <span class="id">m</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#list_length_z">list_length_z</a></span> (<span class="id"><a href="compcert.x86.Asm.html#fn_code">fn_code</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#STRAIGHTLINE.fn">fn</a></span>) &lt;= <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.max_unsigned">Ptrofs.max_unsigned</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span> <span class="id">ofs</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#rs">rs</a></span>#<span class="id"><a href="compcert.x86.Asm.html#PC">PC</a></span> = <span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#b">b</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ofs">ofs</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_funct_ptr">Genv.find_funct_ptr</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#STRAIGHTLINE.ge">ge</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#b">b</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="compcert.common.AST.html#Internal">Internal</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#STRAIGHTLINE.fn">fn</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#code_tail">code_tail</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ofs">ofs</a></span>) (<span class="id"><a href="compcert.x86.Asm.html#fn_code">fn_code</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#STRAIGHTLINE.fn">fn</a></span>) <span class="id"><a href="compcert.backend.Asmgenproof0.html#c">c</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">ofs</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rs</span>'#<span class="id"><a href="compcert.x86.Asm.html#PC">PC</a></span> = <span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#b">b</a></span> <span class="id">ofs</span>'<br/>
&nbsp;&nbsp;/\ <span class="id"><a href="compcert.backend.Asmgenproof0.html#code_tail">code_tail</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span> <span class="id">ofs</span>') (<span class="id"><a href="compcert.x86.Asm.html#fn_code">fn_code</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#STRAIGHTLINE.fn">fn</a></span>) <span class="id">c</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4164')">Proof.</div>
<div class="proofscript" id="proof4164">
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="compcert.lib.Integers.html#Ptrofs.add">Ptrofs.add</a></span> <span class="id">ofs</span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.one">Ptrofs.one</a></span>). <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H0</span>. <span class="tactic">rewrite</span> <span class="id">H2</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#code_tail_next_int">code_tail_next_int</a></span> <span class="kwd">with</span> <span class="id">i1</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHexec_straight</span> <span class="kwd">with</span> (<span class="id"><a href="compcert.lib.Integers.html#Ptrofs.add">Ptrofs.add</a></span> <span class="id">ofs</span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.one">Ptrofs.one</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">rewrite</span> <span class="id">H0</span>. <span class="tactic">rewrite</span> <span class="id">H3</span>. <span class="tactic">reflexivity</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#code_tail_next_int">code_tail_next_int</a></span> <span class="kwd">with</span> <span class="id">i</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#STRAIGHTLINE">STRAIGHTLINE</a></span>.<br/>
<br/>
<h1> Properties of the Mach call stack </h1>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="MATCH_STACK">MATCH_STACK</a></span>.<br/>
<br/>
<span class="kwd">Context</span> {<span class="id">CTX</span>: <span class="id"><a href="compcert.backend.Conventions.html#main_args_ctx">main_args_ctx</a></span>}.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="MATCH_STACK.ge">ge</a></span>: <span class="id"><a href="compcert.backend.Mach.html#genv">Mach.genv</a></span>.<br/>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="match_stack">match_stack</a></span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.backend.Mach.html#stackframe">Mach.stackframe</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="match_stack_nil">match_stack_nil</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">MAINARGS</span>: <span class="id"><a href="compcert.backend.Conventions.html#main_args">main_args</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#match_stack">match_stack</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="match_stack_dummy">match_stack_dummy</a></span> <span class="id">initial_parent_sp</span> <span class="id">initial_parent_ra</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">MAINARGS</span>: <span class="id"><a href="compcert.backend.Conventions.html#main_args">main_args</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">INITSPDEF</span>: <span class="id"><a href="compcert.backend.Asmgenproof0.html#initial_parent_sp">initial_parent_sp</a></span> &lt;&gt; <span class="id"><a href="compcert.common.Values.html#Vundef">Vundef</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#match_stack">match_stack</a></span> ((<span class="id"><a href="compcert.backend.Mach.html#dummy_stack">dummy_stack</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#initial_parent_sp">initial_parent_sp</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#initial_parent_ra">initial_parent_ra</a></span>)::[])<br/>
&nbsp;&nbsp;| <span class="id"><a name="match_stack_cons">match_stack_cons</a></span>: <span class="kwd">forall</span> <span class="id">fb</span> <span class="id">sp</span> <span class="id">ra</span> <span class="id">c</span> <span class="id">s</span> <span class="id">f</span> <span class="id">tf</span> <span class="id">tc</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_funct_ptr">Genv.find_funct_ptr</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#MATCH_STACK.ge">ge</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#fb">fb</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="compcert.common.AST.html#Internal">Internal</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#f">f</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#transl_code_at_pc">transl_code_at_pc</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#MATCH_STACK.ge">ge</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ra">ra</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#fb">fb</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#f">f</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c">c</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#tf">tf</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#tc">tc</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">OFSZERO</span>: <span class="kwd">forall</span> <span class="id">ofs</span> <span class="id">blk</span> (<span class="id">SPOFS</span>: <span class="id"><a href="compcert.backend.Asmgenproof0.html#sp">sp</a></span> = <span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#blk">blk</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ofs">ofs</a></span>), <span class="id"><a href="compcert.backend.Asmgenproof0.html#ofs">ofs</a></span> = <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#sp">sp</a></span> &lt;&gt; <span class="id"><a href="compcert.common.Values.html#Vundef">Vundef</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#match_stack">match_stack</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#s">s</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#match_stack">match_stack</a></span> (<span class="id"><a href="compcert.backend.Mach.html#Stackframe">Stackframe</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#fb">fb</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#ra">ra</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#c">c</a></span> :: <span class="id"><a href="compcert.backend.Asmgenproof0.html#s">s</a></span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="parent_sp_def">parent_sp_def</a></span>: <span class="kwd">forall</span> <span class="id">s</span>, <span class="id"><a href="compcert.backend.Asmgenproof0.html#match_stack">match_stack</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#s">s</a></span> -&gt; <span class="id"><a href="compcert.backend.Mach.html#parent_sp">parent_sp</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#s">s</a></span> &lt;&gt; <span class="id"><a href="compcert.common.Values.html#Vundef">Vundef</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4165')">Proof.</div>
<div class="proofscript" id="proof4165">
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.common.Values.html#Vnullptr">Vnullptr</a></span>; <span class="tactic">destruct</span> <span class="id"><a href="compcert.x86_64.Archi.html#ptr64">Archi.ptr64</a></span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="lessdef_parent_sp">lessdef_parent_sp</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Asmgenproof0.html#match_stack">match_stack</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#s">s</a></span> -&gt; <span class="id"><a href="compcert.common.Values.html#Val.lessdef">Val.lessdef</a></span> (<span class="id"><a href="compcert.backend.Mach.html#parent_sp">parent_sp</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#s">s</a></span>) <span class="id"><a href="compcert.backend.Asmgenproof0.html#v">v</a></span> -&gt; <span class="id"><a href="compcert.backend.Asmgenproof0.html#v">v</a></span> = <span class="id"><a href="compcert.backend.Mach.html#parent_sp">parent_sp</a></span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#s">s</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4166')">Proof.</div>
<div class="proofscript" id="proof4166">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H0</span>. <span class="tactic">auto</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#parent_sp_def">parent_sp_def</a></span>; <span class="tactic">eauto</span>. <span class="tactic">tauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.backend.Asmgenproof0.html#MATCH_STACK">MATCH_STACK</a></span>.<br/>
<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</div>
</body>
</html>
