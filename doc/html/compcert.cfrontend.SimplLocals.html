
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module SimplLocals</title>
<meta name="description" content="Documentation of Coq module SimplLocals" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module SimplLocals</h1>
<div class="coq">
<br/>
<div class="doc">Pulling local scalar variables whose address is not taken
  into temporary variables. </div>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.FSets.FSets.html">FSets</a></span>.<br/>
<span class="kwd">Require</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.FSets.FSetAVL.html">FSetAVL</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.lib.Coqlib.html">Coqlib</a></span> <span class="id"><a href="compcert.lib.Ordered.html">Ordered</a></span> <span class="id"><a href="compcert.common.Errors.html">Errors</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.common.AST.html">AST</a></span> <span class="id"><a href="compcert.common.Linking.html">Linking</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html">Ctypes</a></span> <span class="id"><a href="compcert.cfrontend.Cop.html">Cop</a></span> <span class="id"><a href="compcert.cfrontend.Clight.html">Clight</a></span>.<br/>
<span class="kwd">Require</span> <span class="id"><a href="compcert.driver.Compopts.html">Compopts</a></span>.<br/>
<br/>
<span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">error_monad_scope</span>.<br/>
<span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">string_scope</span>.<br/>
<span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">list_scope</span>.<br/>
<br/>
<span class="kwd">Module</span> <span class="id"><a name="VSet">VSet</a></span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.FSets.FSetAVL.html#Make">FSetAVL.Make</a></span>(<span class="id"><a href="compcert.lib.Ordered.html#OrderedPositive">OrderedPositive</a></span>).<br/>
<br/>
<div class="doc">The set of local variables that can be lifted to temporaries,
  because they are scalar and their address is not taken. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="compilenv">compilenv</a></span> := <span class="id"><a href="compcert.cfrontend.SimplLocals.html#t">VSet.t</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="is_liftable_var">is_liftable_var</a></span> (<span class="id">cenv</span>: <span class="id"><a href="compcert.cfrontend.SimplLocals.html#compilenv">compilenv</a></span>) (<span class="id">a</span>: <span class="id"><a href="compcert.cfrontend.Clight.html#expr">expr</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="compcert.common.AST.html#ident">ident</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#a">a</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Clight.html#Evar">Evar</a></span> <span class="id">id</span> <span class="id">ty</span> =&gt; <span class="kwd">if</span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#mem">VSet.mem</a></span> <span class="id">id</span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#cenv">cenv</a></span> <span class="kwd">then</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">id</span> <span class="kwd">else</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<div class="doc">Smart constructor for casts </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="make_cast">make_cast</a></span> (<span class="id">a</span>: <span class="id"><a href="compcert.cfrontend.Clight.html#expr">expr</a></span>) (<span class="id">tto</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#type">type</a></span>) : <span class="id"><a href="compcert.cfrontend.Clight.html#expr">expr</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.cfrontend.Cop.html#classify_cast">classify_cast</a></span> (<span class="id"><a href="compcert.cfrontend.Clight.html#typeof">typeof</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#a">a</a></span>) <span class="id"><a href="compcert.cfrontend.SimplLocals.html#tto">tto</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Cop.html#cast_case_pointer">cast_case_pointer</a></span> =&gt; <span class="id"><a href="compcert.cfrontend.SimplLocals.html#a">a</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Cop.html#cast_case_i2i">cast_case_i2i</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#I32">I32</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="compcert.cfrontend.SimplLocals.html#a">a</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Cop.html#cast_case_f2f">cast_case_f2f</a></span> =&gt; <span class="id"><a href="compcert.cfrontend.SimplLocals.html#a">a</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Cop.html#cast_case_s2s">cast_case_s2s</a></span> =&gt; <span class="id"><a href="compcert.cfrontend.SimplLocals.html#a">a</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Cop.html#cast_case_l2l">cast_case_l2l</a></span> =&gt; <span class="id"><a href="compcert.cfrontend.SimplLocals.html#a">a</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Cop.html#cast_case_struct">cast_case_struct</a></span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="compcert.cfrontend.SimplLocals.html#a">a</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Cop.html#cast_case_union">cast_case_union</a></span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="compcert.cfrontend.SimplLocals.html#a">a</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Cop.html#cast_case_void">cast_case_void</a></span> =&gt; <span class="id"><a href="compcert.cfrontend.SimplLocals.html#a">a</a></span><br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="compcert.cfrontend.Clight.html#Ecast">Ecast</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#a">a</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#tto">tto</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<div class="doc">Insertion of debug annotations </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Sdebug_temp">Sdebug_temp</a></span> (<span class="id">id</span>: <span class="id"><a href="compcert.common.AST.html#ident">ident</a></span>) (<span class="id">ty</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#type">type</a></span>) :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Clight.html#Sbuiltin">Sbuiltin</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> (<span class="id"><a href="compcert.common.AST.html#EF_debug">EF_debug</a></span> 2%<span class="id">positive</span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#id">id</a></span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#typ_of_type">typ_of_type</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#ty">ty</a></span> :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.cfrontend.Ctypes.html#Tcons">Tcons</a></span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#typeconv">typeconv</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#ty">ty</a></span>) <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tnil">Tnil</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.cfrontend.Clight.html#Etempvar">Etempvar</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#id">id</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#ty">ty</a></span> :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Sdebug_var">Sdebug_var</a></span> (<span class="id">id</span>: <span class="id"><a href="compcert.common.AST.html#ident">ident</a></span>) (<span class="id">ty</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#type">type</a></span>) :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Clight.html#Sbuiltin">Sbuiltin</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> (<span class="id"><a href="compcert.common.AST.html#EF_debug">EF_debug</a></span> 5%<span class="id">positive</span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#id">id</a></span> (<span class="id"><a href="compcert.common.AST.html#Tptr">AST.Tptr</a></span> :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.cfrontend.Ctypes.html#Tcons">Tcons</a></span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#Tpointer">Tpointer</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#ty">ty</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#noattr">noattr</a></span>) <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tnil">Tnil</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.cfrontend.Clight.html#Eaddrof">Eaddrof</a></span> (<span class="id"><a href="compcert.cfrontend.Clight.html#Evar">Evar</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#id">id</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#ty">ty</a></span>) (<span class="id"><a href="compcert.cfrontend.Ctypes.html#Tpointer">Tpointer</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#ty">ty</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#noattr">noattr</a></span>) :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Sset_debug">Sset_debug</a></span> (<span class="id">id</span>: <span class="id"><a href="compcert.common.AST.html#ident">ident</a></span>) (<span class="id">ty</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#type">type</a></span>) (<span class="id">a</span>: <span class="id"><a href="compcert.cfrontend.Clight.html#expr">expr</a></span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="compcert.driver.Compopts.html#debug">Compopts.debug</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;<span class="kwd">then</span> <span class="id"><a href="compcert.cfrontend.Clight.html#Ssequence">Ssequence</a></span> (<span class="id"><a href="compcert.cfrontend.Clight.html#Sset">Sset</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#id">id</a></span> (<span class="id"><a href="compcert.cfrontend.SimplLocals.html#make_cast">make_cast</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#a">a</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#ty">ty</a></span>)) (<span class="id"><a href="compcert.cfrontend.SimplLocals.html#Sdebug_temp">Sdebug_temp</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#id">id</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#ty">ty</a></span>)<br/>
&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="compcert.cfrontend.Clight.html#Sset">Sset</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#id">id</a></span> (<span class="id"><a href="compcert.cfrontend.SimplLocals.html#make_cast">make_cast</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#a">a</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#ty">ty</a></span>).<br/>
<br/>
<div class="doc">Rewriting of expressions and statements. </div>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="simpl_expr">simpl_expr</a></span> (<span class="id">cenv</span>: <span class="id"><a href="compcert.cfrontend.SimplLocals.html#compilenv">compilenv</a></span>) (<span class="id">a</span>: <span class="id"><a href="compcert.cfrontend.Clight.html#expr">expr</a></span>) : <span class="id"><a href="compcert.cfrontend.Clight.html#expr">expr</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#a">a</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Clight.html#Econst_int">Econst_int</a></span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="compcert.cfrontend.SimplLocals.html#a">a</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Clight.html#Econst_float">Econst_float</a></span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="compcert.cfrontend.SimplLocals.html#a">a</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Clight.html#Econst_single">Econst_single</a></span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="compcert.cfrontend.SimplLocals.html#a">a</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Clight.html#Econst_long">Econst_long</a></span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="compcert.cfrontend.SimplLocals.html#a">a</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Clight.html#Evar">Evar</a></span> <span class="id">id</span> <span class="id">ty</span> =&gt; <span class="kwd">if</span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#mem">VSet.mem</a></span> <span class="id">id</span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#cenv">cenv</a></span> <span class="kwd">then</span> <span class="id"><a href="compcert.cfrontend.Clight.html#Etempvar">Etempvar</a></span> <span class="id">id</span> <span class="id">ty</span> <span class="kwd">else</span> <span class="id"><a href="compcert.cfrontend.Clight.html#Evar">Evar</a></span> <span class="id">id</span> <span class="id">ty</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Clight.html#Etempvar">Etempvar</a></span> <span class="id">id</span> <span class="id">ty</span> =&gt; <span class="id"><a href="compcert.cfrontend.Clight.html#Etempvar">Etempvar</a></span> <span class="id">id</span> <span class="id">ty</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Clight.html#Ederef">Ederef</a></span> <span class="id">a1</span> <span class="id">ty</span> =&gt; <span class="id"><a href="compcert.cfrontend.Clight.html#Ederef">Ederef</a></span> (<span class="id"><a href="compcert.cfrontend.SimplLocals.html#simpl_expr">simpl_expr</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#cenv">cenv</a></span> <span class="id">a1</span>) <span class="id">ty</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Clight.html#Eaddrof">Eaddrof</a></span> <span class="id">a1</span> <span class="id">ty</span> =&gt; <span class="id"><a href="compcert.cfrontend.Clight.html#Eaddrof">Eaddrof</a></span> (<span class="id"><a href="compcert.cfrontend.SimplLocals.html#simpl_expr">simpl_expr</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#cenv">cenv</a></span> <span class="id">a1</span>) <span class="id">ty</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Clight.html#Eunop">Eunop</a></span> <span class="id">op</span> <span class="id">a1</span> <span class="id">ty</span> =&gt; <span class="id"><a href="compcert.cfrontend.Clight.html#Eunop">Eunop</a></span> <span class="id">op</span> (<span class="id"><a href="compcert.cfrontend.SimplLocals.html#simpl_expr">simpl_expr</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#cenv">cenv</a></span> <span class="id">a1</span>) <span class="id">ty</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Clight.html#Ebinop">Ebinop</a></span> <span class="id">op</span> <span class="id">a1</span> <span class="id">a2</span> <span class="id">ty</span> =&gt; <span class="id"><a href="compcert.cfrontend.Clight.html#Ebinop">Ebinop</a></span> <span class="id">op</span> (<span class="id"><a href="compcert.cfrontend.SimplLocals.html#simpl_expr">simpl_expr</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#cenv">cenv</a></span> <span class="id">a1</span>) (<span class="id"><a href="compcert.cfrontend.SimplLocals.html#simpl_expr">simpl_expr</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#cenv">cenv</a></span> <span class="id">a2</span>) <span class="id">ty</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Clight.html#Ecast">Ecast</a></span> <span class="id">a1</span> <span class="id">ty</span> =&gt; <span class="id"><a href="compcert.cfrontend.Clight.html#Ecast">Ecast</a></span> (<span class="id"><a href="compcert.cfrontend.SimplLocals.html#simpl_expr">simpl_expr</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#cenv">cenv</a></span> <span class="id">a1</span>) <span class="id">ty</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Clight.html#Efield">Efield</a></span> <span class="id">a1</span> <span class="id">fld</span> <span class="id">ty</span> =&gt; <span class="id"><a href="compcert.cfrontend.Clight.html#Efield">Efield</a></span> (<span class="id"><a href="compcert.cfrontend.SimplLocals.html#simpl_expr">simpl_expr</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#cenv">cenv</a></span> <span class="id">a1</span>) <span class="id">fld</span> <span class="id">ty</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Clight.html#Esizeof">Esizeof</a></span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="compcert.cfrontend.SimplLocals.html#a">a</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Clight.html#Ealignof">Ealignof</a></span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="compcert.cfrontend.SimplLocals.html#a">a</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="simpl_exprlist">simpl_exprlist</a></span> (<span class="id">cenv</span>: <span class="id"><a href="compcert.cfrontend.SimplLocals.html#compilenv">compilenv</a></span>) (<span class="id">al</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.cfrontend.Clight.html#expr">expr</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.cfrontend.Clight.html#expr">expr</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="id"><a href="compcert.cfrontend.SimplLocals.html#simpl_expr">simpl_expr</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#cenv">cenv</a></span>) <span class="id"><a href="compcert.cfrontend.SimplLocals.html#al">al</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="check_temp">check_temp</a></span> (<span class="id">cenv</span>: <span class="id"><a href="compcert.cfrontend.SimplLocals.html#compilenv">compilenv</a></span>) (<span class="id">id</span>: <span class="id"><a href="compcert.common.AST.html#ident">ident</a></span>) : <span class="id"><a href="compcert.common.Errors.html#res">res</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#unit">unit</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#mem">VSet.mem</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#id">id</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#cenv">cenv</a></span><br/>
&nbsp;&nbsp;<span class="kwd">then</span> <span class="id"><a href="compcert.common.Errors.html#Error">Error</a></span> (<span class="id"><a href="compcert.common.Errors.html#MSG">MSG</a></span> "<span class="id">bad</span> <span class="id">temporary</span> " :: <span class="id"><a href="compcert.common.Errors.html#CTX">CTX</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#id">id</a></span> :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)<br/>
&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="check_opttemp">check_opttemp</a></span> (<span class="id">cenv</span>: <span class="id"><a href="compcert.cfrontend.SimplLocals.html#compilenv">compilenv</a></span>) (<span class="id">optid</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="compcert.common.AST.html#ident">ident</a></span>) : <span class="id"><a href="compcert.common.Errors.html#res">res</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#unit">unit</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#optid">optid</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">id</span> =&gt; <span class="id"><a href="compcert.cfrontend.SimplLocals.html#check_temp">check_temp</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#cenv">cenv</a></span> <span class="id">id</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="simpl_stmt">simpl_stmt</a></span> (<span class="id">cenv</span>: <span class="id"><a href="compcert.cfrontend.SimplLocals.html#compilenv">compilenv</a></span>) (<span class="id">s</span>: <span class="id"><a href="compcert.cfrontend.Clight.html#statement">statement</a></span>) : <span class="id"><a href="compcert.common.Errors.html#res">res</a></span> <span class="id"><a href="compcert.cfrontend.Clight.html#statement">statement</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#s">s</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Clight.html#Sskip">Sskip</a></span> =&gt; <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.cfrontend.Clight.html#Sskip">Sskip</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Clight.html#Sassign">Sassign</a></span> <span class="id">a1</span> <span class="id">a2</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#is_liftable_var">is_liftable_var</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#cenv">cenv</a></span> <span class="id">a1</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">id</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> (<span class="id"><a href="compcert.cfrontend.SimplLocals.html#Sset_debug">Sset_debug</a></span> <span class="id">id</span> (<span class="id"><a href="compcert.cfrontend.Clight.html#typeof">typeof</a></span> <span class="id">a1</span>) (<span class="id"><a href="compcert.cfrontend.SimplLocals.html#simpl_expr">simpl_expr</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#cenv">cenv</a></span> <span class="id">a2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> (<span class="id"><a href="compcert.cfrontend.Clight.html#Sassign">Sassign</a></span> (<span class="id"><a href="compcert.cfrontend.SimplLocals.html#simpl_expr">simpl_expr</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#cenv">cenv</a></span> <span class="id">a1</span>) (<span class="id"><a href="compcert.cfrontend.SimplLocals.html#simpl_expr">simpl_expr</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#cenv">cenv</a></span> <span class="id">a2</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Clight.html#Sset">Sset</a></span> <span class="id">id</span> <span class="id">a</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">x</span> &lt;- <span class="id"><a href="compcert.cfrontend.SimplLocals.html#check_temp">check_temp</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#cenv">cenv</a></span> <span class="id">id</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> (<span class="id"><a href="compcert.cfrontend.Clight.html#Sset">Sset</a></span> <span class="id">id</span> (<span class="id"><a href="compcert.cfrontend.SimplLocals.html#simpl_expr">simpl_expr</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#cenv">cenv</a></span> <span class="id">a</span>))<br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Clight.html#Scall">Scall</a></span> <span class="id">optid</span> <span class="id">a</span> <span class="id">al</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">x</span> &lt;- <span class="id"><a href="compcert.cfrontend.SimplLocals.html#check_opttemp">check_opttemp</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#cenv">cenv</a></span> <span class="id">optid</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> (<span class="id"><a href="compcert.cfrontend.Clight.html#Scall">Scall</a></span> <span class="id">optid</span> (<span class="id"><a href="compcert.cfrontend.SimplLocals.html#simpl_expr">simpl_expr</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#cenv">cenv</a></span> <span class="id">a</span>) (<span class="id"><a href="compcert.cfrontend.SimplLocals.html#simpl_exprlist">simpl_exprlist</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#cenv">cenv</a></span> <span class="id">al</span>))<br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Clight.html#Sbuiltin">Sbuiltin</a></span> <span class="id">optid</span> <span class="id">ef</span> <span class="id">tyargs</span> <span class="id">al</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">x</span> &lt;- <span class="id"><a href="compcert.cfrontend.SimplLocals.html#check_opttemp">check_opttemp</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#cenv">cenv</a></span> <span class="id">optid</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> (<span class="id"><a href="compcert.cfrontend.Clight.html#Sbuiltin">Sbuiltin</a></span> <span class="id">optid</span> <span class="id">ef</span> <span class="id">tyargs</span> (<span class="id"><a href="compcert.cfrontend.SimplLocals.html#simpl_exprlist">simpl_exprlist</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#cenv">cenv</a></span> <span class="id">al</span>))<br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Clight.html#Ssequence">Ssequence</a></span> <span class="id">s1</span> <span class="id">s2</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">s1</span>' &lt;- <span class="id"><a href="compcert.cfrontend.SimplLocals.html#simpl_stmt">simpl_stmt</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#cenv">cenv</a></span> <span class="id">s1</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">s2</span>' &lt;- <span class="id"><a href="compcert.cfrontend.SimplLocals.html#simpl_stmt">simpl_stmt</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#cenv">cenv</a></span> <span class="id">s2</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> (<span class="id"><a href="compcert.cfrontend.Clight.html#Ssequence">Ssequence</a></span> <span class="id">s1</span>' <span class="id">s2</span>')<br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Clight.html#Sifthenelse">Sifthenelse</a></span> <span class="id">a</span> <span class="id">s1</span> <span class="id">s2</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">s1</span>' &lt;- <span class="id"><a href="compcert.cfrontend.SimplLocals.html#simpl_stmt">simpl_stmt</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#cenv">cenv</a></span> <span class="id">s1</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">s2</span>' &lt;- <span class="id"><a href="compcert.cfrontend.SimplLocals.html#simpl_stmt">simpl_stmt</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#cenv">cenv</a></span> <span class="id">s2</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> (<span class="id"><a href="compcert.cfrontend.Clight.html#Sifthenelse">Sifthenelse</a></span> (<span class="id"><a href="compcert.cfrontend.SimplLocals.html#simpl_expr">simpl_expr</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#cenv">cenv</a></span> <span class="id">a</span>) <span class="id">s1</span>' <span class="id">s2</span>')<br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Clight.html#Sloop">Sloop</a></span> <span class="id">s1</span> <span class="id">s2</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">s1</span>' &lt;- <span class="id"><a href="compcert.cfrontend.SimplLocals.html#simpl_stmt">simpl_stmt</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#cenv">cenv</a></span> <span class="id">s1</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">s2</span>' &lt;- <span class="id"><a href="compcert.cfrontend.SimplLocals.html#simpl_stmt">simpl_stmt</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#cenv">cenv</a></span> <span class="id">s2</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> (<span class="id"><a href="compcert.cfrontend.Clight.html#Sloop">Sloop</a></span> <span class="id">s1</span>' <span class="id">s2</span>')<br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Clight.html#Sbreak">Sbreak</a></span> =&gt; <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.cfrontend.Clight.html#Sbreak">Sbreak</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Clight.html#Scontinue">Scontinue</a></span> =&gt; <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.cfrontend.Clight.html#Scontinue">Scontinue</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Clight.html#Sreturn">Sreturn</a></span> <span class="id">opta</span> =&gt; <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> (<span class="id"><a href="compcert.cfrontend.Clight.html#Sreturn">Sreturn</a></span> (<span class="id"><a href="compcert.lib.Coqlib.html#option_map">option_map</a></span> (<span class="id"><a href="compcert.cfrontend.SimplLocals.html#simpl_expr">simpl_expr</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#cenv">cenv</a></span>) <span class="id">opta</span>))<br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Clight.html#Sswitch">Sswitch</a></span> <span class="id">a</span> <span class="id">ls</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">ls</span>' &lt;- <span class="id"><a href="compcert.cfrontend.SimplLocals.html#simpl_lblstmt">simpl_lblstmt</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#cenv">cenv</a></span> <span class="id">ls</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> (<span class="id"><a href="compcert.cfrontend.Clight.html#Sswitch">Sswitch</a></span> (<span class="id"><a href="compcert.cfrontend.SimplLocals.html#simpl_expr">simpl_expr</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#cenv">cenv</a></span> <span class="id">a</span>) <span class="id">ls</span>')<br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Clight.html#Slabel">Slabel</a></span> <span class="id">lbl</span> <span class="id">s</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">s</span>' &lt;- <span class="id"><a href="compcert.cfrontend.SimplLocals.html#simpl_stmt">simpl_stmt</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#cenv">cenv</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#s">s</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> (<span class="id"><a href="compcert.cfrontend.Clight.html#Slabel">Slabel</a></span> <span class="id">lbl</span> <span class="id">s</span>')<br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Clight.html#Sgoto">Sgoto</a></span> <span class="id">lbl</span> =&gt; <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> (<span class="id"><a href="compcert.cfrontend.Clight.html#Sgoto">Sgoto</a></span> <span class="id">lbl</span>)<br/>
&nbsp;&nbsp;<span class="kwd">end</span><br/>
<br/>
<span class="kwd">with</span> <span class="id"><a name="simpl_lblstmt">simpl_lblstmt</a></span> (<span class="id">cenv</span>: <span class="id"><a href="compcert.cfrontend.SimplLocals.html#compilenv">compilenv</a></span>) (<span class="id">ls</span>: <span class="id"><a href="compcert.cfrontend.Clight.html#labeled_statements">labeled_statements</a></span>) : <span class="id"><a href="compcert.common.Errors.html#res">res</a></span> <span class="id"><a href="compcert.cfrontend.Clight.html#labeled_statements">labeled_statements</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#ls">ls</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Clight.html#LSnil">LSnil</a></span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.cfrontend.Clight.html#LSnil">LSnil</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Clight.html#LScons">LScons</a></span> <span class="id">c</span> <span class="id">s</span> <span class="id">ls1</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">s</span>' &lt;- <span class="id"><a href="compcert.cfrontend.SimplLocals.html#simpl_stmt">simpl_stmt</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#cenv">cenv</a></span> <span class="id">s</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">ls1</span>' &lt;- <span class="id"><a href="compcert.cfrontend.SimplLocals.html#simpl_lblstmt">simpl_lblstmt</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#cenv">cenv</a></span> <span class="id">ls1</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> (<span class="id"><a href="compcert.cfrontend.Clight.html#LScons">LScons</a></span> <span class="id">c</span> <span class="id">s</span>' <span class="id">ls1</span>')<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<div class="doc">Function parameters that are not lifted to temporaries must be
  stored in the corresponding local variable at function entry. </div>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="store_params">store_params</a></span> (<span class="id">cenv</span>: <span class="id"><a href="compcert.cfrontend.SimplLocals.html#compilenv">compilenv</a></span>) (<span class="id">params</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="compcert.common.AST.html#ident">ident</a></span> * <span class="id"><a href="compcert.cfrontend.Ctypes.html#type">type</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">s</span>: <span class="id"><a href="compcert.cfrontend.Clight.html#statement">statement</a></span>): <span class="id"><a href="compcert.cfrontend.Clight.html#statement">statement</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#params">params</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; <span class="id"><a href="compcert.cfrontend.SimplLocals.html#s">s</a></span><br/>
&nbsp;&nbsp;| (<span class="id">id</span>, <span class="id">ty</span>) :: <span class="id">params</span>' =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#mem">VSet.mem</a></span> <span class="id">id</span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#cenv">cenv</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#store_params">store_params</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#cenv">cenv</a></span> <span class="id">params</span>' <span class="id"><a href="compcert.cfrontend.SimplLocals.html#s">s</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="compcert.cfrontend.Clight.html#Ssequence">Ssequence</a></span> (<span class="id"><a href="compcert.cfrontend.Clight.html#Sassign">Sassign</a></span> (<span class="id"><a href="compcert.cfrontend.Clight.html#Evar">Evar</a></span> <span class="id">id</span> <span class="id">ty</span>) (<span class="id"><a href="compcert.cfrontend.Clight.html#Etempvar">Etempvar</a></span> <span class="id">id</span> <span class="id">ty</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.cfrontend.SimplLocals.html#store_params">store_params</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#cenv">cenv</a></span> <span class="id">params</span>' <span class="id"><a href="compcert.cfrontend.SimplLocals.html#s">s</a></span>)<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<div class="doc">Compute the set of variables whose address is taken </div>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="addr_taken_expr">addr_taken_expr</a></span> (<span class="id">a</span>: <span class="id"><a href="compcert.cfrontend.Clight.html#expr">expr</a></span>): <span class="id"><a href="compcert.cfrontend.SimplLocals.html#t">VSet.t</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#a">a</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Clight.html#Econst_int">Econst_int</a></span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="compcert.cfrontend.SimplLocals.html#empty">VSet.empty</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Clight.html#Econst_float">Econst_float</a></span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="compcert.cfrontend.SimplLocals.html#empty">VSet.empty</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Clight.html#Econst_single">Econst_single</a></span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="compcert.cfrontend.SimplLocals.html#empty">VSet.empty</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Clight.html#Econst_long">Econst_long</a></span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="compcert.cfrontend.SimplLocals.html#empty">VSet.empty</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Clight.html#Evar">Evar</a></span> <span class="id">id</span> <span class="id">ty</span> =&gt; <span class="id"><a href="compcert.cfrontend.SimplLocals.html#empty">VSet.empty</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Clight.html#Etempvar">Etempvar</a></span> <span class="id">id</span> <span class="id">ty</span> =&gt; <span class="id"><a href="compcert.cfrontend.SimplLocals.html#empty">VSet.empty</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Clight.html#Ederef">Ederef</a></span> <span class="id">a1</span> <span class="id">ty</span> =&gt; <span class="id"><a href="compcert.cfrontend.SimplLocals.html#addr_taken_expr">addr_taken_expr</a></span> <span class="id">a1</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Clight.html#Eaddrof">Eaddrof</a></span> (<span class="id"><a href="compcert.cfrontend.Clight.html#Evar">Evar</a></span> <span class="id">id</span> <span class="id">ty1</span>) <span class="id">ty</span> =&gt; <span class="id"><a href="compcert.cfrontend.SimplLocals.html#singleton">VSet.singleton</a></span> <span class="id">id</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Clight.html#Eaddrof">Eaddrof</a></span> <span class="id">a1</span> <span class="id">ty</span> =&gt; <span class="id"><a href="compcert.cfrontend.SimplLocals.html#addr_taken_expr">addr_taken_expr</a></span> <span class="id">a1</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Clight.html#Eunop">Eunop</a></span> <span class="id">op</span> <span class="id">a1</span> <span class="id">ty</span> =&gt; <span class="id"><a href="compcert.cfrontend.SimplLocals.html#addr_taken_expr">addr_taken_expr</a></span> <span class="id">a1</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Clight.html#Ebinop">Ebinop</a></span> <span class="id">op</span> <span class="id">a1</span> <span class="id">a2</span> <span class="id">ty</span> =&gt; <span class="id"><a href="compcert.cfrontend.SimplLocals.html#union">VSet.union</a></span> (<span class="id"><a href="compcert.cfrontend.SimplLocals.html#addr_taken_expr">addr_taken_expr</a></span> <span class="id">a1</span>) (<span class="id"><a href="compcert.cfrontend.SimplLocals.html#addr_taken_expr">addr_taken_expr</a></span> <span class="id">a2</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Clight.html#Ecast">Ecast</a></span> <span class="id">a1</span> <span class="id">ty</span> =&gt; <span class="id"><a href="compcert.cfrontend.SimplLocals.html#addr_taken_expr">addr_taken_expr</a></span> <span class="id">a1</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Clight.html#Efield">Efield</a></span> <span class="id">a1</span> <span class="id">fld</span> <span class="id">ty</span> =&gt; <span class="id"><a href="compcert.cfrontend.SimplLocals.html#addr_taken_expr">addr_taken_expr</a></span> <span class="id">a1</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Clight.html#Esizeof">Esizeof</a></span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="compcert.cfrontend.SimplLocals.html#empty">VSet.empty</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Clight.html#Ealignof">Ealignof</a></span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="compcert.cfrontend.SimplLocals.html#empty">VSet.empty</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="addr_taken_exprlist">addr_taken_exprlist</a></span> (<span class="id">l</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.cfrontend.Clight.html#expr">expr</a></span>) : <span class="id"><a href="compcert.cfrontend.SimplLocals.html#t">VSet.t</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#l">l</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; <span class="id"><a href="compcert.cfrontend.SimplLocals.html#empty">VSet.empty</a></span><br/>
&nbsp;&nbsp;| <span class="id">a</span> :: <span class="id">l</span>' =&gt; <span class="id"><a href="compcert.cfrontend.SimplLocals.html#union">VSet.union</a></span> (<span class="id"><a href="compcert.cfrontend.SimplLocals.html#addr_taken_expr">addr_taken_expr</a></span> <span class="id">a</span>) (<span class="id"><a href="compcert.cfrontend.SimplLocals.html#addr_taken_exprlist">addr_taken_exprlist</a></span> <span class="id">l</span>')<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="addr_taken_stmt">addr_taken_stmt</a></span> (<span class="id">s</span>: <span class="id"><a href="compcert.cfrontend.Clight.html#statement">statement</a></span>) : <span class="id"><a href="compcert.cfrontend.SimplLocals.html#t">VSet.t</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#s">s</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Clight.html#Sskip">Sskip</a></span> =&gt; <span class="id"><a href="compcert.cfrontend.SimplLocals.html#empty">VSet.empty</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Clight.html#Sassign">Sassign</a></span> <span class="id">a</span> <span class="id">b</span> =&gt; <span class="id"><a href="compcert.cfrontend.SimplLocals.html#union">VSet.union</a></span> (<span class="id"><a href="compcert.cfrontend.SimplLocals.html#addr_taken_expr">addr_taken_expr</a></span> <span class="id">a</span>) (<span class="id"><a href="compcert.cfrontend.SimplLocals.html#addr_taken_expr">addr_taken_expr</a></span> <span class="id">b</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Clight.html#Sset">Sset</a></span> <span class="id">id</span> <span class="id">a</span> =&gt; <span class="id"><a href="compcert.cfrontend.SimplLocals.html#addr_taken_expr">addr_taken_expr</a></span> <span class="id">a</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Clight.html#Scall">Scall</a></span> <span class="id">optid</span> <span class="id">a</span> <span class="id">bl</span> =&gt; <span class="id"><a href="compcert.cfrontend.SimplLocals.html#union">VSet.union</a></span> (<span class="id"><a href="compcert.cfrontend.SimplLocals.html#addr_taken_expr">addr_taken_expr</a></span> <span class="id">a</span>) (<span class="id"><a href="compcert.cfrontend.SimplLocals.html#addr_taken_exprlist">addr_taken_exprlist</a></span> <span class="id">bl</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Clight.html#Sbuiltin">Sbuiltin</a></span> <span class="id">optid</span> <span class="id">ef</span> <span class="id">tyargs</span> <span class="id">bl</span> =&gt; <span class="id"><a href="compcert.cfrontend.SimplLocals.html#addr_taken_exprlist">addr_taken_exprlist</a></span> <span class="id">bl</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Clight.html#Ssequence">Ssequence</a></span> <span class="id">s1</span> <span class="id">s2</span> =&gt; <span class="id"><a href="compcert.cfrontend.SimplLocals.html#union">VSet.union</a></span> (<span class="id"><a href="compcert.cfrontend.SimplLocals.html#addr_taken_stmt">addr_taken_stmt</a></span> <span class="id">s1</span>) (<span class="id"><a href="compcert.cfrontend.SimplLocals.html#addr_taken_stmt">addr_taken_stmt</a></span> <span class="id">s2</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Clight.html#Sifthenelse">Sifthenelse</a></span> <span class="id">a</span> <span class="id">s1</span> <span class="id">s2</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.SimplLocals.html#union">VSet.union</a></span> (<span class="id"><a href="compcert.cfrontend.SimplLocals.html#addr_taken_expr">addr_taken_expr</a></span> <span class="id">a</span>) (<span class="id"><a href="compcert.cfrontend.SimplLocals.html#union">VSet.union</a></span> (<span class="id"><a href="compcert.cfrontend.SimplLocals.html#addr_taken_stmt">addr_taken_stmt</a></span> <span class="id">s1</span>) (<span class="id"><a href="compcert.cfrontend.SimplLocals.html#addr_taken_stmt">addr_taken_stmt</a></span> <span class="id">s2</span>))<br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Clight.html#Sloop">Sloop</a></span> <span class="id">s1</span> <span class="id">s2</span> =&gt; <span class="id"><a href="compcert.cfrontend.SimplLocals.html#union">VSet.union</a></span> (<span class="id"><a href="compcert.cfrontend.SimplLocals.html#addr_taken_stmt">addr_taken_stmt</a></span> <span class="id">s1</span>) (<span class="id"><a href="compcert.cfrontend.SimplLocals.html#addr_taken_stmt">addr_taken_stmt</a></span> <span class="id">s2</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Clight.html#Sbreak">Sbreak</a></span> =&gt; <span class="id"><a href="compcert.cfrontend.SimplLocals.html#empty">VSet.empty</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Clight.html#Scontinue">Scontinue</a></span> =&gt; <span class="id"><a href="compcert.cfrontend.SimplLocals.html#empty">VSet.empty</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Clight.html#Sreturn">Sreturn</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="compcert.cfrontend.SimplLocals.html#empty">VSet.empty</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Clight.html#Sreturn">Sreturn</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">a</span>) =&gt; <span class="id"><a href="compcert.cfrontend.SimplLocals.html#addr_taken_expr">addr_taken_expr</a></span> <span class="id">a</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Clight.html#Sswitch">Sswitch</a></span> <span class="id">a</span> <span class="id">ls</span> =&gt; <span class="id"><a href="compcert.cfrontend.SimplLocals.html#union">VSet.union</a></span> (<span class="id"><a href="compcert.cfrontend.SimplLocals.html#addr_taken_expr">addr_taken_expr</a></span> <span class="id">a</span>) (<span class="id"><a href="compcert.cfrontend.SimplLocals.html#addr_taken_lblstmt">addr_taken_lblstmt</a></span> <span class="id">ls</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Clight.html#Slabel">Slabel</a></span> <span class="id">lbl</span> <span class="id">s</span> =&gt; <span class="id"><a href="compcert.cfrontend.SimplLocals.html#addr_taken_stmt">addr_taken_stmt</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#s">s</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Clight.html#Sgoto">Sgoto</a></span> <span class="id">lbl</span> =&gt; <span class="id"><a href="compcert.cfrontend.SimplLocals.html#empty">VSet.empty</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span><br/>
<br/>
<span class="kwd">with</span> <span class="id"><a name="addr_taken_lblstmt">addr_taken_lblstmt</a></span> (<span class="id">ls</span>: <span class="id"><a href="compcert.cfrontend.Clight.html#labeled_statements">labeled_statements</a></span>) : <span class="id"><a href="compcert.cfrontend.SimplLocals.html#t">VSet.t</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#ls">ls</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Clight.html#LSnil">LSnil</a></span> =&gt; <span class="id"><a href="compcert.cfrontend.SimplLocals.html#empty">VSet.empty</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Clight.html#LScons">LScons</a></span> <span class="id">c</span> <span class="id">s</span> <span class="id">ls</span>' =&gt; <span class="id"><a href="compcert.cfrontend.SimplLocals.html#union">VSet.union</a></span> (<span class="id"><a href="compcert.cfrontend.SimplLocals.html#addr_taken_stmt">addr_taken_stmt</a></span> <span class="id">s</span>) (<span class="id"><a href="compcert.cfrontend.SimplLocals.html#addr_taken_lblstmt">addr_taken_lblstmt</a></span> <span class="id">ls</span>')<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<div class="doc">The compilation environment for a function is the set of local variables
  that are scalars and whose addresses are not taken. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="add_local_variable">add_local_variable</a></span> (<span class="id">atk</span>: <span class="id"><a href="compcert.cfrontend.SimplLocals.html#t">VSet.t</a></span>) (<span class="id">id_ty</span>: <span class="id"><a href="compcert.common.AST.html#ident">ident</a></span> * <span class="id"><a href="compcert.cfrontend.Ctypes.html#type">type</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">cenv</span>: <span class="id"><a href="compcert.cfrontend.SimplLocals.html#compilenv">compilenv</a></span>) : <span class="id"><a href="compcert.cfrontend.SimplLocals.html#compilenv">compilenv</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> (<span class="id">id</span>, <span class="id">ty</span>) := <span class="id"><a href="compcert.cfrontend.SimplLocals.html#id_ty">id_ty</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#access_mode">access_mode</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#ty">ty</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#By_value">By_value</a></span> <span class="id">chunk</span> =&gt; <span class="kwd">if</span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#mem">VSet.mem</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#id">id</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#atk">atk</a></span> <span class="kwd">then</span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#cenv">cenv</a></span> <span class="kwd">else</span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#add">VSet.add</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#id">id</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#cenv">cenv</a></span><br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="compcert.cfrontend.SimplLocals.html#cenv">cenv</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="cenv_for">cenv_for</a></span> (<span class="id">f</span>: <span class="id"><a href="compcert.cfrontend.Clight.html#function">function</a></span>) : <span class="id"><a href="compcert.cfrontend.SimplLocals.html#compilenv">compilenv</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">atk</span> := <span class="id"><a href="compcert.cfrontend.SimplLocals.html#addr_taken_stmt">addr_taken_stmt</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#f">f</a></span>.(<span class="id"><a href="compcert.cfrontend.Clight.html#fn_body">fn_body</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right">List.fold_right</a></span> (<span class="id"><a href="compcert.cfrontend.SimplLocals.html#add_local_variable">add_local_variable</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#atk">atk</a></span>) <span class="id"><a href="compcert.cfrontend.SimplLocals.html#empty">VSet.empty</a></span> (<span class="id"><a href="compcert.cfrontend.SimplLocals.html#f">f</a></span>.(<span class="id"><a href="compcert.cfrontend.Clight.html#fn_params">fn_params</a></span>) ++ <span class="id"><a href="compcert.cfrontend.SimplLocals.html#f">f</a></span>.(<span class="id"><a href="compcert.cfrontend.Clight.html#fn_vars">fn_vars</a></span>)).<br/>
<br/>
<div class="doc">Transform a function </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="add_debug_var">add_debug_var</a></span> (<span class="id">id_ty</span>: <span class="id"><a href="compcert.common.AST.html#ident">ident</a></span> * <span class="id"><a href="compcert.cfrontend.Ctypes.html#type">type</a></span>) (<span class="id">s</span>: <span class="id"><a href="compcert.cfrontend.Clight.html#statement">statement</a></span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> (<span class="id">id</span>, <span class="id">ty</span>) := <span class="id"><a href="compcert.cfrontend.SimplLocals.html#id_ty">id_ty</a></span> <span class="kwd">in</span> <span class="id"><a href="compcert.cfrontend.Clight.html#Ssequence">Ssequence</a></span> (<span class="id"><a href="compcert.cfrontend.SimplLocals.html#Sdebug_var">Sdebug_var</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#id">id</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#ty">ty</a></span>) <span class="id"><a href="compcert.cfrontend.SimplLocals.html#s">s</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="add_debug_vars">add_debug_vars</a></span> (<span class="id">vars</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="compcert.common.AST.html#ident">ident</a></span> * <span class="id"><a href="compcert.cfrontend.Ctypes.html#type">type</a></span>)) (<span class="id">s</span>: <span class="id"><a href="compcert.cfrontend.Clight.html#statement">statement</a></span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="compcert.driver.Compopts.html#debug">Compopts.debug</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;<span class="kwd">then</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right">List.fold_right</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#add_debug_var">add_debug_var</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#s">s</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#vars">vars</a></span><br/>
&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#s">s</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="add_debug_param">add_debug_param</a></span> (<span class="id">id_ty</span>: <span class="id"><a href="compcert.common.AST.html#ident">ident</a></span> * <span class="id"><a href="compcert.cfrontend.Ctypes.html#type">type</a></span>) (<span class="id">s</span>: <span class="id"><a href="compcert.cfrontend.Clight.html#statement">statement</a></span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> (<span class="id">id</span>, <span class="id">ty</span>) := <span class="id"><a href="compcert.cfrontend.SimplLocals.html#id_ty">id_ty</a></span> <span class="kwd">in</span> <span class="id"><a href="compcert.cfrontend.Clight.html#Ssequence">Ssequence</a></span> (<span class="id"><a href="compcert.cfrontend.SimplLocals.html#Sdebug_temp">Sdebug_temp</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#id">id</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#ty">ty</a></span>) <span class="id"><a href="compcert.cfrontend.SimplLocals.html#s">s</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="add_debug_params">add_debug_params</a></span> (<span class="id">params</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="compcert.common.AST.html#ident">ident</a></span> * <span class="id"><a href="compcert.cfrontend.Ctypes.html#type">type</a></span>)) (<span class="id">s</span>: <span class="id"><a href="compcert.cfrontend.Clight.html#statement">statement</a></span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="compcert.driver.Compopts.html#debug">Compopts.debug</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;<span class="kwd">then</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right">List.fold_right</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#add_debug_param">add_debug_param</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#s">s</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#params">params</a></span><br/>
&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#s">s</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="remove_lifted">remove_lifted</a></span> (<span class="id">cenv</span>: <span class="id"><a href="compcert.cfrontend.SimplLocals.html#compilenv">compilenv</a></span>) (<span class="id">vars</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="compcert.common.AST.html#ident">ident</a></span> * <span class="id"><a href="compcert.cfrontend.Ctypes.html#type">type</a></span>)) :=<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#filter">List.filter</a></span> (<span class="kwd">fun</span> <span class="id">id_ty</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> (<span class="id"><a href="compcert.cfrontend.SimplLocals.html#mem">VSet.mem</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#id_ty">id_ty</a></span>) <span class="id"><a href="compcert.cfrontend.SimplLocals.html#cenv">cenv</a></span>)) <span class="id"><a href="compcert.cfrontend.SimplLocals.html#vars">vars</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="add_lifted">add_lifted</a></span> (<span class="id">cenv</span>: <span class="id"><a href="compcert.cfrontend.SimplLocals.html#compilenv">compilenv</a></span>) (<span class="id">vars1</span> <span class="id">vars2</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="compcert.common.AST.html#ident">ident</a></span> * <span class="id"><a href="compcert.cfrontend.Ctypes.html#type">type</a></span>)) :=<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#filter">List.filter</a></span> (<span class="kwd">fun</span> <span class="id">id_ty</span> =&gt; <span class="id"><a href="compcert.cfrontend.SimplLocals.html#mem">VSet.mem</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#id_ty">id_ty</a></span>) <span class="id"><a href="compcert.cfrontend.SimplLocals.html#cenv">cenv</a></span>) <span class="id"><a href="compcert.cfrontend.SimplLocals.html#vars1">vars1</a></span> ++ <span class="id"><a href="compcert.cfrontend.SimplLocals.html#vars2">vars2</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="transf_function">transf_function</a></span> (<span class="id">f</span>: <span class="id"><a href="compcert.cfrontend.Clight.html#function">function</a></span>) : <span class="id"><a href="compcert.common.Errors.html#res">res</a></span> <span class="id"><a href="compcert.cfrontend.Clight.html#function">function</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">cenv</span> := <span class="id"><a href="compcert.cfrontend.SimplLocals.html#cenv_for">cenv_for</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#f">f</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id">assertion</span> (<span class="id"><a href="compcert.lib.Coqlib.html#list_disjoint_dec">list_disjoint_dec</a></span> <span class="id"><a href="compcert.common.AST.html#ident_eq">ident_eq</a></span> (<span class="id"><a href="compcert.cfrontend.Clight.html#var_names">var_names</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#f">f</a></span>.(<span class="id"><a href="compcert.cfrontend.Clight.html#fn_params">fn_params</a></span>)) (<span class="id"><a href="compcert.cfrontend.Clight.html#var_names">var_names</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#f">f</a></span>.(<span class="id"><a href="compcert.cfrontend.Clight.html#fn_temps">fn_temps</a></span>)));<br/>
&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">body</span>' &lt;- <span class="id"><a href="compcert.cfrontend.SimplLocals.html#simpl_stmt">simpl_stmt</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#cenv">cenv</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#f">f</a></span>.(<span class="id"><a href="compcert.cfrontend.Clight.html#fn_body">fn_body</a></span>);<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">vars</span>' := <span class="id"><a href="compcert.cfrontend.SimplLocals.html#remove_lifted">remove_lifted</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#cenv">cenv</a></span> (<span class="id"><a href="compcert.cfrontend.SimplLocals.html#f">f</a></span>.(<span class="id"><a href="compcert.cfrontend.Clight.html#fn_params">fn_params</a></span>) ++ <span class="id"><a href="compcert.cfrontend.SimplLocals.html#f">f</a></span>.(<span class="id"><a href="compcert.cfrontend.Clight.html#fn_vars">fn_vars</a></span>)) <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">temps</span>' := <span class="id"><a href="compcert.cfrontend.SimplLocals.html#add_lifted">add_lifted</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#cenv">cenv</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#f">f</a></span>.(<span class="id"><a href="compcert.cfrontend.Clight.html#fn_vars">fn_vars</a></span>) <span class="id"><a href="compcert.cfrontend.SimplLocals.html#f">f</a></span>.(<span class="id"><a href="compcert.cfrontend.Clight.html#fn_temps">fn_temps</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> {| <span class="id"><a href="compcert.cfrontend.Clight.html#mkfunction">fn_return</a></span> := <span class="id"><a href="compcert.cfrontend.SimplLocals.html#f">f</a></span>.(<span class="id"><a href="compcert.cfrontend.Clight.html#fn_return">fn_return</a></span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">fn_callconv</span> := <span class="id"><a href="compcert.cfrontend.SimplLocals.html#f">f</a></span>.(<span class="id"><a href="compcert.cfrontend.Clight.html#fn_callconv">fn_callconv</a></span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">fn_params</span> := <span class="id"><a href="compcert.cfrontend.SimplLocals.html#f">f</a></span>.(<span class="id"><a href="compcert.cfrontend.Clight.html#fn_params">fn_params</a></span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">fn_vars</span> := <span class="id">vars</span>';<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">fn_temps</span> := <span class="id">temps</span>';<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">fn_body</span> := <span class="id"><a href="compcert.cfrontend.SimplLocals.html#add_debug_params">add_debug_params</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#f">f</a></span>.(<span class="id"><a href="compcert.cfrontend.Clight.html#fn_params">fn_params</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.cfrontend.SimplLocals.html#store_params">store_params</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#cenv">cenv</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#f">f</a></span>.(<span class="id"><a href="compcert.cfrontend.Clight.html#fn_params">fn_params</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.cfrontend.SimplLocals.html#add_debug_vars">add_debug_vars</a></span> <span class="id">vars</span>' <span class="id">body</span>')) |}.<br/>
<br/>
<div class="doc">Whole-program transformation </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="transf_fundef">transf_fundef</a></span> (<span class="id">fd</span>: <span class="id"><a href="compcert.cfrontend.Clight.html#fundef">fundef</a></span>) : <span class="id"><a href="compcert.common.Errors.html#res">res</a></span> <span class="id"><a href="compcert.cfrontend.Clight.html#fundef">fundef</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#fd">fd</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Internal">Internal</a></span> <span class="id">f</span> =&gt; <span class="tactic">do</span> <span class="id">tf</span> &lt;- <span class="id"><a href="compcert.cfrontend.SimplLocals.html#transf_function">transf_function</a></span> <span class="id">f</span>; <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#Internal">Internal</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#tf">tf</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#External">External</a></span> <span class="id">ef</span> <span class="id">targs</span> <span class="id">tres</span> <span class="id">cconv</span> =&gt; <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#External">External</a></span> <span class="id">ef</span> <span class="id">targs</span> <span class="id">tres</span> <span class="id">cconv</span>)<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="transf_program">transf_program</a></span> (<span class="id">p</span>: <span class="id"><a href="compcert.cfrontend.Clight.html#program">program</a></span>) : <span class="id"><a href="compcert.common.Errors.html#res">res</a></span> <span class="id"><a href="compcert.cfrontend.Clight.html#program">program</a></span> :=<br/>
&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">p1</span> &lt;- <span class="id"><a href="compcert.common.AST.html#transform_partial_program">AST.transform_partial_program</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#transf_fundef">transf_fundef</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#p">p</a></span>;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> {| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Build_program">prog_defs</a></span> := <span class="id"><a href="compcert.common.AST.html#prog_defs">AST.prog_defs</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#p1">p1</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">prog_public</span> := <span class="id"><a href="compcert.common.AST.html#prog_public">AST.prog_public</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#p1">p1</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">prog_main</span> := <span class="id"><a href="compcert.common.AST.html#prog_main">AST.prog_main</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#p1">p1</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">prog_types</span> := <span class="id"><a href="compcert.cfrontend.Ctypes.html#prog_types">prog_types</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#p">p</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">prog_comp_env</span> := <span class="id"><a href="compcert.cfrontend.Ctypes.html#prog_comp_env">prog_comp_env</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#p">p</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">prog_comp_env_eq</span> := <span class="id"><a href="compcert.cfrontend.Ctypes.html#prog_comp_env_eq">prog_comp_env_eq</a></span> <span class="id"><a href="compcert.cfrontend.SimplLocals.html#p">p</a></span> |}.<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</div>
</body>
</html>
