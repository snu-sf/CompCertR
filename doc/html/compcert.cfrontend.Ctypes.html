
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module Ctypes</title>
<meta name="description" content="Documentation of Coq module Ctypes" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module Ctypes</h1>
<div class="coq">
<br/>
<div class="doc">Type expressions for the Compcert C and Clight languages </div>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.lib.Axioms.html">Axioms</a></span> <span class="id"><a href="compcert.lib.Coqlib.html">Coqlib</a></span> <span class="id"><a href="compcert.lib.Maps.html">Maps</a></span> <span class="id"><a href="compcert.common.Errors.html">Errors</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.common.AST.html">AST</a></span> <span class="id"><a href="compcert.common.Linking.html">Linking</a></span>.<br/>
<span class="kwd">Require</span> <span class="id"><a href="compcert.x86_64.Archi.html">Archi</a></span>.<br/>
<br/>
<h1> Syntax of types </h1>
<br/>
<div class="doc">Compcert C types are similar to those of C.  They include numeric types,
  pointers, arrays, function types, and composite types (struct and
  union).  Numeric types (integers and floats) fully specify the
  bit size of the type.  An integer type is a pair of a signed/unsigned
  flag and a bit size: 8, 16, or 32 bits, or the special <span class="bracket"><span class="id">IBool</span></span> size
  standing for the C99 <span class="bracket"><span class="id">_Bool</span></span> type.  64-bit integers are treated separately. </div>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="signedness">signedness</a></span> : <span class="kwd">Type</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="Signed">Signed</a></span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#signedness">signedness</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="Unsigned">Unsigned</a></span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#signedness">signedness</a></span>.<br/>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="intsize">intsize</a></span> : <span class="kwd">Type</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="I8">I8</a></span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#intsize">intsize</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="I16">I16</a></span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#intsize">intsize</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="I32">I32</a></span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#intsize">intsize</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="IBool">IBool</a></span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#intsize">intsize</a></span>.<br/>
<br/>
<div class="doc">Float types come in two sizes: 32 bits (single precision)
  and 64-bit (double precision). </div>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="floatsize">floatsize</a></span> : <span class="kwd">Type</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="F32">F32</a></span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#floatsize">floatsize</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="F64">F64</a></span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#floatsize">floatsize</a></span>.<br/>
<br/>
<div class="doc">Every type carries a set of attributes.  Currently, only two
  attributes are modeled: <span class="bracket"><span class="id">volatile</span></span> and <span class="bracket"><span class="id">_Alignas</span>(<span class="id">n</span>)</span> (from ISO C 2011). </div>
<br/>
<span class="kwd">Record</span> <span class="id"><a name="attr">attr</a></span> : <span class="kwd">Type</span> := <span class="id"><a name="mk_attr">mk_attr</a></span> {<br/>
&nbsp;&nbsp;<span class="id"><a name="attr_volatile">attr_volatile</a></span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>;<br/>
&nbsp;&nbsp;<span class="id"><a name="attr_alignas">attr_alignas</a></span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#N">N</a></span>         <span class="docright">(* log2 of required alignment  *)</span><br/>
}.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="noattr">noattr</a></span> := {| <span class="id"><a href="compcert.cfrontend.Ctypes.html#mk_attr">attr_volatile</a></span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>; <span class="id">attr_alignas</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> |}.<br/>
<br/>
<div class="doc">The syntax of type expressions.  Some points to note:
<ul>
<li>
 Array types <span class="bracket"><span class="id">Tarray</span> <span class="id">n</span></span> carry the size <span class="bracket"><span class="id">n</span></span> of the array.
  Arrays with unknown sizes are represented by pointer types.
</li>
<li>
 Function types <span class="bracket"><span class="id">Tfunction</span> <span class="id">targs</span> <span class="id">tres</span></span> specify the number and types
  of the function arguments (list <span class="bracket"><span class="id">targs</span></span>), and the type of the
  function result (<span class="bracket"><span class="id">tres</span></span>).  Variadic functions and old-style unprototyped
  functions are not supported.
</li>
</ul>
</div>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="type">type</a></span> : <span class="kwd">Type</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="Tvoid">Tvoid</a></span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#type">type</a></span>                                    <span class="docright">(* the <span class="bracket"><span class="id">void</span></span> type  *)</span><br/>
&nbsp;&nbsp;| <span class="id"><a name="Tint">Tint</a></span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#intsize">intsize</a></span> -&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#signedness">signedness</a></span> -&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#attr">attr</a></span> -&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#type">type</a></span>    <span class="docright">(* integer types  *)</span><br/>
&nbsp;&nbsp;| <span class="id"><a name="Tlong">Tlong</a></span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#signedness">signedness</a></span> -&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#attr">attr</a></span> -&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#type">type</a></span>              <span class="docright">(* 64-bit integer types  *)</span><br/>
&nbsp;&nbsp;| <span class="id"><a name="Tfloat">Tfloat</a></span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#floatsize">floatsize</a></span> -&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#attr">attr</a></span> -&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#type">type</a></span>              <span class="docright">(* floating-point types  *)</span><br/>
&nbsp;&nbsp;| <span class="id"><a name="Tpointer">Tpointer</a></span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#type">type</a></span> -&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#attr">attr</a></span> -&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#type">type</a></span>                 <span class="docright">(* pointer types (<span class="bracket">*<span class="id">ty</span></span>)  *)</span><br/>
&nbsp;&nbsp;| <span class="id"><a name="Tarray">Tarray</a></span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#type">type</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#attr">attr</a></span> -&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#type">type</a></span>              <span class="docright">(* array types (<span class="bracket"><span class="id">ty</span>[<span class="id">len</span>]</span>)  *)</span><br/>
&nbsp;&nbsp;| <span class="id"><a name="Tfunction">Tfunction</a></span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#typelist">typelist</a></span> -&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#type">type</a></span> -&gt; <span class="id"><a href="compcert.common.AST.html#calling_convention">calling_convention</a></span> -&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#type">type</a></span>    <span class="docright">(* function types  *)</span><br/>
&nbsp;&nbsp;| <span class="id"><a name="Tstruct">Tstruct</a></span>: <span class="id"><a href="compcert.common.AST.html#ident">ident</a></span> -&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#attr">attr</a></span> -&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#type">type</a></span>                 <span class="docright">(* struct types  *)</span><br/>
&nbsp;&nbsp;| <span class="id"><a name="Tunion">Tunion</a></span>: <span class="id"><a href="compcert.common.AST.html#ident">ident</a></span> -&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#attr">attr</a></span> -&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#type">type</a></span>                  <span class="docright">(* union types  *)</span><br/>
<span class="kwd">with</span> <span class="id"><a name="typelist">typelist</a></span> : <span class="kwd">Type</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="Tnil">Tnil</a></span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#typelist">typelist</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="Tcons">Tcons</a></span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#type">type</a></span> -&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#typelist">typelist</a></span> -&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#typelist">typelist</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="intsize_eq">intsize_eq</a></span>: <span class="kwd">forall</span> (<span class="id">s1</span> <span class="id">s2</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#intsize">intsize</a></span>), {<span class="id"><a href="compcert.cfrontend.Ctypes.html#s1">s1</a></span>=<span class="id"><a href="compcert.cfrontend.Ctypes.html#s2">s2</a></span>} + {<span class="id"><a href="compcert.cfrontend.Ctypes.html#s1">s1</a></span>&lt;&gt;<span class="id"><a href="compcert.cfrontend.Ctypes.html#s2">s2</a></span>}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4245')">Proof.</div>
<div class="proofscript" id="proof4245">
&nbsp;&nbsp;<span class="id">decide</span> <span class="id">equality</span>.<br/>
Defined.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="type_eq">type_eq</a></span>: <span class="kwd">forall</span> (<span class="id">ty1</span> <span class="id">ty2</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#type">type</a></span>), {<span class="id"><a href="compcert.cfrontend.Ctypes.html#ty1">ty1</a></span>=<span class="id"><a href="compcert.cfrontend.Ctypes.html#ty2">ty2</a></span>} + {<span class="id"><a href="compcert.cfrontend.Ctypes.html#ty1">ty1</a></span>&lt;&gt;<span class="id"><a href="compcert.cfrontend.Ctypes.html#ty2">ty2</a></span>}<br/>
<span class="kwd">with</span> <span class="id"><a name="typelist_eq">typelist_eq</a></span>: <span class="kwd">forall</span> (<span class="id">tyl1</span> <span class="id">tyl2</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#typelist">typelist</a></span>), {<span class="id"><a href="compcert.cfrontend.Ctypes.html#tyl1">tyl1</a></span>=<span class="id"><a href="compcert.cfrontend.Ctypes.html#tyl2">tyl2</a></span>} + {<span class="id"><a href="compcert.cfrontend.Ctypes.html#tyl1">tyl1</a></span>&lt;&gt;<span class="id"><a href="compcert.cfrontend.Ctypes.html#tyl2">tyl2</a></span>}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4246')">Proof.</div>
<div class="proofscript" id="proof4246">
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> (<span class="id">x</span> <span class="id">y</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#signedness">signedness</a></span>), {<span class="id"><a href="compcert.cfrontend.Ctypes.html#x">x</a></span>=<span class="id"><a href="compcert.cfrontend.Ctypes.html#y">y</a></span>} + {<span class="id"><a href="compcert.cfrontend.Ctypes.html#x">x</a></span>&lt;&gt;<span class="id"><a href="compcert.cfrontend.Ctypes.html#y">y</a></span>}) <span class="tactic">by</span> <span class="id">decide</span> <span class="id">equality</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> (<span class="id">x</span> <span class="id">y</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#floatsize">floatsize</a></span>), {<span class="id"><a href="compcert.cfrontend.Ctypes.html#x">x</a></span>=<span class="id"><a href="compcert.cfrontend.Ctypes.html#y">y</a></span>} + {<span class="id"><a href="compcert.cfrontend.Ctypes.html#x">x</a></span>&lt;&gt;<span class="id"><a href="compcert.cfrontend.Ctypes.html#y">y</a></span>}) <span class="tactic">by</span> <span class="id">decide</span> <span class="id">equality</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> (<span class="id">x</span> <span class="id">y</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#attr">attr</a></span>), {<span class="id"><a href="compcert.cfrontend.Ctypes.html#x">x</a></span>=<span class="id"><a href="compcert.cfrontend.Ctypes.html#y">y</a></span>} + {<span class="id"><a href="compcert.cfrontend.Ctypes.html#x">x</a></span>&lt;&gt;<span class="id"><a href="compcert.cfrontend.Ctypes.html#y">y</a></span>}).<br/>
&nbsp;&nbsp;{ <span class="id">decide</span> <span class="id">equality</span>. <span class="id">decide</span> <span class="id">equality</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.NArith.BinNat.html#N.eq_dec">N.eq_dec</a></span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Bool.Bool.html#bool_dec">bool_dec</a></span>. }<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="id"><a href="compcert.common.AST.html#ident_eq">ident_eq</a></span> <span class="id"><a href="compcert.lib.Coqlib.html#zeq">zeq</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Bool.Bool.html#bool_dec">bool_dec</a></span> <span class="id"><a href="compcert.common.AST.html#ident_eq">ident_eq</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#intsize_eq">intsize_eq</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">decide</span> <span class="id">equality</span>.<br/>
&nbsp;&nbsp;<span class="id">decide</span> <span class="id">equality</span>.<br/>
&nbsp;&nbsp;<span class="id">decide</span> <span class="id">equality</span>.<br/>
Defined.</div>
<br/>
<span class="id">Opaque</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#type_eq">type_eq</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#typelist_eq">typelist_eq</a></span>.<br/>
<br/>
<div class="doc">Extract the attributes of a type. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="attr_of_type">attr_of_type</a></span> (<span class="id">ty</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#type">type</a></span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#ty">ty</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tvoid">Tvoid</a></span> =&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#noattr">noattr</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tint">Tint</a></span> <span class="id">sz</span> <span class="id">si</span> <span class="id">a</span> =&gt; <span class="id">a</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tlong">Tlong</a></span> <span class="id">si</span> <span class="id">a</span> =&gt; <span class="id">a</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tfloat">Tfloat</a></span> <span class="id">sz</span> <span class="id">a</span> =&gt; <span class="id">a</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tpointer">Tpointer</a></span> <span class="id">elt</span> <span class="id">a</span> =&gt; <span class="id">a</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tarray">Tarray</a></span> <span class="id">elt</span> <span class="id">sz</span> <span class="id">a</span> =&gt; <span class="id">a</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tfunction">Tfunction</a></span> <span class="id">args</span> <span class="id">res</span> <span class="id">cc</span> =&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#noattr">noattr</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tstruct">Tstruct</a></span> <span class="id">id</span> <span class="id">a</span> =&gt; <span class="id">a</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tunion">Tunion</a></span> <span class="id">id</span> <span class="id">a</span> =&gt; <span class="id">a</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<div class="doc">Change the top-level attributes of a type </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="change_attributes">change_attributes</a></span> (<span class="id">f</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#attr">attr</a></span> -&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#attr">attr</a></span>) (<span class="id">ty</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#type">type</a></span>) : <span class="id"><a href="compcert.cfrontend.Ctypes.html#type">type</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#ty">ty</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tvoid">Tvoid</a></span> =&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#ty">ty</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tint">Tint</a></span> <span class="id">sz</span> <span class="id">si</span> <span class="id">a</span> =&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tint">Tint</a></span> <span class="id">sz</span> <span class="id">si</span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#f">f</a></span> <span class="id">a</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tlong">Tlong</a></span> <span class="id">si</span> <span class="id">a</span> =&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tlong">Tlong</a></span> <span class="id">si</span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#f">f</a></span> <span class="id">a</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tfloat">Tfloat</a></span> <span class="id">sz</span> <span class="id">a</span> =&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tfloat">Tfloat</a></span> <span class="id">sz</span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#f">f</a></span> <span class="id">a</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tpointer">Tpointer</a></span> <span class="id">elt</span> <span class="id">a</span> =&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tpointer">Tpointer</a></span> <span class="id">elt</span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#f">f</a></span> <span class="id">a</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tarray">Tarray</a></span> <span class="id">elt</span> <span class="id">sz</span> <span class="id">a</span> =&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tarray">Tarray</a></span> <span class="id">elt</span> <span class="id">sz</span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#f">f</a></span> <span class="id">a</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tfunction">Tfunction</a></span> <span class="id">args</span> <span class="id">res</span> <span class="id">cc</span> =&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#ty">ty</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tstruct">Tstruct</a></span> <span class="id">id</span> <span class="id">a</span> =&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tstruct">Tstruct</a></span> <span class="id">id</span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#f">f</a></span> <span class="id">a</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tunion">Tunion</a></span> <span class="id">id</span> <span class="id">a</span> =&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tunion">Tunion</a></span> <span class="id">id</span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#f">f</a></span> <span class="id">a</span>)<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<div class="doc">Erase the top-level attributes of a type </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="remove_attributes">remove_attributes</a></span> (<span class="id">ty</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#type">type</a></span>) : <span class="id"><a href="compcert.cfrontend.Ctypes.html#type">type</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Ctypes.html#change_attributes">change_attributes</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#noattr">noattr</a></span>) <span class="id"><a href="compcert.cfrontend.Ctypes.html#ty">ty</a></span>.<br/>
<br/>
<div class="doc">Add extra attributes to the top-level attributes of a type </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="attr_union">attr_union</a></span> (<span class="id">a1</span> <span class="id">a2</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#attr">attr</a></span>) : <span class="id"><a href="compcert.cfrontend.Ctypes.html#attr">attr</a></span> :=<br/>
&nbsp;&nbsp;{| <span class="id"><a href="compcert.cfrontend.Ctypes.html#mk_attr">attr_volatile</a></span> := <span class="id"><a href="compcert.cfrontend.Ctypes.html#a1">a1</a></span>.(<span class="id"><a href="compcert.cfrontend.Ctypes.html#attr_volatile">attr_volatile</a></span>) || <span class="id"><a href="compcert.cfrontend.Ctypes.html#a2">a2</a></span>.(<span class="id"><a href="compcert.cfrontend.Ctypes.html#attr_volatile">attr_volatile</a></span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">attr_alignas</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#a1">a1</a></span>.(<span class="id"><a href="compcert.cfrontend.Ctypes.html#attr_alignas">attr_alignas</a></span>), <span class="id"><a href="compcert.cfrontend.Ctypes.html#a2">a2</a></span>.(<span class="id"><a href="compcert.cfrontend.Ctypes.html#attr_alignas">attr_alignas</a></span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>, <span class="id">al</span> =&gt; <span class="id">al</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">al</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id">al</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">n1</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">n2</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.NArith.BinNat.html#N.max">N.max</a></span> <span class="id">n1</span> <span class="id">n2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;|}.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="merge_attributes">merge_attributes</a></span> (<span class="id">ty</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#type">type</a></span>) (<span class="id">a</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#attr">attr</a></span>) : <span class="id"><a href="compcert.cfrontend.Ctypes.html#type">type</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Ctypes.html#change_attributes">change_attributes</a></span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#attr_union">attr_union</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#a">a</a></span>) <span class="id"><a href="compcert.cfrontend.Ctypes.html#ty">ty</a></span>.<br/>
<br/>
<div class="doc">Syntax for <span class="bracket"><span class="kwd">struct</span></span> and <span class="bracket"><span class="id">union</span></span> definitions.  <span class="bracket"><span class="kwd">struct</span></span> and <span class="bracket"><span class="id">union</span></span>
  are collectively called "composites".  Each compilation unit
  comes with a list of top-level definitions of composites. </div>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="struct_or_union">struct_or_union</a></span> : <span class="kwd">Type</span> := <span class="id"><a name="Struct">Struct</a></span> | <span class="id"><a name="Union">Union</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="members">members</a></span> : <span class="kwd">Type</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="compcert.common.AST.html#ident">ident</a></span> * <span class="id"><a href="compcert.cfrontend.Ctypes.html#type">type</a></span>).<br/>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="composite_definition">composite_definition</a></span> : <span class="kwd">Type</span> :=<br/>
&nbsp;&nbsp;<span class="id"><a name="Composite">Composite</a></span> (<span class="id">id</span>: <span class="id"><a href="compcert.common.AST.html#ident">ident</a></span>) (<span class="id">su</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#struct_or_union">struct_or_union</a></span>) (<span class="id">m</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#members">members</a></span>) (<span class="id">a</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#attr">attr</a></span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="name_composite_def">name_composite_def</a></span> (<span class="id">c</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_definition">composite_definition</a></span>) : <span class="id"><a href="compcert.common.AST.html#ident">ident</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#c">c</a></span> <span class="kwd">with</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#Composite">Composite</a></span> <span class="id">id</span> <span class="id">su</span> <span class="id">m</span> <span class="id">a</span> =&gt; <span class="id">id</span> <span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="composite_def_eq">composite_def_eq</a></span> (<span class="id">x</span> <span class="id">y</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_definition">composite_definition</a></span>): {<span class="id"><a href="compcert.cfrontend.Ctypes.html#x">x</a></span>=<span class="id"><a href="compcert.cfrontend.Ctypes.html#y">y</a></span>} + {<span class="id"><a href="compcert.cfrontend.Ctypes.html#x">x</a></span>&lt;&gt;<span class="id"><a href="compcert.cfrontend.Ctypes.html#y">y</a></span>}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4247')">Proof.</div>
<div class="proofscript" id="proof4247">
&nbsp;&nbsp;<span class="id">decide</span> <span class="id">equality</span>.<br/>
- <span class="id">decide</span> <span class="id">equality</span>. <span class="id">decide</span> <span class="id">equality</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.NArith.BinNat.html#N.eq_dec">N.eq_dec</a></span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Bool.Bool.html#bool_dec">bool_dec</a></span>.<br/>
- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#list_eq_dec">list_eq_dec</a></span>. <span class="id">decide</span> <span class="id">equality</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#type_eq">type_eq</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.AST.html#ident_eq">ident_eq</a></span>.<br/>
- <span class="id">decide</span> <span class="id">equality</span>.<br/>
- <span class="tactic">apply</span> <span class="id"><a href="compcert.common.AST.html#ident_eq">ident_eq</a></span>.<br/>
Defined.</div>
<br/>
<span class="kwd">Global</span> <span class="id">Opaque</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_def_eq">composite_def_eq</a></span>. <br/>
<br/>
<div class="doc">For type-checking, compilation and semantics purposes, the composite
  definitions are collected in the following <span class="bracket"><span class="id">composite_env</span></span> environment.
  The <span class="bracket"><span class="id">composite</span></span> record contains additional information compared with
  the <span class="bracket"><span class="id">composite_definition</span></span>, such as size and alignment information. </div>
<br/>
<span class="kwd">Record</span> <span class="id"><a name="composite">composite</a></span> : <span class="kwd">Type</span> := {<br/>
&nbsp;&nbsp;<span class="id"><a name="co_su">co_su</a></span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#struct_or_union">struct_or_union</a></span>;<br/>
&nbsp;&nbsp;<span class="id"><a name="co_members">co_members</a></span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#members">members</a></span>;<br/>
&nbsp;&nbsp;<span class="id"><a name="co_attr">co_attr</a></span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#attr">attr</a></span>;<br/>
&nbsp;&nbsp;<span class="id"><a name="co_sizeof">co_sizeof</a></span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>;<br/>
&nbsp;&nbsp;<span class="id"><a name="co_alignof">co_alignof</a></span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>;<br/>
&nbsp;&nbsp;<span class="id"><a name="co_rank">co_rank</a></span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>;<br/>
&nbsp;&nbsp;<span class="id"><a name="co_sizeof_pos">co_sizeof_pos</a></span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#co_sizeof">co_sizeof</a></span> &gt;= 0;<br/>
&nbsp;&nbsp;<span class="id"><a name="co_alignof_two_p">co_alignof_two_p</a></span>: <span class="id">exists</span> <span class="id">n</span>, <span class="id"><a href="compcert.cfrontend.Ctypes.html#co_alignof">co_alignof</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_power_nat">two_power_nat</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#n">n</a></span>;<br/>
&nbsp;&nbsp;<span class="id"><a name="co_sizeof_alignof">co_sizeof_alignof</a></span>: (<span class="id"><a href="compcert.cfrontend.Ctypes.html#co_alignof">co_alignof</a></span> | <span class="id"><a href="compcert.cfrontend.Ctypes.html#co_sizeof">co_sizeof</a></span>)<br/>
}.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="composite_env">composite_env</a></span> : <span class="kwd">Type</span> := <span class="id"><a href="compcert.lib.Maps.html#PTree.t">PTree.t</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#composite">composite</a></span>.<br/>
<br/>
<h1> Operations over types </h1>
<br/>
<h2> Conversions </h2>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="type_int32s">type_int32s</a></span> := <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tint">Tint</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#I32">I32</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#Signed">Signed</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#noattr">noattr</a></span>.<br/>
<span class="kwd">Definition</span> <span class="id"><a name="type_bool">type_bool</a></span> := <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tint">Tint</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#IBool">IBool</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#Signed">Signed</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#noattr">noattr</a></span>.<br/>
<br/>
<div class="doc">The usual unary conversion.  Promotes small integer types to <span class="bracket"><span class="id">signed</span> <span class="id">int32</span></span>
  and degrades array types and function types to pointer types.
  Attributes are erased. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="typeconv">typeconv</a></span> (<span class="id">ty</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#type">type</a></span>) : <span class="id"><a href="compcert.cfrontend.Ctypes.html#type">type</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#ty">ty</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tint">Tint</a></span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#I8">I8</a></span> | <span class="id"><a href="compcert.cfrontend.Ctypes.html#I16">I16</a></span> | <span class="id"><a href="compcert.cfrontend.Ctypes.html#IBool">IBool</a></span>) <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tint">Tint</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#I32">I32</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#Signed">Signed</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#noattr">noattr</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tarray">Tarray</a></span> <span class="id">t</span> <span class="id">sz</span> <span class="id">a</span>       =&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tpointer">Tpointer</a></span> <span class="id">t</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#noattr">noattr</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tfunction">Tfunction</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>     =&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tpointer">Tpointer</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#ty">ty</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#noattr">noattr</a></span><br/>
&nbsp;&nbsp;| <span class="id">_</span>                   =&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#remove_attributes">remove_attributes</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#ty">ty</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<div class="doc">Default conversion for arguments to an unprototyped or variadic function.
  Like <span class="bracket"><span class="id">typeconv</span></span> but also converts single floats to double floats. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="default_argument_conversion">default_argument_conversion</a></span> (<span class="id">ty</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#type">type</a></span>) : <span class="id"><a href="compcert.cfrontend.Ctypes.html#type">type</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#ty">ty</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tint">Tint</a></span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#I8">I8</a></span> | <span class="id"><a href="compcert.cfrontend.Ctypes.html#I16">I16</a></span> | <span class="id"><a href="compcert.cfrontend.Ctypes.html#IBool">IBool</a></span>) <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tint">Tint</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#I32">I32</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#Signed">Signed</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#noattr">noattr</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tfloat">Tfloat</a></span> <span class="id">_</span> <span class="id">_</span>          =&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tfloat">Tfloat</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#F64">F64</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#noattr">noattr</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tarray">Tarray</a></span> <span class="id">t</span> <span class="id">sz</span> <span class="id">a</span>       =&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tpointer">Tpointer</a></span> <span class="id">t</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#noattr">noattr</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tfunction">Tfunction</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>     =&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tpointer">Tpointer</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#ty">ty</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#noattr">noattr</a></span><br/>
&nbsp;&nbsp;| <span class="id">_</span>                   =&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#remove_attributes">remove_attributes</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#ty">ty</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<h2> Complete types </h2>
<br/>
<div class="doc">A type is complete if it fully describes an object.
  All struct and union names appearing in the type must be defined,
  unless they occur under a pointer or function type.  <span class="bracket"><span class="id">void</span></span> and
  function types are incomplete types. </div>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="complete_type">complete_type</a></span> (<span class="id">env</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_env">composite_env</a></span>) (<span class="id">t</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#type">type</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#t">t</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tvoid">Tvoid</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tint">Tint</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tlong">Tlong</a></span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tfloat">Tfloat</a></span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tpointer">Tpointer</a></span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tarray">Tarray</a></span> <span class="id">t</span>' <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#complete_type">complete_type</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> <span class="id">t</span>'<br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tfunction">Tfunction</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tstruct">Tstruct</a></span> <span class="id">id</span> <span class="id">_</span> | <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tunion">Tunion</a></span> <span class="id">id</span> <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span>!<span class="id">id</span> <span class="kwd">with</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">co</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> | <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> <span class="kwd">end</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="complete_or_function_type">complete_or_function_type</a></span> (<span class="id">env</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_env">composite_env</a></span>) (<span class="id">t</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#type">type</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#t">t</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tfunction">Tfunction</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span><br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#complete_type">complete_type</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#t">t</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<h2> Alignment of a type </h2>
<br/>
<div class="doc">Adjust the natural alignment <span class="bracket"><span class="id">al</span></span> based on the attributes <span class="bracket"><span class="id">a</span></span> attached
  to the type.  If an "alignas" attribute is given, use it as alignment
  in preference to <span class="bracket"><span class="id">al</span></span>. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="align_attr">align_attr</a></span> (<span class="id">a</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#attr">attr</a></span>) (<span class="id">al</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#attr_alignas">attr_alignas</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#a">a</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">l</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_N">Z.of_N</a></span> <span class="id">l</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#al">al</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<div class="doc">In the ISO C standard, alignment is defined only for complete
  types.  However, it is convenient that <span class="bracket"><span class="id">alignof</span></span> is a total
  function.  For incomplete types, it returns 1. </div>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="alignof">alignof</a></span> (<span class="id">env</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_env">composite_env</a></span>) (<span class="id">t</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#type">type</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Ctypes.html#align_attr">align_attr</a></span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#attr_of_type">attr_of_type</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#t">t</a></span>)<br/>
&nbsp;&nbsp;&nbsp;(<span class="kwd">match</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#t">t</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tvoid">Tvoid</a></span> =&gt; 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tint">Tint</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#I8">I8</a></span> <span class="id">_</span> <span class="id">_</span> =&gt; 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tint">Tint</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#I16">I16</a></span> <span class="id">_</span> <span class="id">_</span> =&gt; 2<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tint">Tint</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#I32">I32</a></span> <span class="id">_</span> <span class="id">_</span> =&gt; 4<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tint">Tint</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#IBool">IBool</a></span> <span class="id">_</span> <span class="id">_</span> =&gt; 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tlong">Tlong</a></span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="compcert.x86_64.Archi.html#align_int64">Archi.align_int64</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tfloat">Tfloat</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#F32">F32</a></span> <span class="id">_</span> =&gt; 4<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tfloat">Tfloat</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#F64">F64</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="compcert.x86_64.Archi.html#align_float64">Archi.align_float64</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tpointer">Tpointer</a></span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="kwd">if</span> <span class="id"><a href="compcert.x86_64.Archi.html#ptr64">Archi.ptr64</a></span> <span class="kwd">then</span> 8 <span class="kwd">else</span> 4<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tarray">Tarray</a></span> <span class="id">t</span>' <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#alignof">alignof</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> <span class="id">t</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tfunction">Tfunction</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> =&gt; 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tstruct">Tstruct</a></span> <span class="id">id</span> <span class="id">_</span> | <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tunion">Tunion</a></span> <span class="id">id</span> <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span>!<span class="id">id</span> <span class="kwd">with</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">co</span> =&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#co_alignof">co_alignof</a></span> <span class="id">co</span> | <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; 1 <span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>).<br/>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="align_attr_two_p">align_attr_two_p</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">al</span> <span class="id">a</span>,<br/>
&nbsp;&nbsp;(<span class="id">exists</span> <span class="id">n</span>, <span class="id"><a href="compcert.cfrontend.Ctypes.html#al">al</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_power_nat">two_power_nat</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#n">n</a></span>) -&gt;<br/>
&nbsp;&nbsp;(<span class="id">exists</span> <span class="id">n</span>, <span class="id"><a href="compcert.cfrontend.Ctypes.html#align_attr">align_attr</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#a">a</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#al">al</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_power_nat">two_power_nat</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#n">n</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4248')">Proof.</div>
<div class="proofscript" id="proof4248">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#align_attr">align_attr</a></span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#attr_alignas">attr_alignas</a></span> <span class="id">a</span>).<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.NArith.BinNat.html#N.to_nat">N.to_nat</a></span> <span class="id">n</span>). <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#two_power_nat_two_p">two_power_nat_two_p</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Znat.html#N_nat_Z">N_nat_Z</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="alignof_two_p">alignof_two_p</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">env</span> <span class="id">t</span>, <span class="id">exists</span> <span class="id">n</span>, <span class="id"><a href="compcert.cfrontend.Ctypes.html#alignof">alignof</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#t">t</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_power_nat">two_power_nat</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#n">n</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4249')">Proof.</div>
<div class="proofscript" id="proof4249">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">t</span>; <span class="tactic">apply</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#align_attr_two_p">align_attr_two_p</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> 0%<span class="id">nat</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> 0%<span class="id">nat</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> 1%<span class="id">nat</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> 2%<span class="id">nat</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> 0%<span class="id">nat</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.x86_64.Archi.html#align_int64">Archi.align_int64</a></span>. <span class="tactic">destruct</span> <span class="id"><a href="compcert.x86_64.Archi.html#ptr64">Archi.ptr64</a></span>; ((<span class="id">exists</span> 2%<span class="id">nat</span>; <span class="tactic">reflexivity</span>) || (<span class="id">exists</span> 3%<span class="id">nat</span>; <span class="tactic">reflexivity</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">f</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> 2%<span class="id">nat</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.x86_64.Archi.html#align_float64">Archi.align_float64</a></span>. <span class="tactic">destruct</span> <span class="id"><a href="compcert.x86_64.Archi.html#ptr64">Archi.ptr64</a></span>; ((<span class="id">exists</span> 2%<span class="id">nat</span>; <span class="tactic">reflexivity</span>) || (<span class="id">exists</span> 3%<span class="id">nat</span>; <span class="tactic">reflexivity</span>)).<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="kwd">if</span> <span class="id"><a href="compcert.x86_64.Archi.html#ptr64">Archi.ptr64</a></span> <span class="kwd">then</span> 3%<span class="id">nat</span> <span class="kwd">else</span> 2%<span class="id">nat</span>); <span class="tactic">destruct</span> <span class="id"><a href="compcert.x86_64.Archi.html#ptr64">Archi.ptr64</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHt</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> 0%<span class="id">nat</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">env</span>!<span class="id">i</span>). <span class="tactic">apply</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co_alignof_two_p">co_alignof_two_p</a></span>. <span class="id">exists</span> 0%<span class="id">nat</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">env</span>!<span class="id">i</span>). <span class="tactic">apply</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co_alignof_two_p">co_alignof_two_p</a></span>. <span class="id">exists</span> 0%<span class="id">nat</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="alignof_pos">alignof_pos</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">env</span> <span class="id">t</span>, <span class="id"><a href="compcert.cfrontend.Ctypes.html#alignof">alignof</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#t">t</a></span> &gt; 0.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4250')">Proof.</div>
<div class="proofscript" id="proof4250">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#alignof_two_p">alignof_two_p</a></span> <span class="id">env</span> <span class="id">t</span>) <span class="kwd">as</span> [<span class="id">n</span> <span class="id">EQ</span>]. <span class="tactic">rewrite</span> <span class="id">EQ</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#two_power_nat_pos">two_power_nat_pos</a></span>.<br/>
Qed.</div>
<br/>
<h2> Size of a type </h2>
<br/>
<div class="doc">In the ISO C standard, size is defined only for complete
  types.  However, it is convenient that <span class="bracket"><span class="id">sizeof</span></span> is a total
  function.  For <span class="bracket"><span class="id">void</span></span> and function types, we follow GCC and define
  their size to be 1.  For undefined structures and unions, the size is
  arbitrarily taken to be 0.
</div>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="sizeof">sizeof</a></span> (<span class="id">env</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_env">composite_env</a></span>) (<span class="id">t</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#type">type</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#t">t</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tvoid">Tvoid</a></span> =&gt; 1<br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tint">Tint</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#I8">I8</a></span> <span class="id">_</span> <span class="id">_</span> =&gt; 1<br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tint">Tint</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#I16">I16</a></span> <span class="id">_</span> <span class="id">_</span> =&gt; 2<br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tint">Tint</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#I32">I32</a></span> <span class="id">_</span> <span class="id">_</span> =&gt; 4<br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tint">Tint</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#IBool">IBool</a></span> <span class="id">_</span> <span class="id">_</span> =&gt; 1<br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tlong">Tlong</a></span> <span class="id">_</span> <span class="id">_</span> =&gt; 8<br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tfloat">Tfloat</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#F32">F32</a></span> <span class="id">_</span> =&gt; 4<br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tfloat">Tfloat</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#F64">F64</a></span> <span class="id">_</span> =&gt; 8<br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tpointer">Tpointer</a></span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="kwd">if</span> <span class="id"><a href="compcert.x86_64.Archi.html#ptr64">Archi.ptr64</a></span> <span class="kwd">then</span> 8 <span class="kwd">else</span> 4<br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tarray">Tarray</a></span> <span class="id">t</span>' <span class="id">n</span> <span class="id">_</span> =&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#sizeof">sizeof</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> <span class="id">t</span>' * <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.max">Z.max</a></span> 0 <span class="id">n</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tfunction">Tfunction</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> =&gt; 1<br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tstruct">Tstruct</a></span> <span class="id">id</span> <span class="id">_</span> | <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tunion">Tunion</a></span> <span class="id">id</span> <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span>!<span class="id">id</span> <span class="kwd">with</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">co</span> =&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#co_sizeof">co_sizeof</a></span> <span class="id">co</span> | <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; 0 <span class="kwd">end</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sizeof_pos">sizeof_pos</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">env</span> <span class="id">t</span>, <span class="id"><a href="compcert.cfrontend.Ctypes.html#sizeof">sizeof</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#t">t</a></span> &gt;= 0.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4251')">Proof.</div>
<div class="proofscript" id="proof4251">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">t</span>; <span class="tactic">simpl</span>; <span class="tactic">try</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">i</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">f</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="compcert.x86_64.Archi.html#ptr64">Archi.ptr64</a></span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="id">change</span> 0 <span class="kwd">with</span> (0 * <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.max">Z.max</a></span> 0 <span class="id">z</span>) <span class="tactic">at</span> 2. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zmult_ge_compat_r">Zmult_ge_compat_r</a></span>. <span class="tactic">auto</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">env</span>!<span class="id">i</span>). <span class="tactic">apply</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co_sizeof_pos">co_sizeof_pos</a></span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">env</span>!<span class="id">i</span>). <span class="tactic">apply</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co_sizeof_pos">co_sizeof_pos</a></span>. <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<div class="doc">The size of a type is an integral multiple of its alignment,
  unless the alignment was artificially increased with the <span class="bracket"><span class="id">__Alignas</span></span>
  attribute. </div>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="naturally_aligned">naturally_aligned</a></span> (<span class="id">t</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#type">type</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Ctypes.html#attr_alignas">attr_alignas</a></span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#attr_of_type">attr_of_type</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#t">t</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> /\<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#t">t</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tarray">Tarray</a></span> <span class="id">t</span>' <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#naturally_aligned">naturally_aligned</a></span> <span class="id">t</span>'<br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sizeof_alignof_compat">sizeof_alignof_compat</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">env</span> <span class="id">t</span>, <span class="id"><a href="compcert.cfrontend.Ctypes.html#naturally_aligned">naturally_aligned</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#t">t</a></span> -&gt; (<span class="id"><a href="compcert.cfrontend.Ctypes.html#alignof">alignof</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#t">t</a></span> | <span class="id"><a href="compcert.cfrontend.Ctypes.html#sizeof">sizeof</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#t">t</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4252')">Proof.</div>
<div class="proofscript" id="proof4252">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">t</span>; <span class="tactic">intros</span> [<span class="id">A</span> <span class="id">B</span>]; <span class="tactic">unfold</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#alignof">alignof</a></span>, <span class="id"><a href="compcert.cfrontend.Ctypes.html#align_attr">align_attr</a></span>; <span class="tactic">rewrite</span> <span class="id">A</span>; <span class="tactic">simpl</span>.<br/>
- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_refl">Z.divide_refl</a></span>.<br/>
- <span class="tactic">destruct</span> <span class="id">i</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_refl">Z.divide_refl</a></span>.<br/>
- <span class="id">exists</span> (8 / <span class="id"><a href="compcert.x86_64.Archi.html#align_int64">Archi.align_int64</a></span>). <span class="tactic">unfold</span> <span class="id"><a href="compcert.x86_64.Archi.html#align_int64">Archi.align_int64</a></span>; <span class="tactic">destruct</span> <span class="id"><a href="compcert.x86_64.Archi.html#ptr64">Archi.ptr64</a></span>; <span class="tactic">reflexivity</span>.<br/>
- <span class="tactic">destruct</span> <span class="id">f</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_refl">Z.divide_refl</a></span>. <span class="id">exists</span> (8 / <span class="id"><a href="compcert.x86_64.Archi.html#align_float64">Archi.align_float64</a></span>). <span class="tactic">unfold</span> <span class="id"><a href="compcert.x86_64.Archi.html#align_float64">Archi.align_float64</a></span>; <span class="tactic">destruct</span> <span class="id"><a href="compcert.x86_64.Archi.html#ptr64">Archi.ptr64</a></span>; <span class="tactic">reflexivity</span>.<br/>
- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_refl">Z.divide_refl</a></span>.<br/>
- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_mul_l">Z.divide_mul_l</a></span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_refl">Z.divide_refl</a></span>.<br/>
- <span class="tactic">destruct</span> (<span class="id">env</span>!<span class="id">i</span>). <span class="tactic">apply</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co_sizeof_alignof">co_sizeof_alignof</a></span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_0_r">Z.divide_0_r</a></span>.<br/>
- <span class="tactic">destruct</span> (<span class="id">env</span>!<span class="id">i</span>). <span class="tactic">apply</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co_sizeof_alignof">co_sizeof_alignof</a></span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_0_r">Z.divide_0_r</a></span>.<br/>
Qed.</div>
<br/>
<h2> Size and alignment for composite definitions </h2>
<br/>
<div class="doc">The alignment for a structure or union is the max of the alignment
  of its members. </div>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="alignof_composite">alignof_composite</a></span> (<span class="id">env</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_env">composite_env</a></span>) (<span class="id">m</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#members">members</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#m">m</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; 1<br/>
&nbsp;&nbsp;| (<span class="id">id</span>, <span class="id">t</span>) :: <span class="id">m</span>' =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.max">Z.max</a></span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#alignof">alignof</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> <span class="id">t</span>) (<span class="id"><a href="compcert.cfrontend.Ctypes.html#alignof_composite">alignof_composite</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> <span class="id">m</span>')<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<div class="doc">The size of a structure corresponds to its layout: fields are
  laid out consecutively, and padding is inserted to align
  each field to the alignment for its type. </div>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="sizeof_struct">sizeof_struct</a></span> (<span class="id">env</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_env">composite_env</a></span>) (<span class="id">cur</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) (<span class="id">m</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#members">members</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#m">m</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#cur">cur</a></span><br/>
&nbsp;&nbsp;| (<span class="id">id</span>, <span class="id">t</span>) :: <span class="id">m</span>' =&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#sizeof_struct">sizeof_struct</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> (<span class="id"><a href="compcert.lib.Coqlib.html#align">align</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#cur">cur</a></span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#alignof">alignof</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> <span class="id">t</span>) + <span class="id"><a href="compcert.cfrontend.Ctypes.html#sizeof">sizeof</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> <span class="id">t</span>) <span class="id">m</span>'<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<div class="doc">The size of an union is the max of the sizes of its members. </div>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="sizeof_union">sizeof_union</a></span> (<span class="id">env</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_env">composite_env</a></span>) (<span class="id">m</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#members">members</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#m">m</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; 0<br/>
&nbsp;&nbsp;| (<span class="id">id</span>, <span class="id">t</span>) :: <span class="id">m</span>' =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.max">Z.max</a></span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#sizeof">sizeof</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> <span class="id">t</span>) (<span class="id"><a href="compcert.cfrontend.Ctypes.html#sizeof_union">sizeof_union</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> <span class="id">m</span>')<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="alignof_composite_two_p">alignof_composite_two_p</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">env</span> <span class="id">m</span>, <span class="id">exists</span> <span class="id">n</span>, <span class="id"><a href="compcert.cfrontend.Ctypes.html#alignof_composite">alignof_composite</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#m">m</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_power_nat">two_power_nat</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#n">n</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4253')">Proof.</div>
<div class="proofscript" id="proof4253">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">m</span> <span class="kwd">as</span> [|[<span class="id">id</span> <span class="id">t</span>]]; <span class="tactic">simpl</span>.<br/>
- <span class="id">exists</span> 0%<span class="id">nat</span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.max_case">Z.max_case</a></span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#alignof_two_p">alignof_two_p</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="alignof_composite_pos">alignof_composite_pos</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">env</span> <span class="id">m</span> <span class="id">a</span>, <span class="id"><a href="compcert.cfrontend.Ctypes.html#align_attr">align_attr</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#a">a</a></span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#alignof_composite">alignof_composite</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#m">m</a></span>) &gt; 0.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4254')">Proof.</div>
<div class="proofscript" id="proof4254">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#align_attr_two_p">align_attr_two_p</a></span>. <span class="tactic">apply</span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#alignof_composite_two_p">alignof_composite_two_p</a></span> <span class="id">env</span> <span class="id">m</span>).<br/>
&nbsp;&nbsp;<span class="id">instantiate</span> (1 := <span class="id">a</span>). <span class="tactic">intros</span> [<span class="id">n</span> <span class="id">EQ</span>].<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">EQ</span>; <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#two_power_nat_pos">two_power_nat_pos</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sizeof_struct_incr">sizeof_struct_incr</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">env</span> <span class="id">m</span> <span class="id">cur</span>, <span class="id"><a href="compcert.cfrontend.Ctypes.html#cur">cur</a></span> &lt;= <span class="id"><a href="compcert.cfrontend.Ctypes.html#sizeof_struct">sizeof_struct</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#cur">cur</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#m">m</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4255')">Proof.</div>
<div class="proofscript" id="proof4255">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">m</span> <span class="kwd">as</span> [|[<span class="id">id</span> <span class="id">t</span>]]; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
- <span class="tactic">omega</span>.<br/>
- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.le_trans">Z.le_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="compcert.lib.Coqlib.html#align">align</a></span> <span class="id">cur</span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#alignof">alignof</a></span> <span class="id">env</span> <span class="id">t</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#align_le">align_le</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#alignof_pos">alignof_pos</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.le_trans">Z.le_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="compcert.lib.Coqlib.html#align">align</a></span> <span class="id">cur</span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#alignof">alignof</a></span> <span class="id">env</span> <span class="id">t</span>) + <span class="id"><a href="compcert.cfrontend.Ctypes.html#sizeof">sizeof</a></span> <span class="id">env</span> <span class="id">t</span>).<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#sizeof_pos">sizeof_pos</a></span> <span class="id">env</span> <span class="id">t</span>); <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHm</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sizeof_union_pos">sizeof_union_pos</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">env</span> <span class="id">m</span>, 0 &lt;= <span class="id"><a href="compcert.cfrontend.Ctypes.html#sizeof_union">sizeof_union</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#m">m</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4256')">Proof.</div>
<div class="proofscript" id="proof4256">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">m</span> <span class="kwd">as</span> [|[<span class="id">id</span> <span class="id">t</span>]]; <span class="tactic">simpl</span>; <span class="id">xomega</span>.<br/>
Qed.</div>
<br/>
<h2> Byte offset for a field of a structure </h2>
<br/>
<div class="doc"><span class="bracket"><span class="id">field_offset</span> <span class="id">env</span> <span class="id">id</span> <span class="id">fld</span></span> returns the byte offset for field <span class="bracket"><span class="id">id</span></span>
  in a structure whose members are <span class="bracket"><span class="id">fld</span></span>.  Fields are laid out
  consecutively, and padding is inserted to align each field to the
  alignment for its type. </div>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="field_offset_rec">field_offset_rec</a></span> (<span class="id">env</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_env">composite_env</a></span>) (<span class="id">id</span>: <span class="id"><a href="compcert.common.AST.html#ident">ident</a></span>) (<span class="id">fld</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#members">members</a></span>) (<span class="id">pos</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="kwd">struct</span> <span class="id">fld</span>} : <span class="id"><a href="compcert.common.Errors.html#res">res</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#fld">fld</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; <span class="id"><a href="compcert.common.Errors.html#Error">Error</a></span> (<span class="id"><a href="compcert.common.Errors.html#MSG">MSG</a></span> "<span class="id">Unknown</span> <span class="id">field</span> " :: <span class="id"><a href="compcert.common.Errors.html#CTX">CTX</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#id">id</a></span> :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)<br/>
&nbsp;&nbsp;| (<span class="id">id</span>', <span class="id">t</span>) :: <span class="id">fld</span>' =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="compcert.common.AST.html#ident_eq">ident_eq</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#id">id</a></span> <span class="id">id</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> (<span class="id"><a href="compcert.lib.Coqlib.html#align">align</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#pos">pos</a></span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#alignof">alignof</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> <span class="id">t</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#field_offset_rec">field_offset_rec</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#id">id</a></span> <span class="id">fld</span>' (<span class="id"><a href="compcert.lib.Coqlib.html#align">align</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#pos">pos</a></span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#alignof">alignof</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> <span class="id">t</span>) + <span class="id"><a href="compcert.cfrontend.Ctypes.html#sizeof">sizeof</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> <span class="id">t</span>)<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="field_offset">field_offset</a></span> (<span class="id">env</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_env">composite_env</a></span>) (<span class="id">id</span>: <span class="id"><a href="compcert.common.AST.html#ident">ident</a></span>) (<span class="id">fld</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#members">members</a></span>) : <span class="id"><a href="compcert.common.Errors.html#res">res</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Ctypes.html#field_offset_rec">field_offset_rec</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#id">id</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#fld">fld</a></span> 0.<br/>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="field_type">field_type</a></span> (<span class="id">id</span>: <span class="id"><a href="compcert.common.AST.html#ident">ident</a></span>) (<span class="id">fld</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#members">members</a></span>) {<span class="kwd">struct</span> <span class="id">fld</span>} : <span class="id"><a href="compcert.common.Errors.html#res">res</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#type">type</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#fld">fld</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; <span class="id"><a href="compcert.common.Errors.html#Error">Error</a></span> (<span class="id"><a href="compcert.common.Errors.html#MSG">MSG</a></span> "<span class="id">Unknown</span> <span class="id">field</span> " :: <span class="id"><a href="compcert.common.Errors.html#CTX">CTX</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#id">id</a></span> :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)<br/>
&nbsp;&nbsp;| (<span class="id">id</span>', <span class="id">t</span>) :: <span class="id">fld</span>' =&gt; <span class="kwd">if</span> <span class="id"><a href="compcert.common.AST.html#ident_eq">ident_eq</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#id">id</a></span> <span class="id">id</span>' <span class="kwd">then</span> <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id">t</span> <span class="kwd">else</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#field_type">field_type</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#id">id</a></span> <span class="id">fld</span>'<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<div class="doc">Some sanity checks about field offsets.  First, field offsets are
  within the range of acceptable offsets. </div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="field_offset_rec_in_range">field_offset_rec_in_range</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">env</span> <span class="id">id</span> <span class="id">ofs</span> <span class="id">ty</span> <span class="id">fld</span> <span class="id">pos</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Ctypes.html#field_offset_rec">field_offset_rec</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#id">id</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#fld">fld</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#pos">pos</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#ofs">ofs</a></span> -&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#field_type">field_type</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#id">id</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#fld">fld</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#ty">ty</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Ctypes.html#pos">pos</a></span> &lt;= <span class="id"><a href="compcert.cfrontend.Ctypes.html#ofs">ofs</a></span> /\ <span class="id"><a href="compcert.cfrontend.Ctypes.html#ofs">ofs</a></span> + <span class="id"><a href="compcert.cfrontend.Ctypes.html#sizeof">sizeof</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#ty">ty</a></span> &lt;= <span class="id"><a href="compcert.cfrontend.Ctypes.html#sizeof_struct">sizeof_struct</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#pos">pos</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#fld">fld</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4257')">Proof.</div>
<div class="proofscript" id="proof4257">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> <span class="id">ty</span>. <span class="tactic">induction</span> <span class="id">fld</span> <span class="kwd">as</span> [|[<span class="id">i</span> <span class="id">t</span>]]; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
- <span class="tactic">discriminate</span>.<br/>
- <span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.AST.html#ident_eq">ident_eq</a></span> <span class="id">id</span> <span class="id">i</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>. <span class="id">inv</span> <span class="id">H0</span>. <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#align_le">align_le</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#alignof_pos">alignof_pos</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#sizeof_struct_incr">sizeof_struct_incr</a></span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">IHfld</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">A</span> <span class="id">B</span>]. <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.le_trans">Z.le_trans</a></span>; <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.le_trans">Z.le_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="compcert.lib.Coqlib.html#align">align</a></span> <span class="id">pos</span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#alignof">alignof</a></span> <span class="id">env</span> <span class="id">t</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#align_le">align_le</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#alignof_pos">alignof_pos</a></span>. <span class="tactic">generalize</span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#sizeof_pos">sizeof_pos</a></span> <span class="id">env</span> <span class="id">t</span>). <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="field_offset_in_range">field_offset_in_range</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">env</span> <span class="id">fld</span> <span class="id">id</span> <span class="id">ofs</span> <span class="id">ty</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Ctypes.html#field_offset">field_offset</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#id">id</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#fld">fld</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#ofs">ofs</a></span> -&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#field_type">field_type</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#id">id</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#fld">fld</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#ty">ty</a></span> -&gt;<br/>
&nbsp;&nbsp;0 &lt;= <span class="id"><a href="compcert.cfrontend.Ctypes.html#ofs">ofs</a></span> /\ <span class="id"><a href="compcert.cfrontend.Ctypes.html#ofs">ofs</a></span> + <span class="id"><a href="compcert.cfrontend.Ctypes.html#sizeof">sizeof</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#ty">ty</a></span> &lt;= <span class="id"><a href="compcert.cfrontend.Ctypes.html#sizeof_struct">sizeof_struct</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> 0 <span class="id"><a href="compcert.cfrontend.Ctypes.html#fld">fld</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4258')">Proof.</div>
<div class="proofscript" id="proof4258">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#field_offset_rec_in_range">field_offset_rec_in_range</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Second, two distinct fields do not overlap </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="field_offset_no_overlap">field_offset_no_overlap</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">env</span> <span class="id">id1</span> <span class="id">ofs1</span> <span class="id">ty1</span> <span class="id">id2</span> <span class="id">ofs2</span> <span class="id">ty2</span> <span class="id">fld</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Ctypes.html#field_offset">field_offset</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#id1">id1</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#fld">fld</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#ofs1">ofs1</a></span> -&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#field_type">field_type</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#id1">id1</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#fld">fld</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#ty1">ty1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Ctypes.html#field_offset">field_offset</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#id2">id2</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#fld">fld</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#ofs2">ofs2</a></span> -&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#field_type">field_type</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#id2">id2</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#fld">fld</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#ty2">ty2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Ctypes.html#id1">id1</a></span> &lt;&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#id2">id2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Ctypes.html#ofs1">ofs1</a></span> + <span class="id"><a href="compcert.cfrontend.Ctypes.html#sizeof">sizeof</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#ty1">ty1</a></span> &lt;= <span class="id"><a href="compcert.cfrontend.Ctypes.html#ofs2">ofs2</a></span> \/ <span class="id"><a href="compcert.cfrontend.Ctypes.html#ofs2">ofs2</a></span> + <span class="id"><a href="compcert.cfrontend.Ctypes.html#sizeof">sizeof</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#ty2">ty2</a></span> &lt;= <span class="id"><a href="compcert.cfrontend.Ctypes.html#ofs1">ofs1</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4259')">Proof.</div>
<div class="proofscript" id="proof4259">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> <span class="id">fld</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#field_offset">field_offset</a></span>. <span class="tactic">generalize</span> 0 <span class="kwd">as</span> <span class="id">pos</span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">fld</span> <span class="kwd">as</span> [|[<span class="id">i</span> <span class="id">t</span>]]; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
- <span class="tactic">discriminate</span>.<br/>
- <span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.AST.html#ident_eq">ident_eq</a></span> <span class="id">id1</span> <span class="id">i</span>); <span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.AST.html#ident_eq">ident_eq</a></span> <span class="id">id2</span> <span class="id">i</span>).<br/>
+ <span class="tactic">congruence</span>.<br/>
+ <span class="tactic">subst</span> <span class="id">i</span>. <span class="id">inv</span> <span class="id">H</span>; <span class="id">inv</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#field_offset_rec_in_range">field_offset_rec_in_range</a></span>. <span class="id">eexact</span> <span class="id">H1</span>. <span class="tactic">eauto</span>. <span class="tactic">tauto</span>.<br/>
+ <span class="tactic">subst</span> <span class="id">i</span>. <span class="id">inv</span> <span class="id">H1</span>; <span class="id">inv</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#field_offset_rec_in_range">field_offset_rec_in_range</a></span>. <span class="id">eexact</span> <span class="id">H</span>. <span class="tactic">eauto</span>. <span class="tactic">tauto</span>.<br/>
+ <span class="tactic">eapply</span> <span class="id">IHfld</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Third, if a struct is a prefix of another, the offsets of common fields
    are the same. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="field_offset_prefix">field_offset_prefix</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">env</span> <span class="id">id</span> <span class="id">ofs</span> <span class="id">fld2</span> <span class="id">fld1</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Ctypes.html#field_offset">field_offset</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#id">id</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#fld1">fld1</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#ofs">ofs</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Ctypes.html#field_offset">field_offset</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#id">id</a></span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#fld1">fld1</a></span> ++ <span class="id"><a href="compcert.cfrontend.Ctypes.html#fld2">fld2</a></span>) = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#ofs">ofs</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4260')">Proof.</div>
<div class="proofscript" id="proof4260">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> <span class="id">fld1</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#field_offset">field_offset</a></span>. <span class="tactic">generalize</span> 0 <span class="kwd">as</span> <span class="id">pos</span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">fld1</span> <span class="kwd">as</span> [|[<span class="id">i</span> <span class="id">t</span>]]; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
- <span class="tactic">discriminate</span>.<br/>
- <span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.AST.html#ident_eq">ident_eq</a></span> <span class="id">id</span> <span class="id">i</span>); <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Fourth, the position of each field respects its alignment. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="field_offset_aligned">field_offset_aligned</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">env</span> <span class="id">id</span> <span class="id">fld</span> <span class="id">ofs</span> <span class="id">ty</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Ctypes.html#field_offset">field_offset</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#id">id</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#fld">fld</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#ofs">ofs</a></span> -&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#field_type">field_type</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#id">id</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#fld">fld</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#ty">ty</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.cfrontend.Ctypes.html#alignof">alignof</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#ty">ty</a></span> | <span class="id"><a href="compcert.cfrontend.Ctypes.html#ofs">ofs</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4261')">Proof.</div>
<div class="proofscript" id="proof4261">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> <span class="id">ty</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#field_offset">field_offset</a></span>. <span class="tactic">generalize</span> 0 <span class="kwd">as</span> <span class="id">pos</span>. <span class="id">revert</span> <span class="id">fld</span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">fld</span> <span class="kwd">as</span> [|[<span class="id">i</span> <span class="id">t</span>]]; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
- <span class="tactic">discriminate</span>.<br/>
- <span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.AST.html#ident_eq">ident_eq</a></span> <span class="id">id</span> <span class="id">i</span>).<br/>
+ <span class="id">inv</span> <span class="id">H</span>; <span class="id">inv</span> <span class="id">H0</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#align_divides">align_divides</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#alignof_pos">alignof_pos</a></span>.<br/>
+ <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<h2> Access modes </h2>
<br/>
<div class="doc">The <span class="bracket"><span class="id">access_mode</span></span> function describes how a l-value of the given
type must be accessed:
<ul>
<li>
 <span class="bracket"><span class="id">By_value</span> <span class="id">ch</span></span>: access by value, i.e. by loading from the address
  of the l-value using the memory chunk <span class="bracket"><span class="id">ch</span></span>;
</li>
<li>
 <span class="bracket"><span class="id">By_reference</span></span>: access by reference, i.e. by just returning
  the address of the l-value (used for arrays and functions);
</li>
<li>
 <span class="bracket"><span class="id">By_copy</span></span>: access is by reference, assignment is by copy
  (used for <span class="bracket"><span class="kwd">struct</span></span> and <span class="bracket"><span class="id">union</span></span> types)
</li>
<li>
 <span class="bracket"><span class="id">By_nothing</span></span>: no access is possible, e.g. for the <span class="bracket"><span class="id">void</span></span> type.
</li>
</ul>
</div>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="mode">mode</a></span>: <span class="kwd">Type</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="By_value">By_value</a></span>: <span class="id"><a href="compcert.common.AST.html#memory_chunk">memory_chunk</a></span> -&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#mode">mode</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="By_reference">By_reference</a></span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#mode">mode</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="By_copy">By_copy</a></span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#mode">mode</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="By_nothing">By_nothing</a></span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#mode">mode</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="access_mode">access_mode</a></span> (<span class="id">ty</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#type">type</a></span>) : <span class="id"><a href="compcert.cfrontend.Ctypes.html#mode">mode</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#ty">ty</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tint">Tint</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#I8">I8</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#Signed">Signed</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#By_value">By_value</a></span> <span class="id"><a href="compcert.common.AST.html#Mint8signed">Mint8signed</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tint">Tint</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#I8">I8</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#Unsigned">Unsigned</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#By_value">By_value</a></span> <span class="id"><a href="compcert.common.AST.html#Mint8unsigned">Mint8unsigned</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tint">Tint</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#I16">I16</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#Signed">Signed</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#By_value">By_value</a></span> <span class="id"><a href="compcert.common.AST.html#Mint16signed">Mint16signed</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tint">Tint</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#I16">I16</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#Unsigned">Unsigned</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#By_value">By_value</a></span> <span class="id"><a href="compcert.common.AST.html#Mint16unsigned">Mint16unsigned</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tint">Tint</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#I32">I32</a></span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#By_value">By_value</a></span> <span class="id"><a href="compcert.common.AST.html#Mint32">Mint32</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tint">Tint</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#IBool">IBool</a></span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#By_value">By_value</a></span> <span class="id"><a href="compcert.common.AST.html#Mint8unsigned">Mint8unsigned</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tlong">Tlong</a></span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#By_value">By_value</a></span> <span class="id"><a href="compcert.common.AST.html#Mint64">Mint64</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tfloat">Tfloat</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#F32">F32</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#By_value">By_value</a></span> <span class="id"><a href="compcert.common.AST.html#Mfloat32">Mfloat32</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tfloat">Tfloat</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#F64">F64</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#By_value">By_value</a></span> <span class="id"><a href="compcert.common.AST.html#Mfloat64">Mfloat64</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tvoid">Tvoid</a></span> =&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#By_nothing">By_nothing</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tpointer">Tpointer</a></span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#By_value">By_value</a></span> <span class="id"><a href="compcert.common.AST.html#Mptr">Mptr</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tarray">Tarray</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#By_reference">By_reference</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tfunction">Tfunction</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#By_reference">By_reference</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tstruct">Tstruct</a></span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#By_copy">By_copy</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tunion">Tunion</a></span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#By_copy">By_copy</a></span><br/>
<span class="kwd">end</span>.<br/>
<br/>
<div class="doc">For the purposes of the semantics and the compiler, a type denotes
  a volatile access if it carries the <span class="bracket"><span class="id">volatile</span></span> attribute and it is
  accessed by value. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="type_is_volatile">type_is_volatile</a></span> (<span class="id">ty</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#type">type</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#access_mode">access_mode</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#ty">ty</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#By_value">By_value</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#attr_volatile">attr_volatile</a></span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#attr_of_type">attr_of_type</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#ty">ty</a></span>)<br/>
&nbsp;&nbsp;| <span class="id">_</span>          =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<h2> Alignment for block copy operations </h2>
<br/>
<div class="doc">A variant of <span class="bracket"><span class="id">alignof</span></span> for use in block copy operations.
  Block copy operations do not support alignments greater than 8,
  and require the size to be an integral multiple of the alignment. </div>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="alignof_blockcopy">alignof_blockcopy</a></span> (<span class="id">env</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_env">composite_env</a></span>) (<span class="id">t</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#type">type</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#t">t</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tvoid">Tvoid</a></span> =&gt; 1<br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tint">Tint</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#I8">I8</a></span> <span class="id">_</span> <span class="id">_</span> =&gt; 1<br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tint">Tint</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#I16">I16</a></span> <span class="id">_</span> <span class="id">_</span> =&gt; 2<br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tint">Tint</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#I32">I32</a></span> <span class="id">_</span> <span class="id">_</span> =&gt; 4<br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tint">Tint</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#IBool">IBool</a></span> <span class="id">_</span> <span class="id">_</span> =&gt; 1<br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tlong">Tlong</a></span> <span class="id">_</span> <span class="id">_</span> =&gt; 8<br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tfloat">Tfloat</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#F32">F32</a></span> <span class="id">_</span> =&gt; 4<br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tfloat">Tfloat</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#F64">F64</a></span> <span class="id">_</span> =&gt; 8<br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tpointer">Tpointer</a></span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="kwd">if</span> <span class="id"><a href="compcert.x86_64.Archi.html#ptr64">Archi.ptr64</a></span> <span class="kwd">then</span> 8 <span class="kwd">else</span> 4<br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tarray">Tarray</a></span> <span class="id">t</span>' <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#alignof_blockcopy">alignof_blockcopy</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> <span class="id">t</span>'<br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tfunction">Tfunction</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> =&gt; 1<br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tstruct">Tstruct</a></span> <span class="id">id</span> <span class="id">_</span> | <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tunion">Tunion</a></span> <span class="id">id</span> <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span>!<span class="id">id</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">co</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.min">Z.min</a></span> 8 (<span class="id"><a href="compcert.cfrontend.Ctypes.html#co_alignof">co_alignof</a></span> <span class="id">co</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="alignof_blockcopy_1248">alignof_blockcopy_1248</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">env</span> <span class="id">ty</span>, <span class="kwd">let</span> <span class="id">a</span> := <span class="id"><a href="compcert.cfrontend.Ctypes.html#alignof_blockcopy">alignof_blockcopy</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#ty">ty</a></span> <span class="kwd">in</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#a">a</a></span> = 1 \/ <span class="id"><a href="compcert.cfrontend.Ctypes.html#a">a</a></span> = 2 \/ <span class="id"><a href="compcert.cfrontend.Ctypes.html#a">a</a></span> = 4 \/ <span class="id"><a href="compcert.cfrontend.Ctypes.html#a">a</a></span> = 8.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4262')">Proof.</div>
<div class="proofscript" id="proof4262">
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">X</span>: <span class="kwd">forall</span> <span class="id">co</span>, <span class="kwd">let</span> <span class="id">a</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.min">Z.min</a></span> 8 (<span class="id"><a href="compcert.cfrontend.Ctypes.html#co_alignof">co_alignof</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co">co</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Ctypes.html#a">a</a></span> = 1 \/ <span class="id"><a href="compcert.cfrontend.Ctypes.html#a">a</a></span> = 2 \/ <span class="id"><a href="compcert.cfrontend.Ctypes.html#a">a</a></span> = 4 \/ <span class="id"><a href="compcert.cfrontend.Ctypes.html#a">a</a></span> = 8).<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#co_alignof_two_p">co_alignof_two_p</a></span> <span class="id">co</span>) <span class="kwd">as</span> [<span class="id">n</span> <span class="id">EQ</span>]. <span class="tactic">unfold</span> <span class="id">a</span>; <span class="tactic">rewrite</span> <span class="id">EQ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">n</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">n</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">n</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">right</span>; <span class="id">right</span>; <span class="id">right</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.min_l">Z.min_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#two_power_nat_two_p">two_power_nat_two_p</a></span>. <span class="tactic">rewrite</span> ! <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Znat.html#Nat2Z.inj_succ">Nat2Z.inj_succ</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">change</span> 8 <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> 3). <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#two_p_monotone">two_p_monotone</a></span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">ty</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">i</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">f</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="compcert.x86_64.Archi.html#ptr64">Archi.ptr64</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHty</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">env</span>!<span class="id">i</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">env</span>!<span class="id">i</span>); <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="alignof_blockcopy_pos">alignof_blockcopy_pos</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">env</span> <span class="id">ty</span>, <span class="id"><a href="compcert.cfrontend.Ctypes.html#alignof_blockcopy">alignof_blockcopy</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#ty">ty</a></span> &gt; 0.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4263')">Proof.</div>
<div class="proofscript" id="proof4263">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">generalize</span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#alignof_blockcopy_1248">alignof_blockcopy_1248</a></span> <span class="id">env</span> <span class="id">ty</span>). <span class="tactic">simpl</span>. <span class="tactic">intuition</span> <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sizeof_alignof_blockcopy_compat">sizeof_alignof_blockcopy_compat</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">env</span> <span class="id">ty</span>, (<span class="id"><a href="compcert.cfrontend.Ctypes.html#alignof_blockcopy">alignof_blockcopy</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#ty">ty</a></span> | <span class="id"><a href="compcert.cfrontend.Ctypes.html#sizeof">sizeof</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#ty">ty</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4264')">Proof.</div>
<div class="proofscript" id="proof4264">
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">X</span>: <span class="kwd">forall</span> <span class="id">co</span>, (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.min">Z.min</a></span> 8 (<span class="id"><a href="compcert.cfrontend.Ctypes.html#co_alignof">co_alignof</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co">co</a></span>) | <span class="id"><a href="compcert.cfrontend.Ctypes.html#co_sizeof">co_sizeof</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co">co</a></span>)).<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_trans">Z.divide_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#co_alignof">co_alignof</a></span> <span class="id">co</span>). 2: <span class="tactic">apply</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co_sizeof_alignof">co_sizeof_alignof</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#co_alignof_two_p">co_alignof_two_p</a></span> <span class="id">co</span>) <span class="kwd">as</span> [<span class="id">n</span> <span class="id">EQ</span>]. <span class="tactic">rewrite</span> <span class="id">EQ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">n</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_refl">Z.divide_refl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">n</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_refl">Z.divide_refl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">n</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_refl">Z.divide_refl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.min_case">Z.min_case</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_nat">Z.of_nat</a></span> <span class="id">n</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">change</span> 8 <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> 3).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p_is_exp">two_p_is_exp</a></span> <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#two_power_nat_two_p">two_power_nat_two_p</a></span>. <span class="tactic">rewrite</span> !<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Znat.html#Nat2Z.inj_succ">Nat2Z.inj_succ</a></span>. <span class="tactic">f_equal</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_refl">Z.divide_refl</a></span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">ty</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_refl">Z.divide_refl</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_refl">Z.divide_refl</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_refl">Z.divide_refl</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_refl">Z.divide_refl</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_refl">Z.divide_refl</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_mul_l">Z.divide_mul_l</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_refl">Z.divide_refl</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">env</span>!<span class="id">i</span>). <span class="tactic">apply</span> <span class="id">X</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_0_r">Z.divide_0_r</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">env</span>!<span class="id">i</span>). <span class="tactic">apply</span> <span class="id">X</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_0_r">Z.divide_0_r</a></span>.<br/>
Qed.</div>
<br/>
<div class="doc">Type ranks </div>
<br/>
<div class="doc">The rank of a type is a nonnegative integer that measures the direct nesting
  of arrays, struct and union types.  It does not take into account indirect
  nesting such as a struct type that appears under a pointer or function type.
  Type ranks ensure that type expressions (ignoring pointer and function types)
  have an inductive structure. </div>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="rank_type">rank_type</a></span> (<span class="id">ce</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_env">composite_env</a></span>) (<span class="id">t</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#type">type</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#t">t</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tarray">Tarray</a></span> <span class="id">t</span>' <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#rank_type">rank_type</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#ce">ce</a></span> <span class="id">t</span>')<br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tstruct">Tstruct</a></span> <span class="id">id</span> <span class="id">_</span> | <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tunion">Tunion</a></span> <span class="id">id</span> <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#ce">ce</a></span>!<span class="id">id</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">co</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S">S</a></span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#co_rank">co_rank</a></span> <span class="id">co</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="rank_members">rank_members</a></span> (<span class="id">ce</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_env">composite_env</a></span>) (<span class="id">m</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#members">members</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#m">m</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; 0%<span class="id">nat</span><br/>
&nbsp;&nbsp;| (<span class="id">id</span>, <span class="id">t</span>) :: <span class="id">m</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Nat.html#max">Init.Nat.max</a></span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#rank_type">rank_type</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#ce">ce</a></span> <span class="id">t</span>) (<span class="id"><a href="compcert.cfrontend.Ctypes.html#rank_members">rank_members</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#ce">ce</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#m">m</a></span>)<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<h2> C types and back-end types </h2>
<br/>
<div class="doc">Extracting a type list from a function parameter declaration. </div>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="type_of_params">type_of_params</a></span> (<span class="id">params</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="compcert.common.AST.html#ident">ident</a></span> * <span class="id"><a href="compcert.cfrontend.Ctypes.html#type">type</a></span>)) : <span class="id"><a href="compcert.cfrontend.Ctypes.html#typelist">typelist</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#params">params</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tnil">Tnil</a></span><br/>
&nbsp;&nbsp;| (<span class="id">id</span>, <span class="id">ty</span>) :: <span class="id">rem</span> =&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tcons">Tcons</a></span> <span class="id">ty</span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#type_of_params">type_of_params</a></span> <span class="id">rem</span>)<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<div class="doc">Translating C types to Cminor types and function signatures. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="typ_of_type">typ_of_type</a></span> (<span class="id">t</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#type">type</a></span>) : <span class="id"><a href="compcert.common.AST.html#typ">AST.typ</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#t">t</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tvoid">Tvoid</a></span> =&gt; <span class="id"><a href="compcert.common.AST.html#Tint">AST.Tint</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tint">Tint</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="compcert.common.AST.html#Tint">AST.Tint</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tlong">Tlong</a></span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="compcert.common.AST.html#Tlong">AST.Tlong</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tfloat">Tfloat</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#F32">F32</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="compcert.common.AST.html#Tsingle">AST.Tsingle</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tfloat">Tfloat</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#F64">F64</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="compcert.common.AST.html#Tfloat">AST.Tfloat</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tpointer">Tpointer</a></span> <span class="id">_</span> <span class="id">_</span> | <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tarray">Tarray</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> | <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tfunction">Tfunction</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> | <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tstruct">Tstruct</a></span> <span class="id">_</span> <span class="id">_</span> | <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tunion">Tunion</a></span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="compcert.common.AST.html#Tptr">AST.Tptr</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="opttyp_of_type">opttyp_of_type</a></span> (<span class="id">t</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#type">type</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="compcert.common.AST.html#typ">AST.typ</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#type_eq">type_eq</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#t">t</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tvoid">Tvoid</a></span> <span class="kwd">then</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> <span class="kwd">else</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#typ_of_type">typ_of_type</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#t">t</a></span>).<br/>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="typlist_of_typelist">typlist_of_typelist</a></span> (<span class="id">tl</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#typelist">typelist</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.common.AST.html#typ">AST.typ</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#tl">tl</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tnil">Tnil</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tcons">Tcons</a></span> <span class="id">hd</span> <span class="id">tl</span> =&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#typ_of_type">typ_of_type</a></span> <span class="id">hd</span> :: <span class="id"><a href="compcert.cfrontend.Ctypes.html#typlist_of_typelist">typlist_of_typelist</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#tl">tl</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="typelist_to_listtype">typelist_to_listtype</a></span> (<span class="id">tys</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#typelist">typelist</a></span>): <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#type">type</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#tys">tys</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tnil">Tnil</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Tcons">Tcons</a></span> <span class="id">hd</span> <span class="id">tl</span> =&gt; <span class="id">hd</span> :: <span class="id"><a href="compcert.cfrontend.Ctypes.html#typelist_to_listtype">typelist_to_listtype</a></span> <span class="id">tl</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="signature_of_type">signature_of_type</a></span> (<span class="id">args</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#typelist">typelist</a></span>) (<span class="id">res</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#type">type</a></span>) (<span class="id">cc</span>: <span class="id"><a href="compcert.common.AST.html#calling_convention">calling_convention</a></span>): <span class="id"><a href="compcert.common.AST.html#signature">signature</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.AST.html#mksignature">mksignature</a></span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#typlist_of_typelist">typlist_of_typelist</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#args">args</a></span>) (<span class="id"><a href="compcert.cfrontend.Ctypes.html#opttyp_of_type">opttyp_of_type</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#res">res</a></span>) <span class="id"><a href="compcert.cfrontend.Ctypes.html#cc">cc</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>.<br/>
<br/>
<h1> Construction of the composite environment </h1>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="sizeof_composite">sizeof_composite</a></span> (<span class="id">env</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_env">composite_env</a></span>) (<span class="id">su</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#struct_or_union">struct_or_union</a></span>) (<span class="id">m</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#members">members</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#su">su</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Struct">Struct</a></span> =&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#sizeof_struct">sizeof_struct</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> 0 <span class="id"><a href="compcert.cfrontend.Ctypes.html#m">m</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Union">Union</a></span>  =&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#sizeof_union">sizeof_union</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#m">m</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sizeof_composite_pos">sizeof_composite_pos</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">env</span> <span class="id">su</span> <span class="id">m</span>, 0 &lt;= <span class="id"><a href="compcert.cfrontend.Ctypes.html#sizeof_composite">sizeof_composite</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#su">su</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#m">m</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4265')">Proof.</div>
<div class="proofscript" id="proof4265">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">su</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#sizeof_struct_incr">sizeof_struct_incr</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#sizeof_union_pos">sizeof_union_pos</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="complete_members">complete_members</a></span> (<span class="id">env</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_env">composite_env</a></span>) (<span class="id">m</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#members">members</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#m">m</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span><br/>
&nbsp;&nbsp;| (<span class="id">id</span>, <span class="id">t</span>) :: <span class="id">m</span>' =&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#complete_type">complete_type</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> <span class="id">t</span> &amp;&amp; <span class="id"><a href="compcert.cfrontend.Ctypes.html#complete_members">complete_members</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> <span class="id">m</span>'<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="complete_member">complete_member</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">env</span> <span class="id">id</span> <span class="id">t</span> <span class="id">m</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#id">id</a></span>, <span class="id"><a href="compcert.cfrontend.Ctypes.html#t">t</a></span>) <span class="id"><a href="compcert.cfrontend.Ctypes.html#m">m</a></span> -&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#complete_members">complete_members</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#m">m</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#complete_type">complete_type</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#t">t</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4266')">Proof.</div>
<div class="proofscript" id="proof4266">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">m</span> <span class="kwd">as</span> [|[<span class="id">id1</span> <span class="id">t1</span>] <span class="id">m</span>]; <span class="tactic">simpl</span>; <span class="tactic">intuition</span> <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">InvBooleans</span>; <span class="id">inv</span> <span class="id">H1</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">InvBooleans</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Convert a composite definition to its internal representation.
  The size and alignment of the composite are determined at this time.
  The alignment takes into account the <span class="bracket"><span class="id">__Alignas</span></span> attributes
  associated with the definition.  The size is rounded up to a multiple
  of the alignment.
  The conversion fails if a type of a member is not complete.  This rules
  out incorrect recursive definitions such as
<pre>
    struct s { int x; struct s next; }</pre>
  Here, when we process the definition of <span class="bracket"><span class="kwd">struct</span> <span class="id">s</span></span>, the identifier <span class="bracket"><span class="id">s</span></span>
  is not bound yet in the composite environment, hence field <span class="bracket"><span class="id">next</span></span>
  has an incomplete type.  However, recursions that go through a pointer type
  are correctly handled:
<pre>
    struct s { int x; struct s * next; }</pre>
  Here, <span class="bracket"><span class="id">next</span></span> has a pointer type, which is always complete, even though
  <span class="bracket"><span class="id">s</span></span> is not yet bound to a composite.
</div>
<br/>
<span class="kwd">Program</span> <span class="kwd">Definition</span> <span class="id"><a name="composite_of_def">composite_of_def</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">env</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_env">composite_env</a></span>) (<span class="id">id</span>: <span class="id"><a href="compcert.common.AST.html#ident">ident</a></span>) (<span class="id">su</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#struct_or_union">struct_or_union</a></span>) (<span class="id">m</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#members">members</a></span>) (<span class="id">a</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#attr">attr</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id"><a href="compcert.common.Errors.html#res">res</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#composite">composite</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span>!<span class="id"><a href="compcert.cfrontend.Ctypes.html#id">id</a></span>, <span class="id"><a href="compcert.cfrontend.Ctypes.html#complete_members">complete_members</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#m">m</a></span> <span class="kwd">return</span> <span class="id">_</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span>, <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Errors.html#Error">Error</a></span> (<span class="id"><a href="compcert.common.Errors.html#MSG">MSG</a></span> "<span class="id">Multiple</span> <span class="id">definitions</span> <span class="id">of</span> <span class="kwd">struct</span> <span class="id">or</span> <span class="id">union</span> " :: <span class="id"><a href="compcert.common.Errors.html#CTX">CTX</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#id">id</a></span> :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Errors.html#Error">Error</a></span> (<span class="id"><a href="compcert.common.Errors.html#MSG">MSG</a></span> "<span class="id">Incomplete</span> <span class="kwd">struct</span> <span class="id">or</span> <span class="id">union</span> " :: <span class="id"><a href="compcert.common.Errors.html#CTX">CTX</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#id">id</a></span> :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">al</span> := <span class="id"><a href="compcert.cfrontend.Ctypes.html#align_attr">align_attr</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#a">a</a></span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#alignof_composite">alignof_composite</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#m">m</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> {| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Build_composite">co_su</a></span> := <span class="id"><a href="compcert.cfrontend.Ctypes.html#su">su</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">co_members</span> := <span class="id"><a href="compcert.cfrontend.Ctypes.html#m">m</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">co_attr</span> := <span class="id"><a href="compcert.cfrontend.Ctypes.html#a">a</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">co_sizeof</span> := <span class="id"><a href="compcert.lib.Coqlib.html#align">align</a></span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#sizeof_composite">sizeof_composite</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#su">su</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#m">m</a></span>) <span class="id"><a href="compcert.cfrontend.Ctypes.html#al">al</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">co_alignof</span> := <span class="id"><a href="compcert.cfrontend.Ctypes.html#al">al</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">co_rank</span> := <span class="id"><a href="compcert.cfrontend.Ctypes.html#rank_members">rank_members</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#m">m</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">co_sizeof_pos</span> := <span class="id">_</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">co_alignof_two_p</span> := <span class="id">_</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">co_sizeof_alignof</span> := <span class="id">_</span> |}<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4267')">Next Obligation.</div>
<div class="proofscript" id="proof4267">
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.le_ge">Z.le_ge</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.le_trans">Z.le_trans</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#sizeof_composite_pos">sizeof_composite_pos</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#align_le">align_le</a></span>; <span class="tactic">apply</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#alignof_composite_pos">alignof_composite_pos</a></span>.<br/>
Defined.</div>
<div class="toggleproof" onclick="toggleDisplay('proof4268')">Next Obligation.</div>
<div class="proofscript" id="proof4268">
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#align_attr_two_p">align_attr_two_p</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#alignof_composite_two_p">alignof_composite_two_p</a></span>.<br/>
Defined.</div>
<div class="toggleproof" onclick="toggleDisplay('proof4269')">Next Obligation.</div>
<div class="proofscript" id="proof4269">
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#align_divides">align_divides</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#alignof_composite_pos">alignof_composite_pos</a></span>.<br/>
Defined.</div>
<br/>
<div class="doc">The composite environment for a program is obtained by entering
  its composite definitions in sequence.  The definitions are assumed
  to be listed in dependency order: the definition of a composite
  must precede all uses of this composite, unless the use is under
  a pointer or function type. </div>
<br/>
<span class="kwd">Local</span> <span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">error_monad_scope</span>.<br/>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="add_composite_definitions">add_composite_definitions</a></span> (<span class="id">env</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_env">composite_env</a></span>) (<span class="id">defs</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_definition">composite_definition</a></span>) : <span class="id"><a href="compcert.common.Errors.html#res">res</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_env">composite_env</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#defs">defs</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Composite">Composite</a></span> <span class="id">id</span> <span class="id">su</span> <span class="id">m</span> <span class="id">a</span> :: <span class="id">defs</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">co</span> &lt;- <span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_of_def">composite_of_def</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> <span class="id">id</span> <span class="id">su</span> <span class="id">m</span> <span class="id">a</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Ctypes.html#add_composite_definitions">add_composite_definitions</a></span> (<span class="id"><a href="compcert.lib.Maps.html#PTree.set">PTree.set</a></span> <span class="id">id</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co">co</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span>) <span class="id"><a href="compcert.cfrontend.Ctypes.html#defs">defs</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="build_composite_env">build_composite_env</a></span> (<span class="id">defs</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_definition">composite_definition</a></span>) :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Ctypes.html#add_composite_definitions">add_composite_definitions</a></span> (<span class="id"><a href="compcert.lib.Maps.html#PTree.empty">PTree.empty</a></span> <span class="id">_</span>) <span class="id"><a href="compcert.cfrontend.Ctypes.html#defs">defs</a></span>.<br/>
<br/>
<div class="doc">Stability properties for alignments, sizes, and ranks.  If the type is
  complete in a composite environment <span class="bracket"><span class="id">env</span></span>, its size, alignment, and rank
  are unchanged if we add more definitions to <span class="bracket"><span class="id">env</span></span>. </div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="STABILITY">STABILITY</a></span>.<br/>
<br/>
<span class="kwd">Variables</span> <span class="id"><a name="STABILITY.env">env</a></span> <span class="id">env</span>': <span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_env">composite_env</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="STABILITY.extends">extends</a></span>: <span class="kwd">forall</span> <span class="id">id</span> <span class="id">co</span>, <span class="id"><a href="compcert.cfrontend.Ctypes.html#STABILITY.env">env</a></span>!<span class="id"><a href="compcert.cfrontend.Ctypes.html#id">id</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co">co</a></span> -&gt; <span class="id">env</span>'!<span class="id"><a href="compcert.cfrontend.Ctypes.html#id">id</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co">co</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="alignof_stable">alignof_stable</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t</span>, <span class="id"><a href="compcert.cfrontend.Ctypes.html#complete_type">complete_type</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#STABILITY.env">env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#t">t</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#alignof">alignof</a></span> <span class="id">env</span>' <span class="id"><a href="compcert.cfrontend.Ctypes.html#t">t</a></span> = <span class="id"><a href="compcert.cfrontend.Ctypes.html#alignof">alignof</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#STABILITY.env">env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#t">t</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4270')">Proof.</div>
<div class="proofscript" id="proof4270">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">t</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>; <span class="tactic">f_equal</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#STABILITY.env">env</a></span>!<span class="id">i</span>) <span class="kwd">as</span> [<span class="id">co</span>|] <span class="id">eqn</span>:<span class="id">E</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#STABILITY.extends">extends</a></span> <span class="tactic">by</span> <span class="tactic">eauto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#STABILITY.env">env</a></span>!<span class="id">i</span>) <span class="kwd">as</span> [<span class="id">co</span>|] <span class="id">eqn</span>:<span class="id">E</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#STABILITY.extends">extends</a></span> <span class="tactic">by</span> <span class="tactic">eauto</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sizeof_stable">sizeof_stable</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t</span>, <span class="id"><a href="compcert.cfrontend.Ctypes.html#complete_type">complete_type</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#STABILITY.env">env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#t">t</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#sizeof">sizeof</a></span> <span class="id">env</span>' <span class="id"><a href="compcert.cfrontend.Ctypes.html#t">t</a></span> = <span class="id"><a href="compcert.cfrontend.Ctypes.html#sizeof">sizeof</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#STABILITY.env">env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#t">t</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4271')">Proof.</div>
<div class="proofscript" id="proof4271">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">t</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHt</span> <span class="tactic">by</span> <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#STABILITY.env">env</a></span>!<span class="id">i</span>) <span class="kwd">as</span> [<span class="id">co</span>|] <span class="id">eqn</span>:<span class="id">E</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#STABILITY.extends">extends</a></span> <span class="tactic">by</span> <span class="tactic">eauto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#STABILITY.env">env</a></span>!<span class="id">i</span>) <span class="kwd">as</span> [<span class="id">co</span>|] <span class="id">eqn</span>:<span class="id">E</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#STABILITY.extends">extends</a></span> <span class="tactic">by</span> <span class="tactic">eauto</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="complete_type_stable">complete_type_stable</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t</span>, <span class="id"><a href="compcert.cfrontend.Ctypes.html#complete_type">complete_type</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#STABILITY.env">env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#t">t</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#complete_type">complete_type</a></span> <span class="id">env</span>' <span class="id"><a href="compcert.cfrontend.Ctypes.html#t">t</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4272')">Proof.</div>
<div class="proofscript" id="proof4272">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">t</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#STABILITY.env">env</a></span>!<span class="id">i</span>) <span class="kwd">as</span> [<span class="id">co</span>|] <span class="id">eqn</span>:<span class="id">E</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#STABILITY.extends">extends</a></span> <span class="tactic">by</span> <span class="tactic">eauto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#STABILITY.env">env</a></span>!<span class="id">i</span>) <span class="kwd">as</span> [<span class="id">co</span>|] <span class="id">eqn</span>:<span class="id">E</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#STABILITY.extends">extends</a></span> <span class="tactic">by</span> <span class="tactic">eauto</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="rank_type_stable">rank_type_stable</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t</span>, <span class="id"><a href="compcert.cfrontend.Ctypes.html#complete_type">complete_type</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#STABILITY.env">env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#t">t</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#rank_type">rank_type</a></span> <span class="id">env</span>' <span class="id"><a href="compcert.cfrontend.Ctypes.html#t">t</a></span> = <span class="id"><a href="compcert.cfrontend.Ctypes.html#rank_type">rank_type</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#STABILITY.env">env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#t">t</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4273')">Proof.</div>
<div class="proofscript" id="proof4273">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">t</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#STABILITY.env">env</a></span>!<span class="id">i</span>) <span class="kwd">as</span> [<span class="id">co</span>|] <span class="id">eqn</span>:<span class="id">E</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#STABILITY.extends">extends</a></span> <span class="tactic">by</span> <span class="tactic">eauto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#STABILITY.env">env</a></span>!<span class="id">i</span>) <span class="kwd">as</span> [<span class="id">co</span>|] <span class="id">eqn</span>:<span class="id">E</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#STABILITY.extends">extends</a></span> <span class="tactic">by</span> <span class="tactic">eauto</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="alignof_composite_stable">alignof_composite_stable</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span>, <span class="id"><a href="compcert.cfrontend.Ctypes.html#complete_members">complete_members</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#STABILITY.env">env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#m">m</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#alignof_composite">alignof_composite</a></span> <span class="id">env</span>' <span class="id"><a href="compcert.cfrontend.Ctypes.html#m">m</a></span> = <span class="id"><a href="compcert.cfrontend.Ctypes.html#alignof_composite">alignof_composite</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#STABILITY.env">env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#m">m</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4274')">Proof.</div>
<div class="proofscript" id="proof4274">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">m</span> <span class="kwd">as</span> [|[<span class="id">id</span> <span class="id">t</span>]]; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">InvBooleans</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#alignof_stable">alignof_stable</a></span> <span class="tactic">by</span> <span class="tactic">auto</span>. <span class="tactic">rewrite</span> <span class="id">IHm</span> <span class="tactic">by</span> <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sizeof_struct_stable">sizeof_struct_stable</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">pos</span>, <span class="id"><a href="compcert.cfrontend.Ctypes.html#complete_members">complete_members</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#STABILITY.env">env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#m">m</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#sizeof_struct">sizeof_struct</a></span> <span class="id">env</span>' <span class="id"><a href="compcert.cfrontend.Ctypes.html#pos">pos</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#m">m</a></span> = <span class="id"><a href="compcert.cfrontend.Ctypes.html#sizeof_struct">sizeof_struct</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#STABILITY.env">env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#pos">pos</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#m">m</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4275')">Proof.</div>
<div class="proofscript" id="proof4275">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">m</span> <span class="kwd">as</span> [|[<span class="id">id</span> <span class="id">t</span>]]; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">InvBooleans</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#alignof_stable">alignof_stable</a></span> <span class="tactic">by</span> <span class="tactic">auto</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#sizeof_stable">sizeof_stable</a></span> <span class="tactic">by</span> <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">IHm</span> <span class="tactic">by</span> <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sizeof_union_stable">sizeof_union_stable</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span>, <span class="id"><a href="compcert.cfrontend.Ctypes.html#complete_members">complete_members</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#STABILITY.env">env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#m">m</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#sizeof_union">sizeof_union</a></span> <span class="id">env</span>' <span class="id"><a href="compcert.cfrontend.Ctypes.html#m">m</a></span> = <span class="id"><a href="compcert.cfrontend.Ctypes.html#sizeof_union">sizeof_union</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#STABILITY.env">env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#m">m</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4276')">Proof.</div>
<div class="proofscript" id="proof4276">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">m</span> <span class="kwd">as</span> [|[<span class="id">id</span> <span class="id">t</span>]]; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">InvBooleans</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#sizeof_stable">sizeof_stable</a></span> <span class="tactic">by</span> <span class="tactic">auto</span>. <span class="tactic">rewrite</span> <span class="id">IHm</span> <span class="tactic">by</span> <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sizeof_composite_stable">sizeof_composite_stable</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">su</span> <span class="id">m</span>, <span class="id"><a href="compcert.cfrontend.Ctypes.html#complete_members">complete_members</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#STABILITY.env">env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#m">m</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#sizeof_composite">sizeof_composite</a></span> <span class="id">env</span>' <span class="id"><a href="compcert.cfrontend.Ctypes.html#su">su</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#m">m</a></span> = <span class="id"><a href="compcert.cfrontend.Ctypes.html#sizeof_composite">sizeof_composite</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#STABILITY.env">env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#su">su</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#m">m</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4277')">Proof.</div>
<div class="proofscript" id="proof4277">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">su</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#sizeof_struct_stable">sizeof_struct_stable</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#sizeof_union_stable">sizeof_union_stable</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="complete_members_stable">complete_members_stable</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span>, <span class="id"><a href="compcert.cfrontend.Ctypes.html#complete_members">complete_members</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#STABILITY.env">env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#m">m</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#complete_members">complete_members</a></span> <span class="id">env</span>' <span class="id"><a href="compcert.cfrontend.Ctypes.html#m">m</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4278')">Proof.</div>
<div class="proofscript" id="proof4278">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">m</span> <span class="kwd">as</span> [|[<span class="id">id</span> <span class="id">t</span>]]; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">InvBooleans</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#complete_type_stable">complete_type_stable</a></span> <span class="tactic">by</span> <span class="tactic">auto</span>. <span class="tactic">rewrite</span> <span class="id">IHm</span> <span class="tactic">by</span> <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="rank_members_stable">rank_members_stable</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span>, <span class="id"><a href="compcert.cfrontend.Ctypes.html#complete_members">complete_members</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#STABILITY.env">env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#m">m</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#rank_members">rank_members</a></span> <span class="id">env</span>' <span class="id"><a href="compcert.cfrontend.Ctypes.html#m">m</a></span> = <span class="id"><a href="compcert.cfrontend.Ctypes.html#rank_members">rank_members</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#STABILITY.env">env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#m">m</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4279')">Proof.</div>
<div class="proofscript" id="proof4279">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">m</span> <span class="kwd">as</span> [|[<span class="id">id</span> <span class="id">t</span>]]; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">InvBooleans</span>. <span class="tactic">f_equal</span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#rank_type_stable">rank_type_stable</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#STABILITY">STABILITY</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="add_composite_definitions_incr">add_composite_definitions_incr</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">id</span> <span class="id">co</span> <span class="id">defs</span> <span class="id">env1</span> <span class="id">env2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Ctypes.html#add_composite_definitions">add_composite_definitions</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env1">env1</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#defs">defs</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env2">env2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Ctypes.html#env1">env1</a></span>!<span class="id"><a href="compcert.cfrontend.Ctypes.html#id">id</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co">co</a></span> -&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#env2">env2</a></span>!<span class="id"><a href="compcert.cfrontend.Ctypes.html#id">id</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co">co</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4280')">Proof.</div>
<div class="proofscript" id="proof4280">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">defs</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
- <span class="id">inv</span> <span class="id">H</span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">destruct</span> <span class="id">a</span>; <span class="id">monadInv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">IHdefs</span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Maps.html#PTree.gso">PTree.gso</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="tactic">subst</span> <span class="id">id0</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_of_def">composite_of_def</a></span> <span class="kwd">in</span> <span class="id">EQ</span>. <span class="tactic">rewrite</span> <span class="id">H0</span> <span class="kwd">in</span> <span class="id">EQ</span>; <span class="tactic">discriminate</span>.<br/>
Qed.</div>
<br/>
<div class="doc">It follows that the sizes and alignments contained in the composite
  environment produced by <span class="bracket"><span class="id">build_composite_env</span></span> are consistent with
  the sizes and alignments of the members of the composite types. </div>
<br/>
<span class="kwd">Record</span> <span class="id"><a name="composite_consistent">composite_consistent</a></span> (<span class="id">env</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_env">composite_env</a></span>) (<span class="id">co</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#composite">composite</a></span>) : <span class="kwd">Prop</span> := {<br/>
&nbsp;&nbsp;<span class="id"><a name="co_consistent_complete">co_consistent_complete</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Ctypes.html#complete_members">complete_members</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#co_members">co_members</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co">co</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>;<br/>
&nbsp;&nbsp;<span class="id"><a name="co_consistent_alignof">co_consistent_alignof</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Ctypes.html#co_alignof">co_alignof</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co">co</a></span> = <span class="id"><a href="compcert.cfrontend.Ctypes.html#align_attr">align_attr</a></span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#co_attr">co_attr</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co">co</a></span>) (<span class="id"><a href="compcert.cfrontend.Ctypes.html#alignof_composite">alignof_composite</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#co_members">co_members</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co">co</a></span>));<br/>
&nbsp;&nbsp;<span class="id"><a name="co_consistent_sizeof">co_consistent_sizeof</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Ctypes.html#co_sizeof">co_sizeof</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co">co</a></span> = <span class="id"><a href="compcert.lib.Coqlib.html#align">align</a></span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#sizeof_composite">sizeof_composite</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#co_su">co_su</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co">co</a></span>) (<span class="id"><a href="compcert.cfrontend.Ctypes.html#co_members">co_members</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co">co</a></span>)) (<span class="id"><a href="compcert.cfrontend.Ctypes.html#co_alignof">co_alignof</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co">co</a></span>);<br/>
&nbsp;&nbsp;<span class="id"><a name="co_consistent_rank">co_consistent_rank</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Ctypes.html#co_rank">co_rank</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co">co</a></span> = <span class="id"><a href="compcert.cfrontend.Ctypes.html#rank_members">rank_members</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#co_members">co_members</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co">co</a></span>)<br/>
}.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="composite_env_consistent">composite_env_consistent</a></span> (<span class="id">env</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_env">composite_env</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">id</span> <span class="id">co</span>, <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span>!<span class="id"><a href="compcert.cfrontend.Ctypes.html#id">id</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co">co</a></span> -&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_consistent">composite_consistent</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co">co</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="composite_consistent_stable">composite_consistent_stable</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">env</span> <span class="id">env</span>': <span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_env">composite_env</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">EXTENDS</span>: <span class="kwd">forall</span> <span class="id">id</span> <span class="id">co</span>, <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span>!<span class="id"><a href="compcert.cfrontend.Ctypes.html#id">id</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co">co</a></span> -&gt; <span class="id">env</span>'!<span class="id"><a href="compcert.cfrontend.Ctypes.html#id">id</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co">co</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">co</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_consistent">composite_consistent</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co">co</a></span> -&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_consistent">composite_consistent</a></span> <span class="id">env</span>' <span class="id"><a href="compcert.cfrontend.Ctypes.html#co">co</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4281')">Proof.</div>
<div class="proofscript" id="proof4281">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [<span class="id">A</span> <span class="id">B</span> <span class="id">C</span> <span class="id">D</span>]. <span class="id">constructor</span>. <br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#complete_members_stable">complete_members_stable</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">symmetry</span>; <span class="tactic">rewrite</span> <span class="id">B</span>. <span class="tactic">f_equal</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#alignof_composite_stable">alignof_composite_stable</a></span>; <span class="tactic">auto</span>. <br/>
&nbsp;&nbsp;<span class="tactic">symmetry</span>; <span class="tactic">rewrite</span> <span class="id">C</span>. <span class="tactic">f_equal</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#sizeof_composite_stable">sizeof_composite_stable</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">symmetry</span>; <span class="tactic">rewrite</span> <span class="id">D</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#rank_members_stable">rank_members_stable</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="composite_of_def_consistent">composite_of_def_consistent</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">env</span> <span class="id">id</span> <span class="id">su</span> <span class="id">m</span> <span class="id">a</span> <span class="id">co</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_of_def">composite_of_def</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#id">id</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#su">su</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#m">m</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#a">a</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co">co</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_consistent">composite_consistent</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co">co</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4282')">Proof.</div>
<div class="proofscript" id="proof4282">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_of_def">composite_of_def</a></span>; <span class="tactic">intros</span>. <br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">env</span>!<span class="id">id</span>); <span class="tactic">try</span> <span class="tactic">discriminate</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#complete_members">complete_members</a></span> <span class="id">env</span> <span class="id">m</span>) <span class="id">eqn</span>:<span class="id">C</span>; <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="build_composite_env_consistent">build_composite_env_consistent</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">defs</span> <span class="id">env</span>, <span class="id"><a href="compcert.cfrontend.Ctypes.html#build_composite_env">build_composite_env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#defs">defs</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> -&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_env_consistent">composite_env_consistent</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4283')">Proof.</div>
<div class="proofscript" id="proof4283">
&nbsp;&nbsp;<span class="tactic">cut</span> (<span class="kwd">forall</span> <span class="id">defs</span> <span class="id">env0</span> <span class="id">env</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Ctypes.html#add_composite_definitions">add_composite_definitions</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env0">env0</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#defs">defs</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_env_consistent">composite_env_consistent</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env0">env0</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_env_consistent">composite_env_consistent</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id">H</span>; <span class="tactic">eauto</span>. <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Maps.html#PTree.gempty">PTree.gempty</a></span> <span class="kwd">in</span> <span class="id">H1</span>; <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">defs</span> <span class="kwd">as</span> [|<span class="id">d1</span> <span class="id">defs</span>]; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
- <span class="id">inv</span> <span class="id">H</span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">destruct</span> <span class="id">d1</span>; <span class="id">monadInv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">IHdefs</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">env1</span> := <span class="id"><a href="compcert.lib.Maps.html#PTree.set">PTree.set</a></span> <span class="id">id</span> <span class="id">x</span> <span class="id">env0</span>) <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">env0</span>!<span class="id">id</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>). <br/>
&nbsp;&nbsp;{ <span class="tactic">unfold</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_of_def">composite_of_def</a></span> <span class="kwd">in</span> <span class="id">EQ</span>. <span class="tactic">destruct</span> (<span class="id">env0</span>!<span class="id">id</span>). <span class="tactic">discriminate</span>. <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">id1</span> <span class="id">co1</span>, <span class="id">env0</span>!<span class="id"><a href="compcert.cfrontend.Ctypes.html#id1">id1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co1">co1</a></span> -&gt; <span class="id">env1</span>!<span class="id"><a href="compcert.cfrontend.Ctypes.html#id1">id1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co1">co1</a></span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id">env1</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Maps.html#PTree.gso">PTree.gso</a></span>; <span class="tactic">auto</span>. <span class="tactic">congruence</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_consistent_stable">composite_consistent_stable</a></span> <span class="kwd">with</span> <span class="id">env0</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">env1</span> <span class="kwd">in</span> <span class="id">H2</span>; <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Maps.html#PTree.gsspec">PTree.gsspec</a></span> <span class="kwd">in</span> <span class="id">H2</span>; <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#peq">peq</a></span> <span class="id">id0</span> <span class="id">id</span>).<br/>
+ <span class="tactic">subst</span> <span class="id">id0</span>. <span class="tactic">inversion</span> <span class="id">H2</span>; <span class="tactic">clear</span> <span class="id">H2</span>. <span class="tactic">subst</span> <span class="id">co</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_of_def_consistent">composite_of_def_consistent</a></span>; <span class="tactic">eauto</span>.<br/>
+ <span class="tactic">eapply</span> <span class="id">H0</span>; <span class="tactic">eauto</span>. <br/>
Qed.</div>
<br/>
<div class="doc">Moreover, every composite definition is reflected in the composite environment. </div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="build_composite_env_charact">build_composite_env_charact</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">id</span> <span class="id">su</span> <span class="id">m</span> <span class="id">a</span> <span class="id">defs</span> <span class="id">env</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Ctypes.html#build_composite_env">build_composite_env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#defs">defs</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#Composite">Composite</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#id">id</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#su">su</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#m">m</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#a">a</a></span>) <span class="id"><a href="compcert.cfrontend.Ctypes.html#defs">defs</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">co</span>, <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span>!<span class="id"><a href="compcert.cfrontend.Ctypes.html#id">id</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co">co</a></span> /\ <span class="id"><a href="compcert.cfrontend.Ctypes.html#co_members">co_members</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co">co</a></span> = <span class="id"><a href="compcert.cfrontend.Ctypes.html#m">m</a></span> /\ <span class="id"><a href="compcert.cfrontend.Ctypes.html#co_attr">co_attr</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co">co</a></span> = <span class="id"><a href="compcert.cfrontend.Ctypes.html#a">a</a></span> /\ <span class="id"><a href="compcert.cfrontend.Ctypes.html#co_su">co_su</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co">co</a></span> = <span class="id"><a href="compcert.cfrontend.Ctypes.html#su">su</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4284')">Proof.</div>
<div class="proofscript" id="proof4284">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> <span class="id">defs</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#build_composite_env">build_composite_env</a></span>. <span class="tactic">generalize</span> (<span class="id"><a href="compcert.lib.Maps.html#PTree.empty">PTree.empty</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#composite">composite</a></span>) <span class="kwd">as</span> <span class="id">env0</span>.<br/>
&nbsp;&nbsp;<span class="id">revert</span> <span class="id">defs</span>. <span class="tactic">induction</span> <span class="id">defs</span> <span class="kwd">as</span> [|<span class="id">d1</span> <span class="id">defs</span>]; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
- <span class="id">contradiction</span>.<br/>
- <span class="tactic">destruct</span> <span class="id">d1</span>; <span class="id">monadInv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span>; [<span class="id">idtac</span>|<span class="tactic">eapply</span> <span class="id">IHdefs</span>;<span class="tactic">eauto</span>]. <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_of_def">composite_of_def</a></span> <span class="kwd">in</span> <span class="id">EQ</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">env0</span>!<span class="id">id</span>) <span class="id">eqn</span>:<span class="id">E</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#complete_members">complete_members</a></span> <span class="id">env0</span> <span class="id">m</span>) <span class="id">eqn</span>:<span class="id">C</span>; <span class="id">simplify_eq</span> <span class="id">EQ</span>. <span class="tactic">clear</span> <span class="id">EQ</span>; <span class="tactic">intros</span> <span class="id">EQ</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#add_composite_definitions_incr">add_composite_definitions_incr</a></span>; <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Maps.html#PTree.gss">PTree.gss</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">x</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="build_composite_env_domain">build_composite_env_domain</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">env</span> <span class="id">defs</span> <span class="id">id</span> <span class="id">co</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Ctypes.html#build_composite_env">build_composite_env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#defs">defs</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span>!<span class="id"><a href="compcert.cfrontend.Ctypes.html#id">id</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co">co</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#Composite">Composite</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#id">id</a></span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#co_su">co_su</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co">co</a></span>) (<span class="id"><a href="compcert.cfrontend.Ctypes.html#co_members">co_members</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co">co</a></span>) (<span class="id"><a href="compcert.cfrontend.Ctypes.html#co_attr">co_attr</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co">co</a></span>)) <span class="id"><a href="compcert.cfrontend.Ctypes.html#defs">defs</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4285')">Proof.</div>
<div class="proofscript" id="proof4285">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">env0</span> <span class="id">defs0</span> <span class="id">id</span> <span class="id">co</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">REC</span>: <span class="kwd">forall</span> <span class="id">l</span> <span class="id">env</span> <span class="id">env</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Ctypes.html#add_composite_definitions">add_composite_definitions</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#l">l</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id">env</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">env</span>'!<span class="id">id</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">co</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span>!<span class="id">id</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">co</span> \/ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#Composite">Composite</a></span> <span class="id">id</span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#co_su">co_su</a></span> <span class="id">co</span>) (<span class="id"><a href="compcert.cfrontend.Ctypes.html#co_members">co_members</a></span> <span class="id">co</span>) (<span class="id"><a href="compcert.cfrontend.Ctypes.html#co_attr">co_attr</a></span> <span class="id">co</span>)) <span class="id"><a href="compcert.cfrontend.Ctypes.html#l">l</a></span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>. <br/>
&nbsp;&nbsp;- <span class="id">inv</span> <span class="id">H</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">a</span>; <span class="id">monadInv</span> <span class="id">H</span>. <span class="id">exploit</span> <span class="id">IHl</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_of_def">composite_of_def</a></span> <span class="kwd">in</span> <span class="id">EQ</span>. <span class="tactic">destruct</span> (<span class="id">env</span>!<span class="id">id0</span>) <span class="id">eqn</span>:<span class="id">E</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#complete_members">complete_members</a></span> <span class="id">env</span> <span class="id">m</span>) <span class="id">eqn</span>:<span class="id">C</span>; <span class="id">simplify_eq</span> <span class="id">EQ</span>. <span class="tactic">clear</span> <span class="id">EQ</span>; <span class="tactic">intros</span> <span class="id">EQ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Maps.html#PTree.gsspec">PTree.gsspec</a></span>. <span class="tactic">intros</span> [<span class="id">A</span>|<span class="id">A</span>]; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#peq">peq</a></span> <span class="id">id</span> <span class="id">id0</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">A</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">H0</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id">REC</span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Maps.html#PTree.gempty">PTree.gempty</a></span>. <span class="tactic">intuition</span> <span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<div class="doc">As a corollay, in a consistent environment, the rank of a composite type
  is strictly greater than the ranks of its member types. </div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="rank_type_members">rank_type_members</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ce</span> <span class="id">id</span> <span class="id">t</span> <span class="id">m</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#id">id</a></span>, <span class="id"><a href="compcert.cfrontend.Ctypes.html#t">t</a></span>) <span class="id"><a href="compcert.cfrontend.Ctypes.html#m">m</a></span> -&gt; (<span class="id"><a href="compcert.cfrontend.Ctypes.html#rank_type">rank_type</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#ce">ce</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#t">t</a></span> &lt;= <span class="id"><a href="compcert.cfrontend.Ctypes.html#rank_members">rank_members</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#ce">ce</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#m">m</a></span>)%<span class="id">nat</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4286')">Proof.</div>
<div class="proofscript" id="proof4286">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">m</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>; <span class="tactic">intuition</span> <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">a</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="id">xomega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="rank_struct_member">rank_struct_member</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ce</span> <span class="id">id</span> <span class="id">a</span> <span class="id">co</span> <span class="id">id1</span> <span class="id">t1</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_env_consistent">composite_env_consistent</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#ce">ce</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Ctypes.html#ce">ce</a></span>!<span class="id"><a href="compcert.cfrontend.Ctypes.html#id">id</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co">co</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#id1">id1</a></span>, <span class="id"><a href="compcert.cfrontend.Ctypes.html#t1">t1</a></span>) (<span class="id"><a href="compcert.cfrontend.Ctypes.html#co_members">co_members</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co">co</a></span>) -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.cfrontend.Ctypes.html#rank_type">rank_type</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#ce">ce</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#t1">t1</a></span> &lt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#rank_type">rank_type</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#ce">ce</a></span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#Tstruct">Tstruct</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#id">id</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#a">a</a></span>))%<span class="id">nat</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4287')">Proof.</div>
<div class="proofscript" id="proof4287">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co_consistent_rank">co_consistent_rank</a></span> <span class="tactic">by</span> <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#rank_type_members">rank_type_members</a></span> <span class="id">ce</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="rank_union_member">rank_union_member</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ce</span> <span class="id">id</span> <span class="id">a</span> <span class="id">co</span> <span class="id">id1</span> <span class="id">t1</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_env_consistent">composite_env_consistent</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#ce">ce</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Ctypes.html#ce">ce</a></span>!<span class="id"><a href="compcert.cfrontend.Ctypes.html#id">id</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co">co</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#id1">id1</a></span>, <span class="id"><a href="compcert.cfrontend.Ctypes.html#t1">t1</a></span>) (<span class="id"><a href="compcert.cfrontend.Ctypes.html#co_members">co_members</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co">co</a></span>) -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.cfrontend.Ctypes.html#rank_type">rank_type</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#ce">ce</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#t1">t1</a></span> &lt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#rank_type">rank_type</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#ce">ce</a></span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#Tunion">Tunion</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#id">id</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#a">a</a></span>))%<span class="id">nat</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4288')">Proof.</div>
<div class="proofscript" id="proof4288">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co_consistent_rank">co_consistent_rank</a></span> <span class="tactic">by</span> <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#rank_type_members">rank_type_members</a></span> <span class="id">ce</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<h1> Programs and compilation units </h1>
<br/>
<div class="doc">The definitions in this section are parameterized over a type <span class="bracket"><span class="id">F</span></span> of 
  internal function definitions, so that they apply both to CompCert C and to Clight. </div>
<br/>
<span class="kwd">Set</span> <span class="kwd">Implicit</span> <span class="id">Arguments</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="PROGRAMS">PROGRAMS</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PROGRAMS.F">F</a></span>: <span class="kwd">Type</span>.<br/>
<br/>
<div class="doc">Functions can either be defined (<span class="bracket"><span class="id">Internal</span></span>) or declared as
  external functions (<span class="bracket"><span class="id">External</span></span>). </div>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="fundef">fundef</a></span> : <span class="kwd">Type</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="Internal">Internal</a></span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#PROGRAMS.F">F</a></span> -&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#fundef">fundef</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="External">External</a></span>: <span class="id"><a href="compcert.common.AST.html#external_function">external_function</a></span> -&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#typelist">typelist</a></span> -&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#type">type</a></span> -&gt; <span class="id"><a href="compcert.common.AST.html#calling_convention">calling_convention</a></span> -&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#fundef">fundef</a></span>.<br/>
<br/>
<div class="doc">A program, or compilation unit, is composed of:
<ul>
<li>
 a list of definitions of functions and global variables;
</li>
<li>
 the names of functions and global variables that are public (not static);
</li>
<li>
 the name of the function that acts as entry point ("main" function).
</li>
<li>
 a list of definitions for structure and union names
</li>
<li>
 the corresponding composite environment
</li>
<li>
 a proof that this environment is consistent with the definitions. </li>
</ul>
</div>
<br/>
<span class="kwd">Record</span> <span class="id"><a name="program">program</a></span> : <span class="kwd">Type</span> := {<br/>
&nbsp;&nbsp;<span class="id"><a name="prog_defs">prog_defs</a></span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="compcert.common.AST.html#ident">ident</a></span> * <span class="id"><a href="compcert.common.AST.html#globdef">globdef</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#fundef">fundef</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#type">type</a></span>);<br/>
&nbsp;&nbsp;<span class="id"><a name="prog_public">prog_public</a></span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.common.AST.html#ident">ident</a></span>;<br/>
&nbsp;&nbsp;<span class="id"><a name="prog_main">prog_main</a></span>: <span class="id"><a href="compcert.common.AST.html#ident">ident</a></span>;<br/>
&nbsp;&nbsp;<span class="id"><a name="prog_types">prog_types</a></span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_definition">composite_definition</a></span>;<br/>
&nbsp;&nbsp;<span class="id"><a name="prog_comp_env">prog_comp_env</a></span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_env">composite_env</a></span>;<br/>
&nbsp;&nbsp;<span class="id"><a name="prog_comp_env_eq">prog_comp_env_eq</a></span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#build_composite_env">build_composite_env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#prog_types">prog_types</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#prog_comp_env">prog_comp_env</a></span><br/>
}.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="program_of_program">program_of_program</a></span> (<span class="id">p</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#program">program</a></span>) : <span class="id"><a href="compcert.common.AST.html#program">AST.program</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#fundef">fundef</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#type">type</a></span> :=<br/>
&nbsp;&nbsp;{| <span class="id"><a href="compcert.common.AST.html#mkprogram">AST.prog_defs</a></span> := <span class="id"><a href="compcert.cfrontend.Ctypes.html#p">p</a></span>.(<span class="id"><a href="compcert.cfrontend.Ctypes.html#prog_defs">prog_defs</a></span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">AST.prog_public</span> := <span class="id"><a href="compcert.cfrontend.Ctypes.html#p">p</a></span>.(<span class="id"><a href="compcert.cfrontend.Ctypes.html#prog_public">prog_public</a></span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">AST.prog_main</span> := <span class="id"><a href="compcert.cfrontend.Ctypes.html#p">p</a></span>.(<span class="id"><a href="compcert.cfrontend.Ctypes.html#prog_main">prog_main</a></span>) |}.<br/>
<br/>
<span class="kwd">Coercion</span> <span class="id">program_of_program</span>: <span class="id">program</span> &gt;-&gt; <span class="id">AST.program</span>.<br/>
<br/>
<span class="kwd">Program</span> <span class="kwd">Definition</span> <span class="id"><a name="make_program">make_program</a></span> (<span class="id">types</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_definition">composite_definition</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">defs</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="compcert.common.AST.html#ident">ident</a></span> * <span class="id"><a href="compcert.common.AST.html#globdef">globdef</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#fundef">fundef</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#type">type</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">public</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.common.AST.html#ident">ident</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">main</span>: <span class="id"><a href="compcert.common.AST.html#ident">ident</a></span>) : <span class="id"><a href="compcert.common.Errors.html#res">res</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#program">program</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#build_composite_env">build_composite_env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#types">types</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.common.Errors.html#Error">Error</a></span> <span class="id">e</span> =&gt; <span class="id"><a href="compcert.common.Errors.html#Error">Error</a></span> <span class="id">e</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id">ce</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> {| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Build_program">prog_defs</a></span> := <span class="id"><a href="compcert.cfrontend.Ctypes.html#defs">defs</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">prog_public</span> := <span class="id"><a href="compcert.cfrontend.Ctypes.html#public">public</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">prog_main</span> := <span class="id"><a href="compcert.cfrontend.Ctypes.html#main">main</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">prog_types</span> := <span class="id"><a href="compcert.cfrontend.Ctypes.html#types">types</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">prog_comp_env</span> := <span class="id">ce</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">prog_comp_env_eq</span> := <span class="id">_</span> |}<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#PROGRAMS">PROGRAMS</a></span>.<br/>
<br/>
<span class="id">Arguments</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#External">External</a></span> {<span class="id">F</span>} <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>.<br/>
<br/>
<span class="kwd">Unset</span> <span class="kwd">Implicit</span> <span class="id">Arguments</span>.<br/>
<br/>
<h1> Separate compilation and linking </h1>
<br/>
<h2> Linking types </h2>
<br/>
<span class="kwd">Program</span> <span class="kwd">Instance</span> <span class="id"><a name="Linker_types">Linker_types</a></span> : <span class="id"><a href="compcert.common.Linking.html#Linker">Linker</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#type">type</a></span> := {<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#link">link</a></span> := <span class="kwd">fun</span> <span class="id">t1</span> <span class="id">t2</span> =&gt; <span class="kwd">if</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#type_eq">type_eq</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#t1">t1</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#t2">t2</a></span> <span class="kwd">then</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#t1">t1</a></span> <span class="kwd">else</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#linkorder">linkorder</a></span> := <span class="kwd">fun</span> <span class="id">t1</span> <span class="id">t2</span> =&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#t1">t1</a></span> = <span class="id"><a href="compcert.cfrontend.Ctypes.html#t2">t2</a></span><br/>
}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4289')">Next Obligation.</div>
<div class="proofscript" id="proof4289">
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#type_eq">type_eq</a></span> <span class="id">x</span> <span class="id">y</span>); <span class="id">inv</span> <span class="id">H</span>. <span class="tactic">auto</span>.<br/>
Defined.</div>
<br/>
<span class="kwd">Global</span> <span class="id">Opaque</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#Linker_types">Linker_types</a></span>.<br/>
<br/>
<h2> Linking composite definitions </h2>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="check_compat_composite">check_compat_composite</a></span> (<span class="id">l</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_definition">composite_definition</a></span>) (<span class="id">cd</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_definition">composite_definition</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#forallb">List.forallb</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">fun</span> <span class="id">cd</span>' =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="compcert.common.AST.html#ident_eq">ident_eq</a></span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#name_composite_def">name_composite_def</a></span> <span class="id">cd</span>') (<span class="id"><a href="compcert.cfrontend.Ctypes.html#name_composite_def">name_composite_def</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#cd">cd</a></span>) <span class="kwd">then</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_def_eq">composite_def_eq</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#cd">cd</a></span> <span class="id">cd</span>' <span class="kwd">else</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Ctypes.html#l">l</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="filter_redefs">filter_redefs</a></span> (<span class="id">l1</span> <span class="id">l2</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_definition">composite_definition</a></span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">names1</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#name_composite_def">name_composite_def</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#l1">l1</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#filter">List.filter</a></span> (<span class="kwd">fun</span> <span class="id">cd</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In_dec">In_dec</a></span> <span class="id"><a href="compcert.common.AST.html#ident_eq">ident_eq</a></span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#name_composite_def">name_composite_def</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#cd">cd</a></span>) <span class="id"><a href="compcert.cfrontend.Ctypes.html#names1">names1</a></span>)) <span class="id"><a href="compcert.cfrontend.Ctypes.html#l2">l2</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="link_composite_defs">link_composite_defs</a></span> (<span class="id">l1</span> <span class="id">l2</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_definition">composite_definition</a></span>): <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_definition">composite_definition</a></span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#forallb">List.forallb</a></span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#check_compat_composite">check_compat_composite</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#l2">l2</a></span>) <span class="id"><a href="compcert.cfrontend.Ctypes.html#l1">l1</a></span><br/>
&nbsp;&nbsp;<span class="kwd">then</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#l1">l1</a></span> ++ <span class="id"><a href="compcert.cfrontend.Ctypes.html#filter_redefs">filter_redefs</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#l1">l1</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#l2">l2</a></span>)<br/>
&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="link_composite_def_inv">link_composite_def_inv</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l1</span> <span class="id">l2</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Ctypes.html#link_composite_defs">link_composite_defs</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#l1">l1</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#l2">l2</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">cd1</span> <span class="id">cd2</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#cd1">cd1</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#l1">l1</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#cd2">cd2</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#l2">l2</a></span> -&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#name_composite_def">name_composite_def</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#cd2">cd2</a></span> = <span class="id"><a href="compcert.cfrontend.Ctypes.html#name_composite_def">name_composite_def</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#cd1">cd1</a></span> -&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#cd2">cd2</a></span> = <span class="id"><a href="compcert.cfrontend.Ctypes.html#cd1">cd1</a></span>)<br/>
&nbsp;&nbsp;/\ <span class="id"><a href="compcert.cfrontend.Ctypes.html#l">l</a></span> = <span class="id"><a href="compcert.cfrontend.Ctypes.html#l1">l1</a></span> ++ <span class="id"><a href="compcert.cfrontend.Ctypes.html#filter_redefs">filter_redefs</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#l1">l1</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#l2">l2</a></span><br/>
&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#x">x</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#l">l</a></span> &lt;-&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#x">x</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#l1">l1</a></span> \/ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#x">x</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#l2">l2</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4290')">Proof.</div>
<div class="proofscript" id="proof4290">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#link_composite_defs">link_composite_defs</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#forallb">forallb</a></span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#check_compat_composite">check_compat_composite</a></span> <span class="id">l2</span>) <span class="id">l1</span>) <span class="id">eqn</span>:<span class="id">C</span>; <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">A</span>: <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">cd1</span> <span class="id">cd2</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#cd1">cd1</a></span> <span class="id">l1</span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#cd2">cd2</a></span> <span class="id">l2</span> -&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#name_composite_def">name_composite_def</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#cd2">cd2</a></span> = <span class="id"><a href="compcert.cfrontend.Ctypes.html#name_composite_def">name_composite_def</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#cd1">cd1</a></span> -&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#cd2">cd2</a></span> = <span class="id"><a href="compcert.cfrontend.Ctypes.html#cd1">cd1</a></span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#forallb_forall">forallb_forall</a></span> <span class="kwd">in</span> <span class="id">C</span>. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">C</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#check_compat_composite">check_compat_composite</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#forallb_forall">forallb_forall</a></span> <span class="kwd">in</span> <span class="id">H</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H</span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="tactic">rewrite</span> <span class="id">H1</span>, <span class="id"><a href="compcert.lib.Coqlib.html#dec_eq_true">dec_eq_true</a></span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="tactic">symmetry</span>; <span class="tactic">eapply</span> <span class="id"><a href="compcert.lib.Coqlib.html#proj_sumbool_true">proj_sumbool_true</a></span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">auto</span>. <span class="tactic">split</span>. <span class="tactic">auto</span>. <br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#filter_redefs">filter_redefs</a></span>; <span class="tactic">intros</span>. <br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_app_iff">in_app_iff</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#filter_In">filter_In</a></span>. <span class="tactic">intuition</span> <span class="tactic">auto</span>. <br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_dec">in_dec</a></span> <span class="id"><a href="compcert.common.AST.html#ident_eq">ident_eq</a></span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#name_composite_def">name_composite_def</a></span> <span class="id">x</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#name_composite_def">name_composite_def</a></span> <span class="id">l1</span>)); <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.lib.Coqlib.html#list_in_map_inv">list_in_map_inv</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">y</span> &amp; <span class="id">P</span> &amp; <span class="id">Q</span>).<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">x</span> = <span class="id">y</span>) <span class="tactic">by</span> <span class="tactic">eauto</span>. <span class="tactic">subst</span> <span class="id">y</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Program</span> <span class="kwd">Instance</span> <span class="id"><a name="Linker_composite_defs">Linker_composite_defs</a></span> : <span class="id"><a href="compcert.common.Linking.html#Linker">Linker</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_definition">composite_definition</a></span>) := {<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#link">link</a></span> := <span class="id"><a href="compcert.cfrontend.Ctypes.html#link_composite_defs">link_composite_defs</a></span>;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#linkorder">linkorder</a></span> := @<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#incl">List.incl</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_definition">composite_definition</a></span><br/>
}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4291')">Next Obligation.</div>
<div class="proofscript" id="proof4291">
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#incl_refl">incl_refl</a></span>.<br/>
Defined.</div>
<div class="toggleproof" onclick="toggleDisplay('proof4292')">Next Obligation.</div>
<div class="proofscript" id="proof4292">
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="tactic">eauto</span>.<br/>
Defined.</div>
<div class="toggleproof" onclick="toggleDisplay('proof4293')">Next Obligation.</div>
<div class="proofscript" id="proof4293">
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#link_composite_def_inv">link_composite_def_inv</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> (<span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span>).<br/>
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="tactic">apply</span> <span class="id">C</span>; <span class="tactic">auto</span>.<br/>
Defined.</div>
<br/>
<div class="doc">Connections with <span class="bracket"><span class="id">build_composite_env</span></span>. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="add_composite_definitions_append">add_composite_definitions_append</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l1</span> <span class="id">l2</span> <span class="id">env</span> <span class="id">env</span>'',<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Ctypes.html#add_composite_definitions">add_composite_definitions</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#l1">l1</a></span> ++ <span class="id"><a href="compcert.cfrontend.Ctypes.html#l2">l2</a></span>) = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id">env</span>'' &lt;-&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">env</span>', <span class="id"><a href="compcert.cfrontend.Ctypes.html#add_composite_definitions">add_composite_definitions</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#l1">l1</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id">env</span>' /\ <span class="id"><a href="compcert.cfrontend.Ctypes.html#add_composite_definitions">add_composite_definitions</a></span> <span class="id">env</span>' <span class="id"><a href="compcert.cfrontend.Ctypes.html#l2">l2</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id">env</span>''.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4294')">Proof.</div>
<div class="proofscript" id="proof4294">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l1</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
- <span class="tactic">split</span>; <span class="tactic">intros</span>. <span class="id">exists</span> <span class="id">env</span>; <span class="tactic">auto</span>. <span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> (<span class="id">env</span>' &amp; <span class="id">A</span> &amp; <span class="id">B</span>). <span class="tactic">congruence</span>.<br/>
- <span class="tactic">destruct</span> <span class="id">a</span>; <span class="tactic">simpl</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_of_def">composite_of_def</a></span> <span class="id">env</span> <span class="id">id</span> <span class="id">su</span> <span class="id">m</span> <span class="id">a</span>); <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHl1</span>. <br/>
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">intros</span>. <span class="tactic">discriminate</span>. <span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> (<span class="id">env</span>' &amp; <span class="id">A</span> &amp; <span class="id">B</span>); <span class="tactic">discriminate</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="composite_eq">composite_eq</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">su1</span> <span class="id">m1</span> <span class="id">a1</span> <span class="id">sz1</span> <span class="id">al1</span> <span class="id">r1</span> <span class="id">pos1</span> <span class="id">al2p1</span> <span class="id">szal1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">su2</span> <span class="id">m2</span> <span class="id">a2</span> <span class="id">sz2</span> <span class="id">al2</span> <span class="id">r2</span> <span class="id">pos2</span> <span class="id">al2p2</span> <span class="id">szal2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Ctypes.html#su1">su1</a></span> = <span class="id"><a href="compcert.cfrontend.Ctypes.html#su2">su2</a></span> -&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#m1">m1</a></span> = <span class="id"><a href="compcert.cfrontend.Ctypes.html#m2">m2</a></span> -&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#a1">a1</a></span> = <span class="id"><a href="compcert.cfrontend.Ctypes.html#a2">a2</a></span> -&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#sz1">sz1</a></span> = <span class="id"><a href="compcert.cfrontend.Ctypes.html#sz2">sz2</a></span> -&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#al1">al1</a></span> = <span class="id"><a href="compcert.cfrontend.Ctypes.html#al2">al2</a></span> -&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#r1">r1</a></span> = <span class="id"><a href="compcert.cfrontend.Ctypes.html#r2">r2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Ctypes.html#Build_composite">Build_composite</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#su1">su1</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#m1">m1</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#a1">a1</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#sz1">sz1</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#al1">al1</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#r1">r1</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#pos1">pos1</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#al2p1">al2p1</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#szal1">szal1</a></span> = <span class="id"><a href="compcert.cfrontend.Ctypes.html#Build_composite">Build_composite</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#su2">su2</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#m2">m2</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#a2">a2</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#sz2">sz2</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#al2">al2</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#r2">r2</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#pos2">pos2</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#al2p2">al2p2</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#szal2">szal2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4295')">Proof.</div>
<div class="proofscript" id="proof4295">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">pos1</span> = <span class="id">pos2</span>) <span class="tactic">by</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Axioms.html#proof_irr">proof_irr</a></span>. <br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">al2p1</span> = <span class="id">al2p2</span>) <span class="tactic">by</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Axioms.html#proof_irr">proof_irr</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">szal1</span> = <span class="id">szal2</span>) <span class="tactic">by</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Axioms.html#proof_irr">proof_irr</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">subst</span>. <span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="composite_of_def_eq">composite_of_def_eq</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">env</span> <span class="id">id</span> <span class="id">co</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_consistent">composite_consistent</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co">co</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span>!<span class="id"><a href="compcert.cfrontend.Ctypes.html#id">id</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_of_def">composite_of_def</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#id">id</a></span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#co_su">co_su</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co">co</a></span>) (<span class="id"><a href="compcert.cfrontend.Ctypes.html#co_members">co_members</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co">co</a></span>) (<span class="id"><a href="compcert.cfrontend.Ctypes.html#co_attr">co_attr</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co">co</a></span>) = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co">co</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4296')">Proof.</div>
<div class="proofscript" id="proof4296">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [<span class="id">A</span> <span class="id">B</span> <span class="id">C</span> <span class="id">D</span>]. <span class="tactic">unfold</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_of_def">composite_of_def</a></span>. <span class="tactic">rewrite</span> <span class="id">H0</span>, <span class="id">A</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">co</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">f_equal</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_eq">composite_eq</a></span>; <span class="tactic">auto</span>. <span class="tactic">rewrite</span> <span class="id">C</span>, <span class="id">B</span>; <span class="tactic">auto</span>. <br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="composite_consistent_unique">composite_consistent_unique</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">env</span> <span class="id">co1</span> <span class="id">co2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_consistent">composite_consistent</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co1">co1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_consistent">composite_consistent</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co2">co2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Ctypes.html#co_su">co_su</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co1">co1</a></span> = <span class="id"><a href="compcert.cfrontend.Ctypes.html#co_su">co_su</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co2">co2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Ctypes.html#co_members">co_members</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co1">co1</a></span> = <span class="id"><a href="compcert.cfrontend.Ctypes.html#co_members">co_members</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co2">co2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Ctypes.html#co_attr">co_attr</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co1">co1</a></span> = <span class="id"><a href="compcert.cfrontend.Ctypes.html#co_attr">co_attr</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co2">co2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Ctypes.html#co1">co1</a></span> = <span class="id"><a href="compcert.cfrontend.Ctypes.html#co2">co2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4297')">Proof.</div>
<div class="proofscript" id="proof4297">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H</span>, <span class="id">H0</span>. <span class="tactic">destruct</span> <span class="id">co1</span>, <span class="id">co2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">apply</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_eq">composite_eq</a></span>; <span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="composite_of_def_stable">composite_of_def_stable</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">env</span> <span class="id">env</span>': <span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_env">composite_env</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">EXTENDS</span>: <span class="kwd">forall</span> <span class="id">id</span> <span class="id">co</span>, <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span>!<span class="id"><a href="compcert.cfrontend.Ctypes.html#id">id</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co">co</a></span> -&gt; <span class="id">env</span>'!<span class="id"><a href="compcert.cfrontend.Ctypes.html#id">id</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co">co</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">id</span> <span class="id">su</span> <span class="id">m</span> <span class="id">a</span> <span class="id">co</span>,<br/>
&nbsp;&nbsp;<span class="id">env</span>'!<span class="id"><a href="compcert.cfrontend.Ctypes.html#id">id</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_of_def">composite_of_def</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#id">id</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#su">su</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#m">m</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#a">a</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co">co</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_of_def">composite_of_def</a></span> <span class="id">env</span>' <span class="id"><a href="compcert.cfrontend.Ctypes.html#id">id</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#su">su</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#m">m</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#a">a</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co">co</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4298')">Proof.</div>
<div class="proofscript" id="proof4298">
&nbsp;&nbsp;<span class="tactic">intros</span>. <br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_of_def">composite_of_def</a></span> <span class="kwd">in</span> <span class="id">H0</span>. <br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">env</span>!<span class="id">id</span>) <span class="id">eqn</span>:<span class="id">E</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#complete_members">complete_members</a></span> <span class="id">env</span> <span class="id">m</span>) <span class="id">eqn</span>:<span class="id">CM</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">transitivity</span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_of_def">composite_of_def</a></span> <span class="id">env</span>' <span class="id">id</span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#co_su">co_su</a></span> <span class="id">co</span>) (<span class="id"><a href="compcert.cfrontend.Ctypes.html#co_members">co_members</a></span> <span class="id">co</span>) (<span class="id"><a href="compcert.cfrontend.Ctypes.html#co_attr">co_attr</a></span> <span class="id">co</span>)).<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H0</span>; <span class="tactic">auto</span>. <br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_of_def_eq">composite_of_def_eq</a></span>; <span class="tactic">auto</span>. <br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_consistent_stable">composite_consistent_stable</a></span> <span class="kwd">with</span> <span class="id">env</span>; <span class="tactic">auto</span>. <br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H0</span>; <span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="link_add_composite_definitions">link_add_composite_definitions</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l0</span> <span class="id">env0</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Ctypes.html#build_composite_env">build_composite_env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#l0">l0</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env0">env0</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span> <span class="id">env1</span> <span class="id">env1</span>' <span class="id">env2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Ctypes.html#add_composite_definitions">add_composite_definitions</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env1">env1</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#l">l</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id">env1</span>' -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">id</span> <span class="id">co</span>, <span class="id"><a href="compcert.cfrontend.Ctypes.html#env1">env1</a></span>!<span class="id"><a href="compcert.cfrontend.Ctypes.html#id">id</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co">co</a></span> -&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#env2">env2</a></span>!<span class="id"><a href="compcert.cfrontend.Ctypes.html#id">id</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co">co</a></span>) -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">id</span> <span class="id">co</span>, <span class="id"><a href="compcert.cfrontend.Ctypes.html#env0">env0</a></span>!<span class="id"><a href="compcert.cfrontend.Ctypes.html#id">id</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co">co</a></span> -&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#env2">env2</a></span>!<span class="id"><a href="compcert.cfrontend.Ctypes.html#id">id</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co">co</a></span>) -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">id</span>, <span class="id"><a href="compcert.cfrontend.Ctypes.html#env2">env2</a></span>!<span class="id"><a href="compcert.cfrontend.Ctypes.html#id">id</a></span> = <span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In_dec">In_dec</a></span> <span class="id"><a href="compcert.common.AST.html#ident_eq">ident_eq</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#id">id</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#name_composite_def">name_composite_def</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#l0">l0</a></span>) <span class="kwd">then</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env0">env0</a></span>!<span class="id"><a href="compcert.cfrontend.Ctypes.html#id">id</a></span> <span class="kwd">else</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env1">env1</a></span>!<span class="id"><a href="compcert.cfrontend.Ctypes.html#id">id</a></span>) -&gt;<br/>
&nbsp;&nbsp;((<span class="kwd">forall</span> <span class="id">cd1</span> <span class="id">cd2</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#cd1">cd1</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#l0">l0</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#cd2">cd2</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#l">l</a></span> -&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#name_composite_def">name_composite_def</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#cd2">cd2</a></span> = <span class="id"><a href="compcert.cfrontend.Ctypes.html#name_composite_def">name_composite_def</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#cd1">cd1</a></span> -&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#cd2">cd2</a></span> = <span class="id"><a href="compcert.cfrontend.Ctypes.html#cd1">cd1</a></span>)) -&gt;<br/>
&nbsp;&nbsp;{ <span class="id">env2</span>' |<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Ctypes.html#add_composite_definitions">add_composite_definitions</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env2">env2</a></span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#filter_redefs">filter_redefs</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#l0">l0</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#l">l</a></span>) = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id">env2</span>'<br/>
&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">id</span> <span class="id">co</span>, <span class="id">env1</span>'!<span class="id"><a href="compcert.cfrontend.Ctypes.html#id">id</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co">co</a></span> -&gt; <span class="id">env2</span>'!<span class="id"><a href="compcert.cfrontend.Ctypes.html#id">id</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co">co</a></span>)<br/>
&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">id</span> <span class="id">co</span>, <span class="id"><a href="compcert.cfrontend.Ctypes.html#env0">env0</a></span>!<span class="id"><a href="compcert.cfrontend.Ctypes.html#id">id</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co">co</a></span> -&gt; <span class="id">env2</span>'!<span class="id"><a href="compcert.cfrontend.Ctypes.html#id">id</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co">co</a></span>) }.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4299')">Proof.</div>
<div class="proofscript" id="proof4299">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span> <span class="id">until</span> <span class="id">env2</span>; <span class="tactic">intros</span> <span class="id">ACD</span> <span class="id">AGREE1</span> <span class="id">AGREE0</span> <span class="id">AGREE2</span> <span class="id">UNIQUE</span>.<br/>
- <span class="id">inv</span> <span class="id">ACD</span>. <span class="id">exists</span> <span class="id">env2</span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">destruct</span> <span class="id">a</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_of_def">composite_of_def</a></span> <span class="id">env1</span> <span class="id">id</span> <span class="id">su</span> <span class="id">m</span> <span class="id">a</span>) <span class="kwd">as</span> [<span class="id">x</span>|<span class="id">e</span>] <span class="id">eqn</span>:<span class="id">EQ</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">ACD</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="id">EQ</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_of_def">composite_of_def</a></span> <span class="tactic">at</span> 1. <br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">env1</span>!<span class="id">id</span>) <span class="id">eqn</span>:<span class="id">E1</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#complete_members">complete_members</a></span> <span class="id">env1</span> <span class="id">m</span>) <span class="id">eqn</span>:<span class="id">CM1</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>. <br/>
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">EQ1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_dec">in_dec</a></span> <span class="id"><a href="compcert.common.AST.html#ident_eq">ident_eq</a></span> <span class="id">id</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#name_composite_def">name_composite_def</a></span> <span class="id">l0</span>)); <span class="tactic">simpl</span>.<br/>
+ <span class="tactic">eapply</span> <span class="id">IHl</span>; <span class="tactic">eauto</span>.<br/>
* <span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Maps.html#PTree.gsspec">PTree.gsspec</a></span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#peq">peq</a></span> <span class="id">id0</span> <span class="id">id</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.lib.Coqlib.html#list_in_map_inv">list_in_map_inv</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> ([<span class="id">id</span>' <span class="id">su</span>' <span class="id">m</span>' <span class="id">a</span>'] &amp; <span class="id">P</span> &amp; <span class="id">Q</span>).<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">X</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#Composite">Composite</a></span> <span class="id">id</span> <span class="id">su</span> <span class="id">m</span> <span class="id">a</span> = <span class="id"><a href="compcert.cfrontend.Ctypes.html#Composite">Composite</a></span> <span class="id">id</span>' <span class="id">su</span>' <span class="id">m</span>' <span class="id">a</span>').<br/>
&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id">UNIQUE</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">P</span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">X</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#build_composite_env_charact">build_composite_env_charact</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">co</span>' &amp; <span class="id">U</span> &amp; <span class="id">V</span> &amp; <span class="id">W</span> &amp; <span class="id">X</span>). <br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">co</span>' = <span class="id">co</span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">apply</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_consistent_unique">composite_consistent_unique</a></span> <span class="kwd">with</span> <span class="id">env2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_consistent_stable">composite_consistent_stable</a></span> <span class="kwd">with</span> <span class="id">env0</span>; <span class="tactic">auto</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#build_composite_env_consistent">build_composite_env_consistent</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_consistent_stable">composite_consistent_stable</a></span> <span class="kwd">with</span> <span class="id">env1</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">EQ1</span>; <span class="id">constructor</span>; <span class="tactic">auto</span>. <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">EQ1</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">EQ1</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">EQ1</span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">co</span>'. <span class="tactic">apply</span> <span class="id">AGREE0</span>; <span class="tactic">auto</span>. <br/>
* <span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id">AGREE2</span>. <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_dec">in_dec</a></span> <span class="id"><a href="compcert.common.AST.html#ident_eq">ident_eq</a></span> <span class="id">id0</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#name_composite_def">name_composite_def</a></span> <span class="id">l0</span>)); <span class="tactic">auto</span>. <br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Maps.html#PTree.gsspec">PTree.gsspec</a></span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#peq">peq</a></span> <span class="id">id0</span> <span class="id">id</span>); <span class="tactic">auto</span>. <span class="tactic">subst</span> <span class="id">id0</span>. <span class="id">contradiction</span>.<br/>
+ <span class="tactic">assert</span> (<span class="id">E2</span>: <span class="id">env2</span>!<span class="id">id</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">rewrite</span> <span class="id">AGREE2</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#pred_dec_false">pred_dec_false</a></span> <span class="tactic">by</span> <span class="tactic">auto</span>. <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">E3</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_of_def">composite_of_def</a></span> <span class="id">env2</span> <span class="id">id</span> <span class="id">su</span> <span class="id">m</span> <span class="id">a</span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#composite_of_def_stable">composite_of_def_stable</a></span>. <span class="id">eexact</span> <span class="id">AGREE1</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">E3</span>. <span class="tactic">simpl</span>. <span class="tactic">eapply</span> <span class="id">IHl</span>; <span class="tactic">eauto</span>. <br/>
* <span class="tactic">intros</span> <span class="id">until</span> <span class="id">co</span>; <span class="tactic">rewrite</span> ! <span class="id"><a href="compcert.lib.Maps.html#PTree.gsspec">PTree.gsspec</a></span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#peq">peq</a></span> <span class="id">id0</span> <span class="id">id</span>); <span class="tactic">auto</span>.<br/>
* <span class="tactic">intros</span> <span class="id">until</span> <span class="id">co</span>; <span class="tactic">rewrite</span> ! <span class="id"><a href="compcert.lib.Maps.html#PTree.gsspec">PTree.gsspec</a></span>. <span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#peq">peq</a></span> <span class="id">id0</span> <span class="id">id</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">id0</span>. <span class="tactic">apply</span> <span class="id">AGREE0</span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="tactic">congruence</span>.<br/>
* <span class="tactic">intros</span>. <span class="tactic">rewrite</span> ! <span class="id"><a href="compcert.lib.Maps.html#PTree.gsspec">PTree.gsspec</a></span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#peq">peq</a></span> <span class="id">id0</span> <span class="id">id</span>); <span class="tactic">auto</span>. <span class="tactic">subst</span> <span class="id">id0</span>. <br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#pred_dec_false">pred_dec_false</a></span> <span class="tactic">by</span> <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="link_build_composite_env">link_build_composite_env</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l1</span> <span class="id">l2</span> <span class="id">l</span> <span class="id">env1</span> <span class="id">env2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Ctypes.html#build_composite_env">build_composite_env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#l1">l1</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env1">env1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Ctypes.html#build_composite_env">build_composite_env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#l2">l2</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env2">env2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#link">link</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#l1">l1</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#l2">l2</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;{ <span class="id">env</span> |<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Ctypes.html#build_composite_env">build_composite_env</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#l">l</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span><br/>
&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">id</span> <span class="id">co</span>, <span class="id"><a href="compcert.cfrontend.Ctypes.html#env1">env1</a></span>!<span class="id"><a href="compcert.cfrontend.Ctypes.html#id">id</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co">co</a></span> -&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span>!<span class="id"><a href="compcert.cfrontend.Ctypes.html#id">id</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co">co</a></span>)<br/>
&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">id</span> <span class="id">co</span>, <span class="id"><a href="compcert.cfrontend.Ctypes.html#env2">env2</a></span>!<span class="id"><a href="compcert.cfrontend.Ctypes.html#id">id</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co">co</a></span> -&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#env">env</a></span>!<span class="id"><a href="compcert.cfrontend.Ctypes.html#id">id</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co">co</a></span>) }.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4300')">Proof.</div>
<div class="proofscript" id="proof4300">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">edestruct</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#link_composite_def_inv">link_composite_def_inv</a></span> <span class="kwd">as</span> (<span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">edestruct</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#link_add_composite_definitions">link_add_composite_definitions</a></span> <span class="kwd">as</span> (<span class="id">env</span> &amp; <span class="id">P</span> &amp; <span class="id">Q</span> &amp; <span class="id">R</span>).<br/>
&nbsp;&nbsp;<span class="id">eexact</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">eexact</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">instantiate</span> (1 := <span class="id">env1</span>). <span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Maps.html#PTree.gempty">PTree.gempty</a></span> <span class="kwd">in</span> <span class="id">H2</span>; <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_dec">in_dec</a></span> <span class="id"><a href="compcert.common.AST.html#ident_eq">ident_eq</a></span> <span class="id">id</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#name_composite_def">name_composite_def</a></span> <span class="id">l1</span>)); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Maps.html#PTree.gempty">PTree.gempty</a></span>. <span class="tactic">destruct</span> (<span class="id">env1</span>!<span class="id">id</span>) <span class="id">eqn</span>:<span class="id">E1</span>; <span class="tactic">auto</span>. <br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#build_composite_env_domain">build_composite_env_domain</a></span>. <span class="id">eexact</span> <span class="id">H</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_map">in_map</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#name_composite_def">name_composite_def</a></span>) <span class="kwd">in</span> <span class="id">H2</span>. <span class="tactic">elim</span> <span class="id">n</span>; <span class="tactic">auto</span>. <br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">env</span>; <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">subst</span> <span class="id">l</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#add_composite_definitions_append">add_composite_definitions_append</a></span>. <span class="id">exists</span> <span class="id">env1</span>; <span class="tactic">auto</span>. <br/>
Qed.</div>
<br/>
<h2> Linking function definitions </h2>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="link_fundef">link_fundef</a></span> {<span class="id">F</span>: <span class="kwd">Type</span>} (<span class="id">fd1</span> <span class="id">fd2</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#fundef">fundef</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#F">F</a></span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#fd1">fd1</a></span>, <span class="id"><a href="compcert.cfrontend.Ctypes.html#fd2">fd2</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Internal">Internal</a></span> <span class="id">_</span>, <span class="id"><a href="compcert.cfrontend.Ctypes.html#Internal">Internal</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#External">External</a></span> <span class="id">ef1</span> <span class="id">targs1</span> <span class="id">tres1</span> <span class="id">cc1</span>, <span class="id"><a href="compcert.cfrontend.Ctypes.html#External">External</a></span> <span class="id">ef2</span> <span class="id">targs2</span> <span class="id">tres2</span> <span class="id">cc2</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="compcert.common.AST.html#external_function_eq">external_function_eq</a></span> <span class="id">ef1</span> <span class="id">ef2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp; <span class="id"><a href="compcert.cfrontend.Ctypes.html#typelist_eq">typelist_eq</a></span> <span class="id">targs1</span> <span class="id">targs2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp; <span class="id"><a href="compcert.cfrontend.Ctypes.html#type_eq">type_eq</a></span> <span class="id">tres1</span> <span class="id">tres2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp; <span class="id"><a href="compcert.common.AST.html#calling_convention_eq">calling_convention_eq</a></span> <span class="id">cc1</span> <span class="id">cc2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#External">External</a></span> <span class="id">ef1</span> <span class="id">targs1</span> <span class="id">tres1</span> <span class="id">cc1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Internal">Internal</a></span> <span class="id">f</span>, <span class="id"><a href="compcert.cfrontend.Ctypes.html#External">External</a></span> <span class="id">ef</span> <span class="id">targs</span> <span class="id">tres</span> <span class="id">cc</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">ef</span> <span class="kwd">with</span> <span class="id"><a href="compcert.common.AST.html#EF_external">EF_external</a></span> <span class="id">id</span> <span class="id">sg</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#Internal">Internal</a></span> <span class="id">f</span>) | <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> <span class="kwd">end</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.cfrontend.Ctypes.html#External">External</a></span> <span class="id">ef</span> <span class="id">targs</span> <span class="id">tres</span> <span class="id">cc</span>, <span class="id"><a href="compcert.cfrontend.Ctypes.html#Internal">Internal</a></span> <span class="id">f</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">ef</span> <span class="kwd">with</span> <span class="id"><a href="compcert.common.AST.html#EF_external">EF_external</a></span> <span class="id">id</span> <span class="id">sg</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#Internal">Internal</a></span> <span class="id">f</span>) | <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> <span class="kwd">end</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="linkorder_fundef">linkorder_fundef</a></span> {<span class="id">F</span>: <span class="kwd">Type</span>}: <span class="id"><a href="compcert.cfrontend.Ctypes.html#fundef">fundef</a></span> <span class="id">F</span> -&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#fundef">fundef</a></span> <span class="id">F</span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="linkorder_fundef_refl">linkorder_fundef_refl</a></span>: <span class="kwd">forall</span> <span class="id">fd</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Ctypes.html#linkorder_fundef">linkorder_fundef</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#fd">fd</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#fd">fd</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="linkorder_fundef_ext_int">linkorder_fundef_ext_int</a></span>: <span class="kwd">forall</span> <span class="id">f</span> <span class="id">id</span> <span class="id">sg</span> <span class="id">targs</span> <span class="id">tres</span> <span class="id">cc</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Ctypes.html#linkorder_fundef">linkorder_fundef</a></span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#External">External</a></span> (<span class="id"><a href="compcert.common.AST.html#EF_external">EF_external</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#id">id</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#sg">sg</a></span>) <span class="id"><a href="compcert.cfrontend.Ctypes.html#targs">targs</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#tres">tres</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#cc">cc</a></span>) (<span class="id"><a href="compcert.cfrontend.Ctypes.html#Internal">Internal</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#f">f</a></span>).<br/>
<br/>
<span class="kwd">Program</span> <span class="kwd">Instance</span> <span class="id"><a name="Linker_fundef">Linker_fundef</a></span> (<span class="id">F</span>: <span class="kwd">Type</span>): <span class="id"><a href="compcert.common.Linking.html#Linker">Linker</a></span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#fundef">fundef</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#F">F</a></span>) := {<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#link">link</a></span> := <span class="id"><a href="compcert.cfrontend.Ctypes.html#link_fundef">link_fundef</a></span>;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#linkorder">linkorder</a></span> := <span class="id"><a href="compcert.cfrontend.Ctypes.html#linkorder_fundef">linkorder_fundef</a></span><br/>
}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4301')">Next Obligation.</div>
<div class="proofscript" id="proof4301">
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
Defined.</div>
<div class="toggleproof" onclick="toggleDisplay('proof4302')">Next Obligation.</div>
<div class="proofscript" id="proof4302">
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>; <span class="id">inv</span> <span class="id">H0</span>; <span class="id">constructor</span>.<br/>
Defined.</div>
<div class="toggleproof" onclick="toggleDisplay('proof4303')">Next Obligation.</div>
<div class="proofscript" id="proof4303">
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">x</span>, <span class="id">y</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
+ <span class="tactic">discriminate</span>.<br/>
+ <span class="tactic">destruct</span> <span class="id">e</span>; <span class="id">inv</span> <span class="id">H</span>. <span class="tactic">split</span>; <span class="id">constructor</span>.<br/>
+ <span class="tactic">destruct</span> <span class="id">e</span>; <span class="id">inv</span> <span class="id">H</span>. <span class="tactic">split</span>; <span class="id">constructor</span>.<br/>
+ <span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.AST.html#external_function_eq">external_function_eq</a></span> <span class="id">e</span> <span class="id">e0</span> &amp;&amp; <span class="id"><a href="compcert.cfrontend.Ctypes.html#typelist_eq">typelist_eq</a></span> <span class="id">t</span> <span class="id">t1</span> &amp;&amp; <span class="id"><a href="compcert.cfrontend.Ctypes.html#type_eq">type_eq</a></span> <span class="id">t0</span> <span class="id">t2</span> &amp;&amp; <span class="id"><a href="compcert.common.AST.html#calling_convention_eq">calling_convention_eq</a></span> <span class="id">c</span> <span class="id">c0</span>) <span class="id">eqn</span>:<span class="id">A</span>; <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">InvBooleans</span>. <span class="tactic">subst</span>. <span class="tactic">split</span>; <span class="id">constructor</span>.<br/>
Defined.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="link_fundef_either">link_fundef_either</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">F</span>: <span class="kwd">Type</span>) (<span class="id">f1</span> <span class="id">f2</span> <span class="id">f</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#fundef">fundef</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#F">F</a></span>), <span class="id"><a href="compcert.common.Linking.html#link">link</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#f1">f1</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#f2">f2</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#f">f</a></span> -&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#f">f</a></span> = <span class="id"><a href="compcert.cfrontend.Ctypes.html#f1">f1</a></span> \/ <span class="id"><a href="compcert.cfrontend.Ctypes.html#f">f</a></span> = <span class="id"><a href="compcert.cfrontend.Ctypes.html#f2">f2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4304')">Proof.</div>
<div class="proofscript" id="proof4304">
&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#link_fundef">link_fundef</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">destruct</span> <span class="id">f1</span>, <span class="id">f2</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
- <span class="tactic">destruct</span> <span class="id">e</span>; <span class="id">inv</span> <span class="id">H</span>. <span class="tactic">auto</span>.<br/>
- <span class="tactic">destruct</span> <span class="id">e</span>; <span class="id">inv</span> <span class="id">H</span>. <span class="tactic">auto</span>.<br/>
- <span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.AST.html#external_function_eq">external_function_eq</a></span> <span class="id">e</span> <span class="id">e0</span> &amp;&amp; <span class="id"><a href="compcert.cfrontend.Ctypes.html#typelist_eq">typelist_eq</a></span> <span class="id">t</span> <span class="id">t1</span> &amp;&amp; <span class="id"><a href="compcert.cfrontend.Ctypes.html#type_eq">type_eq</a></span> <span class="id">t0</span> <span class="id">t2</span> &amp;&amp; <span class="id"><a href="compcert.common.AST.html#calling_convention_eq">calling_convention_eq</a></span> <span class="id">c</span> <span class="id">c0</span>); <span class="id">inv</span> <span class="id">H</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Global</span> <span class="id">Opaque</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#Linker_fundef">Linker_fundef</a></span>.<br/>
<br/>
<h2> Linking programs </h2>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="lift_option">lift_option</a></span> {<span class="id">A</span>: <span class="kwd">Type</span>} (<span class="id">opt</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#A">A</a></span>) : { <span class="id">x</span> | <span class="id"><a href="compcert.cfrontend.Ctypes.html#opt">opt</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#x">x</a></span> } + { <span class="id"><a href="compcert.cfrontend.Ctypes.html#opt">opt</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> }.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4305')">Proof.</div>
<div class="proofscript" id="proof4305">
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">opt</span>. <span class="id">left</span>; <span class="id">exists</span> <span class="id">a</span>; <span class="tactic">auto</span>. <span class="id">right</span>; <span class="tactic">auto</span>. <br/>
Defined.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="link_program">link_program</a></span> {<span class="id">F</span>:<span class="kwd">Type</span>} (<span class="id">p1</span> <span class="id">p2</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#program">program</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#F">F</a></span>): <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#program">program</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#F">F</a></span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.common.Linking.html#link">link</a></span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#program_of_program">program_of_program</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#p1">p1</a></span>) (<span class="id"><a href="compcert.cfrontend.Ctypes.html#program_of_program">program_of_program</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#p2">p2</a></span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">p</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#lift_option">lift_option</a></span> (<span class="id"><a href="compcert.common.Linking.html#link">link</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#p1">p1</a></span>.(<span class="id"><a href="compcert.cfrontend.Ctypes.html#prog_types">prog_types</a></span>) <span class="id"><a href="compcert.cfrontend.Ctypes.html#p2">p2</a></span>.(<span class="id"><a href="compcert.cfrontend.Ctypes.html#prog_types">prog_types</a></span>)) <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#inright">inright</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#inleft">inleft</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">typs</span> <span class="id">EQ</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#link_build_composite_env">link_build_composite_env</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Ctypes.html#p1">p1</a></span>.(<span class="id"><a href="compcert.cfrontend.Ctypes.html#prog_types">prog_types</a></span>) <span class="id"><a href="compcert.cfrontend.Ctypes.html#p2">p2</a></span>.(<span class="id"><a href="compcert.cfrontend.Ctypes.html#prog_types">prog_types</a></span>) <span class="id">typs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Ctypes.html#p1">p1</a></span>.(<span class="id"><a href="compcert.cfrontend.Ctypes.html#prog_comp_env">prog_comp_env</a></span>) <span class="id"><a href="compcert.cfrontend.Ctypes.html#p2">p2</a></span>.(<span class="id"><a href="compcert.cfrontend.Ctypes.html#prog_comp_env">prog_comp_env</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Ctypes.html#p1">p1</a></span>.(<span class="id"><a href="compcert.cfrontend.Ctypes.html#prog_comp_env_eq">prog_comp_env_eq</a></span>) <span class="id"><a href="compcert.cfrontend.Ctypes.html#p2">p2</a></span>.(<span class="id"><a href="compcert.cfrontend.Ctypes.html#prog_comp_env_eq">prog_comp_env_eq</a></span>) <span class="id">EQ</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">env</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#conj">conj</a></span> <span class="id">P</span> <span class="id">Q</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> {| <span class="id"><a href="compcert.cfrontend.Ctypes.html#Build_program">prog_defs</a></span> := <span class="id">p</span>.(<span class="id"><a href="compcert.common.AST.html#prog_defs">AST.prog_defs</a></span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">prog_public</span> := <span class="id">p</span>.(<span class="id"><a href="compcert.common.AST.html#prog_public">AST.prog_public</a></span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">prog_main</span> := <span class="id">p</span>.(<span class="id"><a href="compcert.common.AST.html#prog_main">AST.prog_main</a></span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">prog_types</span> := <span class="id">typs</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">prog_comp_env</span> := <span class="id">env</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">prog_comp_env_eq</span> := <span class="id">P</span> |}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="linkorder_program">linkorder_program</a></span> {<span class="id">F</span>: <span class="kwd">Type</span>} (<span class="id">p1</span> <span class="id">p2</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#program">program</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#F">F</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#linkorder">linkorder</a></span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#program_of_program">program_of_program</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#p1">p1</a></span>) (<span class="id"><a href="compcert.cfrontend.Ctypes.html#program_of_program">program_of_program</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#p2">p2</a></span>)<br/>
&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">id</span> <span class="id">co</span>, <span class="id"><a href="compcert.cfrontend.Ctypes.html#p1">p1</a></span>.(<span class="id"><a href="compcert.cfrontend.Ctypes.html#prog_comp_env">prog_comp_env</a></span>)!<span class="id"><a href="compcert.cfrontend.Ctypes.html#id">id</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co">co</a></span> -&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#p2">p2</a></span>.(<span class="id"><a href="compcert.cfrontend.Ctypes.html#prog_comp_env">prog_comp_env</a></span>)!<span class="id"><a href="compcert.cfrontend.Ctypes.html#id">id</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#co">co</a></span>).<br/>
<br/>
<span class="kwd">Program</span> <span class="kwd">Instance</span> <span class="id"><a name="Linker_program">Linker_program</a></span> (<span class="id">F</span>: <span class="kwd">Type</span>): <span class="id"><a href="compcert.common.Linking.html#Linker">Linker</a></span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#program">program</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#F">F</a></span>) := {<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#link">link</a></span> := <span class="id"><a href="compcert.cfrontend.Ctypes.html#link_program">link_program</a></span>;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#linkorder">linkorder</a></span> := <span class="id"><a href="compcert.cfrontend.Ctypes.html#linkorder_program">linkorder_program</a></span><br/>
}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4306')">Next Obligation.</div>
<div class="proofscript" id="proof4306">
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Linking.html#linkorder_refl">linkorder_refl</a></span>. <span class="tactic">auto</span>.<br/>
Defined.</div>
<div class="toggleproof" onclick="toggleDisplay('proof4307')">Next Obligation.</div>
<div class="proofscript" id="proof4307">
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>, <span class="id">H0</span>. <span class="tactic">split</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Linking.html#linkorder_trans">linkorder_trans</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">auto</span>.<br/>
Defined.</div>
<div class="toggleproof" onclick="toggleDisplay('proof4308')">Next Obligation.</div>
<div class="proofscript" id="proof4308">
&nbsp;&nbsp;<span class="id">revert</span> <span class="id">H</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#link_program">link_program</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.Linking.html#link">link</a></span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#program_of_program">program_of_program</a></span> <span class="id">x</span>) (<span class="id"><a href="compcert.cfrontend.Ctypes.html#program_of_program">program_of_program</a></span> <span class="id">y</span>)) <span class="kwd">as</span> [<span class="id">p</span>|] <span class="id">eqn</span>:<span class="id">LP</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#lift_option">lift_option</a></span> (<span class="id"><a href="compcert.common.Linking.html#link">link</a></span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#prog_types">prog_types</a></span> <span class="id">x</span>) (<span class="id"><a href="compcert.cfrontend.Ctypes.html#prog_types">prog_types</a></span> <span class="id">y</span>))) <span class="kwd">as</span> [[<span class="id">typs</span> <span class="id">EQ</span>]|<span class="id">EQ</span>]; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#link_build_composite_env">link_build_composite_env</a></span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#prog_types">prog_types</a></span> <span class="id">x</span>) (<span class="id"><a href="compcert.cfrontend.Ctypes.html#prog_types">prog_types</a></span> <span class="id">y</span>) <span class="id">typs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.cfrontend.Ctypes.html#prog_comp_env">prog_comp_env</a></span> <span class="id">x</span>) (<span class="id"><a href="compcert.cfrontend.Ctypes.html#prog_comp_env">prog_comp_env</a></span> <span class="id">y</span>) (<span class="id"><a href="compcert.cfrontend.Ctypes.html#prog_comp_env_eq">prog_comp_env_eq</a></span> <span class="id">x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.cfrontend.Ctypes.html#prog_comp_env_eq">prog_comp_env_eq</a></span> <span class="id">y</span>) <span class="id">EQ</span>) <span class="kwd">as</span> (<span class="id">env</span> &amp; <span class="id">P</span> &amp; <span class="id">Q</span> &amp; <span class="id">R</span>).<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.Linking.html#link_linkorder">link_linkorder</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">LP</span>). <br/>
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">X</span>; <span class="id">inv</span> <span class="id">X</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
Defined.</div>
<br/>
<span class="kwd">Global</span> <span class="id">Opaque</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#Linker_program">Linker_program</a></span>.<br/>
<br/>
<h2> Commutation between linking and program transformations </h2>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="LINK_MATCH_PROGRAM">LINK_MATCH_PROGRAM</a></span>.<br/>
<br/>
<span class="kwd">Context</span> {<span class="id">F</span> <span class="id">G</span>: <span class="kwd">Type</span>}.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="LINK_MATCH_PROGRAM.match_fundef">match_fundef</a></span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#fundef">fundef</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#LINK_MATCH_PROGRAM.F">F</a></span> -&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#fundef">fundef</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#LINK_MATCH_PROGRAM.G">G</a></span> -&gt; <span class="kwd">Prop</span>.<br/>
<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="LINK_MATCH_PROGRAM.link_match_fundef">link_match_fundef</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f1</span> <span class="id">tf1</span> <span class="id">f2</span> <span class="id">tf2</span> <span class="id">f</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#link">link</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#f1">f1</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#f2">f2</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#f">f</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.cfrontend.Ctypes.html#LINK_MATCH_PROGRAM.match_fundef">match_fundef</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#f1">f1</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#tf1">tf1</a></span> -&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#LINK_MATCH_PROGRAM.match_fundef">match_fundef</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#f2">f2</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#tf2">tf2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">tf</span>, <span class="id"><a href="compcert.common.Linking.html#link">link</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#tf1">tf1</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#tf2">tf2</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#tf">tf</a></span> /\ <span class="id"><a href="compcert.cfrontend.Ctypes.html#LINK_MATCH_PROGRAM.match_fundef">match_fundef</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#f">f</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#tf">tf</a></span>.<br/>
<br/>
<span class="kwd">Let</span> <span class="id"><a name="LINK_MATCH_PROGRAM.match_program">match_program</a></span> (<span class="id">p</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#program">program</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#LINK_MATCH_PROGRAM.F">F</a></span>) (<span class="id">tp</span>: <span class="id"><a href="compcert.cfrontend.Ctypes.html#program">program</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#LINK_MATCH_PROGRAM.G">G</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#match_program">Linking.match_program</a></span> (<span class="kwd">fun</span> <span class="id">ctx</span> <span class="id">f</span> <span class="id">tf</span> =&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#LINK_MATCH_PROGRAM.match_fundef">match_fundef</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#f">f</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#tf">tf</a></span>) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#p">p</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#tp">tp</a></span><br/>
&nbsp;/\ <span class="id"><a href="compcert.cfrontend.Ctypes.html#prog_types">prog_types</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#tp">tp</a></span> = <span class="id"><a href="compcert.cfrontend.Ctypes.html#prog_types">prog_types</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#p">p</a></span>.<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="link_match_program">link_match_program</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">p1</span> <span class="id">p2</span> <span class="id">tp1</span> <span class="id">tp2</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#link">link</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#p1">p1</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#p2">p2</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#p">p</a></span> -&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#LINK_MATCH_PROGRAM.match_program">match_program</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#p1">p1</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#tp1">tp1</a></span> -&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#LINK_MATCH_PROGRAM.match_program">match_program</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#p2">p2</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#tp2">tp2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">tp</span>, <span class="id"><a href="compcert.common.Linking.html#link">link</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#tp1">tp1</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#tp2">tp2</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#tp">tp</a></span> /\ <span class="id"><a href="compcert.cfrontend.Ctypes.html#LINK_MATCH_PROGRAM.match_program">match_program</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#p">p</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#tp">tp</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4309')">Proof.</div>
<div class="proofscript" id="proof4309">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H0</span>, <span class="id">H1</span>. <br/>
<span class="kwd">Local</span> <span class="id">Transparent</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#Linker_program">Linker_program</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">unfold</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#link_program">link_program</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.Linking.html#link">link</a></span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#program_of_program">program_of_program</a></span> <span class="id">p1</span>) (<span class="id"><a href="compcert.cfrontend.Ctypes.html#program_of_program">program_of_program</a></span> <span class="id">p2</span>)) <span class="kwd">as</span> [<span class="id">pp</span>|] <span class="id">eqn</span>:<span class="id">LP</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">A</span>: <span class="id">exists</span> <span class="id">tpp</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#link">link</a></span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#program_of_program">program_of_program</a></span> <span class="id">tp1</span>) (<span class="id"><a href="compcert.cfrontend.Ctypes.html#program_of_program">program_of_program</a></span> <span class="id">tp2</span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#tpp">tpp</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="compcert.common.Linking.html#match_program">Linking.match_program</a></span> (<span class="kwd">fun</span> <span class="id">ctx</span> <span class="id">f</span> <span class="id">tf</span> =&gt; <span class="id"><a href="compcert.cfrontend.Ctypes.html#LINK_MATCH_PROGRAM.match_fundef">match_fundef</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#f">f</a></span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#tf">tf</a></span>) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> <span class="id">pp</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#tpp">tpp</a></span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Linking.html#link_match_program">Linking.link_match_program</a></span>. <br/>
&nbsp;&nbsp;- <span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#LINK_MATCH_PROGRAM.link_match_fundef">link_match_fundef</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">tf</span> &amp; <span class="id">A</span> &amp; <span class="id">B</span>). <span class="id">exists</span> <span class="id">tf</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Local</span> <span class="id">Transparent</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#Linker_types">Linker_types</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#type_eq">type_eq</a></span> <span class="id">v1</span> <span class="id">v2</span>); <span class="id">inv</span> <span class="id">H4</span>. <span class="id">exists</span> <span class="id">v</span>; <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#dec_eq_true">dec_eq_true</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> (<span class="id"><a href="compcert.common.Linking.html#link_linkorder">link_linkorder</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">LP</span>).<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> (<span class="id"><a href="compcert.common.Linking.html#link_linkorder">link_linkorder</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">LP</span>). }<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">A</span> <span class="kwd">as</span> (<span class="id">tpp</span> &amp; <span class="id">TLP</span> &amp; <span class="id">MP</span>).<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">unfold</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#link_program">link_program</a></span>. <span class="tactic">rewrite</span> <span class="id">TLP</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#lift_option">lift_option</a></span> (<span class="id"><a href="compcert.common.Linking.html#link">link</a></span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#prog_types">prog_types</a></span> <span class="id">p1</span>) (<span class="id"><a href="compcert.cfrontend.Ctypes.html#prog_types">prog_types</a></span> <span class="id">p2</span>))) <span class="kwd">as</span> [[<span class="id">typs</span> <span class="id">EQ</span>]|<span class="id">EQ</span>]; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#link_build_composite_env">link_build_composite_env</a></span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#prog_types">prog_types</a></span> <span class="id">p1</span>) (<span class="id"><a href="compcert.cfrontend.Ctypes.html#prog_types">prog_types</a></span> <span class="id">p2</span>) <span class="id">typs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.cfrontend.Ctypes.html#prog_comp_env">prog_comp_env</a></span> <span class="id">p1</span>) (<span class="id"><a href="compcert.cfrontend.Ctypes.html#prog_comp_env">prog_comp_env</a></span> <span class="id">p2</span>) (<span class="id"><a href="compcert.cfrontend.Ctypes.html#prog_comp_env_eq">prog_comp_env_eq</a></span> <span class="id">p1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.cfrontend.Ctypes.html#prog_comp_env_eq">prog_comp_env_eq</a></span> <span class="id">p2</span>) <span class="id">EQ</span>) <span class="kwd">as</span> (<span class="id">env</span> &amp; <span class="id">P</span> &amp; <span class="id">Q</span>). <br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H2</span>, &lt;- <span class="id">H3</span> <span class="kwd">in</span> <span class="id">EQ</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#lift_option">lift_option</a></span> (<span class="id"><a href="compcert.common.Linking.html#link">link</a></span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#prog_types">prog_types</a></span> <span class="id">tp1</span>) (<span class="id"><a href="compcert.cfrontend.Ctypes.html#prog_types">prog_types</a></span> <span class="id">tp2</span>))) <span class="kwd">as</span> [[<span class="id">ttyps</span> <span class="id">EQ</span>']|<span class="id">EQ</span>']; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">ttyps</span> = <span class="id">typs</span>) <span class="tactic">by</span> <span class="tactic">congruence</span>. <span class="tactic">subst</span> <span class="id">ttyps</span>. <br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#link_build_composite_env">link_build_composite_env</a></span> (<span class="id"><a href="compcert.cfrontend.Ctypes.html#prog_types">prog_types</a></span> <span class="id">tp1</span>) (<span class="id"><a href="compcert.cfrontend.Ctypes.html#prog_types">prog_types</a></span> <span class="id">tp2</span>) <span class="id">typs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.cfrontend.Ctypes.html#prog_comp_env">prog_comp_env</a></span> <span class="id">tp1</span>) (<span class="id"><a href="compcert.cfrontend.Ctypes.html#prog_comp_env">prog_comp_env</a></span> <span class="id">tp2</span>) (<span class="id"><a href="compcert.cfrontend.Ctypes.html#prog_comp_env_eq">prog_comp_env_eq</a></span> <span class="id">tp1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.cfrontend.Ctypes.html#prog_comp_env_eq">prog_comp_env_eq</a></span> <span class="id">tp2</span>) <span class="id">EQ</span>') <span class="kwd">as</span> (<span class="id">tenv</span> &amp; <span class="id">R</span> &amp; <span class="id">S</span>).<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">tenv</span> = <span class="id">env</span>) <span class="tactic">by</span> <span class="tactic">congruence</span>. <span class="tactic">subst</span> <span class="id">tenv</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>; <span class="tactic">eauto</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#program_of_program">program_of_program</a></span>; <span class="tactic">simpl</span>. <span class="tactic">destruct</span> <span class="id">pp</span>, <span class="id">tpp</span>; <span class="tactic">exact</span> <span class="id">MP</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.cfrontend.Ctypes.html#LINK_MATCH_PROGRAM">LINK_MATCH_PROGRAM</a></span>.<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</div>
</body>
</html>
