
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module Bounds</title>
<meta name="description" content="Documentation of Coq module Bounds" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module Bounds</h1>
<div class="coq">
<br/>
<div class="doc">Computation of resource bounds for Linear code. </div>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.FSets.FSets.html">FSets</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.FSets.FSetAVL.html">FSetAVL</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.lib.Coqlib.html">Coqlib</a></span> <span class="id"><a href="compcert.lib.Ordered.html">Ordered</a></span>.<br/>
<span class="kwd">Require</span> <span class="id"><a href="compcert.lib.Intv.html">Intv</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.common.AST.html">AST</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.x86.Op.html">Op</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.x86.Machregs.html">Machregs</a></span> <span class="id"><a href="compcert.backend.Locations.html">Locations</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.backend.Linear.html">Linear</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.backend.Conventions.html">Conventions</a></span>.<br/>
<br/>
<span class="kwd">Module</span> <span class="id"><a name="RegOrd">RegOrd</a></span> := <span class="id"><a href="compcert.lib.Ordered.html#OrderedIndexed">OrderedIndexed</a></span> (<span class="id"><a href="compcert.x86.Machregs.html#IndexedMreg">IndexedMreg</a></span>).<br/>
<span class="kwd">Module</span> <span class="id"><a name="RegSet">RegSet</a></span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.FSets.FSetAVL.html#Make">FSetAVL.Make</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#RegOrd">RegOrd</a></span>).<br/>
<br/>
<h1> Resource bounds for a function </h1>
<br/>
<div class="doc">The <span class="bracket"><span class="id">bounds</span></span> record capture how many local and outgoing stack slots
  and callee-save registers are used by a function. </div>
<br/>
<div class="doc">We demand that all bounds are positive or null.
  These properties are used later to reason about the layout of
  the activation record. </div>
<br/>
<span class="kwd">Record</span> <span class="id"><a name="bounds">bounds</a></span> : <span class="kwd">Type</span> := <span class="id"><a name="mkbounds">mkbounds</a></span> {<br/>
&nbsp;&nbsp;<span class="id"><a name="used_callee_save">used_callee_save</a></span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.x86.Machregs.html#mreg">mreg</a></span>;<br/>
&nbsp;&nbsp;<span class="id"><a name="bound_local">bound_local</a></span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>;<br/>
&nbsp;&nbsp;<span class="id"><a name="bound_outgoing">bound_outgoing</a></span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>;<br/>
&nbsp;&nbsp;<span class="id"><a name="bound_stack_data">bound_stack_data</a></span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>;<br/>
&nbsp;&nbsp;<span class="id"><a name="bound_local_pos">bound_local_pos</a></span>: <span class="id"><a href="compcert.backend.Bounds.html#bound_local">bound_local</a></span> &gt;= 0;<br/>
&nbsp;&nbsp;<span class="id"><a name="bound_outgoing_pos">bound_outgoing_pos</a></span>: <span class="id"><a href="compcert.backend.Bounds.html#bound_outgoing">bound_outgoing</a></span> &gt;= 0;<br/>
&nbsp;&nbsp;<span class="id"><a name="bound_stack_data_pos">bound_stack_data_pos</a></span>: <span class="id"><a href="compcert.backend.Bounds.html#bound_stack_data">bound_stack_data</a></span> &gt;= 0;<br/>
&nbsp;&nbsp;<span class="id"><a name="used_callee_save_norepet">used_callee_save_norepet</a></span>: <span class="id"><a href="compcert.lib.Coqlib.html#list_norepet">list_norepet</a></span> <span class="id"><a href="compcert.backend.Bounds.html#used_callee_save">used_callee_save</a></span>;<br/>
&nbsp;&nbsp;<span class="id"><a name="used_callee_save_prop">used_callee_save_prop</a></span>: <span class="kwd">forall</span> <span class="id">r</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.backend.Bounds.html#r">r</a></span> <span class="id"><a href="compcert.backend.Bounds.html#used_callee_save">used_callee_save</a></span> -&gt; <span class="id"><a href="compcert.x86.Conventions1.html#is_callee_save">is_callee_save</a></span> <span class="id"><a href="compcert.backend.Bounds.html#r">r</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span><br/>
}.<br/>
<br/>
<div class="doc">The following predicates define the correctness of a set of bounds
    for the code of a function. </div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="WITHIN_BOUNDS">WITHIN_BOUNDS</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="WITHIN_BOUNDS.b">b</a></span>: <span class="id"><a href="compcert.backend.Bounds.html#bounds">bounds</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="mreg_within_bounds">mreg_within_bounds</a></span> (<span class="id">r</span>: <span class="id"><a href="compcert.x86.Machregs.html#mreg">mreg</a></span>) :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.x86.Conventions1.html#is_callee_save">is_callee_save</a></span> <span class="id"><a href="compcert.backend.Bounds.html#r">r</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.backend.Bounds.html#r">r</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#used_callee_save">used_callee_save</a></span> <span class="id"><a href="compcert.backend.Bounds.html#WITHIN_BOUNDS.b">b</a></span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="slot_within_bounds">slot_within_bounds</a></span> (<span class="id">sl</span>: <span class="id"><a href="compcert.backend.Locations.html#slot">slot</a></span>) (<span class="id">ofs</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) (<span class="id">ty</span>: <span class="id"><a href="compcert.common.AST.html#typ">typ</a></span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.backend.Bounds.html#sl">sl</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="kwd">Local</span> =&gt; <span class="id"><a href="compcert.backend.Bounds.html#ofs">ofs</a></span> + <span class="id"><a href="compcert.backend.Locations.html#typesize">typesize</a></span> <span class="id"><a href="compcert.backend.Bounds.html#ty">ty</a></span> &lt;= <span class="id"><a href="compcert.backend.Bounds.html#bound_local">bound_local</a></span> <span class="id"><a href="compcert.backend.Bounds.html#WITHIN_BOUNDS.b">b</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.Locations.html#Outgoing">Outgoing</a></span> =&gt; <span class="id"><a href="compcert.backend.Bounds.html#ofs">ofs</a></span> + <span class="id"><a href="compcert.backend.Locations.html#typesize">typesize</a></span> <span class="id"><a href="compcert.backend.Bounds.html#ty">ty</a></span> &lt;= <span class="id"><a href="compcert.backend.Bounds.html#bound_outgoing">bound_outgoing</a></span> <span class="id"><a href="compcert.backend.Bounds.html#WITHIN_BOUNDS.b">b</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.Locations.html#Incoming">Incoming</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="instr_within_bounds">instr_within_bounds</a></span> (<span class="id">i</span>: <span class="id"><a href="compcert.backend.Linear.html#instruction">instruction</a></span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.backend.Bounds.html#i">i</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.Linear.html#Lgetstack">Lgetstack</a></span> <span class="id">sl</span> <span class="id">ofs</span> <span class="id">ty</span> <span class="id">r</span> =&gt; <span class="id"><a href="compcert.backend.Bounds.html#slot_within_bounds">slot_within_bounds</a></span> <span class="id">sl</span> <span class="id">ofs</span> <span class="id">ty</span> /\ <span class="id"><a href="compcert.backend.Bounds.html#mreg_within_bounds">mreg_within_bounds</a></span> <span class="id">r</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.Linear.html#Lsetstack">Lsetstack</a></span> <span class="id">r</span> <span class="id">sl</span> <span class="id">ofs</span> <span class="id">ty</span> =&gt; <span class="id"><a href="compcert.backend.Bounds.html#slot_within_bounds">slot_within_bounds</a></span> <span class="id">sl</span> <span class="id">ofs</span> <span class="id">ty</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.Linear.html#Lop">Lop</a></span> <span class="id">op</span> <span class="id">args</span> <span class="id">res</span> =&gt; <span class="id"><a href="compcert.backend.Bounds.html#mreg_within_bounds">mreg_within_bounds</a></span> <span class="id">res</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.Linear.html#Lload">Lload</a></span> <span class="id">chunk</span> <span class="id">addr</span> <span class="id">args</span> <span class="id">dst</span> =&gt; <span class="id"><a href="compcert.backend.Bounds.html#mreg_within_bounds">mreg_within_bounds</a></span> <span class="id">dst</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.Linear.html#Lcall">Lcall</a></span> <span class="id">sig</span> <span class="id">ros</span> =&gt; <span class="id"><a href="compcert.x86.Conventions1.html#size_arguments">size_arguments</a></span> <span class="id">sig</span> &lt;= <span class="id"><a href="compcert.backend.Bounds.html#bound_outgoing">bound_outgoing</a></span> <span class="id"><a href="compcert.backend.Bounds.html#WITHIN_BOUNDS.b">b</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.Linear.html#Lbuiltin">Lbuiltin</a></span> <span class="id">ef</span> <span class="id">args</span> <span class="id">res</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">r</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.backend.Bounds.html#r">r</a></span> (<span class="id"><a href="compcert.common.AST.html#params_of_builtin_res">params_of_builtin_res</a></span> <span class="id">res</span>) \/ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.backend.Bounds.html#r">r</a></span> (<span class="id"><a href="compcert.x86.Machregs.html#destroyed_by_builtin">destroyed_by_builtin</a></span> <span class="id">ef</span>) -&gt; <span class="id"><a href="compcert.backend.Bounds.html#mreg_within_bounds">mreg_within_bounds</a></span> <span class="id"><a href="compcert.backend.Bounds.html#r">r</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">sl</span> <span class="id">ofs</span> <span class="id">ty</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="compcert.backend.Locations.html#S">S</a></span> <span class="id"><a href="compcert.backend.Bounds.html#sl">sl</a></span> <span class="id"><a href="compcert.backend.Bounds.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Bounds.html#ty">ty</a></span>) (<span class="id"><a href="compcert.common.AST.html#params_of_builtin_args">params_of_builtin_args</a></span> <span class="id">args</span>) -&gt; <span class="id"><a href="compcert.backend.Bounds.html#slot_within_bounds">slot_within_bounds</a></span> <span class="id"><a href="compcert.backend.Bounds.html#sl">sl</a></span> <span class="id"><a href="compcert.backend.Bounds.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Bounds.html#ty">ty</a></span>)<br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.backend.Bounds.html#WITHIN_BOUNDS">WITHIN_BOUNDS</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="function_within_bounds">function_within_bounds</a></span> (<span class="id">f</span>: <span class="id"><a href="compcert.backend.Linear.html#function">function</a></span>) (<span class="id">b</span>: <span class="id"><a href="compcert.backend.Bounds.html#bounds">bounds</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">instr</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.backend.Bounds.html#instr">instr</a></span> <span class="id"><a href="compcert.backend.Bounds.html#f">f</a></span>.(<span class="id"><a href="compcert.backend.Linear.html#fn_code">fn_code</a></span>) -&gt; <span class="id"><a href="compcert.backend.Bounds.html#instr_within_bounds">instr_within_bounds</a></span> <span class="id"><a href="compcert.backend.Bounds.html#b">b</a></span> <span class="id"><a href="compcert.backend.Bounds.html#instr">instr</a></span>.<br/>
<br/>
<h1> Inference of resource bounds for a function </h1>
<br/>
<div class="doc">The resource bounds for a function are computed by a linear scan
  of its instructions. </div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="BOUNDS">BOUNDS</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="BOUNDS.f">f</a></span>: <span class="id"><a href="compcert.backend.Linear.html#function">function</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="record_reg">record_reg</a></span> (<span class="id">u</span>: <span class="id"><a href="compcert.backend.Bounds.html#t">RegSet.t</a></span>) (<span class="id">r</span>: <span class="id"><a href="compcert.x86.Machregs.html#mreg">mreg</a></span>) : <span class="id"><a href="compcert.backend.Bounds.html#t">RegSet.t</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="compcert.x86.Conventions1.html#is_callee_save">is_callee_save</a></span> <span class="id"><a href="compcert.backend.Bounds.html#r">r</a></span> <span class="kwd">then</span> <span class="id"><a href="compcert.backend.Bounds.html#add">RegSet.add</a></span> <span class="id"><a href="compcert.backend.Bounds.html#r">r</a></span> <span class="id"><a href="compcert.backend.Bounds.html#u">u</a></span> <span class="kwd">else</span> <span class="id"><a href="compcert.backend.Bounds.html#u">u</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="record_regs">record_regs</a></span> (<span class="id">u</span>: <span class="id"><a href="compcert.backend.Bounds.html#t">RegSet.t</a></span>) (<span class="id">rl</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.x86.Machregs.html#mreg">mreg</a></span>) : <span class="id"><a href="compcert.backend.Bounds.html#t">RegSet.t</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_left">fold_left</a></span> <span class="id"><a href="compcert.backend.Bounds.html#record_reg">record_reg</a></span> <span class="id"><a href="compcert.backend.Bounds.html#rl">rl</a></span> <span class="id"><a href="compcert.backend.Bounds.html#u">u</a></span>.<br/>
<br/>
<div class="doc">In the proof of the <span class="bracket"><span class="id">Stacking</span></span> pass, we only need to bound the
  registers written by an instruction.  Therefore, we examine the
  result registers only, not the argument registers. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="record_regs_of_instr">record_regs_of_instr</a></span> (<span class="id">u</span>: <span class="id"><a href="compcert.backend.Bounds.html#t">RegSet.t</a></span>) (<span class="id">i</span>: <span class="id"><a href="compcert.backend.Linear.html#instruction">instruction</a></span>) : <span class="id"><a href="compcert.backend.Bounds.html#t">RegSet.t</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.backend.Bounds.html#i">i</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.Linear.html#Lgetstack">Lgetstack</a></span> <span class="id">sl</span> <span class="id">ofs</span> <span class="id">ty</span> <span class="id">r</span> =&gt; <span class="id"><a href="compcert.backend.Bounds.html#record_reg">record_reg</a></span> <span class="id"><a href="compcert.backend.Bounds.html#u">u</a></span> <span class="id">r</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.Linear.html#Lsetstack">Lsetstack</a></span> <span class="id">r</span> <span class="id">sl</span> <span class="id">ofs</span> <span class="id">ty</span> =&gt; <span class="id"><a href="compcert.backend.Bounds.html#record_reg">record_reg</a></span> <span class="id"><a href="compcert.backend.Bounds.html#u">u</a></span> <span class="id">r</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.Linear.html#Lop">Lop</a></span> <span class="id">op</span> <span class="id">args</span> <span class="id">res</span> =&gt; <span class="id"><a href="compcert.backend.Bounds.html#record_reg">record_reg</a></span> <span class="id"><a href="compcert.backend.Bounds.html#u">u</a></span> <span class="id">res</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.Linear.html#Lload">Lload</a></span> <span class="id">chunk</span> <span class="id">addr</span> <span class="id">args</span> <span class="id">dst</span> =&gt; <span class="id"><a href="compcert.backend.Bounds.html#record_reg">record_reg</a></span> <span class="id"><a href="compcert.backend.Bounds.html#u">u</a></span> <span class="id">dst</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.Linear.html#Lstore">Lstore</a></span> <span class="id">chunk</span> <span class="id">addr</span> <span class="id">args</span> <span class="id">src</span> =&gt; <span class="id"><a href="compcert.backend.Bounds.html#u">u</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.Linear.html#Lcall">Lcall</a></span> <span class="id">sig</span> <span class="id">ros</span> =&gt; <span class="id"><a href="compcert.backend.Bounds.html#u">u</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.Linear.html#Ltailcall">Ltailcall</a></span> <span class="id">sig</span> <span class="id">ros</span> =&gt; <span class="id"><a href="compcert.backend.Bounds.html#u">u</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.Linear.html#Lbuiltin">Lbuiltin</a></span> <span class="id">ef</span> <span class="id">args</span> <span class="id">res</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Bounds.html#record_regs">record_regs</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#record_regs">record_regs</a></span> <span class="id"><a href="compcert.backend.Bounds.html#u">u</a></span> (<span class="id"><a href="compcert.common.AST.html#params_of_builtin_res">params_of_builtin_res</a></span> <span class="id">res</span>)) (<span class="id"><a href="compcert.x86.Machregs.html#destroyed_by_builtin">destroyed_by_builtin</a></span> <span class="id">ef</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.Linear.html#Llabel">Llabel</a></span> <span class="id">lbl</span> =&gt; <span class="id"><a href="compcert.backend.Bounds.html#u">u</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.Linear.html#Lgoto">Lgoto</a></span> <span class="id">lbl</span> =&gt; <span class="id"><a href="compcert.backend.Bounds.html#u">u</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.Linear.html#Lcond">Lcond</a></span> <span class="id">cond</span> <span class="id">args</span> <span class="id">lbl</span> =&gt; <span class="id"><a href="compcert.backend.Bounds.html#u">u</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.Linear.html#Ljumptable">Ljumptable</a></span> <span class="id">arg</span> <span class="id">tbl</span> =&gt; <span class="id"><a href="compcert.backend.Bounds.html#u">u</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.Linear.html#Lreturn">Lreturn</a></span> =&gt; <span class="id"><a href="compcert.backend.Bounds.html#u">u</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="record_regs_of_function">record_regs_of_function</a></span> : <span class="id"><a href="compcert.backend.Bounds.html#t">RegSet.t</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_left">fold_left</a></span> <span class="id"><a href="compcert.backend.Bounds.html#record_regs_of_instr">record_regs_of_instr</a></span> <span class="id"><a href="compcert.backend.Bounds.html#BOUNDS.f">f</a></span>.(<span class="id"><a href="compcert.backend.Linear.html#fn_code">fn_code</a></span>) <span class="id"><a href="compcert.backend.Bounds.html#empty">RegSet.empty</a></span>.<br/>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="slots_of_locs">slots_of_locs</a></span> (<span class="id">l</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.backend.Locations.html#loc">loc</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="compcert.backend.Locations.html#slot">slot</a></span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> * <span class="id"><a href="compcert.common.AST.html#typ">typ</a></span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.backend.Bounds.html#l">l</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.Locations.html#S">S</a></span> <span class="id">sl</span> <span class="id">ofs</span> <span class="id">ty</span> :: <span class="id">l</span>' =&gt; (<span class="id">sl</span>, <span class="id">ofs</span>, <span class="id">ty</span>) :: <span class="id"><a href="compcert.backend.Bounds.html#slots_of_locs">slots_of_locs</a></span> <span class="id">l</span>'<br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id">r</span> :: <span class="id">l</span>' =&gt; <span class="id"><a href="compcert.backend.Bounds.html#slots_of_locs">slots_of_locs</a></span> <span class="id">l</span>'<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="slots_of_instr">slots_of_instr</a></span> (<span class="id">i</span>: <span class="id"><a href="compcert.backend.Linear.html#instruction">instruction</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="compcert.backend.Locations.html#slot">slot</a></span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> * <span class="id"><a href="compcert.common.AST.html#typ">typ</a></span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.backend.Bounds.html#i">i</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.Linear.html#Lgetstack">Lgetstack</a></span> <span class="id">sl</span> <span class="id">ofs</span> <span class="id">ty</span> <span class="id">r</span> =&gt; (<span class="id">sl</span>, <span class="id">ofs</span>, <span class="id">ty</span>) :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.Linear.html#Lsetstack">Lsetstack</a></span> <span class="id">r</span> <span class="id">sl</span> <span class="id">ofs</span> <span class="id">ty</span> =&gt; (<span class="id">sl</span>, <span class="id">ofs</span>, <span class="id">ty</span>) :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.Linear.html#Lbuiltin">Lbuiltin</a></span> <span class="id">ef</span> <span class="id">args</span> <span class="id">res</span> =&gt; <span class="id"><a href="compcert.backend.Bounds.html#slots_of_locs">slots_of_locs</a></span> (<span class="id"><a href="compcert.common.AST.html#params_of_builtin_args">params_of_builtin_args</a></span> <span class="id">args</span>)<br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="max_over_list">max_over_list</a></span> {<span class="id">A</span>: <span class="kwd">Type</span>} (<span class="id">valu</span>: <span class="id"><a href="compcert.backend.Bounds.html#A">A</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) (<span class="id">l</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.backend.Bounds.html#A">A</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_left">List.fold_left</a></span> (<span class="kwd">fun</span> <span class="id">m</span> <span class="id">l</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.max">Z.max</a></span> <span class="id"><a href="compcert.backend.Bounds.html#m">m</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#valu">valu</a></span> <span class="id"><a href="compcert.backend.Bounds.html#l">l</a></span>)) <span class="id"><a href="compcert.backend.Bounds.html#l">l</a></span> 0.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="max_over_instrs">max_over_instrs</a></span> (<span class="id">valu</span>: <span class="id"><a href="compcert.backend.Linear.html#instruction">instruction</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Bounds.html#max_over_list">max_over_list</a></span> <span class="id"><a href="compcert.backend.Bounds.html#valu">valu</a></span> <span class="id"><a href="compcert.backend.Bounds.html#BOUNDS.f">f</a></span>.(<span class="id"><a href="compcert.backend.Linear.html#fn_code">fn_code</a></span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="max_over_slots_of_instr">max_over_slots_of_instr</a></span> (<span class="id">valu</span>: <span class="id"><a href="compcert.backend.Locations.html#slot">slot</a></span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> * <span class="id"><a href="compcert.common.AST.html#typ">typ</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) (<span class="id">i</span>: <span class="id"><a href="compcert.backend.Linear.html#instruction">instruction</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Bounds.html#max_over_list">max_over_list</a></span> <span class="id"><a href="compcert.backend.Bounds.html#valu">valu</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#slots_of_instr">slots_of_instr</a></span> <span class="id"><a href="compcert.backend.Bounds.html#i">i</a></span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="max_over_slots_of_funct">max_over_slots_of_funct</a></span> (<span class="id">valu</span>: <span class="id"><a href="compcert.backend.Locations.html#slot">slot</a></span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> * <span class="id"><a href="compcert.common.AST.html#typ">typ</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Bounds.html#max_over_instrs">max_over_instrs</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#max_over_slots_of_instr">max_over_slots_of_instr</a></span> <span class="id"><a href="compcert.backend.Bounds.html#valu">valu</a></span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="local_slot">local_slot</a></span> (<span class="id">s</span>: <span class="id"><a href="compcert.backend.Locations.html#slot">slot</a></span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> * <span class="id"><a href="compcert.common.AST.html#typ">typ</a></span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.backend.Bounds.html#s">s</a></span> <span class="kwd">with</span> (<span class="kwd">Local</span>, <span class="id">ofs</span>, <span class="id">ty</span>) =&gt; <span class="id">ofs</span> + <span class="id"><a href="compcert.backend.Locations.html#typesize">typesize</a></span> <span class="id">ty</span> | <span class="id">_</span> =&gt; 0 <span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="outgoing_slot">outgoing_slot</a></span> (<span class="id">s</span>: <span class="id"><a href="compcert.backend.Locations.html#slot">slot</a></span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> * <span class="id"><a href="compcert.common.AST.html#typ">typ</a></span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.backend.Bounds.html#s">s</a></span> <span class="kwd">with</span> (<span class="id"><a href="compcert.backend.Locations.html#Outgoing">Outgoing</a></span>, <span class="id">ofs</span>, <span class="id">ty</span>) =&gt; <span class="id">ofs</span> + <span class="id"><a href="compcert.backend.Locations.html#typesize">typesize</a></span> <span class="id">ty</span> | <span class="id">_</span> =&gt; 0 <span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="outgoing_space">outgoing_space</a></span> (<span class="id">i</span>: <span class="id"><a href="compcert.backend.Linear.html#instruction">instruction</a></span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.backend.Bounds.html#i">i</a></span> <span class="kwd">with</span> <span class="id"><a href="compcert.backend.Linear.html#Lcall">Lcall</a></span> <span class="id">sig</span> <span class="id">_</span> =&gt; <span class="id"><a href="compcert.x86.Conventions1.html#size_arguments">size_arguments</a></span> <span class="id">sig</span> | <span class="id">_</span> =&gt; 0 <span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="max_over_list_pos">max_over_list_pos</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">A</span>: <span class="kwd">Type</span>) (<span class="id">valu</span>: <span class="id"><a href="compcert.backend.Bounds.html#A">A</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) (<span class="id">l</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.backend.Bounds.html#A">A</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Bounds.html#max_over_list">max_over_list</a></span> <span class="id"><a href="compcert.backend.Bounds.html#valu">valu</a></span> <span class="id"><a href="compcert.backend.Bounds.html#l">l</a></span> &gt;= 0.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3939')">Proof.</div>
<div class="proofscript" id="proof3939">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> <span class="id">valu</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Bounds.html#max_over_list">max_over_list</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">l</span> <span class="id">z</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_left">fold_left</a></span> (<span class="kwd">fun</span> <span class="id">x</span> <span class="id">y</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.max">Z.max</a></span> <span class="id"><a href="compcert.backend.Bounds.html#x">x</a></span> (<span class="id">valu</span> <span class="id"><a href="compcert.backend.Bounds.html#y">y</a></span>)) <span class="id"><a href="compcert.backend.Bounds.html#l">l</a></span> <span class="id"><a href="compcert.backend.Bounds.html#z">z</a></span> &gt;= <span class="id"><a href="compcert.backend.Bounds.html#z">z</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">omega</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zge_trans">Zge_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.max">Z.max</a></span> <span class="id">z</span> (<span class="id">valu</span> <span class="id">a</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.le_ge">Z.le_ge</a></span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.le_max_l">Z.le_max_l</a></span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="max_over_slots_of_funct_pos">max_over_slots_of_funct_pos</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">valu</span>: <span class="id"><a href="compcert.backend.Locations.html#slot">slot</a></span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> * <span class="id"><a href="compcert.common.AST.html#typ">typ</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>), <span class="id"><a href="compcert.backend.Bounds.html#max_over_slots_of_funct">max_over_slots_of_funct</a></span> <span class="id"><a href="compcert.backend.Bounds.html#valu">valu</a></span> &gt;= 0.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3940')">Proof.</div>
<div class="proofscript" id="proof3940">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Bounds.html#max_over_slots_of_funct">max_over_slots_of_funct</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Bounds.html#max_over_instrs">max_over_instrs</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Bounds.html#max_over_list_pos">max_over_list_pos</a></span>.<br/>
Qed.</div>
<br/>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="fold_left_preserves">fold_left_preserves</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">A</span> <span class="id">B</span>: <span class="kwd">Type</span>) (<span class="id">f</span>: <span class="id"><a href="compcert.backend.Bounds.html#A">A</a></span> -&gt; <span class="id"><a href="compcert.backend.Bounds.html#B">B</a></span> -&gt; <span class="id"><a href="compcert.backend.Bounds.html#A">A</a></span>) (<span class="id">P</span>: <span class="id"><a href="compcert.backend.Bounds.html#A">A</a></span> -&gt; <span class="kwd">Prop</span>),<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">a</span> <span class="id">b</span>, <span class="id"><a href="compcert.backend.Bounds.html#P">P</a></span> <span class="id"><a href="compcert.backend.Bounds.html#a">a</a></span> -&gt; <span class="id"><a href="compcert.backend.Bounds.html#P">P</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#f">f</a></span> <span class="id"><a href="compcert.backend.Bounds.html#a">a</a></span> <span class="id"><a href="compcert.backend.Bounds.html#b">b</a></span>)) -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span> <span class="id">a</span>, <span class="id"><a href="compcert.backend.Bounds.html#P">P</a></span> <span class="id"><a href="compcert.backend.Bounds.html#a">a</a></span> -&gt; <span class="id"><a href="compcert.backend.Bounds.html#P">P</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_left">fold_left</a></span> <span class="id"><a href="compcert.backend.Bounds.html#f">f</a></span> <span class="id"><a href="compcert.backend.Bounds.html#l">l</a></span> <span class="id"><a href="compcert.backend.Bounds.html#a">a</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3941')">Proof.</div>
<div class="proofscript" id="proof3941">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="fold_left_ensures">fold_left_ensures</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">A</span> <span class="id">B</span>: <span class="kwd">Type</span>) (<span class="id">f</span>: <span class="id"><a href="compcert.backend.Bounds.html#A">A</a></span> -&gt; <span class="id"><a href="compcert.backend.Bounds.html#B">B</a></span> -&gt; <span class="id"><a href="compcert.backend.Bounds.html#A">A</a></span>) (<span class="id">P</span>: <span class="id"><a href="compcert.backend.Bounds.html#A">A</a></span> -&gt; <span class="kwd">Prop</span>) <span class="id">b0</span>,<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">a</span> <span class="id">b</span>, <span class="id"><a href="compcert.backend.Bounds.html#P">P</a></span> <span class="id"><a href="compcert.backend.Bounds.html#a">a</a></span> -&gt; <span class="id"><a href="compcert.backend.Bounds.html#P">P</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#f">f</a></span> <span class="id"><a href="compcert.backend.Bounds.html#a">a</a></span> <span class="id"><a href="compcert.backend.Bounds.html#b">b</a></span>)) -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">a</span>, <span class="id"><a href="compcert.backend.Bounds.html#P">P</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#f">f</a></span> <span class="id"><a href="compcert.backend.Bounds.html#a">a</a></span> <span class="id"><a href="compcert.backend.Bounds.html#b0">b0</a></span>)) -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span> <span class="id">a</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.backend.Bounds.html#b0">b0</a></span> <span class="id"><a href="compcert.backend.Bounds.html#l">l</a></span> -&gt; <span class="id"><a href="compcert.backend.Bounds.html#P">P</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_left">fold_left</a></span> <span class="id"><a href="compcert.backend.Bounds.html#f">f</a></span> <span class="id"><a href="compcert.backend.Bounds.html#l">l</a></span> <span class="id"><a href="compcert.backend.Bounds.html#a">a</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3942')">Proof.</div>
<div class="proofscript" id="proof3942">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>. <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H1</span>. <span class="tactic">subst</span> <span class="id">a</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Bounds.html#fold_left_preserves">fold_left_preserves</a></span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id">IHl</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="only_callee_saves">only_callee_saves</a></span> (<span class="id">u</span>: <span class="id"><a href="compcert.backend.Bounds.html#t">RegSet.t</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span>, <span class="id"><a href="compcert.backend.Bounds.html#In">RegSet.In</a></span> <span class="id"><a href="compcert.backend.Bounds.html#r">r</a></span> <span class="id"><a href="compcert.backend.Bounds.html#u">u</a></span> -&gt; <span class="id"><a href="compcert.x86.Conventions1.html#is_callee_save">is_callee_save</a></span> <span class="id"><a href="compcert.backend.Bounds.html#r">r</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="record_reg_only">record_reg_only</a></span>: <span class="kwd">forall</span> <span class="id">u</span> <span class="id">r</span>, <span class="id"><a href="compcert.backend.Bounds.html#only_callee_saves">only_callee_saves</a></span> <span class="id"><a href="compcert.backend.Bounds.html#u">u</a></span> -&gt; <span class="id"><a href="compcert.backend.Bounds.html#only_callee_saves">only_callee_saves</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#record_reg">record_reg</a></span> <span class="id"><a href="compcert.backend.Bounds.html#u">u</a></span> <span class="id"><a href="compcert.backend.Bounds.html#r">r</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3943')">Proof.</div>
<div class="proofscript" id="proof3943">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Bounds.html#only_callee_saves">only_callee_saves</a></span>, <span class="id"><a href="compcert.backend.Bounds.html#record_reg">record_reg</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.x86.Conventions1.html#is_callee_save">is_callee_save</a></span> <span class="id">r</span>) <span class="id">eqn</span>:<span class="id">CS</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.x86.Machregs.html#mreg_eq">mreg_eq</a></span> <span class="id">r</span> <span class="id">r0</span>). <span class="tactic">congruence</span>. <span class="tactic">apply</span> <span class="id">H</span>; <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Bounds.html#add_3">RegSet.add_3</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="record_regs_only">record_regs_only</a></span>: <span class="kwd">forall</span> <span class="id">rl</span> <span class="id">u</span>, <span class="id"><a href="compcert.backend.Bounds.html#only_callee_saves">only_callee_saves</a></span> <span class="id"><a href="compcert.backend.Bounds.html#u">u</a></span> -&gt; <span class="id"><a href="compcert.backend.Bounds.html#only_callee_saves">only_callee_saves</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#record_regs">record_regs</a></span> <span class="id"><a href="compcert.backend.Bounds.html#u">u</a></span> <span class="id"><a href="compcert.backend.Bounds.html#rl">rl</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3944')">Proof.</div>
<div class="proofscript" id="proof3944">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Bounds.html#record_regs">record_regs</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Bounds.html#fold_left_preserves">fold_left_preserves</a></span>; <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="compcert.backend.Bounds.html#record_reg_only">record_reg_only</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="record_regs_of_instr_only">record_regs_of_instr_only</a></span>: <span class="kwd">forall</span> <span class="id">u</span> <span class="id">i</span>, <span class="id"><a href="compcert.backend.Bounds.html#only_callee_saves">only_callee_saves</a></span> <span class="id"><a href="compcert.backend.Bounds.html#u">u</a></span> -&gt; <span class="id"><a href="compcert.backend.Bounds.html#only_callee_saves">only_callee_saves</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#record_regs_of_instr">record_regs_of_instr</a></span> <span class="id"><a href="compcert.backend.Bounds.html#u">u</a></span> <span class="id"><a href="compcert.backend.Bounds.html#i">i</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3945')">Proof.</div>
<div class="proofscript" id="proof3945">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">i</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="compcert.backend.Bounds.html#record_reg_only">record_reg_only</a></span>, <span class="id"><a href="compcert.backend.Bounds.html#record_regs_only">record_regs_only</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="record_regs_of_function_only">record_regs_of_function_only</a></span>:<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Bounds.html#only_callee_saves">only_callee_saves</a></span> <span class="id"><a href="compcert.backend.Bounds.html#record_regs_of_function">record_regs_of_function</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3946')">Proof.</div>
<div class="proofscript" id="proof3946">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Bounds.html#record_regs_of_function">record_regs_of_function</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Bounds.html#fold_left_preserves">fold_left_preserves</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Bounds.html#record_regs_of_instr_only">record_regs_of_instr_only</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="id">eelim</span> <span class="id"><a href="compcert.backend.Bounds.html#empty_1">RegSet.empty_1</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Program</span> <span class="kwd">Definition</span> <span class="id"><a name="function_bounds">function_bounds</a></span> := {|<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Bounds.html#mkbounds">used_callee_save</a></span> := <span class="id"><a href="compcert.backend.Bounds.html#elements">RegSet.elements</a></span> <span class="id"><a href="compcert.backend.Bounds.html#record_regs_of_function">record_regs_of_function</a></span>;<br/>
&nbsp;&nbsp;<span class="id">bound_local</span> := <span class="id"><a href="compcert.backend.Bounds.html#max_over_slots_of_funct">max_over_slots_of_funct</a></span> <span class="id"><a href="compcert.backend.Bounds.html#local_slot">local_slot</a></span>;<br/>
&nbsp;&nbsp;<span class="id">bound_outgoing</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.max">Z.max</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#max_over_instrs">max_over_instrs</a></span> <span class="id"><a href="compcert.backend.Bounds.html#outgoing_space">outgoing_space</a></span>) (<span class="id"><a href="compcert.backend.Bounds.html#max_over_slots_of_funct">max_over_slots_of_funct</a></span> <span class="id"><a href="compcert.backend.Bounds.html#outgoing_slot">outgoing_slot</a></span>);<br/>
&nbsp;&nbsp;<span class="id">bound_stack_data</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.max">Z.max</a></span> <span class="id"><a href="compcert.backend.Bounds.html#BOUNDS.f">f</a></span>.(<span class="id"><a href="compcert.backend.Linear.html#fn_stacksize">fn_stacksize</a></span>) 0<br/>
|}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3947')">Next Obligation.</div>
<div class="proofscript" id="proof3947">
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Bounds.html#max_over_slots_of_funct_pos">max_over_slots_of_funct_pos</a></span>.<br/>
Qed.</div>
<div class="toggleproof" onclick="toggleDisplay('proof3948')">Next Obligation.</div>
<div class="proofscript" id="proof3948">
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.le_ge">Z.le_ge</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.le_trans">Z.le_trans</a></span>. 2: <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.le_max_r">Z.le_max_r</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ge_le">Z.ge_le</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Bounds.html#max_over_slots_of_funct_pos">max_over_slots_of_funct_pos</a></span>.<br/>
Qed.</div>
<div class="toggleproof" onclick="toggleDisplay('proof3949')">Next Obligation.</div>
<div class="proofscript" id="proof3949">
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.le_ge">Z.le_ge</a></span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.le_max_r">Z.le_max_r</a></span>.<br/>
Qed.</div>
<div class="toggleproof" onclick="toggleDisplay('proof3950')">Next Obligation.</div>
<div class="proofscript" id="proof3950">
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="compcert.backend.Bounds.html#elements_3w">RegSet.elements_3w</a></span> <span class="id"><a href="compcert.backend.Bounds.html#record_regs_of_function">record_regs_of_function</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="compcert.backend.Bounds.html#elements">RegSet.elements</a></span> <span class="id"><a href="compcert.backend.Bounds.html#record_regs_of_function">record_regs_of_function</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> 1. <span class="id">constructor</span>. <span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="tactic">elim</span> <span class="id">H</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.SetoidList.html#InA_alt">InA_alt</a></span>. <span class="id">exists</span> <span class="id">x</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<div class="toggleproof" onclick="toggleDisplay('proof3951')">Next Obligation.</div>
<div class="proofscript" id="proof3951">
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Bounds.html#record_regs_of_function_only">record_regs_of_function_only</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Bounds.html#elements_2">RegSet.elements_2</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.SetoidList.html#InA_alt">InA_alt</a></span>. <span class="id">exists</span> <span class="id">r</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">We now show the correctness of the inferred bounds. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="record_reg_incr">record_reg_incr</a></span>: <span class="kwd">forall</span> <span class="id">u</span> <span class="id">r</span> <span class="id">r</span>', <span class="id"><a href="compcert.backend.Bounds.html#In">RegSet.In</a></span> <span class="id">r</span>' <span class="id"><a href="compcert.backend.Bounds.html#u">u</a></span> -&gt; <span class="id"><a href="compcert.backend.Bounds.html#In">RegSet.In</a></span> <span class="id">r</span>' (<span class="id"><a href="compcert.backend.Bounds.html#record_reg">record_reg</a></span> <span class="id"><a href="compcert.backend.Bounds.html#u">u</a></span> <span class="id"><a href="compcert.backend.Bounds.html#r">r</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3952')">Proof.</div>
<div class="proofscript" id="proof3952">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Bounds.html#record_reg">record_reg</a></span>; <span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.x86.Conventions1.html#is_callee_save">is_callee_save</a></span> <span class="id">r</span>); <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Bounds.html#add_2">RegSet.add_2</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="record_reg_ok">record_reg_ok</a></span>: <span class="kwd">forall</span> <span class="id">u</span> <span class="id">r</span>, <span class="id"><a href="compcert.x86.Conventions1.html#is_callee_save">is_callee_save</a></span> <span class="id"><a href="compcert.backend.Bounds.html#r">r</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt; <span class="id"><a href="compcert.backend.Bounds.html#In">RegSet.In</a></span> <span class="id"><a href="compcert.backend.Bounds.html#r">r</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#record_reg">record_reg</a></span> <span class="id"><a href="compcert.backend.Bounds.html#u">u</a></span> <span class="id"><a href="compcert.backend.Bounds.html#r">r</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3953')">Proof.</div>
<div class="proofscript" id="proof3953">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Bounds.html#record_reg">record_reg</a></span>; <span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id">H</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Bounds.html#add_1">RegSet.add_1</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="record_regs_incr">record_regs_incr</a></span>: <span class="kwd">forall</span> <span class="id">r</span>' <span class="id">rl</span> <span class="id">u</span>, <span class="id"><a href="compcert.backend.Bounds.html#In">RegSet.In</a></span> <span class="id">r</span>' <span class="id"><a href="compcert.backend.Bounds.html#u">u</a></span> -&gt; <span class="id"><a href="compcert.backend.Bounds.html#In">RegSet.In</a></span> <span class="id">r</span>' (<span class="id"><a href="compcert.backend.Bounds.html#record_regs">record_regs</a></span> <span class="id"><a href="compcert.backend.Bounds.html#u">u</a></span> <span class="id"><a href="compcert.backend.Bounds.html#rl">rl</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3954')">Proof.</div>
<div class="proofscript" id="proof3954">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Bounds.html#record_regs">record_regs</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Bounds.html#fold_left_preserves">fold_left_preserves</a></span>; <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="compcert.backend.Bounds.html#record_reg_incr">record_reg_incr</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="record_regs_ok">record_regs_ok</a></span>: <span class="kwd">forall</span> <span class="id">r</span> <span class="id">rl</span> <span class="id">u</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.backend.Bounds.html#r">r</a></span> <span class="id"><a href="compcert.backend.Bounds.html#rl">rl</a></span> -&gt; <span class="id"><a href="compcert.x86.Conventions1.html#is_callee_save">is_callee_save</a></span> <span class="id"><a href="compcert.backend.Bounds.html#r">r</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt; <span class="id"><a href="compcert.backend.Bounds.html#In">RegSet.In</a></span> <span class="id"><a href="compcert.backend.Bounds.html#r">r</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#record_regs">record_regs</a></span> <span class="id"><a href="compcert.backend.Bounds.html#u">u</a></span> <span class="id"><a href="compcert.backend.Bounds.html#rl">rl</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3955')">Proof.</div>
<div class="proofscript" id="proof3955">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Bounds.html#record_regs">record_regs</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Bounds.html#fold_left_ensures">fold_left_ensures</a></span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="compcert.backend.Bounds.html#record_reg_incr">record_reg_incr</a></span>, <span class="id"><a href="compcert.backend.Bounds.html#record_reg_ok">record_reg_ok</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="record_regs_of_instr_incr">record_regs_of_instr_incr</a></span>: <span class="kwd">forall</span> <span class="id">r</span>' <span class="id">u</span> <span class="id">i</span>, <span class="id"><a href="compcert.backend.Bounds.html#In">RegSet.In</a></span> <span class="id">r</span>' <span class="id"><a href="compcert.backend.Bounds.html#u">u</a></span> -&gt; <span class="id"><a href="compcert.backend.Bounds.html#In">RegSet.In</a></span> <span class="id">r</span>' (<span class="id"><a href="compcert.backend.Bounds.html#record_regs_of_instr">record_regs_of_instr</a></span> <span class="id"><a href="compcert.backend.Bounds.html#u">u</a></span> <span class="id"><a href="compcert.backend.Bounds.html#i">i</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3956')">Proof.</div>
<div class="proofscript" id="proof3956">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">i</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="compcert.backend.Bounds.html#record_reg_incr">record_reg_incr</a></span>, <span class="id"><a href="compcert.backend.Bounds.html#record_regs_incr">record_regs_incr</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="defined_by_instr">defined_by_instr</a></span> (<span class="id">r</span>': <span class="id"><a href="compcert.x86.Machregs.html#mreg">mreg</a></span>) (<span class="id">i</span>: <span class="id"><a href="compcert.backend.Linear.html#instruction">instruction</a></span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.backend.Bounds.html#i">i</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.Linear.html#Lgetstack">Lgetstack</a></span> <span class="id">sl</span> <span class="id">ofs</span> <span class="id">ty</span> <span class="id">r</span> =&gt; <span class="id">r</span>' = <span class="id">r</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.Linear.html#Lop">Lop</a></span> <span class="id">op</span> <span class="id">args</span> <span class="id">res</span> =&gt; <span class="id">r</span>' = <span class="id">res</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.Linear.html#Lload">Lload</a></span> <span class="id">chunk</span> <span class="id">addr</span> <span class="id">args</span> <span class="id">dst</span> =&gt; <span class="id">r</span>' = <span class="id">dst</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.Linear.html#Lbuiltin">Lbuiltin</a></span> <span class="id">ef</span> <span class="id">args</span> <span class="id">res</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">r</span>' (<span class="id"><a href="compcert.common.AST.html#params_of_builtin_res">params_of_builtin_res</a></span> <span class="id">res</span>) \/ <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">r</span>' (<span class="id"><a href="compcert.x86.Machregs.html#destroyed_by_builtin">destroyed_by_builtin</a></span> <span class="id">ef</span>)<br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="record_regs_of_instr_ok">record_regs_of_instr_ok</a></span>: <span class="kwd">forall</span> <span class="id">r</span>' <span class="id">u</span> <span class="id">i</span>, <span class="id"><a href="compcert.backend.Bounds.html#defined_by_instr">defined_by_instr</a></span> <span class="id">r</span>' <span class="id"><a href="compcert.backend.Bounds.html#i">i</a></span> -&gt; <span class="id"><a href="compcert.x86.Conventions1.html#is_callee_save">is_callee_save</a></span> <span class="id">r</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt; <span class="id"><a href="compcert.backend.Bounds.html#In">RegSet.In</a></span> <span class="id">r</span>' (<span class="id"><a href="compcert.backend.Bounds.html#record_regs_of_instr">record_regs_of_instr</a></span> <span class="id"><a href="compcert.backend.Bounds.html#u">u</a></span> <span class="id"><a href="compcert.backend.Bounds.html#i">i</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3957')">Proof.</div>
<div class="proofscript" id="proof3957">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">i</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">try</span> <span class="id">contradiction</span>; <span class="tactic">subst</span>; <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="compcert.backend.Bounds.html#record_reg_ok">record_reg_ok</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span>; <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="compcert.backend.Bounds.html#record_regs_incr">record_regs_incr</a></span>, <span class="id"><a href="compcert.backend.Bounds.html#record_regs_ok">record_regs_ok</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="record_regs_of_function_ok">record_regs_of_function_ok</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span> <span class="id">i</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.backend.Bounds.html#i">i</a></span> <span class="id"><a href="compcert.backend.Bounds.html#BOUNDS.f">f</a></span>.(<span class="id"><a href="compcert.backend.Linear.html#fn_code">fn_code</a></span>) -&gt; <span class="id"><a href="compcert.backend.Bounds.html#defined_by_instr">defined_by_instr</a></span> <span class="id"><a href="compcert.backend.Bounds.html#r">r</a></span> <span class="id"><a href="compcert.backend.Bounds.html#i">i</a></span> -&gt; <span class="id"><a href="compcert.x86.Conventions1.html#is_callee_save">is_callee_save</a></span> <span class="id"><a href="compcert.backend.Bounds.html#r">r</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt; <span class="id"><a href="compcert.backend.Bounds.html#In">RegSet.In</a></span> <span class="id"><a href="compcert.backend.Bounds.html#r">r</a></span> <span class="id"><a href="compcert.backend.Bounds.html#record_regs_of_function">record_regs_of_function</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3958')">Proof.</div>
<div class="proofscript" id="proof3958">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Bounds.html#record_regs_of_function">record_regs_of_function</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Bounds.html#fold_left_ensures">fold_left_ensures</a></span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="compcert.backend.Bounds.html#record_regs_of_instr_incr">record_regs_of_instr_incr</a></span>, <span class="id"><a href="compcert.backend.Bounds.html#record_regs_of_instr_ok">record_regs_of_instr_ok</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="max_over_list_bound">max_over_list_bound</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">A</span>: <span class="kwd">Type</span>) (<span class="id">valu</span>: <span class="id"><a href="compcert.backend.Bounds.html#A">A</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) (<span class="id">l</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.backend.Bounds.html#A">A</a></span>) (<span class="id">x</span>: <span class="id"><a href="compcert.backend.Bounds.html#A">A</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.backend.Bounds.html#x">x</a></span> <span class="id"><a href="compcert.backend.Bounds.html#l">l</a></span> -&gt; <span class="id"><a href="compcert.backend.Bounds.html#valu">valu</a></span> <span class="id"><a href="compcert.backend.Bounds.html#x">x</a></span> &lt;= <span class="id"><a href="compcert.backend.Bounds.html#max_over_list">max_over_list</a></span> <span class="id"><a href="compcert.backend.Bounds.html#valu">valu</a></span> <span class="id"><a href="compcert.backend.Bounds.html#l">l</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3959')">Proof.</div>
<div class="proofscript" id="proof3959">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> <span class="id">x</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Bounds.html#max_over_list">max_over_list</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">c</span> <span class="id">z</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">f</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_left">fold_left</a></span> (<span class="kwd">fun</span> <span class="id">x</span> <span class="id">y</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.max">Z.max</a></span> <span class="id"><a href="compcert.backend.Bounds.html#x">x</a></span> (<span class="id">valu</span> <span class="id"><a href="compcert.backend.Bounds.html#y">y</a></span>)) <span class="id"><a href="compcert.backend.Bounds.html#c">c</a></span> <span class="id"><a href="compcert.backend.Bounds.html#z">z</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Bounds.html#z">z</a></span> &lt;= <span class="id"><a href="compcert.backend.Bounds.html#f">f</a></span> /\ (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id">x</span> <span class="id"><a href="compcert.backend.Bounds.html#c">c</a></span> -&gt; <span class="id">valu</span> <span class="id">x</span> &lt;= <span class="id"><a href="compcert.backend.Bounds.html#f">f</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">c</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">omega</span>. <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id">IHc</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.max">Z.max</a></span> <span class="id">z</span> (<span class="id">valu</span> <span class="id">a</span>))); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.le_trans">Z.le_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.max">Z.max</a></span> <span class="id">z</span> (<span class="id">valu</span> <span class="id">a</span>)). <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.le_max_l">Z.le_max_l</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">H1</span>; <span class="tactic">elim</span> <span class="id">H1</span>; <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">a</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.le_trans">Z.le_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.max">Z.max</a></span> <span class="id">z</span> (<span class="id">valu</span> <span class="id">x</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.le_max_r">Z.le_max_r</a></span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intro</span>. <span class="tactic">elim</span> (<span class="id">H</span> <span class="id">l</span> 0); <span class="tactic">intros</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="max_over_instrs_bound">max_over_instrs_bound</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">valu</span>: <span class="id"><a href="compcert.backend.Linear.html#instruction">instruction</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) <span class="id">i</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.backend.Bounds.html#i">i</a></span> <span class="id"><a href="compcert.backend.Bounds.html#BOUNDS.f">f</a></span>.(<span class="id"><a href="compcert.backend.Linear.html#fn_code">fn_code</a></span>) -&gt; <span class="id"><a href="compcert.backend.Bounds.html#valu">valu</a></span> <span class="id"><a href="compcert.backend.Bounds.html#i">i</a></span> &lt;= <span class="id"><a href="compcert.backend.Bounds.html#max_over_instrs">max_over_instrs</a></span> <span class="id"><a href="compcert.backend.Bounds.html#valu">valu</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3960')">Proof.</div>
<div class="proofscript" id="proof3960">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Bounds.html#max_over_instrs">max_over_instrs</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Bounds.html#max_over_list_bound">max_over_list_bound</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="max_over_slots_of_funct_bound">max_over_slots_of_funct_bound</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">valu</span>: <span class="id"><a href="compcert.backend.Locations.html#slot">slot</a></span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> * <span class="id"><a href="compcert.common.AST.html#typ">typ</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) <span class="id">i</span> <span class="id">s</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.backend.Bounds.html#i">i</a></span> <span class="id"><a href="compcert.backend.Bounds.html#BOUNDS.f">f</a></span>.(<span class="id"><a href="compcert.backend.Linear.html#fn_code">fn_code</a></span>) -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.backend.Bounds.html#s">s</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#slots_of_instr">slots_of_instr</a></span> <span class="id"><a href="compcert.backend.Bounds.html#i">i</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Bounds.html#valu">valu</a></span> <span class="id"><a href="compcert.backend.Bounds.html#s">s</a></span> &lt;= <span class="id"><a href="compcert.backend.Bounds.html#max_over_slots_of_funct">max_over_slots_of_funct</a></span> <span class="id"><a href="compcert.backend.Bounds.html#valu">valu</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3961')">Proof.</div>
<div class="proofscript" id="proof3961">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Bounds.html#max_over_slots_of_funct">max_over_slots_of_funct</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.le_trans">Z.le_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="compcert.backend.Bounds.html#max_over_slots_of_instr">max_over_slots_of_instr</a></span> <span class="id">valu</span> <span class="id">i</span>).<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Bounds.html#max_over_slots_of_instr">max_over_slots_of_instr</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Bounds.html#max_over_list_bound">max_over_list_bound</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Bounds.html#max_over_instrs_bound">max_over_instrs_bound</a></span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="local_slot_bound">local_slot_bound</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">i</span> <span class="id">ofs</span> <span class="id">ty</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.backend.Bounds.html#i">i</a></span> <span class="id"><a href="compcert.backend.Bounds.html#BOUNDS.f">f</a></span>.(<span class="id"><a href="compcert.backend.Linear.html#fn_code">fn_code</a></span>) -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="kwd">Local</span>, <span class="id"><a href="compcert.backend.Bounds.html#ofs">ofs</a></span>, <span class="id"><a href="compcert.backend.Bounds.html#ty">ty</a></span>) (<span class="id"><a href="compcert.backend.Bounds.html#slots_of_instr">slots_of_instr</a></span> <span class="id"><a href="compcert.backend.Bounds.html#i">i</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Bounds.html#ofs">ofs</a></span> + <span class="id"><a href="compcert.backend.Locations.html#typesize">typesize</a></span> <span class="id"><a href="compcert.backend.Bounds.html#ty">ty</a></span> &lt;= <span class="id"><a href="compcert.backend.Bounds.html#bound_local">bound_local</a></span> <span class="id"><a href="compcert.backend.Bounds.html#function_bounds">function_bounds</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3962')">Proof.</div>
<div class="proofscript" id="proof3962">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Bounds.html#function_bounds">function_bounds</a></span>, <span class="id"><a href="compcert.backend.Bounds.html#bound_local">bound_local</a></span>.<br/>
&nbsp;&nbsp;<span class="id">change</span> (<span class="id">ofs</span> + <span class="id"><a href="compcert.backend.Locations.html#typesize">typesize</a></span> <span class="id">ty</span>) <span class="kwd">with</span> (<span class="id"><a href="compcert.backend.Bounds.html#local_slot">local_slot</a></span> (<span class="kwd">Local</span>, <span class="id">ofs</span>, <span class="id">ty</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Bounds.html#max_over_slots_of_funct_bound">max_over_slots_of_funct_bound</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="outgoing_slot_bound">outgoing_slot_bound</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">i</span> <span class="id">ofs</span> <span class="id">ty</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.backend.Bounds.html#i">i</a></span> <span class="id"><a href="compcert.backend.Bounds.html#BOUNDS.f">f</a></span>.(<span class="id"><a href="compcert.backend.Linear.html#fn_code">fn_code</a></span>) -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="compcert.backend.Locations.html#Outgoing">Outgoing</a></span>, <span class="id"><a href="compcert.backend.Bounds.html#ofs">ofs</a></span>, <span class="id"><a href="compcert.backend.Bounds.html#ty">ty</a></span>) (<span class="id"><a href="compcert.backend.Bounds.html#slots_of_instr">slots_of_instr</a></span> <span class="id"><a href="compcert.backend.Bounds.html#i">i</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Bounds.html#ofs">ofs</a></span> + <span class="id"><a href="compcert.backend.Locations.html#typesize">typesize</a></span> <span class="id"><a href="compcert.backend.Bounds.html#ty">ty</a></span> &lt;= <span class="id"><a href="compcert.backend.Bounds.html#bound_outgoing">bound_outgoing</a></span> <span class="id"><a href="compcert.backend.Bounds.html#function_bounds">function_bounds</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3963')">Proof.</div>
<div class="proofscript" id="proof3963">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">change</span> (<span class="id">ofs</span> + <span class="id"><a href="compcert.backend.Locations.html#typesize">typesize</a></span> <span class="id">ty</span>) <span class="kwd">with</span> (<span class="id"><a href="compcert.backend.Bounds.html#outgoing_slot">outgoing_slot</a></span> (<span class="id"><a href="compcert.backend.Locations.html#Outgoing">Outgoing</a></span>, <span class="id">ofs</span>, <span class="id">ty</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Bounds.html#function_bounds">function_bounds</a></span>, <span class="id"><a href="compcert.backend.Bounds.html#bound_outgoing">bound_outgoing</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#Zmax_bound_r">Zmax_bound_r</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Bounds.html#max_over_slots_of_funct_bound">max_over_slots_of_funct_bound</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="size_arguments_bound">size_arguments_bound</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">sig</span> <span class="id">ros</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="compcert.backend.Linear.html#Lcall">Lcall</a></span> <span class="id"><a href="compcert.backend.Bounds.html#sig">sig</a></span> <span class="id"><a href="compcert.backend.Bounds.html#ros">ros</a></span>) <span class="id"><a href="compcert.backend.Bounds.html#BOUNDS.f">f</a></span>.(<span class="id"><a href="compcert.backend.Linear.html#fn_code">fn_code</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.x86.Conventions1.html#size_arguments">size_arguments</a></span> <span class="id"><a href="compcert.backend.Bounds.html#sig">sig</a></span> &lt;= <span class="id"><a href="compcert.backend.Bounds.html#bound_outgoing">bound_outgoing</a></span> <span class="id"><a href="compcert.backend.Bounds.html#function_bounds">function_bounds</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3964')">Proof.</div>
<div class="proofscript" id="proof3964">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">change</span> (<span class="id"><a href="compcert.x86.Conventions1.html#size_arguments">size_arguments</a></span> <span class="id">sig</span>) <span class="kwd">with</span> (<span class="id"><a href="compcert.backend.Bounds.html#outgoing_space">outgoing_space</a></span> (<span class="id"><a href="compcert.backend.Linear.html#Lcall">Lcall</a></span> <span class="id">sig</span> <span class="id">ros</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Bounds.html#function_bounds">function_bounds</a></span>, <span class="id"><a href="compcert.backend.Bounds.html#bound_outgoing">bound_outgoing</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#Zmax_bound_l">Zmax_bound_l</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Bounds.html#max_over_instrs_bound">max_over_instrs_bound</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Consequently, all machine registers or stack slots mentioned by one
  of the instructions of function <span class="bracket"><span class="id">f</span></span> are within bounds. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="mreg_is_within_bounds">mreg_is_within_bounds</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">i</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.backend.Bounds.html#i">i</a></span> <span class="id"><a href="compcert.backend.Bounds.html#BOUNDS.f">f</a></span>.(<span class="id"><a href="compcert.backend.Linear.html#fn_code">fn_code</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span>, <span class="id"><a href="compcert.backend.Bounds.html#defined_by_instr">defined_by_instr</a></span> <span class="id"><a href="compcert.backend.Bounds.html#r">r</a></span> <span class="id"><a href="compcert.backend.Bounds.html#i">i</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Bounds.html#mreg_within_bounds">mreg_within_bounds</a></span> <span class="id"><a href="compcert.backend.Bounds.html#function_bounds">function_bounds</a></span> <span class="id"><a href="compcert.backend.Bounds.html#r">r</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3965')">Proof.</div>
<div class="proofscript" id="proof3965">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Bounds.html#mreg_within_bounds">mreg_within_bounds</a></span>. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Bounds.html#record_regs_of_function_ok">record_regs_of_function_ok</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Bounds.html#elements_1">RegSet.elements_1</a></span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.SetoidList.html#InA_alt">InA_alt</a></span> <span class="kwd">in</span> <span class="id">H2</span>. <span class="tactic">destruct</span> <span class="id">H2</span> <span class="kwd">as</span> (<span class="id">r</span>' &amp; <span class="id">A</span> &amp; <span class="id">B</span>).<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">r</span>'; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="slot_is_within_bounds">slot_is_within_bounds</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">i</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.backend.Bounds.html#i">i</a></span> <span class="id"><a href="compcert.backend.Bounds.html#BOUNDS.f">f</a></span>.(<span class="id"><a href="compcert.backend.Linear.html#fn_code">fn_code</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">sl</span> <span class="id">ty</span> <span class="id">ofs</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#sl">sl</a></span>, <span class="id"><a href="compcert.backend.Bounds.html#ofs">ofs</a></span>, <span class="id"><a href="compcert.backend.Bounds.html#ty">ty</a></span>) (<span class="id"><a href="compcert.backend.Bounds.html#slots_of_instr">slots_of_instr</a></span> <span class="id"><a href="compcert.backend.Bounds.html#i">i</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Bounds.html#slot_within_bounds">slot_within_bounds</a></span> <span class="id"><a href="compcert.backend.Bounds.html#function_bounds">function_bounds</a></span> <span class="id"><a href="compcert.backend.Bounds.html#sl">sl</a></span> <span class="id"><a href="compcert.backend.Bounds.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Bounds.html#ty">ty</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3966')">Proof.</div>
<div class="proofscript" id="proof3966">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Bounds.html#slot_within_bounds">slot_within_bounds</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">sl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Bounds.html#local_slot_bound">local_slot_bound</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Bounds.html#outgoing_slot_bound">outgoing_slot_bound</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="slots_of_locs_charact">slots_of_locs_charact</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">sl</span> <span class="id">ofs</span> <span class="id">ty</span> <span class="id">l</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#sl">sl</a></span>, <span class="id"><a href="compcert.backend.Bounds.html#ofs">ofs</a></span>, <span class="id"><a href="compcert.backend.Bounds.html#ty">ty</a></span>) (<span class="id"><a href="compcert.backend.Bounds.html#slots_of_locs">slots_of_locs</a></span> <span class="id"><a href="compcert.backend.Bounds.html#l">l</a></span>) &lt;-&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="compcert.backend.Locations.html#S">S</a></span> <span class="id"><a href="compcert.backend.Bounds.html#sl">sl</a></span> <span class="id"><a href="compcert.backend.Bounds.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Bounds.html#ty">ty</a></span>) <span class="id"><a href="compcert.backend.Bounds.html#l">l</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3967')">Proof.</div>
<div class="proofscript" id="proof3967">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">a</span>; <span class="tactic">simpl</span>; <span class="tactic">intuition</span> <span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<div class="doc">It follows that every instruction in the function is within bounds,
    in the sense of the <span class="bracket"><span class="id">instr_within_bounds</span></span> predicate. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="instr_is_within_bounds">instr_is_within_bounds</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">i</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.backend.Bounds.html#i">i</a></span> <span class="id"><a href="compcert.backend.Bounds.html#BOUNDS.f">f</a></span>.(<span class="id"><a href="compcert.backend.Linear.html#fn_code">fn_code</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Bounds.html#instr_within_bounds">instr_within_bounds</a></span> <span class="id"><a href="compcert.backend.Bounds.html#function_bounds">function_bounds</a></span> <span class="id"><a href="compcert.backend.Bounds.html#i">i</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3968')">Proof.</div>
<div class="proofscript" id="proof3968">
&nbsp;&nbsp;<span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">i</span>;<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="compcert.backend.Bounds.html#mreg_is_within_bounds">mreg_is_within_bounds</a></span> <span class="id">_</span> <span class="id">H</span>); <span class="tactic">generalize</span> (<span class="id"><a href="compcert.backend.Bounds.html#slot_is_within_bounds">slot_is_within_bounds</a></span> <span class="id">_</span> <span class="id">H</span>);<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">intros</span>; <span class="tactic">auto</span>.<br/>
<span class="comment">(*&nbsp;call&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Bounds.html#size_arguments_bound">size_arguments_bound</a></span>; <span class="tactic">eauto</span>.<br/>
<span class="comment">(*&nbsp;builtin&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H1</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H0</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Bounds.html#slots_of_locs_charact">slots_of_locs_charact</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="function_is_within_bounds">function_is_within_bounds</a></span>:<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Bounds.html#function_within_bounds">function_within_bounds</a></span> <span class="id"><a href="compcert.backend.Bounds.html#BOUNDS.f">f</a></span> <span class="id"><a href="compcert.backend.Bounds.html#function_bounds">function_bounds</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3969')">Proof.</div>
<div class="proofscript" id="proof3969">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Bounds.html#instr_is_within_bounds">instr_is_within_bounds</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.backend.Bounds.html#BOUNDS">BOUNDS</a></span>.<br/>
<br/>
<div class="doc">Helper to determine the size of the frame area that holds the contents of saved registers. </div>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="size_callee_save_area_rec">size_callee_save_area_rec</a></span> (<span class="id">l</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.x86.Machregs.html#mreg">mreg</a></span>) (<span class="id">ofs</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.backend.Bounds.html#l">l</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; <span class="id"><a href="compcert.backend.Bounds.html#ofs">ofs</a></span><br/>
&nbsp;&nbsp;| <span class="id">r</span> :: <span class="id">l</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ty</span> := <span class="id"><a href="compcert.x86.Machregs.html#mreg_type">mreg_type</a></span> <span class="id">r</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">sz</span> := <span class="id"><a href="compcert.common.AST.html#typesize">AST.typesize</a></span> <span class="id"><a href="compcert.backend.Bounds.html#ty">ty</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Bounds.html#size_callee_save_area_rec">size_callee_save_area_rec</a></span> <span class="id"><a href="compcert.backend.Bounds.html#l">l</a></span> (<span class="id"><a href="compcert.lib.Coqlib.html#align">align</a></span> <span class="id"><a href="compcert.backend.Bounds.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Bounds.html#sz">sz</a></span> + <span class="id"><a href="compcert.backend.Bounds.html#sz">sz</a></span>)<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="size_callee_save_area">size_callee_save_area</a></span> (<span class="id">b</span>: <span class="id"><a href="compcert.backend.Bounds.html#bounds">bounds</a></span>) (<span class="id">ofs</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Bounds.html#size_callee_save_area_rec">size_callee_save_area_rec</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#used_callee_save">used_callee_save</a></span> <span class="id"><a href="compcert.backend.Bounds.html#b">b</a></span>) <span class="id"><a href="compcert.backend.Bounds.html#ofs">ofs</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="size_callee_save_area_rec_incr">size_callee_save_area_rec_incr</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span> <span class="id">ofs</span>, <span class="id"><a href="compcert.backend.Bounds.html#ofs">ofs</a></span> &lt;= <span class="id"><a href="compcert.backend.Bounds.html#size_callee_save_area_rec">size_callee_save_area_rec</a></span> <span class="id"><a href="compcert.backend.Bounds.html#l">l</a></span> <span class="id"><a href="compcert.backend.Bounds.html#ofs">ofs</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3970')">Proof.</div>
<div class="proofscript" id="proof3970">
<span class="kwd">Local</span> <span class="id">Opaque</span> <span class="id"><a href="compcert.x86.Machregs.html#mreg_type">mreg_type</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span> <span class="kwd">as</span> [ | <span class="id">r</span> <span class="id">l</span>]; <span class="tactic">intros</span>; <span class="tactic">simpl</span>.<br/>
- <span class="tactic">omega</span>.<br/>
- <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.le_trans">Z.le_trans</a></span>. 2: <span class="tactic">apply</span> <span class="id">IHl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="compcert.common.AST.html#typesize_pos">AST.typesize_pos</a></span> (<span class="id"><a href="compcert.x86.Machregs.html#mreg_type">mreg_type</a></span> <span class="id">r</span>)); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.le_trans">Z.le_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="compcert.lib.Coqlib.html#align">align</a></span> <span class="id">ofs</span> (<span class="id"><a href="compcert.common.AST.html#typesize">AST.typesize</a></span> (<span class="id"><a href="compcert.x86.Machregs.html#mreg_type">mreg_type</a></span> <span class="id">r</span>))).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#align_le">align_le</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="size_callee_save_area_incr">size_callee_save_area_incr</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span> <span class="id">ofs</span>, <span class="id"><a href="compcert.backend.Bounds.html#ofs">ofs</a></span> &lt;= <span class="id"><a href="compcert.backend.Bounds.html#size_callee_save_area">size_callee_save_area</a></span> <span class="id"><a href="compcert.backend.Bounds.html#b">b</a></span> <span class="id"><a href="compcert.backend.Bounds.html#ofs">ofs</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3971')">Proof.</div>
<div class="proofscript" id="proof3971">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Bounds.html#size_callee_save_area_rec_incr">size_callee_save_area_rec_incr</a></span>.<br/>
Qed.</div>
<br/>
<div class="doc">Layout of the stack frame and its properties.  These definitions
  are used in the machine-dependent <span class="bracket"><span class="id">Stacklayout</span></span> module and in the
  <span class="bracket"><span class="id">Stacking</span></span> pass. </div>
<br/>
<span class="kwd">Record</span> <span class="id"><a name="frame_env">frame_env</a></span> : <span class="kwd">Type</span> := <span class="id"><a name="mk_frame_env">mk_frame_env</a></span> {<br/>
&nbsp;&nbsp;<span class="id"><a name="fe_size">fe_size</a></span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>;<br/>
&nbsp;&nbsp;<span class="id"><a name="fe_ofs_link">fe_ofs_link</a></span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>;<br/>
&nbsp;&nbsp;<span class="id"><a name="fe_ofs_retaddr">fe_ofs_retaddr</a></span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>;<br/>
&nbsp;&nbsp;<span class="id"><a name="fe_ofs_local">fe_ofs_local</a></span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>;<br/>
&nbsp;&nbsp;<span class="id"><a name="fe_ofs_callee_save">fe_ofs_callee_save</a></span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>;<br/>
&nbsp;&nbsp;<span class="id"><a name="fe_stack_data">fe_stack_data</a></span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>;<br/>
&nbsp;&nbsp;<span class="id"><a name="fe_used_callee_save">fe_used_callee_save</a></span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.x86.Machregs.html#mreg">mreg</a></span><br/>
}.<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</div>
</body>
</html>
