
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module Fappli_IEEE_extra</title>
<meta name="description" content="Documentation of Coq module Fappli_IEEE_extra" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module Fappli_IEEE_extra</h1>
<div class="coq">
<br/>
<div class="doc">Additional operations and proofs about IEEE-754 binary
    floating-point numbers, on top of the Flocq library. </div>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.micromega.Psatz.html">Psatz</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Bool.Bool.html">Bool</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Eqdep_dec.html">Eqdep_dec</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.flocq.Core.Fcore.html">Fcore</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.flocq.Core.Fcore_digits.html">Fcore_digits</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_digits.html">Fcalc_digits</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_ops.html">Fcalc_ops</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html">Fcalc_round</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html">Fcalc_bracket</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.flocq.Prop.Fprop_Sterbenz.html">Fprop_Sterbenz</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html">Fappli_IEEE</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_rnd_odd.html">Fappli_rnd_odd</a></span>.<br/>
<br/>
<span class="kwd">Local</span> <span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">Z_scope</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Extra_ops">Extra_ops</a></span>.<br/>
<br/>
<div class="doc"><span class="bracket"><span class="id">prec</span></span> is the number of bits of the mantissa including the implicit one.
    <span class="bracket"><span class="id">emax</span></span> is the exponent of the infinities.
    Typically p=24 and emax = 128 in single precision. </div>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Extra_ops.prec">prec</a></span> <span class="id"><a name="Extra_ops.emax">emax</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.<br/>
<span class="kwd">Context</span> (<span class="id">prec_gt_0_</span> : <span class="id"><a href="compcert.flocq.Core.Fcore_FLX.html#Prec_gt_0">Prec_gt_0</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span>).<br/>
<span class="kwd">Let</span> <span class="id"><a name="Extra_ops.emin">emin</a></span> := (3 - <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span> - <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span>)%<span class="id">Z</span>.<br/>
<span class="kwd">Let</span> <span class="id"><a name="Extra_ops.fexp">fexp</a></span> := <span class="id"><a href="compcert.flocq.Core.Fcore_FLT.html#FLT_exp">FLT_exp</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emin">emin</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="Extra_ops.Hmax">Hmax</a></span> : (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span> &lt; <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span>)%<span class="id">Z</span>.<br/>
<span class="kwd">Let</span> <span class="id"><a name="Extra_ops.binary_float">binary_float</a></span> := <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#binary_float">binary_float</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span>.<br/>
<br/>
<div class="doc">Remarks on <span class="bracket"><span class="id">is_finite</span></span> </div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="is_finite_not_is_nan">is_finite_not_is_nan</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">f</span>: <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.binary_float">binary_float</a></span>), <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#is_finite">is_finite</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#f">f</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt; <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#is_nan">is_nan</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#f">f</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof819')">Proof.</div>
<div class="proofscript" id="proof819">
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">f</span>; <span class="tactic">reflexivity</span> || <span class="tactic">discriminate</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="is_finite_strict_finite">is_finite_strict_finite</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">f</span>: <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.binary_float">binary_float</a></span>), <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#is_finite_strict">is_finite_strict</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#f">f</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt; <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#is_finite">is_finite</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#f">f</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof820')">Proof.</div>
<div class="proofscript" id="proof820">
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">f</span>; <span class="tactic">reflexivity</span> || <span class="tactic">discriminate</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Digression on FP numbers that cannot be <span class="bracket">-0.0</span>. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="is_finite_pos0">is_finite_pos0</a></span> (<span class="id">f</span>: <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.binary_float">binary_float</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#f">f</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B754_zero">B754_zero</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">s</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> <span class="id">s</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B754_infinity">B754_infinity</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B754_nan">B754_nan</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B754_finite">B754_finite</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Bsign_pos0">Bsign_pos0</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#is_finite_pos0">is_finite_pos0</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt; <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#Bsign">Bsign</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span> = <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool">Rlt_bool</a></span> (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2R">B2R</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span>) 0%<span class="id">R</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof821')">Proof.</div>
<div class="proofscript" id="proof821">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">x</span> <span class="kwd">as</span> [ [] | | | [] <span class="id">ex</span> <span class="id">mx</span> <span class="id">Bx</span> ]; <span class="tactic">try</span> <span class="tactic">discriminate</span>; <span class="tactic">simpl</span>.<br/>
- <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool_false">Rlt_bool_false</a></span>; <span class="tactic">auto</span>. <span class="id">lra</span>.<br/>
- <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool_true">Rlt_bool_true</a></span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_float_prop.html#F2R_lt_0_compat">F2R_lt_0_compat</a></span>. <span class="tactic">compute</span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool_false">Rlt_bool_false</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> ((<span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#F2R">F2R</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#Float">Float</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pos">Z.pos</a></span> <span class="id">ex</span>) <span class="id">mx</span>) &gt; 0)%<span class="id">R</span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;( <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_float_prop.html#F2R_gt_0_compat">F2R_gt_0_compat</a></span>; <span class="tactic">compute</span>; <span class="tactic">auto</span> ).<br/>
&nbsp;&nbsp;<span class="id">lra</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="B2R_inj_pos0">B2R_inj_pos0</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#is_finite_pos0">is_finite_pos0</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt; <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#is_finite_pos0">is_finite_pos0</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#y">y</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2R">B2R</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span> = <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2R">B2R</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span> = <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#y">y</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof822')">Proof.</div>
<div class="proofscript" id="proof822">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2R_Bsign_inj">B2R_Bsign_inj</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">x</span>; <span class="tactic">reflexivity</span>||<span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">y</span>; <span class="tactic">reflexivity</span>||<span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> ! <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Bsign_pos0">Bsign_pos0</a></span> <span class="tactic">by</span> <span class="tactic">auto</span>. <span class="tactic">rewrite</span> <span class="id">H1</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<h2> Decidable equality </h2>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Beq_dec">Beq_dec</a></span>: <span class="kwd">forall</span> (<span class="id">f1</span> <span class="id">f2</span>: <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.binary_float">binary_float</a></span>), {<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#f1">f1</a></span> = <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#f2">f2</a></span>} + {<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#f1">f1</a></span> &lt;&gt; <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#f2">f2</a></span>}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof823')">Proof.</div>
<div class="proofscript" id="proof823">
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">UIP_bool</span>: <span class="kwd">forall</span> (<span class="id">b1</span> <span class="id">b2</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>) (<span class="id">e</span> <span class="id">e</span>': <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#b1">b1</a></span> = <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#b2">b2</a></span>), <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#e">e</a></span> = <span class="id">e</span>').<br/>
&nbsp;&nbsp;{ <span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Eqdep_dec.html#UIP_dec">UIP_dec</a></span>. <span class="id">decide</span> <span class="id">equality</span>. }<br/>
&nbsp;&nbsp;<span class="kwd">Ltac</span> <span class="id">try_not_eq</span> := <span class="tactic">try</span> <span class="id">solve</span> [<span class="id">right</span>; <span class="tactic">congruence</span>].<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">f1</span> <span class="kwd">as</span> [| |? []|], <span class="id">f2</span> <span class="kwd">as</span> [| |? []|];<br/>
&nbsp;&nbsp;<span class="tactic">try</span> <span class="tactic">destruct</span> <span class="id">b</span>; <span class="tactic">try</span> <span class="tactic">destruct</span> <span class="id">b0</span>;<br/>
&nbsp;&nbsp;<span class="tactic">try</span> <span class="id">solve</span> [<span class="id">left</span>; <span class="tactic">auto</span>]; <span class="id">try_not_eq</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.eq_dec">Pos.eq_dec</a></span> <span class="id">x</span> <span class="id">x0</span>); <span class="id">try_not_eq</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>; <span class="id">left</span>; <span class="tactic">f_equal</span>; <span class="tactic">f_equal</span>; <span class="tactic">apply</span> <span class="id">UIP_bool</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.eq_dec">Pos.eq_dec</a></span> <span class="id">x</span> <span class="id">x0</span>); <span class="id">try_not_eq</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span>; <span class="id">left</span>; <span class="tactic">f_equal</span>; <span class="tactic">f_equal</span>; <span class="tactic">apply</span> <span class="id">UIP_bool</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.eq_dec">Pos.eq_dec</a></span> <span class="id">m</span> <span class="id">m0</span>); <span class="id">try_not_eq</span>;<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.eq_dec">Z.eq_dec</a></span> <span class="id">e</span> <span class="id">e1</span>); <span class="tactic">try</span> <span class="id">solve</span> [<span class="id">right</span>; <span class="tactic">intro</span> <span class="id">H</span>; <span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">congruence</span>];<br/>
&nbsp;&nbsp;<span class="tactic">subst</span>; <span class="id">left</span>; <span class="tactic">f_equal</span>; <span class="tactic">apply</span> <span class="id">UIP_bool</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.eq_dec">Pos.eq_dec</a></span> <span class="id">m</span> <span class="id">m0</span>); <span class="id">try_not_eq</span>;<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.eq_dec">Z.eq_dec</a></span> <span class="id">e</span> <span class="id">e1</span>); <span class="tactic">try</span> <span class="id">solve</span> [<span class="id">right</span>; <span class="tactic">intro</span> <span class="id">H</span>; <span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">congruence</span>];<br/>
&nbsp;&nbsp;<span class="tactic">subst</span>; <span class="id">left</span>; <span class="tactic">f_equal</span>; <span class="tactic">apply</span> <span class="id">UIP_bool</span>.<br/>
Defined.</div>
<br/>
<h2> Conversion from an integer to a FP number </h2>
<br/>
<div class="doc">Integers that can be represented exactly as FP numbers. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="integer_representable">integer_representable</a></span> (<span class="id">n</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>): <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.abs">Z.abs</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span> &lt;= 2^<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span> - 2^(<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span> - <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span>) /\ <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.fexp">fexp</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span>).<br/>
<br/>
<span class="kwd">Let</span> <span class="id"><a name="Extra_ops.int_upper_bound_eq">int_upper_bound_eq</a></span>: 2^<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span> - 2^(<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span> - <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span>) = (2^<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span> - 1) * 2^(<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span> - <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof824')">Proof.</div>
<div class="proofscript" id="proof824">
&nbsp;&nbsp;<span class="tactic">red</span> <span class="kwd">in</span> <span class="id">prec_gt_0_</span>.<br/>
&nbsp;&nbsp;<span class="id">ring_simplify</span>. <span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zpower_plus">Zpower_plus</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span>) <span class="tactic">by</span> <span class="tactic">omega</span>. <span class="tactic">f_equal</span>. <span class="tactic">f_equal</span>. <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="integer_representable_n2p">integer_representable_n2p</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;-2^<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span> &lt; <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span> &lt; 2^<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span> -&gt; 0 &lt;= <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#p">p</a></span> -&gt; <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#p">p</a></span> &lt;= <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span> - <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#integer_representable">integer_representable</a></span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span> * 2^<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#p">p</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof825')">Proof.</div>
<div class="proofscript" id="proof825">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">split</span>.<br/>
- <span class="tactic">red</span> <span class="kwd">in</span> <span class="id">prec_gt_0_</span>. <span class="tactic">replace</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.abs">Z.abs</a></span> (<span class="id">n</span> * 2^<span class="id">p</span>)) <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.abs">Z.abs</a></span> <span class="id">n</span> * 2^<span class="id">p</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.int_upper_bound_eq">int_upper_bound_eq</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zmult_le_compat">Zmult_le_compat</a></span>. <span class="id">zify</span>; <span class="tactic">omega</span>. <span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zpower_le">Zpower_le</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span>); <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="id">zify</span>; <span class="tactic">omega</span>. <span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zpower_ge_0">Zpower_ge_0</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.abs_mul">Z.abs_mul</a></span>. <span class="tactic">f_equal</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.abs_eq">Z.abs_eq</a></span>. <span class="tactic">auto</span>. <span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zpower_ge_0">Zpower_ge_0</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span>).<br/>
- <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_FLT.html#generic_format_FLT">generic_format_FLT</a></span>. <span class="id">exists</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#Float">Float</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> <span class="id">n</span> <span class="id">p</span>).<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#F2R">F2R</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_Zpower">Z2R_Zpower</a></span> <span class="tactic">by</span> <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_mult">Z2R_mult</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="id">zify</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#emin">emin</a></span>; <span class="tactic">red</span> <span class="kwd">in</span> <span class="id">prec_gt_0_</span>; <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="integer_representable_2p">integer_representable_2p</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;0 &lt;= <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#p">p</a></span> &lt;= <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span> - 1 -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#integer_representable">integer_representable</a></span> (2^<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#p">p</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof826')">Proof.</div>
<div class="proofscript" id="proof826">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">split</span>.<br/>
- <span class="tactic">red</span> <span class="kwd">in</span> <span class="id">prec_gt_0_</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.abs_eq">Z.abs_eq</a></span> <span class="tactic">by</span> (<span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zpower_ge_0">Zpower_ge_0</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span>)).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.le_trans">Z.le_trans</a></span> <span class="kwd">with</span> (2^(<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span>-1)).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zpower_le">Zpower_le</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span>); <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (2^<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span> = 2^(<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span>-1)*2).<br/>
&nbsp;&nbsp;{ <span class="id">change</span> 2 <span class="kwd">with</span> (2^1) <span class="tactic">at</span> 3. <span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zpower_plus">Zpower_plus</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span>) <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">f_equal</span>. <span class="tactic">omega</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (2^(<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span> - <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span>) &lt;= 2^(<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span> - 1)).<br/>
&nbsp;&nbsp;{ <span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zpower_le">Zpower_le</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span>). <span class="tactic">omega</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
- <span class="tactic">red</span> <span class="kwd">in</span> <span class="id">prec_gt_0_</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_FLT.html#generic_format_FLT">generic_format_FLT</a></span>. <span class="id">exists</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#Float">Float</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> 1 <span class="id">p</span>).<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#F2R">F2R</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_1_l">Rmult_1_l</a></span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_Zpower">Z2R_Zpower</a></span>. <span class="tactic">auto</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="id">change</span> 1 <span class="kwd">with</span> (2^0). <span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zpower_lt">Zpower_lt</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span>). <span class="tactic">omega</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#emin">emin</a></span>; <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="integer_representable_opp">integer_representable_opp</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span>, <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#integer_representable">integer_representable</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span> -&gt; <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#integer_representable">integer_representable</a></span> (-<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof827')">Proof.</div>
<div class="proofscript" id="proof827">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">n</span> (<span class="id">A</span> &amp; <span class="id">B</span>); <span class="tactic">split</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.abs_opp">Z.abs_opp</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_opp">Z2R_opp</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#generic_format_opp">generic_format_opp</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="integer_representable_n2p_wide">integer_representable_n2p_wide</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;-2^<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span> &lt;= <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span> &lt;= 2^<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span> -&gt; 0 &lt;= <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#p">p</a></span> -&gt; <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#p">p</a></span> &lt; <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span> - <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#integer_representable">integer_representable</a></span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span> * 2^<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#p">p</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof828')">Proof.</div>
<div class="proofscript" id="proof828">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">red</span> <span class="kwd">in</span> <span class="id">prec_gt_0_</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.eq_dec">Z.eq_dec</a></span> <span class="id">n</span> (2^<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span>)); [<span class="id">idtac</span> | <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.eq_dec">Z.eq_dec</a></span> <span class="id">n</span> (-2^<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span>))].<br/>
- <span class="tactic">rewrite</span> <span class="id">e</span>. <span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zpower_plus">Zpower_plus</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span>) <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#integer_representable_2p">integer_representable_2p</a></span>. <span class="tactic">omega</span>.<br/>
- <span class="tactic">rewrite</span> <span class="id">e</span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zopp_mult_distr_l">Zopp_mult_distr_l</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#integer_representable_opp">integer_representable_opp</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zpower_plus">Zpower_plus</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span>) <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#integer_representable_2p">integer_representable_2p</a></span>. <span class="tactic">omega</span>.<br/>
- <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#integer_representable_n2p">integer_representable_n2p</a></span>; <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="integer_representable_n">integer_representable_n</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span>, -2^<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span> &lt;= <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span> &lt;= 2^<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span> -&gt; <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#integer_representable">integer_representable</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof829')">Proof.</div>
<div class="proofscript" id="proof829">
&nbsp;&nbsp;<span class="tactic">red</span> <span class="kwd">in</span> <span class="id">prec_gt_0_</span>. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> <span class="id">n</span> <span class="kwd">with</span> (<span class="id">n</span> * 2^0) <span class="tactic">by</span> (<span class="id">change</span> (2^0) <span class="kwd">with</span> 1; <span class="tactic">ring</span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#integer_representable_n2p_wide">integer_representable_n2p_wide</a></span>. <span class="tactic">auto</span>. <span class="tactic">omega</span>. <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="round_int_no_overflow">round_int_no_overflow</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.abs">Z.abs</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span> &lt;= 2^<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span> - 2^(<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span>-<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span>) -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.fexp">fexp</a></span> (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#round_mode">round_mode</a></span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#mode_NE">mode_NE</a></span>) (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span>)) &lt; <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow">bpow</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span>)%<span class="id">R</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof830')">Proof.</div>
<div class="proofscript" id="proof830">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">red</span> <span class="kwd">in</span> <span class="id">prec_gt_0_</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.flocq.Core.Fcore_rnd_ne.html#round_NE_abs">round_NE_abs</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> (2^<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span> - 2^(<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span>-<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span>))).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#round_le_generic">round_le_generic</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#fexp_correct">fexp_correct</a></span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#valid_rnd_N">valid_rnd_N</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_FLT.html#generic_format_FLT">generic_format_FLT</a></span>. <span class="id">exists</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#Float">Float</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> (2^<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span>-1) (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span>-<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span>)).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.int_upper_bound_eq">int_upper_bound_eq</a></span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#F2R">F2R</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_Zpower">Z2R_Zpower</a></span> <span class="tactic">by</span> <span class="tactic">omega</span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_mult">Z2R_mult</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">assert</span> (0 &lt; 2^<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span>) <span class="tactic">by</span> (<span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zpower_gt_0">Zpower_gt_0</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span>); <span class="tactic">omega</span>). <span class="id">zify</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#emin">emin</a></span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_abs">Z2R_abs</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_le">Z2R_le</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_Zpower">Z2R_Zpower</a></span> <span class="tactic">by</span> <span class="tactic">omega</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_lt">Z2R_lt</a></span>. <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (0 &lt; 2^(<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span>-<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span>)) <span class="tactic">by</span> (<span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zpower_gt_0">Zpower_gt_0</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span>); <span class="tactic">omega</span>).<br/>
&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#fexp_correct">fexp_correct</a></span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Conversion from an integer.  Round to nearest. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="BofZ">BofZ</a></span> (<span class="id">n</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) : <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.binary_float">binary_float</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#binary_normalize">binary_normalize</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec_gt_0_">prec_gt_0_</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.Hmax">Hmax</a></span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#mode_NE">mode_NE</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span> 0 <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>.<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="BofZ_correct">BofZ_correct</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool">Rlt_bool</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.fexp">fexp</a></span> (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#round_mode">round_mode</a></span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#mode_NE">mode_NE</a></span>) (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span>))) (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow">bpow</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span>)<br/>
&nbsp;&nbsp;<span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2R">B2R</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ">BofZ</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span>) = <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.fexp">fexp</a></span> (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#round_mode">round_mode</a></span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#mode_NE">mode_NE</a></span>) (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span>) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#is_finite">is_finite</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ">BofZ</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#Bsign">Bsign</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ">BofZ</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ltb">Z.ltb</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span> 0<br/>
&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2FF">B2FF</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ">BofZ</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span>) = <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#binary_overflow">binary_overflow</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#mode_NE">mode_NE</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ltb">Z.ltb</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span> 0).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof831')">Proof.</div>
<div class="proofscript" id="proof831">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#binary_normalize_correct">binary_normalize_correct</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec_gt_0_">prec_gt_0_</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.Hmax">Hmax</a></span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#mode_NE">mode_NE</a></span> <span class="id">n</span> 0 <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>).<br/>
&nbsp;&nbsp;<span class="id">fold</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emin">emin</a></span>; <span class="id">fold</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.fexp">fexp</a></span>; <span class="id">fold</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ">BofZ</a></span> <span class="id">n</span>).<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#F2R">F2R</a></span> {| <span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#Float">Fnum</a></span> := <span class="id">n</span>; <span class="id">Fexp</span> := 0 |}) <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> <span class="id">n</span>).<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool">Rlt_bool</a></span>.<br/>
- <span class="tactic">intros</span> (<span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span>). <span class="tactic">split</span>; [|<span class="tactic">split</span>].<br/>
&nbsp;&nbsp;+ <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id">C</span>. <span class="id">change</span> 0%<span class="id">R</span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> 0). <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rcompare_Z2R">Rcompare_Z2R</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ltb">Z.ltb</a></span>. <span class="tactic">auto</span>.<br/>
- <span class="tactic">intros</span> <span class="id">A</span>; <span class="tactic">rewrite</span> <span class="id">A</span>. <span class="tactic">f_equal</span>. <span class="id">change</span> 0%<span class="id">R</span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> 0).<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ltb_spec">Z.ltb_spec</a></span> <span class="id">n</span> 0); <span class="tactic">intros</span> <span class="id">SPEC</span>; <span class="tactic">inversion</span> <span class="id">SPEC</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool_true">Rlt_bool_true</a></span>; <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_lt">Z2R_lt</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool_false">Rlt_bool_false</a></span>; <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_le">Z2R_le</a></span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#F2R">F2R</a></span>; <span class="tactic">simpl</span>. <span class="tactic">ring</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="BofZ_finite">BofZ_finite</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.abs">Z.abs</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span> &lt;= 2^<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span> - 2^(<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span>-<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2R">B2R</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ">BofZ</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span>) = <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.fexp">fexp</a></span> (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#round_mode">round_mode</a></span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#mode_NE">mode_NE</a></span>) (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span>)<br/>
&nbsp;&nbsp;/\ <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#is_finite">is_finite</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ">BofZ</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span><br/>
&nbsp;&nbsp;/\ <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#Bsign">Bsign</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ">BofZ</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ltb">Z.ltb</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span> 0%<span class="id">Z</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof832')">Proof.</div>
<div class="proofscript" id="proof832">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ_correct">BofZ_correct</a></span> <span class="id">n</span>). <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool_true">Rlt_bool_true</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#round_int_no_overflow">round_int_no_overflow</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="BofZ_representable">BofZ_representable</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#integer_representable">integer_representable</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2R">B2R</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ">BofZ</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span>) = <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span><br/>
&nbsp;&nbsp;/\ <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#is_finite">is_finite</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ">BofZ</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span><br/>
&nbsp;&nbsp;/\ <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#Bsign">Bsign</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ">BofZ</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span>) = (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span> &lt;? 0).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof833')">Proof.</div>
<div class="proofscript" id="proof833">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> (<span class="id">P</span> &amp; <span class="id">Q</span>). <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ_finite">BofZ_finite</a></span> <span class="id">n</span>) <span class="kwd">as</span> (<span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span>). <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intuition</span>. <span class="tactic">rewrite</span> <span class="id">A</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#round_generic">round_generic</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#valid_rnd_round_mode">valid_rnd_round_mode</a></span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="BofZ_exact">BofZ_exact</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;-2^<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span> &lt;= <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span> &lt;= 2^<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2R">B2R</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ">BofZ</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span>) = <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span><br/>
&nbsp;&nbsp;/\ <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#is_finite">is_finite</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ">BofZ</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span><br/>
&nbsp;&nbsp;/\ <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#Bsign">Bsign</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ">BofZ</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ltb">Z.ltb</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span> 0%<span class="id">Z</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof834')">Proof.</div>
<div class="proofscript" id="proof834">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ_representable">BofZ_representable</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#integer_representable_n">integer_representable_n</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="BofZ_finite_pos0">BofZ_finite_pos0</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.abs">Z.abs</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span> &lt;= 2^<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span> - 2^(<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span>-<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span>) -&gt; <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#is_finite_pos0">is_finite_pos0</a></span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ">BofZ</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof835')">Proof.</div>
<div class="proofscript" id="proof835">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#binary_normalize_correct">binary_normalize_correct</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec_gt_0_">prec_gt_0_</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.Hmax">Hmax</a></span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#mode_NE">mode_NE</a></span> <span class="id">n</span> 0 <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>).<br/>
&nbsp;&nbsp;<span class="id">fold</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emin">emin</a></span>; <span class="id">fold</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.fexp">fexp</a></span>; <span class="id">fold</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ">BofZ</a></span> <span class="id">n</span>).<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#F2R">F2R</a></span> {| <span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#Float">Fnum</a></span> := <span class="id">n</span>; <span class="id">Fexp</span> := 0 |}) <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> <span class="id">n</span>) <span class="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#F2R">F2R</a></span>; <span class="tactic">simpl</span>; <span class="tactic">ring</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool_true">Rlt_bool_true</a></span> <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#round_int_no_overflow">round_int_no_overflow</a></span>; <span class="tactic">auto</span>).<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span>).<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ">BofZ</a></span> <span class="id">n</span>); <span class="tactic">auto</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">rewrite</span> <span class="id">C</span>. <span class="id">change</span> 0%<span class="id">R</span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> 0). <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rcompare_Z2R">Rcompare_Z2R</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zcompare_spec">Zcompare_spec</a></span> <span class="id">n</span> 0); <span class="tactic">intros</span> <span class="id">SPEC</span>; <span class="tactic">inversion</span> <span class="id">SPEC</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> ((<span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_rnd_ne.html#ZnearestE">ZnearestE</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> <span class="id">n</span>) &lt;= -1)%<span class="id">R</span>).<br/>
&nbsp;&nbsp;{ <span class="id">change</span> (-1)%<span class="id">R</span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> (-1)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#round_le_generic">round_le_generic</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#fexp_correct">fexp_correct</a></span>. <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#valid_rnd_N">valid_rnd_N</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#integer_representable_opp">integer_representable_opp</a></span> 1).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#integer_representable_2p">integer_representable_2p</a></span> 0).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">red</span> <span class="kwd">in</span> <span class="id">prec_gt_0_</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_le">Z2R_le</a></span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id">lra</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="BofZ_finite_equal">BofZ_finite_equal</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.abs">Z.abs</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span> &lt;= 2^<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span> - 2^(<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span>-<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.abs">Z.abs</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#y">y</a></span> &lt;= 2^<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span> - 2^(<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span>-<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2R">B2R</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ">BofZ</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span>) = <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2R">B2R</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ">BofZ</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#y">y</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ">BofZ</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span> = <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ">BofZ</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#y">y</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof836')">Proof.</div>
<div class="proofscript" id="proof836">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#B2R_inj_pos0">B2R_inj_pos0</a></span>; <span class="tactic">auto</span>; <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ_finite_pos0">BofZ_finite_pos0</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Commutation properties with addition, subtraction, multiplication. </div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="BofZ_plus">BofZ_plus</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">nan</span> <span class="id">p</span> <span class="id">q</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#integer_representable">integer_representable</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#p">p</a></span> -&gt; <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#integer_representable">integer_representable</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#q">q</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#Bplus">Bplus</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.Hmax">Hmax</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#nan">nan</a></span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#mode_NE">mode_NE</a></span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ">BofZ</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#p">p</a></span>) (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ">BofZ</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#q">q</a></span>) = <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ">BofZ</a></span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#p">p</a></span> + <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#q">q</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof837')">Proof.</div>
<div class="proofscript" id="proof837">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ_representable">BofZ_representable</a></span> <span class="id">p</span>) <span class="kwd">as</span> (<span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ_representable">BofZ_representable</a></span> <span class="id">q</span>) <span class="kwd">as</span> (<span class="id">D</span> &amp; <span class="id">E</span> &amp; <span class="id">F</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#Bplus_correct">Bplus_correct</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.Hmax">Hmax</a></span> <span class="id">nan</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#mode_NE">mode_NE</a></span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ">BofZ</a></span> <span class="id">p</span>) (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ">BofZ</a></span> <span class="id">q</span>) <span class="id">B</span> <span class="id">E</span>).<br/>
&nbsp;&nbsp;<span class="id">fold</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emin">emin</a></span>; <span class="id">fold</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.fexp">fexp</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">A</span>, <span class="id">D</span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_plus">Z2R_plus</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ_correct">BofZ_correct</a></span> (<span class="id">p</span> + <span class="id">q</span>)). <span class="tactic">destruct</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool">Rlt_bool</a></span>.<br/>
- <span class="tactic">intros</span> (<span class="id">P</span> &amp; <span class="id">Q</span> &amp; <span class="id">R</span>) (<span class="id">U</span> &amp; <span class="id">V</span> &amp; <span class="id">W</span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2R_Bsign_inj">B2R_Bsign_inj</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">P</span>, <span class="id">U</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">R</span>, <span class="id">W</span>, <span class="id">C</span>, <span class="id">F</span>.<br/>
&nbsp;&nbsp;<span class="id">change</span> 0%<span class="id">R</span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> 0). <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rcompare_Z2R">Rcompare_Z2R</a></span>. <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ltb">Z.ltb</a></span> <span class="tactic">at</span> 3.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zcompare_spec">Zcompare_spec</a></span> (<span class="id">p</span> + <span class="id">q</span>) 0); <span class="tactic">intros</span> <span class="id">SPEC</span>; <span class="tactic">inversion</span> <span class="id">SPEC</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">EITHER</span>: 0 &lt;= <span class="id">p</span> \/ 0 &lt;= <span class="id">q</span>) <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">EITHER</span>; [<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Bool.Bool.html#andb_false_intro1">andb_false_intro1</a></span> | <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Bool.Bool.html#andb_false_intro2">andb_false_intro2</a></span>];<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zlt_bool_false">Zlt_bool_false</a></span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">intros</span> <span class="id">P</span> (<span class="id">U</span> &amp; <span class="id">V</span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2FF_inj">B2FF_inj</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">P</span>, <span class="id">U</span>, <span class="id">C</span>. <span class="tactic">f_equal</span>. <span class="tactic">rewrite</span> <span class="id">C</span>, <span class="id">F</span> <span class="kwd">in</span> <span class="id">V</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zlt_bool_spec">Zlt_bool_spec</a></span> <span class="id">p</span> 0) (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zlt_bool_spec">Zlt_bool_spec</a></span> <span class="id">q</span> 0). <span class="tactic">rewrite</span> &lt;- <span class="id">V</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">SPEC1</span> <span class="id">SPEC2</span>; <span class="tactic">inversion</span> <span class="id">SPEC1</span>; <span class="tactic">inversion</span> <span class="id">SPEC2</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>; <span class="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zlt_bool_true">Zlt_bool_true</a></span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zlt_bool_false">Zlt_bool_false</a></span>; <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="BofZ_minus">BofZ_minus</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">nan</span> <span class="id">p</span> <span class="id">q</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#integer_representable">integer_representable</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#p">p</a></span> -&gt; <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#integer_representable">integer_representable</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#q">q</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#Bminus">Bminus</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.Hmax">Hmax</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#nan">nan</a></span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#mode_NE">mode_NE</a></span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ">BofZ</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#p">p</a></span>) (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ">BofZ</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#q">q</a></span>) = <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ">BofZ</a></span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#p">p</a></span> - <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#q">q</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof838')">Proof.</div>
<div class="proofscript" id="proof838">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ_representable">BofZ_representable</a></span> <span class="id">p</span>) <span class="kwd">as</span> (<span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ_representable">BofZ_representable</a></span> <span class="id">q</span>) <span class="kwd">as</span> (<span class="id">D</span> &amp; <span class="id">E</span> &amp; <span class="id">F</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#Bminus_correct">Bminus_correct</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.Hmax">Hmax</a></span> <span class="id">nan</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#mode_NE">mode_NE</a></span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ">BofZ</a></span> <span class="id">p</span>) (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ">BofZ</a></span> <span class="id">q</span>) <span class="id">B</span> <span class="id">E</span>).<br/>
&nbsp;&nbsp;<span class="id">fold</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emin">emin</a></span>; <span class="id">fold</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.fexp">fexp</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">A</span>, <span class="id">D</span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_minus">Z2R_minus</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ_correct">BofZ_correct</a></span> (<span class="id">p</span> - <span class="id">q</span>)). <span class="tactic">destruct</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool">Rlt_bool</a></span>.<br/>
- <span class="tactic">intros</span> (<span class="id">P</span> &amp; <span class="id">Q</span> &amp; <span class="id">R</span>) (<span class="id">U</span> &amp; <span class="id">V</span> &amp; <span class="id">W</span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2R_Bsign_inj">B2R_Bsign_inj</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">P</span>, <span class="id">U</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">R</span>, <span class="id">W</span>, <span class="id">C</span>, <span class="id">F</span>.<br/>
&nbsp;&nbsp;<span class="id">change</span> 0%<span class="id">R</span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> 0). <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rcompare_Z2R">Rcompare_Z2R</a></span>. <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ltb">Z.ltb</a></span> <span class="tactic">at</span> 3.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zcompare_spec">Zcompare_spec</a></span> (<span class="id">p</span> - <span class="id">q</span>) 0); <span class="tactic">intros</span> <span class="id">SPEC</span>; <span class="tactic">inversion</span> <span class="id">SPEC</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">EITHER</span>: 0 &lt;= <span class="id">p</span> \/ <span class="id">q</span> &lt; 0) <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">EITHER</span>; [<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Bool.Bool.html#andb_false_intro1">andb_false_intro1</a></span> | <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Bool.Bool.html#andb_false_intro2">andb_false_intro2</a></span>].<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zlt_bool_false">Zlt_bool_false</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zlt_bool_true">Zlt_bool_true</a></span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">intros</span> <span class="id">P</span> (<span class="id">U</span> &amp; <span class="id">V</span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2FF_inj">B2FF_inj</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">P</span>, <span class="id">U</span>, <span class="id">C</span>. <span class="tactic">f_equal</span>. <span class="tactic">rewrite</span> <span class="id">C</span>, <span class="id">F</span> <span class="kwd">in</span> <span class="id">V</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zlt_bool_spec">Zlt_bool_spec</a></span> <span class="id">p</span> 0) (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zlt_bool_spec">Zlt_bool_spec</a></span> <span class="id">q</span> 0). <span class="tactic">rewrite</span> <span class="id">V</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">SPEC1</span> <span class="id">SPEC2</span>; <span class="tactic">inversion</span> <span class="id">SPEC1</span>; <span class="tactic">inversion</span> <span class="id">SPEC2</span>; <span class="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H3</span> <span class="kwd">in</span> <span class="id">H1</span>; <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zlt_bool_true">Zlt_bool_true</a></span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zlt_bool_false">Zlt_bool_false</a></span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H3</span> <span class="kwd">in</span> <span class="id">H1</span>; <span class="tactic">discriminate</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="BofZ_mult">BofZ_mult</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">nan</span> <span class="id">p</span> <span class="id">q</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#integer_representable">integer_representable</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#p">p</a></span> -&gt; <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#integer_representable">integer_representable</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#q">q</a></span> -&gt;<br/>
&nbsp;&nbsp;0 &lt; <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#q">q</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#Bmult">Bmult</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.Hmax">Hmax</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#nan">nan</a></span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#mode_NE">mode_NE</a></span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ">BofZ</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#p">p</a></span>) (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ">BofZ</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#q">q</a></span>) = <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ">BofZ</a></span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#p">p</a></span> * <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#q">q</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof839')">Proof.</div>
<div class="proofscript" id="proof839">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">SIGN</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#xorb">xorb</a></span> (<span class="id">p</span> &lt;? 0) (<span class="id">q</span> &lt;? 0) = (<span class="id">p</span> * <span class="id">q</span> &lt;? 0)).<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zlt_bool_false">Zlt_bool_false</a></span> <span class="id">q</span>) <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zlt_bool_spec">Zlt_bool_spec</a></span> <span class="id">p</span> 0); <span class="tactic">intros</span> <span class="id">SPEC</span>; <span class="tactic">inversion</span> <span class="id">SPEC</span>; <span class="tactic">simpl</span>; <span class="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zlt_bool_true">Zlt_bool_true</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.mul_comm">Z.mul_comm</a></span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.mul_pos_neg">Z.mul_pos_neg</a></span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zlt_bool_false">Zlt_bool_false</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zsame_sign_imp">Zsame_sign_imp</a></span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ_representable">BofZ_representable</a></span> <span class="id">p</span>) <span class="kwd">as</span> (<span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ_representable">BofZ_representable</a></span> <span class="id">q</span>) <span class="kwd">as</span> (<span class="id">D</span> &amp; <span class="id">E</span> &amp; <span class="id">F</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#Bmult_correct">Bmult_correct</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.Hmax">Hmax</a></span> <span class="id">nan</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#mode_NE">mode_NE</a></span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ">BofZ</a></span> <span class="id">p</span>) (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ">BofZ</a></span> <span class="id">q</span>)).<br/>
&nbsp;&nbsp;<span class="id">fold</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emin">emin</a></span>; <span class="id">fold</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.fexp">fexp</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">A</span>, <span class="id">B</span>, <span class="id">C</span>, <span class="id">D</span>, <span class="id">E</span>, <span class="id">F</span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_mult">Z2R_mult</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ_correct">BofZ_correct</a></span> (<span class="id">p</span> * <span class="id">q</span>)). <span class="tactic">destruct</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool">Rlt_bool</a></span>.<br/>
- <span class="tactic">intros</span> (<span class="id">P</span> &amp; <span class="id">Q</span> &amp; <span class="id">R</span>) (<span class="id">U</span> &amp; <span class="id">V</span> &amp; <span class="id">W</span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2R_Bsign_inj">B2R_Bsign_inj</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">P</span>, <span class="id">U</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">R</span>, <span class="id">W</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#is_finite_not_is_nan">is_finite_not_is_nan</a></span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">intros</span> <span class="id">P</span> <span class="id">U</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2FF_inj">B2FF_inj</a></span>. <span class="tactic">rewrite</span> <span class="id">P</span>, <span class="id">U</span>. <span class="tactic">f_equal</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="BofZ_mult_2p">BofZ_mult_2p</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">nan</span> <span class="id">x</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.abs">Z.abs</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span> &lt;= 2^<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span> - 2^(<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span>-<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span>) -&gt;<br/>
&nbsp;&nbsp;2^<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span> &lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.abs">Z.abs</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;0 &lt;= <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#p">p</a></span> &lt;= <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span> - 1 -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#Bmult">Bmult</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.Hmax">Hmax</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#nan">nan</a></span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#mode_NE">mode_NE</a></span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ">BofZ</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span>) (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ">BofZ</a></span> (2^<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#p">p</a></span>)) = <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ">BofZ</a></span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span> * 2^<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#p">p</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof840')">Proof.</div>
<div class="proofscript" id="proof840">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.eq_dec">Z.eq_dec</a></span> <span class="id">x</span> 0).<br/>
- <span class="tactic">subst</span> <span class="id">x</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ_mult">BofZ_mult</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#integer_representable_n">integer_representable_n</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zpower_ge_0">Zpower_ge_0</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span>). <span class="tactic">simpl</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#integer_representable_2p">integer_representable_2p</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zpower_gt_0">Zpower_gt_0</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
- <span class="tactic">assert</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> <span class="id">x</span> &lt;&gt; 0%<span class="id">R</span>) <span class="tactic">by</span> (<span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_neq">Z2R_neq</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">n</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ_finite">BofZ_finite</a></span> <span class="id">x</span> <span class="id">H</span>) <span class="kwd">as</span> (<span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span>).<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ_representable">BofZ_representable</a></span> (2^<span class="id">p</span>)) <span class="kwd">as</span> (<span class="id">D</span> &amp; <span class="id">E</span> &amp; <span class="id">F</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#integer_representable_2p">integer_representable_2p</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#canonic_exp">canonic_exp</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.fexp">fexp</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> (<span class="id">x</span> * 2^<span class="id">p</span>)) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#canonic_exp">canonic_exp</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.fexp">fexp</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> <span class="id">x</span>) + <span class="id">p</span>).<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#canonic_exp">canonic_exp</a></span>, <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#fexp">fexp</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_mult">Z2R_mult</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">change</span> (2^<span class="id">p</span>) <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span>^<span class="id">p</span>). <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_Zpower">Z2R_Zpower</a></span> <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#ln_beta_mult_bpow">ln_beta_mult_bpow</a></span> <span class="tactic">by</span> <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span> + 1 &lt;= <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#ln_beta">ln_beta</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> <span class="id">x</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#ln_beta_abs">ln_beta_abs</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> <span class="id">x</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#ln_beta_bpow">ln_beta_bpow</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#ln_beta_le">ln_beta_le</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow_gt_0">bpow_gt_0</a></span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_Zpower">Z2R_Zpower</a></span> <span class="tactic">by</span> (<span class="tactic">red</span> <span class="kwd">in</span> <span class="id">prec_gt_0_</span>;<span class="tactic">omega</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_abs">Z2R_abs</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_le">Z2R_le</a></span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Fcore_FLT.html#FLT_exp">FLT_exp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#emin">emin</a></span>; <span class="tactic">red</span> <span class="kwd">in</span> <span class="id">prec_gt_0_</span>; <span class="id">zify</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">m</span>, <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.fexp">fexp</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#m">m</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> <span class="id">x</span>) * <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> (2^<span class="id">p</span>) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.fexp">fexp</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#m">m</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> (<span class="id">x</span> * 2^<span class="id">p</span>)))%<span class="id">R</span>.<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#round">round</a></span>, <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#scaled_mantissa">scaled_mantissa</a></span>. <span class="tactic">rewrite</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_mult">Z2R_mult</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.opp_add_distr">Z.opp_add_distr</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow_plus">bpow_plus</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">a</span> := <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> <span class="id">x</span>); <span class="tactic">set</span> (<span class="id">b</span> := <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow">bpow</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> (- <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#canonic_exp">canonic_exp</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.fexp">fexp</a></span> <span class="id">a</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">a</span> * <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> (2^<span class="id">p</span>) * (<span class="id">b</span> * <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow">bpow</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> (-<span class="id">p</span>)))%<span class="id">R</span> <span class="kwd">with</span> (<span class="id">a</span> * <span class="id">b</span>)%<span class="id">R</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#F2R">F2R</a></span>; <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>. <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow_plus">bpow_plus</a></span>.  <span class="tactic">f_equal</span>. <span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_Zpower">Z2R_Zpower</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span>). <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">transitivity</span> ((<span class="id">a</span> * <span class="id">b</span>) * (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> (2^<span class="id">p</span>) * <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow">bpow</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> (-<span class="id">p</span>)))%<span class="id">R</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_Zpower">Z2R_Zpower</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span>). <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow_plus">bpow_plus</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">p</span> + -<span class="id">p</span>) <span class="kwd">with</span> 0 <span class="tactic">by</span> <span class="tactic">omega</span>. <span class="id">change</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow">bpow</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> 0) <span class="kwd">with</span> 1%<span class="id">R</span>. <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">m</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.fexp">fexp</a></span> (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#round_mode">round_mode</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#m">m</a></span>) (<span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.fexp">fexp</a></span> (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#round_mode">round_mode</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#m">m</a></span>) <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span>) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.fexp">fexp</a></span> (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#round_mode">round_mode</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#m">m</a></span>) <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span>).<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#round_generic">round_generic</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#valid_rnd_round_mode">valid_rnd_round_mode</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#generic_format_round">generic_format_round</a></span>.  <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#fexp_correct">fexp_correct</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#valid_rnd_round_mode">valid_rnd_round_mode</a></span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#xorb">xorb</a></span> (<span class="id">x</span> &lt;? 0) (2^<span class="id">p</span> &lt;? 0) = (<span class="id">x</span> * 2^<span class="id">p</span> &lt;? 0)).<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (0 &lt; 2^<span class="id">p</span>) <span class="tactic">by</span> (<span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zpower_gt_0">Zpower_gt_0</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span>); <span class="tactic">omega</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zlt_bool_false">Zlt_bool_false</a></span> (2^<span class="id">p</span>)) <span class="tactic">by</span> <span class="tactic">omega</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Bool.Bool.html#xorb_false_r">xorb_false_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">symmetry</span>. <span class="tactic">generalize</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zlt_bool_spec">Zlt_bool_spec</a></span> <span class="id">x</span> 0); <span class="tactic">intros</span> <span class="id">SPEC</span>; <span class="tactic">inversion</span> <span class="id">SPEC</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zlt_bool_true">Zlt_bool_true</a></span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.mul_neg_pos">Z.mul_neg_pos</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zlt_bool_false">Zlt_bool_false</a></span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.mul_nonneg_nonneg">Z.mul_nonneg_nonneg</a></span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#Bmult_correct">Bmult_correct</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.Hmax">Hmax</a></span> <span class="id">nan</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#mode_NE">mode_NE</a></span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ">BofZ</a></span> <span class="id">x</span>) (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ">BofZ</a></span> (2^<span class="id">p</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ_correct">BofZ_correct</a></span> (<span class="id">x</span> * 2^<span class="id">p</span>)).<br/>
&nbsp;&nbsp;<span class="id">fold</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emin">emin</a></span>; <span class="id">fold</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.fexp">fexp</a></span>. <span class="tactic">rewrite</span> <span class="id">A</span>, <span class="id">B</span>, <span class="id">C</span>, <span class="id">D</span>, <span class="id">E</span>, <span class="id">F</span>, <span class="id">H4</span>, <span class="id">H5</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool">Rlt_bool</a></span>.<br/>
+ <span class="tactic">intros</span> (<span class="id">P</span> &amp; <span class="id">Q</span> &amp; <span class="id">R</span>) (<span class="id">U</span> &amp; <span class="id">V</span> &amp; <span class="id">W</span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2R_Bsign_inj">B2R_Bsign_inj</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">P</span>, <span class="id">U</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">R</span>, <span class="id">W</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#is_finite_not_is_nan">is_finite_not_is_nan</a></span>; <span class="tactic">auto</span>.<br/>
+ <span class="tactic">intros</span> <span class="id">P</span> <span class="id">U</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2FF_inj">B2FF_inj</a></span>. <span class="tactic">rewrite</span> <span class="id">P</span>, <span class="id">U</span>. <span class="tactic">f_equal</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Rounding to odd the argument of <span class="bracket"><span class="id">BofZ</span></span>. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="round_odd_flt">round_odd_flt</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">prec</span>' <span class="id">emin</span>' <span class="id">x</span> <span class="id">choice</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span> &gt; 1 -&gt; <span class="id">prec</span>' &gt; 1 -&gt; <span class="id">prec</span>' &gt;= <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span> + 2 -&gt; <span class="id">emin</span>' &lt;= <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emin">emin</a></span> - 2 -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.fexp">fexp</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#Znearest">Znearest</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#choice">choice</a></span>) (<span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_FLT.html#FLT_exp">FLT_exp</a></span> <span class="id">emin</span>' <span class="id">prec</span>') <span class="id"><a href="compcert.flocq.Appli.Fappli_rnd_odd.html#Zrnd_odd">Zrnd_odd</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span>) =<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.fexp">fexp</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#Znearest">Znearest</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#choice">choice</a></span>) <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof841')">Proof.</div>
<div class="proofscript" id="proof841">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_rnd_odd.html#round_odd_prop">round_odd_prop</a></span>. <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#fexp_correct">fexp_correct</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_FLT.html#exists_NE_FLT">exists_NE_FLT</a></span>. <span class="id">right</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_FLT.html#FLT_exp_valid">FLT_exp_valid</a></span>. <span class="tactic">red</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_FLT.html#exists_NE_FLT">exists_NE_FLT</a></span>. <span class="id">right</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#fexp">fexp</a></span>, <span class="id"><a href="compcert.flocq.Core.Fcore_FLT.html#FLT_exp">FLT_exp</a></span>; <span class="tactic">intros</span>. <span class="id">zify</span>; <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Corollary</span> <span class="id"><a name="round_odd_fix">round_odd_fix</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">p</span> <span class="id">choice</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span> &gt; 1 -&gt;<br/>
&nbsp;&nbsp;0 &lt;= <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#p">p</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow">bpow</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span> + <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#p">p</a></span> + 1) &lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span>)%<span class="id">R</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.fexp">fexp</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#Znearest">Znearest</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#choice">choice</a></span>) (<span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_FIX.html#FIX_exp">FIX_exp</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#p">p</a></span>) <span class="id"><a href="compcert.flocq.Appli.Fappli_rnd_odd.html#Zrnd_odd">Zrnd_odd</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span>) =<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.fexp">fexp</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#Znearest">Znearest</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#choice">choice</a></span>) <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof842')">Proof.</div>
<div class="proofscript" id="proof842">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Req_EM_T">Req_EM_T</a></span> <span class="id">x</span> 0%<span class="id">R</span>).<br/>
- <span class="tactic">subst</span> <span class="id">x</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#round_0">round_0</a></span>. <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_rnd_odd.html#valid_rnd_odd">valid_rnd_odd</a></span>.<br/>
- <span class="tactic">set</span> (<span class="id">prec</span>' := <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#ln_beta">ln_beta</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> <span class="id">x</span> - <span class="id">p</span>).<br/>
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">emin</span>' := <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emin">emin</a></span> - 2).<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">PREC</span>: <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#ln_beta">ln_beta</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow">bpow</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span> + <span class="id">p</span> + 1)) &lt;= <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#ln_beta">ln_beta</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#ln_beta_abs">ln_beta_abs</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#ln_beta_le">ln_beta_le</a></span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow_gt_0">bpow_gt_0</a></span>. }<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#ln_beta_bpow">ln_beta_bpow</a></span> <span class="kwd">in</span> <span class="id">PREC</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">CANON</span>: <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#canonic_exp">canonic_exp</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_FLT.html#FLT_exp">FLT_exp</a></span> <span class="id">emin</span>' <span class="id">prec</span>') <span class="id">x</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#canonic_exp">canonic_exp</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_FIX.html#FIX_exp">FIX_exp</a></span> <span class="id">p</span>) <span class="id">x</span>).<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#canonic_exp">canonic_exp</a></span>, <span class="id"><a href="compcert.flocq.Core.Fcore_FLT.html#FLT_exp">FLT_exp</a></span>, <span class="id"><a href="compcert.flocq.Core.Fcore_FIX.html#FIX_exp">FIX_exp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#ln_beta">ln_beta</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> <span class="id">x</span> - <span class="id">prec</span>') <span class="kwd">with</span> <span class="id">p</span> <span class="tactic">by</span> (<span class="tactic">unfold</span> <span class="id">prec</span>'; <span class="tactic">omega</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.max_l">Z.max_l</a></span>. <span class="tactic">unfold</span> <span class="id">emin</span>', <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#emin">emin</a></span>. <span class="tactic">red</span> <span class="kwd">in</span> <span class="id">prec_gt_0_</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">RND</span>: <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_FIX.html#FIX_exp">FIX_exp</a></span> <span class="id">p</span>) <span class="id"><a href="compcert.flocq.Appli.Fappli_rnd_odd.html#Zrnd_odd">Zrnd_odd</a></span> <span class="id">x</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_FLT.html#FLT_exp">FLT_exp</a></span> <span class="id">emin</span>' <span class="id">prec</span>') <span class="id"><a href="compcert.flocq.Appli.Fappli_rnd_odd.html#Zrnd_odd">Zrnd_odd</a></span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#round">round</a></span>, <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#scaled_mantissa">scaled_mantissa</a></span>. <span class="tactic">rewrite</span> <span class="id">CANON</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">RND</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#round_odd_flt">round_odd_flt</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">prec</span>'. <span class="tactic">red</span> <span class="kwd">in</span> <span class="id">prec_gt_0_</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">prec</span>'. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">emin</span>'. <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="int_round_odd">int_round_odd</a></span> (<span class="id">x</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) (<span class="id">p</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) :=<br/>
&nbsp;&nbsp;(<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.eqb">Z.eqb</a></span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span> <span class="id">mod</span> 2^<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#p">p</a></span>) 0 || <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.odd">Z.odd</a></span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span> / 2^<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#p">p</a></span>) <span class="kwd">then</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span> / 2^<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#p">p</a></span> <span class="kwd">else</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span> / 2^<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#p">p</a></span> + 1) * 2^<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#p">p</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Zrnd_odd_int">Zrnd_odd_int</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span> <span class="id">p</span>, 0 &lt;= <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#p">p</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Appli.Fappli_rnd_odd.html#Zrnd_odd">Zrnd_odd</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span> * <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow">bpow</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> (-<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#p">p</a></span>)) * 2^<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#p">p</a></span> =<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#int_round_odd">int_round_odd</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#p">p</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof843')">Proof.</div>
<div class="proofscript" id="proof843">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (0 &lt; 2^<span class="id">p</span>) <span class="tactic">by</span> (<span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zpower_gt_0">Zpower_gt_0</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span>); <span class="tactic">omega</span>).<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">n</span> = (<span class="id">n</span> / 2^<span class="id">p</span>) * 2^<span class="id">p</span> + <span class="id">n</span> <span class="id">mod</span> 2^<span class="id">p</span>) <span class="tactic">by</span> (<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.mul_comm">Z.mul_comm</a></span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.div_mod">Z.div_mod</a></span>; <span class="tactic">omega</span>).<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (0 &lt;= <span class="id">n</span> <span class="id">mod</span> 2^<span class="id">p</span> &lt; 2^<span class="id">p</span>) <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zdiv.html#Z_mod_lt">Z_mod_lt</a></span>; <span class="tactic">omega</span>).<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#int_round_odd">int_round_odd</a></span>. <span class="tactic">set</span> (<span class="id">q</span> := <span class="id">n</span> / 2^<span class="id">p</span>) <span class="kwd">in</span> *; <span class="tactic">set</span> (<span class="id">r</span> := <span class="id">n</span> <span class="id">mod</span> 2^<span class="id">p</span>) <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow_gt_0">bpow_gt_0</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> (-<span class="id">p</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow">bpow</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> <span class="id">p</span> * <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow">bpow</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> (-<span class="id">p</span>) = 1)%<span class="id">R</span>.<br/>
&nbsp;&nbsp;{ <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow_plus">bpow_plus</a></span>. <span class="tactic">replace</span> (<span class="id">p</span> + -<span class="id">p</span>) <span class="kwd">with</span> 0 <span class="tactic">by</span> <span class="tactic">omega</span>. <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> <span class="id">n</span> * <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow">bpow</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> (-<span class="id">p</span>) = <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> <span class="id">q</span> + <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> <span class="id">r</span> * <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow">bpow</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> (-<span class="id">p</span>))%<span class="id">R</span>.<br/>
&nbsp;&nbsp;{ <span class="tactic">rewrite</span> <span class="id">H1</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_plus">Z2R_plus</a></span>, <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_mult">Z2R_mult</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">change</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> (2^<span class="id">p</span>)) <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span>^<span class="id">p</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_Zpower">Z2R_Zpower</a></span> <span class="tactic">by</span> <span class="tactic">omega</span>. <span class="id">ring_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>. <span class="tactic">rewrite</span> <span class="id">H4</span>. <span class="tactic">ring</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (0 &lt;= <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> <span class="id">r</span> &lt; <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow">bpow</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> <span class="id">p</span>)%<span class="id">R</span>.<br/>
&nbsp;&nbsp;{ <span class="tactic">split</span>. <span class="id">change</span> 0%<span class="id">R</span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> 0). <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_le">Z2R_le</a></span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_Zpower">Z2R_Zpower</a></span> <span class="tactic">by</span> <span class="tactic">omega</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_lt">Z2R_lt</a></span>; <span class="tactic">tauto</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (0 &lt;= <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> <span class="id">r</span> * <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow">bpow</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> (-<span class="id">p</span>) &lt; 1)%<span class="id">R</span>.<br/>
&nbsp;&nbsp;{ <span class="tactic">generalize</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow_gt_0">bpow_gt_0</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> (-<span class="id">p</span>)). <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_pos">Rmult_le_pos</a></span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H4</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_compat_r">Rmult_lt_compat_r</a></span>. <span class="tactic">auto</span>. <span class="tactic">tauto</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Zfloor">Zfloor</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> <span class="id">n</span> * <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow">bpow</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> (-<span class="id">p</span>)) = <span class="id">q</span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Zfloor_imp">Zfloor_imp</a></span>. <span class="tactic">rewrite</span> <span class="id">H5</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_plus">Z2R_plus</a></span>. <span class="id">change</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> 1) <span class="kwd">with</span> 1%<span class="id">R</span>. <span class="id">lra</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_rnd_odd.html#Zrnd_odd">Zrnd_odd</a></span>. <span class="tactic">destruct</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Req_EM_T">Req_EM_T</a></span>.<br/>
- <span class="tactic">assert</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> <span class="id">r</span> * <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow">bpow</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> (-<span class="id">p</span>) = 0)%<span class="id">R</span>.<br/>
&nbsp;&nbsp;{ <span class="tactic">rewrite</span> <span class="id">H8</span> <span class="kwd">in</span> <span class="id">e</span>. <span class="tactic">rewrite</span> <span class="id">e</span> <span class="kwd">in</span> <span class="id">H5</span>. <span class="id">lra</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_integral">Rmult_integral</a></span> <span class="kwd">in</span> <span class="id">H9</span>. <span class="tactic">destruct</span> <span class="id">H9</span>; [ | <span class="id">lra</span> ].<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#eq_Z2R">eq_Z2R</a></span> <span class="id">r</span> 0) <span class="kwd">in</span> <span class="id">H9</span>. <span class="tactic">apply</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.eqb_eq">Z.eqb_eq</a></span> <span class="kwd">in</span> <span class="id">H9</span>. <span class="tactic">rewrite</span> <span class="id">H9</span>. <span class="tactic">assumption</span>.<br/>
- <span class="tactic">assert</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> <span class="id">r</span> * <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow">bpow</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> (-<span class="id">p</span>) &lt;&gt; 0)%<span class="id">R</span>.<br/>
&nbsp;&nbsp;{ <span class="tactic">rewrite</span> <span class="id">H8</span> <span class="kwd">in</span> <span class="id">n0</span>. <span class="id">lra</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.eqb">Z.eqb</a></span> <span class="id">r</span> 0) <span class="id">eqn</span>:<span class="id">RZ</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.eqb_eq">Z.eqb_eq</a></span> <span class="kwd">in</span> <span class="id">RZ</span>. <span class="tactic">rewrite</span> <span class="id">RZ</span> <span class="kwd">in</span> <span class="id">H9</span>. <span class="id">change</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> 0) <span class="kwd">with</span> 0%<span class="id">R</span> <span class="kwd">in</span> <span class="id">H9</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_0_l">Rmult_0_l</a></span> <span class="kwd">in</span> <span class="id">H9</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Zceil_floor_neq">Zceil_floor_neq</a></span> <span class="tactic">by</span> <span class="id">lra</span>. <span class="tactic">rewrite</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;<span class="id">change</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zeven">Zeven</a></span> <span class="kwd">with</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.even">Z.even</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zeven.html#Zodd_even_bool">Zodd_even_bool</a></span>. <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.even">Z.even</a></span> <span class="id">q</span>); <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="int_round_odd_le">int_round_odd_le</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">p</span> <span class="id">x</span> <span class="id">y</span>, 0 &lt;= <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#p">p</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span> &lt;= <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#y">y</a></span> -&gt; <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#int_round_odd">int_round_odd</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#p">p</a></span> &lt;= <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#int_round_odd">int_round_odd</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#y">y</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#p">p</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof844')">Proof.</div>
<div class="proofscript" id="proof844">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="compcert.flocq.Appli.Fappli_rnd_odd.html#Zrnd_odd">Zrnd_odd</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> <span class="id">x</span> * <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow">bpow</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> (-<span class="id">p</span>)) &lt;= <span class="id"><a href="compcert.flocq.Appli.Fappli_rnd_odd.html#Zrnd_odd">Zrnd_odd</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> <span class="id">y</span> * <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow">bpow</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> (-<span class="id">p</span>))).<br/>
&nbsp;&nbsp;{ <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#Zrnd_le">Zrnd_le</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_rnd_odd.html#valid_rnd_odd">valid_rnd_odd</a></span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat_r">Rmult_le_compat_r</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow_ge_0">bpow_ge_0</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_le">Z2R_le</a></span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- ! <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Zrnd_odd_int">Zrnd_odd_int</a></span> <span class="tactic">by</span> <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zmult_le_compat_r">Zmult_le_compat_r</a></span>. <span class="tactic">auto</span>. <span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zpower_ge_0">Zpower_ge_0</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span>).<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="int_round_odd_exact">int_round_odd_exact</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">p</span> <span class="id">x</span>, 0 &lt;= <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#p">p</a></span> -&gt;<br/>
&nbsp;&nbsp;(2^<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#p">p</a></span> | <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span>) -&gt; <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#int_round_odd">int_round_odd</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#p">p</a></span> = <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof845')">Proof.</div>
<div class="proofscript" id="proof845">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#int_round_odd">int_round_odd</a></span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Znumtheory.html#Zdivide_mod">Znumtheory.Zdivide_mod</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H0</span>. <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.mul_comm">Z.mul_comm</a></span>. <span class="tactic">symmetry</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zdiv.html#Z_div_exact_2">Z_div_exact_2</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.lt_gt">Z.lt_gt</a></span>. <span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zpower_gt_0">Zpower_gt_0</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span>). <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="BofZ_round_odd">BofZ_round_odd</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span> &gt; 1 -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.abs">Z.abs</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span> &lt;= 2^<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span> - 2^(<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span>-<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span>) -&gt;<br/>
&nbsp;&nbsp;0 &lt;= <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#p">p</a></span> &lt;= <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span> - <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span> -&gt;<br/>
&nbsp;&nbsp;2^(<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span> + <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#p">p</a></span> + 1) &lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.abs">Z.abs</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ">BofZ</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span> = <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ">BofZ</a></span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#int_round_odd">int_round_odd</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#p">p</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof846')">Proof.</div>
<div class="proofscript" id="proof846">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">x</span> <span class="id">p</span> <span class="id">PREC</span> <span class="id">XRANGE</span> <span class="id">PRANGE</span> <span class="id">XGE</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">DIV</span>: (2^<span class="id">p</span> | 2^<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span> - 2^(<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span> - <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span>))).<br/>
&nbsp;&nbsp;{ <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.int_upper_bound_eq">int_upper_bound_eq</a></span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_mul_r">Z.divide_mul_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> (2^(<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span> - <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span> - <span class="id">p</span>)). <span class="tactic">red</span> <span class="kwd">in</span> <span class="id">prec_gt_0_</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zpower_plus">Zpower_plus</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span>) <span class="tactic">by</span> <span class="tactic">omega</span>. <span class="tactic">f_equal</span>; <span class="tactic">omega</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">YRANGE</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.abs">Z.abs</a></span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#int_round_odd">int_round_odd</a></span> <span class="id">x</span> <span class="id">p</span>) &lt;= 2^<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span> - 2^(<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span>-<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span>)).<br/>
&nbsp;&nbsp;{ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.abs_le">Z.abs_le</a></span>. <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (-(2^<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span> - 2^(<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span>-<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span>))) <span class="kwd">with</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#int_round_odd">int_round_odd</a></span> (-(2^<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span> - 2^(<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span>-<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span>))) <span class="id">p</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#int_round_odd_le">int_round_odd_le</a></span>; <span class="id">zify</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#int_round_odd_exact">int_round_odd_exact</a></span>. <span class="tactic">omega</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_opp_r">Z.divide_opp_r</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (2^<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span> - 2^(<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span>-<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span>)) <span class="kwd">with</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#int_round_odd">int_round_odd</a></span> (2^<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span> - 2^(<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span>-<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span>)) <span class="id">p</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#int_round_odd_le">int_round_odd_le</a></span>; <span class="id">zify</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#int_round_odd_exact">int_round_odd_exact</a></span>. <span class="tactic">omega</span>. <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ_finite">BofZ_finite</a></span> <span class="id">x</span> <span class="id">XRANGE</span>) <span class="kwd">as</span> (<span class="id">X1</span> &amp; <span class="id">X2</span> &amp; <span class="id">X3</span>).<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ_finite">BofZ_finite</a></span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#int_round_odd">int_round_odd</a></span> <span class="id">x</span> <span class="id">p</span>) <span class="id">YRANGE</span>) <span class="kwd">as</span> (<span class="id">Y1</span> &amp; <span class="id">Y2</span> &amp; <span class="id">Y3</span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ_finite_equal">BofZ_finite_equal</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">X1</span>, <span class="id">Y1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#int_round_odd">int_round_odd</a></span> <span class="id">x</span> <span class="id">p</span>) = <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_FIX.html#FIX_exp">FIX_exp</a></span> <span class="id">p</span>) <span class="id"><a href="compcert.flocq.Appli.Fappli_rnd_odd.html#Zrnd_odd">Zrnd_odd</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> <span class="id">x</span>)).<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#round">round</a></span>, <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#scaled_mantissa">scaled_mantissa</a></span>, <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#canonic_exp">canonic_exp</a></span>, <span class="id"><a href="compcert.flocq.Core.Fcore_FIX.html#FIX_exp">FIX_exp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Zrnd_odd_int">Zrnd_odd_int</a></span> <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#F2R">F2R</a></span>; <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_mult">Z2R_mult</a></span>. <span class="tactic">f_equal</span>. <span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_Zpower">Z2R_Zpower</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span>). <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span>. <span class="tactic">symmetry</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#round_odd_fix">round_odd_fix</a></span>. <span class="tactic">auto</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_Zpower">Z2R_Zpower</a></span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_abs">Z2R_abs</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_le">Z2R_le</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span> <span class="kwd">in</span> <span class="id">prec_gt_0_</span>; <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="int_round_odd_shifts">int_round_odd_shifts</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">p</span>, 0 &lt;= <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#p">p</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#int_round_odd">int_round_odd</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#p">p</a></span> =<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.shiftl">Z.shiftl</a></span> (<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.eqb">Z.eqb</a></span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span> <span class="id">mod</span> 2^<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#p">p</a></span>) 0 <span class="kwd">then</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.shiftr">Z.shiftr</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#p">p</a></span> <span class="kwd">else</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.lor">Z.lor</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.shiftr">Z.shiftr</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#p">p</a></span>) 1) <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#p">p</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof847')">Proof.</div>
<div class="proofscript" id="proof847">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#int_round_odd">int_round_odd</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.shiftl_mul_pow2">Z.shiftl_mul_pow2</a></span> <span class="tactic">by</span> <span class="tactic">auto</span>. <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.shiftr_div_pow2">Z.shiftr_div_pow2</a></span> <span class="tactic">by</span> <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">x</span> <span class="id">mod</span> 2^<span class="id">p</span> =? 0) <span class="id">eqn</span>:<span class="id">E</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">n</span>, (<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.odd">Z.odd</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span> <span class="kwd">then</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span> <span class="kwd">else</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span> + 1) = <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.lor">Z.lor</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span> 1).<br/>
&nbsp;&nbsp;{ <span class="tactic">destruct</span> <span class="id">n</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">p0</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">p0</span>; <span class="tactic">auto</span>. <span class="tactic">induction</span> <span class="id">p0</span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id">H0</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="int_round_odd_bits">int_round_odd_bits</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span> <span class="id">p</span>, 0 &lt;= <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#p">p</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">i</span>, 0 &lt;= <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#i">i</a></span> &lt; <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#p">p</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit">Z.testbit</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#y">y</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#i">i</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit">Z.testbit</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#y">y</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#p">p</a></span> = (<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.eqb">Z.eqb</a></span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span> <span class="id">mod</span> 2^<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#p">p</a></span>) 0 <span class="kwd">then</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit">Z.testbit</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#p">p</a></span> <span class="kwd">else</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>) -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">i</span>, <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#p">p</a></span> &lt; <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#i">i</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit">Z.testbit</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#y">y</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#i">i</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.testbit">Z.testbit</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#i">i</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#int_round_odd">int_round_odd</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#p">p</a></span> = <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#y">y</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof848')">Proof.</div>
<div class="proofscript" id="proof848">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> <span class="id">p</span>; <span class="tactic">intros</span> <span class="id">PPOS</span> <span class="id">BELOW</span> <span class="id">AT</span> <span class="id">ABOVE</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#int_round_odd_shifts">int_round_odd_shifts</a></span> <span class="tactic">by</span> <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">Z.bits_inj</span>'. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zcompare_spec">Zcompare_spec</a></span> <span class="id">n</span> <span class="id">p</span>); <span class="tactic">intros</span> <span class="id">SPEC</span>; <span class="tactic">inversion</span> <span class="id">SPEC</span>.<br/>
- <span class="tactic">rewrite</span> <span class="id">BELOW</span> <span class="tactic">by</span> <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.shiftl_spec_low">Z.shiftl_spec_low</a></span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">subst</span> <span class="id">n</span>. <span class="tactic">rewrite</span> <span class="id">AT</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.shiftl_spec_high">Z.shiftl_spec_high</a></span> <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">p</span> - <span class="id">p</span>) <span class="kwd">with</span> 0 <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">x</span> <span class="id">mod</span> 2^<span class="id">p</span> =? 0).<br/>
&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.shiftr_spec">Z.shiftr_spec</a></span> <span class="tactic">by</span> <span class="tactic">omega</span>. <span class="tactic">f_equal</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.lor_spec">Z.lor_spec</a></span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Bool.Bool.html#orb_true_r">orb_true_r</a></span>.<br/>
- <span class="tactic">rewrite</span> <span class="id">ABOVE</span> <span class="tactic">by</span> <span class="tactic">auto</span>.  <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.shiftl_spec_high">Z.shiftl_spec_high</a></span> <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">x</span> <span class="id">mod</span> 2^<span class="id">p</span> =? 0).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.shiftr_spec">Z.shiftr_spec</a></span> <span class="tactic">by</span> <span class="tactic">omega</span>. <span class="tactic">f_equal</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.lor_spec">Z.lor_spec</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.shiftr_spec">Z.shiftr_spec</a></span> <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="id">change</span> 1 <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ones">Z.ones</a></span> 1). <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ones_spec_high">Z.ones_spec_high</a></span> <span class="tactic">by</span> <span class="tactic">omega</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Bool.Bool.html#orb_false_r">orb_false_r</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">f_equal</span>; <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<h2> Conversion from a FP number to an integer </h2>
<br/>
<div class="doc">Always rounds toward zero. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="ZofB">ZofB</a></span> (<span class="id">f</span>: <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.binary_float">binary_float</a></span>): <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#f">f</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B754_finite">B754_finite</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">s</span> <span class="id">m</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Zpos">Zpos</a></span> <span class="id">e</span>) <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#cond_Zopp">cond_Zopp</a></span> <span class="id">s</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Zpos">Zpos</a></span> <span class="id">m</span>) * <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pow_pos">Z.pow_pos</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> <span class="id">e</span>)%<span class="id">Z</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B754_finite">B754_finite</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">s</span> <span class="id">m</span> 0 <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#cond_Zopp">cond_Zopp</a></span> <span class="id">s</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Zpos">Zpos</a></span> <span class="id">m</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B754_finite">B754_finite</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">s</span> <span class="id">m</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Zneg">Zneg</a></span> <span class="id">e</span>) <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#cond_Zopp">cond_Zopp</a></span> <span class="id">s</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Zpos">Zpos</a></span> <span class="id">m</span> / <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pow_pos">Z.pow_pos</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> <span class="id">e</span>))%<span class="id">Z</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B754_zero">B754_zero</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> 0%<span class="id">Z</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="ZofB_correct">ZofB_correct</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#ZofB">ZofB</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#f">f</a></span> = <span class="kwd">if</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#is_finite">is_finite</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#f">f</a></span> <span class="kwd">then</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Ztrunc">Ztrunc</a></span> (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2R">B2R</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#f">f</a></span>)) <span class="kwd">else</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof849')">Proof.</div>
<div class="proofscript" id="proof849">
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">f</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">f_equal</span>. <span class="tactic">symmetry</span>. <span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Ztrunc_Z2R">Ztrunc_Z2R</a></span> 0).<br/>
- <span class="tactic">destruct</span> <span class="id">e</span>; <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#F2R">F2R</a></span>; <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_1_r">Rmult_1_r</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Ztrunc_Z2R">Ztrunc_Z2R</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#F2R">F2R</a></span>; <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_mult">Z2R_mult</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Ztrunc_Z2R">Ztrunc_Z2R</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#F2R">F2R</a></span>; <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_cond_Zopp">Z2R_cond_Zopp</a></span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#cond_Ropp_mult_l">cond_Ropp_mult_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">EQ</span>: <span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Ztrunc">Ztrunc</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#cond_Ropp">cond_Ropp</a></span> <span class="id">b</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span>) = <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#cond_Zopp">cond_Zopp</a></span> <span class="id">b</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Ztrunc">Ztrunc</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">b</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Ztrunc_opp">Ztrunc_opp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">EQ</span>. <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zpower_pos_gt_0">Zpower_pos_gt_0</a></span> 2 <span class="id">p</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span> <span class="id">_</span>)); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Ztrunc_floor">Ztrunc_floor</a></span>. <span class="tactic">symmetry</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Zfloor_div">Zfloor_div</a></span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_pos">Rmult_le_pos</a></span>. <span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_le">Z2R_le</a></span> 0). <span class="tactic">compute</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rinv_0_lt_compat">Rinv_0_lt_compat</a></span>. <span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_lt">Z2R_lt</a></span> 0). <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Interval properties. </div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="Ztrunc_range_pos">Ztrunc_range_pos</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span>, 0 &lt; <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Ztrunc">Ztrunc</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span> -&gt; (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Ztrunc">Ztrunc</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span>) &lt;= <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span> &lt; <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Ztrunc">Ztrunc</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span> + 1)%<span class="id">Z</span>)%<span class="id">R</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof850')">Proof.</div>
<div class="proofscript" id="proof850">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Ztrunc_floor">Ztrunc_floor</a></span>. <span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Zfloor_lb">Zfloor_lb</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_plus">Z2R_plus</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Zfloor_ub">Zfloor_ub</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rle_bool_spec">Rle_bool_spec</a></span> 0%<span class="id">R</span> <span class="id">x</span>). <span class="tactic">intros</span> <span class="id">RLE</span>; <span class="tactic">inversion</span> <span class="id">RLE</span>; <span class="tactic">subst</span>; <span class="tactic">clear</span> <span class="id">RLE</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Ztrunc_ceil">Ztrunc_ceil</a></span> <span class="kwd">in</span> <span class="id">H</span> <span class="tactic">by</span> <span class="id">lra</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Zceil">Zceil</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (-<span class="id">x</span> &lt; 0)%<span class="id">R</span>.<br/>
&nbsp;&nbsp;{ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Zfloor">Zfloor</a></span> (-<span class="id">x</span>)) + 1)%<span class="id">R</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Zfloor_ub">Zfloor_ub</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">change</span> 0%<span class="id">R</span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> 0). <span class="id">change</span> 1%<span class="id">R</span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> 1). <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_plus">Z2R_plus</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_le">Z2R_le</a></span>. <span class="tactic">omega</span>. }<br/>
&nbsp;&nbsp;<span class="id">lra</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="Ztrunc_range_zero">Ztrunc_range_zero</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span>, <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Ztrunc">Ztrunc</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span> = 0 -&gt; (-1 &lt; <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span> &lt; 1)%<span class="id">R</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof851')">Proof.</div>
<div class="proofscript" id="proof851">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">generalize</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rle_bool_spec">Rle_bool_spec</a></span> 0%<span class="id">R</span> <span class="id">x</span>). <span class="tactic">intros</span> <span class="id">RLE</span>; <span class="tactic">inversion</span> <span class="id">RLE</span>; <span class="tactic">subst</span>; <span class="tactic">clear</span> <span class="id">RLE</span>.<br/>
- <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Ztrunc_floor">Ztrunc_floor</a></span> <span class="kwd">in</span> <span class="id">H</span> <span class="tactic">by</span> <span class="tactic">auto</span>. <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="kwd">with</span> 0%<span class="id">R</span>; <span class="tactic">auto</span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_0">Ropp_0</a></span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_lt_contravar">Ropp_lt_contravar</a></span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_0_1">Rlt_0_1</a></span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">replace</span> 1%<span class="id">R</span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Zfloor">Zfloor</a></span> <span class="id">x</span>) + 1)%<span class="id">R</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Zfloor_ub">Zfloor_ub</a></span>. <span class="tactic">rewrite</span> <span class="id">H</span>. <span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_0_l">Rplus_0_l</a></span>.<br/>
- <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Ztrunc_ceil">Ztrunc_ceil</a></span> <span class="kwd">in</span> <span class="id">H</span> <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>; <span class="tactic">auto</span>). <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">apply</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_lt_cancel">Ropp_lt_cancel</a></span> (-(1))). <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_involutive">Ropp_involutive</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> 1%<span class="id">R</span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Zfloor">Zfloor</a></span> (-<span class="id">x</span>)) + 1)%<span class="id">R</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Zfloor_ub">Zfloor_ub</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Zceil">Zceil</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">replace</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Zfloor">Zfloor</a></span> (-<span class="id">x</span>)) <span class="kwd">with</span> 0 <span class="tactic">by</span> <span class="tactic">omega</span>. <span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_0_l">Rplus_0_l</a></span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="kwd">with</span> 0%<span class="id">R</span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_0_1">Rle_0_1</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="ZofB_range_pos">ZofB_range_pos</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">n</span>, <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#ZofB">ZofB</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#f">f</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span> -&gt; 0 &lt; <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span> -&gt; (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span> &lt;= <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2R">B2R</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#f">f</a></span> &lt; <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span> + 1)%<span class="id">Z</span>)%<span class="id">R</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof852')">Proof.</div>
<div class="proofscript" id="proof852">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#ZofB_correct">ZofB_correct</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#is_finite">is_finite</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span> <span class="id">f</span>) <span class="id">eqn</span>:<span class="id">FIN</span>; <span class="tactic">inversion</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Ztrunc_range_pos">Ztrunc_range_pos</a></span>. <span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="ZofB_range_neg">ZofB_range_neg</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">n</span>, <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#ZofB">ZofB</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#f">f</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span> -&gt; <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span> &lt; 0 -&gt; (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span> - 1)%<span class="id">Z</span> &lt; <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2R">B2R</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#f">f</a></span> &lt;= <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span>)%<span class="id">R</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof853')">Proof.</div>
<div class="proofscript" id="proof853">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#ZofB_correct">ZofB_correct</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#is_finite">is_finite</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span> <span class="id">f</span>) <span class="id">eqn</span>:<span class="id">FIN</span>; <span class="tactic">inversion</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">x</span> := <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2R">B2R</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span> <span class="id">f</span>) <span class="kwd">in</span> *. <span class="tactic">set</span> (<span class="id">y</span> := (-<span class="id">x</span>)%<span class="id">R</span>).<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">A</span>: (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Ztrunc">Ztrunc</a></span> <span class="id">y</span>) &lt;= <span class="id">y</span> &lt; <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Ztrunc">Ztrunc</a></span> <span class="id">y</span> + 1)%<span class="id">Z</span>)%<span class="id">R</span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Ztrunc_range_pos">Ztrunc_range_pos</a></span>. <span class="tactic">unfold</span> <span class="id">y</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Ztrunc_opp">Ztrunc_opp</a></span>. <span class="tactic">omega</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">A</span> <span class="kwd">as</span> [<span class="id">B</span> <span class="id">C</span>].<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">y</span> <span class="kwd">in</span> <span class="id">B</span>, <span class="id">C</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Ztrunc_opp">Ztrunc_opp</a></span> <span class="kwd">in</span> <span class="id">B</span>, <span class="id">C</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (- <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Ztrunc">Ztrunc</a></span> <span class="id">x</span> + 1) <span class="kwd">with</span> (- (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Ztrunc">Ztrunc</a></span> <span class="id">x</span> - 1)) <span class="kwd">in</span> <span class="id">C</span> <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_opp">Z2R_opp</a></span> <span class="kwd">in</span> <span class="id">B</span>, <span class="id">C</span>. <span class="id">lra</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="ZofB_range_zero">ZofB_range_zero</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span>, <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#ZofB">ZofB</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#f">f</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> 0 -&gt; (-1 &lt; <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2R">B2R</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#f">f</a></span> &lt; 1)%<span class="id">R</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof854')">Proof.</div>
<div class="proofscript" id="proof854">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#ZofB_correct">ZofB_correct</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#is_finite">is_finite</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span> <span class="id">f</span>) <span class="id">eqn</span>:<span class="id">FIN</span>; <span class="tactic">inversion</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Ztrunc_range_zero">Ztrunc_range_zero</a></span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="ZofB_range_nonneg">ZofB_range_nonneg</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">n</span>, <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#ZofB">ZofB</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#f">f</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span> -&gt; 0 &lt;= <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span> -&gt; (-1 &lt; <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2R">B2R</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#f">f</a></span> &lt; <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span> + 1)%<span class="id">Z</span>)%<span class="id">R</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof855')">Proof.</div>
<div class="proofscript" id="proof855">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.eq_dec">Z.eq_dec</a></span> <span class="id">n</span> 0).<br/>
- <span class="tactic">subst</span> <span class="id">n</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#ZofB_range_zero">ZofB_range_zero</a></span>. <span class="tactic">auto</span>.<br/>
- <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#ZofB_range_pos">ZofB_range_pos</a></span> <span class="id">f</span> <span class="id">n</span>) <span class="kwd">as</span> (<span class="id">A</span> &amp; <span class="id">B</span>). <span class="tactic">auto</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> 0). <span class="tactic">simpl</span>; <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> <span class="id">n</span>); <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_le">Z2R_le</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">For representable integers, <span class="bracket"><span class="id">ZofB</span></span> is left inverse of <span class="bracket"><span class="id">BofZ</span></span>. </div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="ZofBofZ_exact">ZofBofZ_exact</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span>, <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#integer_representable">integer_representable</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span> -&gt; <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#ZofB">ZofB</a></span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ">BofZ</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof856')">Proof.</div>
<div class="proofscript" id="proof856">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ_representable">BofZ_representable</a></span> <span class="id">n</span> <span class="id">H</span>) <span class="kwd">as</span> (<span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#ZofB_correct">ZofB_correct</a></span>. <span class="tactic">rewrite</span> <span class="id">A</span>, <span class="id">B</span>. <span class="tactic">f_equal</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Ztrunc_Z2R">Ztrunc_Z2R</a></span>.<br/>
Qed.</div>
<br/>
<div class="doc">Compatibility with subtraction </div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="Zfloor_minus">Zfloor_minus</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">n</span>, <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Zfloor">Zfloor</a></span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span> - <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span>) = <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Zfloor">Zfloor</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span> - <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof857')">Proof.</div>
<div class="proofscript" id="proof857">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Zfloor_imp">Zfloor_imp</a></span>. <span class="tactic">replace</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Zfloor">Zfloor</a></span> <span class="id">x</span> - <span class="id">n</span> + 1) <span class="kwd">with</span> ((<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Zfloor">Zfloor</a></span> <span class="id">x</span> + 1) - <span class="id">n</span>) <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> ! <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_minus">Z2R_minus</a></span>. <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rminus">Rminus</a></span>. <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_le_compat_r">Rplus_le_compat_r</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Zfloor_lb">Zfloor_lb</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rplus_lt_compat_r">Rplus_lt_compat_r</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_plus">Z2R_plus</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Zfloor_ub">Zfloor_ub</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="ZofB_minus">ZofB_minus</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">minus_nan</span> <span class="id">m</span> <span class="id">f</span> <span class="id">p</span> <span class="id">q</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#ZofB">ZofB</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#f">f</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#p">p</a></span> -&gt; 0 &lt;= <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#p">p</a></span> &lt; 2*<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#q">q</a></span> -&gt; <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#q">q</a></span> &lt;= 2^<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span> -&gt; (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#q">q</a></span> &lt;= <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2R">B2R</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#f">f</a></span>)%<span class="id">R</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#ZofB">ZofB</a></span> (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#Bminus">Bminus</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.Hmax">Hmax</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#minus_nan">minus_nan</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#m">m</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#f">f</a></span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ">BofZ</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#q">q</a></span>)) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#p">p</a></span> - <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#q">q</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof858')">Proof.</div>
<div class="proofscript" id="proof858">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Q</span>: -2^<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span> &lt;= <span class="id">q</span> &lt;= 2^<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">split</span>; <span class="tactic">auto</span>.  <span class="tactic">generalize</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zpower_ge_0">Zpower_ge_0</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span>); <span class="tactic">simpl</span>; <span class="tactic">omega</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">RANGE</span>: (-1 &lt; <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2R">B2R</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">f</span> &lt; <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> (<span class="id">p</span> + 1)%<span class="id">Z</span>)%<span class="id">R</span>) <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#ZofB_range_nonneg">ZofB_range_nonneg</a></span>; <span class="tactic">auto</span>; <span class="tactic">omega</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#ZofB_correct">ZofB_correct</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#is_finite">is_finite</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span> <span class="id">f</span>) <span class="id">eqn</span>:<span class="id">FIN</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">PQ2</span>: (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> (<span class="id">p</span> + 1) &lt;= <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> <span class="id">q</span> * 2)%<span class="id">R</span>).<br/>
&nbsp;&nbsp;{ <span class="id">change</span> 2%<span class="id">R</span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> 2). <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_mult">Z2R_mult</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_le">Z2R_le</a></span>. <span class="tactic">omega</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">EXACT</span>: <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.fexp">fexp</a></span> (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#round_mode">round_mode</a></span> <span class="id">m</span>) (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2R">B2R</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">f</span> - <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> <span class="id">q</span>)%<span class="id">R</span> = (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2R">B2R</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">f</span> - <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> <span class="id">q</span>)%<span class="id">R</span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#round_generic">round_generic</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#valid_rnd_round_mode">valid_rnd_round_mode</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Prop.Fprop_Sterbenz.html#sterbenz_aux">sterbenz_aux</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_FLT.html#FLT_exp_monotone">FLT_exp_monotone</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#generic_format_B2R">generic_format_B2R</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#integer_representable_n">integer_representable_n</a></span>. <span class="tactic">auto</span>. <span class="id">lra</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ_exact">BofZ_exact</a></span> <span class="id">q</span> <span class="id">Q</span>) <span class="kwd">as</span> (<span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span>).<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#Bminus_correct">Bminus_correct</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.Hmax">Hmax</a></span> <span class="id">minus_nan</span> <span class="id">m</span> <span class="id">f</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ">BofZ</a></span> <span class="id">q</span>) <span class="id">FIN</span> <span class="id">B</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool_true">Rlt_bool_true</a></span>.<br/>
- <span class="id">fold</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emin">emin</a></span>; <span class="id">fold</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.fexp">fexp</a></span>. <span class="tactic">intros</span> (<span class="id">D</span> &amp; <span class="id">E</span> &amp; <span class="id">F</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#ZofB_correct">ZofB_correct</a></span>. <span class="tactic">rewrite</span> <span class="id">E</span>. <span class="tactic">rewrite</span> <span class="id">D</span>. <span class="tactic">rewrite</span> <span class="id">A</span>. <span class="tactic">rewrite</span> <span class="id">EXACT</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>. <span class="tactic">f_equal</span>. <span class="tactic">rewrite</span> ! <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Ztrunc_floor">Ztrunc_floor</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Zfloor_minus">Zfloor_minus</a></span>.<br/>
&nbsp;&nbsp;<span class="id">lra</span>. <span class="id">lra</span>.<br/>
- <span class="tactic">rewrite</span> <span class="id">A</span>. <span class="id">fold</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emin">emin</a></span>; <span class="id">fold</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.fexp">fexp</a></span>. <span class="tactic">rewrite</span> <span class="id">EXACT</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow">bpow</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> <span class="id">q</span>). <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rabs_le">Rabs_le</a></span>. <span class="id">lra</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_Zpower">Z2R_Zpower</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_le">Z2R_le</a></span>; <span class="tactic">auto</span>. <span class="tactic">red</span> <span class="kwd">in</span> <span class="id">prec_gt_0_</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow_lt">bpow_lt</a></span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">A variant of <span class="bracket"><span class="id">ZofB</span></span> that bounds the range of representable integers. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="ZofB_range">ZofB_range</a></span> (<span class="id">f</span>: <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.binary_float">binary_float</a></span>) (<span class="id">zmin</span> <span class="id">zmax</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>): <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#ZofB">ZofB</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#f">f</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">z</span> =&gt; <span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.leb">Z.leb</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#zmin">zmin</a></span> <span class="id">z</span> &amp;&amp; <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.leb">Z.leb</a></span> <span class="id">z</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#zmax">zmax</a></span> <span class="kwd">then</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">z</span> <span class="kwd">else</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="ZofB_range_correct">ZofB_range_correct</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">min</span> <span class="id">max</span>,<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">n</span> := <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Ztrunc">Ztrunc</a></span> (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2R">B2R</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#f">f</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#ZofB_range">ZofB_range</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#f">f</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#min">min</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#max">max</a></span> =<br/>
&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#is_finite">is_finite</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#f">f</a></span> &amp;&amp; <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.leb">Z.leb</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#min">min</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span> &amp;&amp; <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.leb">Z.leb</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#max">max</a></span> <span class="kwd">then</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span> <span class="kwd">else</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof859')">Proof.</div>
<div class="proofscript" id="proof859">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#ZofB_range">ZofB_range</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#ZofB_correct">ZofB_correct</a></span>. <span class="id">fold</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#is_finite">is_finite</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span> <span class="id">f</span>); <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="ZofB_range_inversion">ZofB_range_inversion</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">min</span> <span class="id">max</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#ZofB_range">ZofB_range</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#f">f</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#min">min</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#max">max</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#min">min</a></span> &lt;= <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span> /\ <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span> &lt;= <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#max">max</a></span> /\ <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#ZofB">ZofB</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#f">f</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof860')">Proof.</div>
<div class="proofscript" id="proof860">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#ZofB_range_correct">ZofB_range_correct</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#ZofB_correct">ZofB_correct</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#is_finite">is_finite</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span> <span class="id">f</span>); <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">n1</span> := <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Ztrunc">Ztrunc</a></span> (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2R">B2R</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">f</span>)) <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">min</span> &lt;=? <span class="id">n1</span>) <span class="id">eqn</span>:<span class="id">MIN</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">n1</span> &lt;=? <span class="id">max</span>) <span class="id">eqn</span>:<span class="id">MAX</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">inversion</span> <span class="id">H</span>. <span class="tactic">subst</span> <span class="id">n</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zle_bool_imp_le">Zle_bool_imp_le</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zle_bool_imp_le">Zle_bool_imp_le</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="ZofB_range_minus">ZofB_range_minus</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">minus_nan</span> <span class="id">m</span> <span class="id">f</span> <span class="id">p</span> <span class="id">q</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#ZofB_range">ZofB_range</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#f">f</a></span> 0 (2 * <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#q">q</a></span> - 1) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#p">p</a></span> -&gt; <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#q">q</a></span> &lt;= 2^<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span> -&gt; (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#q">q</a></span> &lt;= <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2R">B2R</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#f">f</a></span>)%<span class="id">R</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#ZofB_range">ZofB_range</a></span> (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#Bminus">Bminus</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.Hmax">Hmax</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#minus_nan">minus_nan</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#m">m</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#f">f</a></span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ">BofZ</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#q">q</a></span>)) (-<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#q">q</a></span>) (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#q">q</a></span> - 1) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#p">p</a></span> - <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#q">q</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof861')">Proof.</div>
<div class="proofscript" id="proof861">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#ZofB_range_inversion">ZofB_range_inversion</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H</span>) <span class="kwd">as</span> (<span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span>).<br/>
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">f</span>' := <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#Bminus">Bminus</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec_gt_0_">prec_gt_0_</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.Hmax">Hmax</a></span> <span class="id">minus_nan</span> <span class="id">m</span> <span class="id">f</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ">BofZ</a></span> <span class="id">q</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">D</span>: <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#ZofB">ZofB</a></span> <span class="id">f</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id">p</span> - <span class="id">q</span>)).<br/>
&nbsp;&nbsp;{ <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#ZofB_minus">ZofB_minus</a></span>. <span class="tactic">auto</span>. <span class="tactic">omega</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#ZofB_range">ZofB_range</a></span>. <span class="tactic">rewrite</span> <span class="id">D</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zle_bool_true">Zle_bool_true</a></span> <span class="tactic">by</span> <span class="tactic">omega</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zle_bool_true">Zle_bool_true</a></span> <span class="tactic">by</span> <span class="tactic">omega</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<h2> Algebraic identities </h2>
<br/>
<div class="doc">Commutativity of addition and multiplication </div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Bplus_commut">Bplus_commut</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">plus_nan</span> <span class="id">mode</span> (<span class="id">x</span> <span class="id">y</span>: <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.binary_float">binary_float</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#plus_nan">plus_nan</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#y">y</a></span> = <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#plus_nan">plus_nan</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#y">y</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#Bplus">Bplus</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.Hmax">Hmax</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#plus_nan">plus_nan</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#mode">mode</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#y">y</a></span> = <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#Bplus">Bplus</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.Hmax">Hmax</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#plus_nan">plus_nan</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#mode">mode</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#y">y</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof862')">Proof.</div>
<div class="proofscript" id="proof862">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> <span class="id">y</span>; <span class="tactic">intros</span> <span class="id">NAN</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#Bplus_correct">Bplus_correct</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.Hmax">Hmax</a></span> <span class="id">plus_nan</span> <span class="id">mode</span> <span class="id">x</span> <span class="id">y</span>).<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#Bplus_correct">Bplus_correct</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.Hmax">Hmax</a></span> <span class="id">plus_nan</span> <span class="id">mode</span> <span class="id">y</span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#Bplus">Bplus</a></span> <span class="kwd">in</span> *; <span class="tactic">destruct</span> <span class="id">x</span>; <span class="tactic">destruct</span> <span class="id">y</span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">rewrite</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#eqb_sym">eqb_sym</a></span> <span class="id">b0</span> <span class="id">b</span>). <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Bool.Bool.html#eqb">eqb</a></span> <span class="id">b</span> <span class="id">b0</span>) <span class="id">eqn</span>:<span class="id">EQB</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">f_equal</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Bool.Bool.html#eqb_prop">eqb_prop</a></span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">rewrite</span> <span class="id">NAN</span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">rewrite</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#eqb_sym">eqb_sym</a></span> <span class="id">b0</span> <span class="id">b</span>). <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Bool.Bool.html#eqb">eqb</a></span> <span class="id">b</span> <span class="id">b0</span>) <span class="id">eqn</span>:<span class="id">EQB</span>.<br/>
&nbsp;&nbsp;<span class="tactic">f_equal</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Bool.Bool.html#eqb_prop">eqb_prop</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">NAN</span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">rewrite</span> <span class="id">NAN</span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">rewrite</span> <span class="id">NAN</span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">rewrite</span> <span class="id">NAN</span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">rewrite</span> <span class="id">NAN</span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">rewrite</span> <span class="id">NAN</span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">rewrite</span> <span class="id">NAN</span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">generalize</span> (<span class="id">H</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span> <span class="id">_</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span> <span class="id">_</span>)); <span class="tactic">clear</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">H0</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span> <span class="id">_</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span> <span class="id">_</span>)); <span class="tactic">clear</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">fold</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emin">emin</a></span>. <span class="id">fold</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.fexp">fexp</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">x</span> := <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B754_finite">B754_finite</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span> <span class="id">b0</span> <span class="id">m0</span> <span class="id">e1</span> <span class="id">e2</span>). <span class="tactic">set</span> (<span class="id">rx</span> := <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2R">B2R</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">y</span> := <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B754_finite">B754_finite</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span> <span class="id">b</span> <span class="id">m</span> <span class="id">e</span> <span class="id">e0</span>). <span class="tactic">set</span> (<span class="id">ry</span> := <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2R">B2R</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">y</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rplus_comm">Rplus_comm</a></span> <span class="id">ry</span> <span class="id">rx</span>). <span class="tactic">destruct</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool">Rlt_bool</a></span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">intros</span> (<span class="id">A1</span> &amp; <span class="id">A2</span> &amp; <span class="id">A3</span>) (<span class="id">B1</span> &amp; <span class="id">B2</span> &amp; <span class="id">B3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2R_Bsign_inj">B2R_Bsign_inj</a></span>; <span class="tactic">auto</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">B1</span> <span class="kwd">in</span> <span class="id">A1</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.add_comm">Z.add_comm</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.min_comm">Z.min_comm</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">intros</span> (<span class="id">A1</span> &amp; <span class="id">A2</span>) (<span class="id">B1</span> &amp; <span class="id">B2</span>). <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2FF_inj">B2FF_inj</a></span>. <span class="tactic">rewrite</span> <span class="id">B2</span> <span class="kwd">in</span> <span class="id">B1</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">B1</span> <span class="kwd">in</span> <span class="id">A1</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Bmult_commut">Bmult_commut</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">mult_nan</span> <span class="id">mode</span> (<span class="id">x</span> <span class="id">y</span>: <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.binary_float">binary_float</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#mult_nan">mult_nan</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#y">y</a></span> = <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#mult_nan">mult_nan</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#y">y</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#Bmult">Bmult</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.Hmax">Hmax</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#mult_nan">mult_nan</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#mode">mode</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#y">y</a></span> = <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#Bmult">Bmult</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.Hmax">Hmax</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#mult_nan">mult_nan</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#mode">mode</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#y">y</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof863')">Proof.</div>
<div class="proofscript" id="proof863">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> <span class="id">y</span>; <span class="tactic">intros</span> <span class="id">NAN</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#Bmult_correct">Bmult_correct</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.Hmax">Hmax</a></span> <span class="id">mult_nan</span> <span class="id">mode</span> <span class="id">x</span> <span class="id">y</span>).<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#Bmult_correct">Bmult_correct</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.Hmax">Hmax</a></span> <span class="id">mult_nan</span> <span class="id">mode</span> <span class="id">y</span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#Bmult">Bmult</a></span> <span class="kwd">in</span> *; <span class="tactic">destruct</span> <span class="id">x</span>; <span class="tactic">destruct</span> <span class="id">y</span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Bool.Bool.html#xorb_comm">xorb_comm</a></span> <span class="id">b0</span> <span class="id">b</span>); <span class="tactic">auto</span>.<br/>
- <span class="tactic">rewrite</span> <span class="id">NAN</span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">rewrite</span> <span class="id">NAN</span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Bool.Bool.html#xorb_comm">xorb_comm</a></span> <span class="id">b0</span> <span class="id">b</span>); <span class="tactic">auto</span>.<br/>
- <span class="tactic">rewrite</span> <span class="id">NAN</span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Bool.Bool.html#xorb_comm">xorb_comm</a></span> <span class="id">b0</span> <span class="id">b</span>); <span class="tactic">auto</span>.<br/>
- <span class="tactic">rewrite</span> <span class="id">NAN</span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Bool.Bool.html#xorb_comm">xorb_comm</a></span> <span class="id">b0</span> <span class="id">b</span>); <span class="tactic">auto</span>.<br/>
- <span class="tactic">rewrite</span> <span class="id">NAN</span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">rewrite</span> <span class="id">NAN</span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">rewrite</span> <span class="id">NAN</span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">rewrite</span> <span class="id">NAN</span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Bool.Bool.html#xorb_comm">xorb_comm</a></span> <span class="id">b0</span> <span class="id">b</span>); <span class="tactic">auto</span>.<br/>
- <span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Bool.Bool.html#xorb_comm">xorb_comm</a></span> <span class="id">b0</span> <span class="id">b</span>); <span class="tactic">auto</span>.<br/>
- <span class="tactic">rewrite</span> <span class="id">NAN</span>; <span class="tactic">auto</span>.<br/>
- <span class="id">revert</span> <span class="id">H</span> <span class="id">H0</span>. <span class="id">fold</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emin">emin</a></span>. <span class="id">fold</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.fexp">fexp</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">x</span> := <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B754_finite">B754_finite</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span> <span class="id">b0</span> <span class="id">m0</span> <span class="id">e1</span> <span class="id">e2</span>). <span class="tactic">set</span> (<span class="id">rx</span> := <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2R">B2R</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">y</span> := <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B754_finite">B754_finite</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span> <span class="id">b</span> <span class="id">m</span> <span class="id">e</span> <span class="id">e0</span>). <span class="tactic">set</span> (<span class="id">ry</span> := <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2R">B2R</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">y</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_comm">Rmult_comm</a></span> <span class="id">ry</span> <span class="id">rx</span>).<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool">Rlt_bool</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.fexp">fexp</a></span> (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#round_mode">round_mode</a></span> <span class="id">mode</span>) (<span class="id">rx</span> * <span class="id">ry</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow">bpow</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span>)).<br/>
&nbsp;&nbsp;+ <span class="tactic">intros</span> (<span class="id">A1</span> &amp; <span class="id">A2</span> &amp; <span class="id">A3</span>) (<span class="id">B1</span> &amp; <span class="id">B2</span> &amp; <span class="id">B3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2R_Bsign_inj">B2R_Bsign_inj</a></span>; <span class="tactic">auto</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">B1</span> <span class="kwd">in</span> <span class="id">A1</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> ! <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#Bsign_FF2B">Bsign_FF2B</a></span>. <span class="tactic">f_equal</span>. <span class="tactic">f_equal</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Bool.Bool.html#xorb_comm">xorb_comm</a></span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.mul_comm">Pos.mul_comm</a></span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.add_comm">Z.add_comm</a></span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">intros</span> <span class="id">A</span> <span class="id">B</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2FF_inj">B2FF_inj</a></span>. <span class="id">etransitivity</span>. <span class="tactic">eapply</span> <span class="id">A</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Bool.Bool.html#xorb_comm">xorb_comm</a></span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Multiplication by 2 is diagonal addition. </div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Bmult2_Bplus">Bmult2_Bplus</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">plus_nan</span> <span class="id">mult_nan</span> <span class="id">mode</span> (<span class="id">f</span>: <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.binary_float">binary_float</a></span>),<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> (<span class="id">x</span> <span class="id">y</span>: <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.binary_float">binary_float</a></span>),<br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#is_nan">is_nan</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt; <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#is_finite">is_finite</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#y">y</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt; <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#plus_nan">plus_nan</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span> = <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#mult_nan">mult_nan</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#y">y</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#Bplus">Bplus</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.Hmax">Hmax</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#plus_nan">plus_nan</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#mode">mode</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#f">f</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#f">f</a></span> = <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#Bmult">Bmult</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.Hmax">Hmax</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#mult_nan">mult_nan</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#mode">mode</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#f">f</a></span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ">BofZ</a></span> 2%<span class="id">Z</span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof864')">Proof.</div>
<div class="proofscript" id="proof864">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> <span class="id">f</span>; <span class="tactic">intros</span> <span class="id">NAN</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ_representable">BofZ_representable</a></span> 2) <span class="kwd">as</span> (<span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#integer_representable_2p">integer_representable_2p</a></span> 1). <span class="tactic">red</span> <span class="kwd">in</span> <span class="id">prec_gt_0_</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#Bmult_correct">Bmult_correct</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.Hmax">Hmax</a></span> <span class="id">mult_nan</span> <span class="id">mode</span> <span class="id">f</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ">BofZ</a></span> 2%<span class="id">Z</span>)). <span class="id">fold</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emin">emin</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">A</span>, <span class="id">B</span>, <span class="id">C</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Bool.Bool.html#xorb_false_r">xorb_false_r</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#is_finite">is_finite</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">f</span>) <span class="id">eqn</span>:<span class="id">FIN</span>.<br/>
- <span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#Bplus_correct">Bplus_correct</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.Hmax">Hmax</a></span> <span class="id">plus_nan</span> <span class="id">mode</span> <span class="id">f</span> <span class="id">f</span> <span class="id">FIN</span> <span class="id">FIN</span>). <span class="id">fold</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emin">emin</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">EQ</span>: (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2R">B2R</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span> <span class="id">f</span> * <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> 2%<span class="id">Z</span> = <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2R">B2R</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span> <span class="id">f</span> + <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2R">B2R</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span> <span class="id">f</span>)%<span class="id">R</span>).<br/>
&nbsp;&nbsp;{ <span class="id">change</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> 2%<span class="id">Z</span>) <span class="kwd">with</span> 2%<span class="id">R</span>. <span class="tactic">ring</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">EQ</span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="tactic">destruct</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool">Rlt_bool</a></span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">destruct</span> <span class="id">H0</span> <span class="kwd">as</span> (<span class="id">P</span> &amp; <span class="id">Q</span> &amp; <span class="id">R</span>). <span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> (<span class="id">S</span> &amp; <span class="id">T</span> &amp; <span class="id">U</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2R_Bsign_inj">B2R_Bsign_inj</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">P</span>, <span class="id">S</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">R</span>, <span class="id">U</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> 0%<span class="id">R</span> <span class="kwd">with</span> (0 * <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> 2%<span class="id">Z</span>)%<span class="id">R</span> <span class="tactic">by</span> <span class="tactic">ring</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rcompare_mult_r">Rcompare_mult_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Bool.Bool.html#andb_diag">andb_diag</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Bool.Bool.html#orb_diag">orb_diag</a></span>. <span class="tactic">destruct</span> <span class="id">f</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rcompare_Eq">Rcompare_Eq</a></span> <span class="tactic">by</span> <span class="tactic">auto</span>. <span class="tactic">destruct</span> <span class="id">mode</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> 0%<span class="id">R</span> <span class="kwd">with</span> (@<span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#F2R">F2R</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> {| <span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#Float">Fnum</a></span> := 0%<span class="id">Z</span>; <span class="id">Fexp</span> := <span class="id">e</span> |}).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_float_prop.html#Rcompare_F2R">Rcompare_F2R</a></span>. <span class="tactic">destruct</span> <span class="id">b</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#F2R">F2R</a></span>. <span class="tactic">simpl</span>. <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">change</span> 0%<span class="id">R</span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> 0%<span class="id">Z</span>). <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_lt">Z2R_lt</a></span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#Bmult">Bmult</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec_gt_0_">prec_gt_0_</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.Hmax">Hmax</a></span> <span class="id">mult_nan</span> <span class="id">mode</span> <span class="id">f</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ">BofZ</a></span> 2)); <span class="tactic">reflexivity</span> || <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">destruct</span> <span class="id">H0</span> <span class="kwd">as</span> (<span class="id">P</span> &amp; <span class="id">Q</span>). <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2FF_inj">B2FF_inj</a></span>. <span class="tactic">rewrite</span> <span class="id">P</span>, <span class="id">H</span>. <span class="tactic">auto</span>.<br/>
- <span class="tactic">destruct</span> <span class="id">f</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">simpl</span> <span class="id">Bplus</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#eqb_true">eqb_true</a></span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ">BofZ</a></span> 2) <span class="id">eqn</span>:<span class="id">B2</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> ((0 = 2)%<span class="id">Z</span>) <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#eq_Z2R">eq_Z2R</a></span>; <span class="tactic">auto</span>). <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">b0</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Bool.Bool.html#xorb_false_r">xorb_false_r</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#Bplus">Bplus</a></span>, <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#Bmult">Bmult</a></span>. <span class="tactic">rewrite</span> &lt;- <span class="id">NAN</span> <span class="tactic">by</span> <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Divisions that can be turned into multiplications by an inverse </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Bexact_inverse_mantissa">Bexact_inverse_mantissa</a></span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.iter">Z.iter</a></span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span> - 1) <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#xO">xO</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#xH">xH</a></span>.<br/>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="Bexact_inverse_mantissa_value">Bexact_inverse_mantissa_value</a></span>:<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Zpos">Zpos</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Bexact_inverse_mantissa">Bexact_inverse_mantissa</a></span> = 2 ^ (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span> - 1).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof865')">Proof.</div>
<div class="proofscript" id="proof865">
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">REC</span>: <span class="kwd">forall</span> <span class="id">n</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pos">Z.pos</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat_rect">nat_rect</a></span> <span class="id">_</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#xH">xH</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#xO">xO</a></span>) <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span>) = 2 ^ (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.of_nat">Z.of_nat</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span>)).<br/>
&nbsp;&nbsp;{ <span class="tactic">induction</span> <span class="id">n</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="id">nat_rect</span>. <span class="tactic">transitivity</span> (2 * <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pos">Z.pos</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat_rect">nat_rect</a></span> <span class="id">_</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#xH">xH</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#xO">xO</a></span>) <span class="id">n</span>)). <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Znat.html#Nat2Z.inj_succ">Nat2Z.inj_succ</a></span>. <span class="tactic">rewrite</span> <span class="id">IHn</span>. <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.succ">Z.succ</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zpower_plus">Zpower_plus</a></span> <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">change</span> (2 ^ 1) <span class="kwd">with</span> 2. <span class="tactic">ring</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">red</span> <span class="kwd">in</span> <span class="id">prec_gt_0_</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Bexact_inverse_mantissa">Bexact_inverse_mantissa</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zmisc.html#iter_nat_of_Z">iter_nat_of_Z</a></span> <span class="tactic">by</span> <span class="tactic">omega</span>. <span class="tactic">rewrite</span> <span class="id">REC</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Znat.html#Zabs2Nat.id_abs">Zabs2Nat.id_abs</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.abs_eq">Z.abs_eq</a></span> <span class="tactic">by</span> <span class="tactic">omega</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="Bexact_inverse_mantissa_digits2_pos">Bexact_inverse_mantissa_digits2_pos</a></span>:<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pos">Z.pos</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_digits.html#digits2_pos">digits2_pos</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Bexact_inverse_mantissa">Bexact_inverse_mantissa</a></span>) = <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof866')">Proof.</div>
<div class="proofscript" id="proof866">
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">DIGITS</span>: <span class="kwd">forall</span> <span class="id">n</span>, <span class="id"><a href="compcert.flocq.Core.Fcore_digits.html#digits2_pos">digits2_pos</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat_rect">nat_rect</a></span> <span class="id">_</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#xH">xH</a></span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#xO">xO</a></span>) <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.of_nat">Pos.of_nat</a></span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span>+1)).<br/>
&nbsp;&nbsp;{ <span class="tactic">induction</span> <span class="id">n</span>; <span class="tactic">simpl</span>. <span class="tactic">auto</span>. <span class="tactic">rewrite</span> <span class="id">IHn</span>. <span class="tactic">destruct</span> <span class="id">n</span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">red</span> <span class="kwd">in</span> <span class="id">prec_gt_0_</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Bexact_inverse_mantissa">Bexact_inverse_mantissa</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zmisc.html#iter_nat_of_Z">iter_nat_of_Z</a></span> <span class="tactic">by</span> <span class="tactic">omega</span>. <span class="tactic">rewrite</span> <span class="id">DIGITS</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Znat.html#Zabs2Nat.abs_nat_nonneg">Zabs2Nat.abs_nat_nonneg</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Znat.html#Z2Nat.inj_sub">Z2Nat.inj_sub</a></span> <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span>; <span class="tactic">try</span>  <span class="tactic">discriminate</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.PeanoNat.html#Nat.sub_add">Nat.sub_add</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.Pnat.html#Pos2Nat.id">Pos2Nat.id</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="id">zify</span>; <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="bounded_Bexact_inverse">bounded_Bexact_inverse</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">e</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emin">emin</a></span> &lt;= <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#e">e</a></span> &lt;= <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span> - <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span> &lt;-&gt; <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#bounded">bounded</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Bexact_inverse_mantissa">Bexact_inverse_mantissa</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#e">e</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof867')">Proof.</div>
<div class="proofscript" id="proof867">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#bounded">bounded</a></span>, <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#canonic_mantissa">canonic_mantissa</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Bool.Bool.html#andb_true_iff">andb_true_iff</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zeq_is_eq_bool">Zeq_is_eq_bool</a></span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zle_is_le_bool">Zle_is_le_bool</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Bexact_inverse_mantissa_digits2_pos">Bexact_inverse_mantissa_digits2_pos</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
- <span class="tactic">intros</span>; <span class="tactic">split</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Fcore_FLT.html#FLT_exp">FLT_exp</a></span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#emin">emin</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="id">zify</span>; <span class="tactic">omega</span>. <span class="tactic">omega</span>.<br/>
- <span class="tactic">intros</span> [<span class="id">A</span> <span class="id">B</span>]. <span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Fcore_FLT.html#FLT_exp">FLT_exp</a></span> <span class="kwd">in</span> <span class="id">A</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#emin">emin</a></span>. <span class="id">zify</span>; <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Program</span> <span class="kwd">Definition</span> <span class="id"><a name="Bexact_inverse">Bexact_inverse</a></span> (<span class="id">f</span>: <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.binary_float">binary_float</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.binary_float">binary_float</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#f">f</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B754_finite">B754_finite</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">s</span> <span class="id">m</span> <span class="id">e</span> <span class="id">B</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.eq_dec">Pos.eq_dec</a></span> <span class="id">m</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Bexact_inverse_mantissa">Bexact_inverse_mantissa</a></span> <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">e</span>' := -<span class="id">e</span> - (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span> - 1) * 2 <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.ZArith_dec.html#Z_le_dec">Z_le_dec</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emin">emin</a></span> <span class="id">e</span>' <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.ZArith_dec.html#Z_le_dec">Z_le_dec</a></span> <span class="id">e</span>' <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span> <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B754_finite">B754_finite</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">s</span> <span class="id">m</span> <span class="id">e</span>' <span class="id">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> <span class="kwd">else</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> <span class="kwd">else</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof868')">Next Obligation.</div>
<div class="proofscript" id="proof868">
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#bounded_Bexact_inverse">bounded_Bexact_inverse</a></span> <span class="kwd">in</span> <span class="id">B</span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#bounded_Bexact_inverse">bounded_Bexact_inverse</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#emin">emin</a></span> <span class="kwd">in</span> *. <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Bexact_inverse_correct">Bexact_inverse_correct</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">f</span>', <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Bexact_inverse">Bexact_inverse</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#f">f</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">f</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#is_finite_strict">is_finite_strict</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#f">f</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span><br/>
&nbsp;&nbsp;/\ <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#is_finite_strict">is_finite_strict</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">f</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span><br/>
&nbsp;&nbsp;/\ <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2R">B2R</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">f</span>' = (/ <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2R">B2R</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#f">f</a></span>)%<span class="id">R</span><br/>
&nbsp;&nbsp;/\ <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2R">B2R</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#f">f</a></span> &lt;&gt; 0%<span class="id">R</span><br/>
&nbsp;&nbsp;/\ <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#Bsign">Bsign</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">f</span>' = <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#Bsign">Bsign</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#f">f</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof869')">Proof with</div>
<div class="proofscript" id="proof869">
 (<span class="tactic">try</span> <span class="tactic">discriminate</span>).<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">f</span> <span class="id">f</span>' <span class="id">EI</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Bexact_inverse">Bexact_inverse</a></span> <span class="kwd">in</span> <span class="id">EI</span>. <span class="tactic">destruct</span> <span class="id">f</span>...<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.eq_dec">Pos.eq_dec</a></span> <span class="id">m</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Bexact_inverse_mantissa">Bexact_inverse_mantissa</a></span>)...<br/>
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">e</span>' := -<span class="id">e</span> - (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span> - 1) * 2) <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.ZArith_dec.html#Z_le_dec">Z_le_dec</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emin">emin</a></span> <span class="id">e</span>')...<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.ZArith_dec.html#Z_le_dec">Z_le_dec</a></span> <span class="id">e</span>' <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span>)...<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">EI</span>; <span class="tactic">clear</span> <span class="id">EI</span>; <span class="tactic">subst</span> <span class="id">f</span>' <span class="id">m</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">auto</span>. <span class="tactic">split</span>. <span class="tactic">auto</span>. <span class="tactic">split</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2R">B2R</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Bexact_inverse_mantissa_value">Bexact_inverse_mantissa_value</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#F2R">F2R</a></span>; <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_cond_Zopp">Z2R_cond_Zopp</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- ! <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#cond_Ropp_mult_l">cond_Ropp_mult_l</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span> <span class="kwd">in</span> <span class="id">prec_gt_0_</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> (2 ^ (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span> - 1))) <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow">bpow</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span> - 1))<br/>
&nbsp;&nbsp;<span class="tactic">by</span> (<span class="tactic">symmetry</span>; <span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_Zpower">Z2R_Zpower</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span>); <span class="tactic">omega</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- ! <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow_plus">bpow_plus</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span> - 1 + <span class="id">e</span>') <span class="kwd">with</span> (- (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span> - 1 + <span class="id">e</span>)) <span class="tactic">by</span> (<span class="tactic">unfold</span> <span class="id">e</span>'; <span class="tactic">omega</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow_opp">bpow_opp</a></span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#cond_Ropp">cond_Ropp</a></span>; <span class="tactic">destruct</span> <span class="id">b</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_inv_permute">Ropp_inv_permute</a></span>. <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow_gt_0">bpow_gt_0</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">simpl</span>. <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_float_prop.html#F2R_eq_0_reg">F2R_eq_0_reg</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">destruct</span> <span class="id">b</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Bdiv_mult_inverse">Bdiv_mult_inverse</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">div_nan</span> <span class="id">mult_nan</span> <span class="id">mode</span> <span class="id">x</span> <span class="id">y</span> <span class="id">z</span>,<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> (<span class="id">x</span> <span class="id">y</span> <span class="id">z</span>: <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.binary_float">binary_float</a></span>),<br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#is_nan">is_nan</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt; <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#is_finite">is_finite</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#y">y</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt; <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#is_finite">is_finite</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#z">z</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#div_nan">div_nan</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#y">y</a></span> = <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#mult_nan">mult_nan</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#z">z</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Bexact_inverse">Bexact_inverse</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#y">y</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#z">z</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#Bdiv">Bdiv</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.Hmax">Hmax</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#div_nan">div_nan</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#mode">mode</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#y">y</a></span> = <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#Bmult">Bmult</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.Hmax">Hmax</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#mult_nan">mult_nan</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#mode">mode</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#z">z</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof870')">Proof.</div>
<div class="proofscript" id="proof870">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> <span class="id">z</span>; <span class="tactic">intros</span> <span class="id">NAN</span>; <span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Bexact_inverse_correct">Bexact_inverse_correct</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">H</span>) <span class="kwd">as</span> (<span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span> &amp; <span class="id">D</span> &amp; <span class="id">E</span>).<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#Bmult_correct">Bmult_correct</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.Hmax">Hmax</a></span> <span class="id">mult_nan</span> <span class="id">mode</span> <span class="id">x</span> <span class="id">z</span>).<br/>
&nbsp;&nbsp;<span class="id">fold</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emin">emin</a></span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="id">fold</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.fexp">fexp</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">pose</span> <span class="id">proof</span> (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#Bdiv_correct">Bdiv_correct</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.Hmax">Hmax</a></span> <span class="id">div_nan</span> <span class="id">mode</span> <span class="id">x</span> <span class="id">y</span> <span class="id">D</span>).<br/>
&nbsp;&nbsp;<span class="id">fold</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emin">emin</a></span> <span class="kwd">in</span> <span class="id">H1</span>. <span class="id">fold</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.fexp">fexp</a></span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#Rdiv">Rdiv</a></span> <span class="kwd">in</span> <span class="id">H1</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">C</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#is_finite">is_finite</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">x</span>) <span class="id">eqn</span>:<span class="id">FINX</span>.<br/>
- <span class="tactic">destruct</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool">Rlt_bool</a></span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">destruct</span> <span class="id">H0</span> <span class="kwd">as</span> (<span class="id">P</span> &amp; <span class="id">Q</span> &amp; <span class="id">R</span>). <span class="tactic">destruct</span> <span class="id">H1</span> <span class="kwd">as</span> (<span class="id">S</span> &amp; <span class="id">T</span> &amp; <span class="id">U</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2R_Bsign_inj">B2R_Bsign_inj</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">Q</span>. <span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#is_finite_strict_finite">is_finite_strict_finite</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">P</span>, <span class="id">S</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">R</span>, <span class="id">U</span>, <span class="id">E</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#is_finite_not_is_nan">is_finite_not_is_nan</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#is_finite_not_is_nan">is_finite_not_is_nan</a></span>. <span class="tactic">rewrite</span> <span class="id">Q</span>. <span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#is_finite_strict_finite">is_finite_strict_finite</a></span>; <span class="tactic">auto</span>.  + <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2FF_inj">B2FF_inj</a></span>. <span class="tactic">rewrite</span> <span class="id">H0</span>, <span class="id">H1</span>. <span class="tactic">rewrite</span> <span class="id">E</span>. <span class="tactic">auto</span>.<br/>
- <span class="tactic">destruct</span> <span class="id">y</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>. <span class="tactic">destruct</span> <span class="id">z</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">x</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">E</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;+ <span class="id">erewrite</span> <span class="id">NAN</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<h2> Conversion from scientific notation </h2>
<br/>
<div class="doc">Russian peasant exponentiation </div>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="pos_pow">pos_pow</a></span> (<span class="id">x</span> <span class="id">y</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#positive">positive</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#positive">positive</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#y">y</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#xH">xH</a></span> =&gt; <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#xO">xO</a></span> <span class="id">y</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.square">Pos.square</a></span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#pos_pow">pos_pow</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#y">y</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#xI">xI</a></span> <span class="id">y</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.mul">Pos.mul</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.square">Pos.square</a></span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#pos_pow">pos_pow</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#y">y</a></span>))<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="pos_pow_spec">pos_pow_spec</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pos">Z.pos</a></span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#pos_pow">pos_pow</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#y">y</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pos">Z.pos</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span> ^ <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pos">Z.pos</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#y">y</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof871')">Proof.</div>
<div class="proofscript" id="proof871">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">REC</span>: <span class="kwd">forall</span> <span class="id">y</span> <span class="id">a</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.iter">Pos.iter</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.mul">Pos.mul</a></span> <span class="id">x</span>) <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#a">a</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#y">y</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.mul">Pos.mul</a></span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#pos_pow">pos_pow</a></span> <span class="id">x</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#y">y</a></span>) <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#a">a</a></span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">induction</span> <span class="id">y</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">rewrite</span> ! <span class="id">IHy</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.square_spec">Pos.square_spec</a></span>, ! <span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.mul_assoc">Pos.mul_assoc</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">rewrite</span> ! <span class="id">IHy</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.square_spec">Pos.square_spec</a></span>, ! <span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.mul_assoc">Pos.mul_assoc</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Pos2Z.inj_pow_pos">Pos2Z.inj_pow_pos</a></span>. <span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.pow">Pos.pow</a></span>. <span class="tactic">rewrite</span> <span class="id">REC</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.mul_1_r">Pos.mul_1_r</a></span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Given a base <span class="bracket"><span class="id">base</span></span>, a mantissa <span class="bracket"><span class="id">m</span></span> and an exponent <span class="bracket"><span class="id">e</span></span>, the following function
  computes the FP number closest to <span class="bracket"><span class="id">m</span> * <span class="id">base</span> ^ <span class="id">e</span></span>, using round to odd, ties break to even.
  The algorithm is naive, computing <span class="bracket"><span class="id">base</span> ^ |<span class="id">e</span>|</span> exactly before doing a multiplication or
  division with <span class="bracket"><span class="id">m</span></span>.  However, we treat specially very large or very small values of <span class="bracket"><span class="id">e</span></span>,
  when the result is known to be <span class="bracket">+<span class="id">infinity</span></span> or <span class="bracket">0.0</span> respectively. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Bparse">Bparse</a></span> (<span class="id">base</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#positive">positive</a></span>) (<span class="id">m</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#positive">positive</a></span>) (<span class="id">e</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>): <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.binary_float">binary_float</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#e">e</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z0">Z0</a></span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ">BofZ</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Zpos">Zpos</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#m">m</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Zpos">Zpos</a></span> <span class="id">p</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#e">e</a></span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.log2">Z.log2</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Zpos">Zpos</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#base">base</a></span>) &lt;? <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ">BofZ</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Zpos">Zpos</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#m">m</a></span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Zpos">Zpos</a></span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#pos_pow">pos_pow</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#base">base</a></span> <span class="id">p</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B754_infinity">B754_infinity</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Zneg">Zneg</a></span> <span class="id">p</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#e">e</a></span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.log2">Z.log2</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Zpos">Zpos</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#base">base</a></span>) + <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.log2_up">Z.log2_up</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Zpos">Zpos</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#m">m</a></span>) &lt;? <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emin">emin</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B754_zero">B754_zero</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#FF2B">FF2B</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span> <span class="id">_</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#proj1">proj1</a></span> (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#Bdiv_correct_aux">Bdiv_correct_aux</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec_gt_0_">prec_gt_0_</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.Hmax">Hmax</a></span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#mode_NE">mode_NE</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#m">m</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z0">Z0</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#pos_pow">pos_pow</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#base">base</a></span> <span class="id">p</span>) <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z0">Z0</a></span>))<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<div class="doc">Properties of <span class="bracket"><span class="id">Z.log2</span></span> and <span class="bracket"><span class="id">Z.log2_up</span></span>. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Zpower_log">Zpower_log</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">base</span>: <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix">radix</a></span>) <span class="id">n</span>,<br/>
&nbsp;&nbsp;0 &lt; <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span> -&gt;<br/>
&nbsp;&nbsp;2 ^ (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.log2">Z.log2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#base">base</a></span>) &lt;= <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#base">base</a></span> ^ <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span> &lt;= 2 ^ (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.log2_up">Z.log2_up</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#base">base</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof872')">Proof.</div>
<div class="proofscript" id="proof872">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">A</span>: 0 &lt; <span class="id">base</span>) <span class="tactic">by</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix_gt_0">radix_gt_0</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">B</span>: 0 &lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.log2">Z.log2</a></span> <span class="id">base</span>) <span class="tactic">by</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.log2_nonneg">Z.log2_nonneg</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">C</span>: 0 &lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.log2_up">Z.log2_up</a></span> <span class="id">base</span>) <span class="tactic">by</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.log2_up_nonneg">Z.log2_up_nonneg</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.log2_spec">Z.log2_spec</a></span> <span class="id">base</span>) <span class="kwd">as</span> [<span class="id">D</span> <span class="id">E</span>]; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.log2_up_spec">Z.log2_up_spec</a></span> <span class="id">base</span>) <span class="kwd">as</span> [<span class="id">F</span> <span class="id">G</span>]. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix_gt_1">radix_gt_1</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">K</span>: 0 &lt;= 2 ^ <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.log2">Z.log2</a></span> <span class="id">base</span>) <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pow_nonneg">Z.pow_nonneg</a></span>; <span class="tactic">omega</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> ! (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.mul_comm">Z.mul_comm</a></span> <span class="id">n</span>). <span class="tactic">rewrite</span> ! <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pow_mul_r">Z.pow_mul_r</a></span> <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pow_le_mono_l">Z.pow_le_mono_l</a></span>; <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="bpow_log_pos">bpow_log_pos</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">base</span>: <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix">radix</a></span>) <span class="id">n</span>,<br/>
&nbsp;&nbsp;0 &lt; <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow">bpow</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.log2">Z.log2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#base">base</a></span>)%<span class="id">Z</span> &lt;= <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow">bpow</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#base">base</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span>)%<span class="id">R</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof873')">Proof.</div>
<div class="proofscript" id="proof873">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> &lt;- ! <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_Zpower">Z2R_Zpower</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_le">Z2R_le</a></span>; <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Zpower_log">Zpower_log</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.mul_comm">Z.mul_comm</a></span>; <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zmult_gt_0_le_0_compat">Zmult_gt_0_le_0_compat</a></span>. <span class="tactic">omega</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.log2_nonneg">Z.log2_nonneg</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="bpow_log_neg">bpow_log_neg</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">base</span>: <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix">radix</a></span>) <span class="id">n</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span> &lt; 0 -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow">bpow</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#base">base</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span> &lt;= <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow">bpow</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.log2">Z.log2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#base">base</a></span>)%<span class="id">Z</span>)%<span class="id">R</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof874')">Proof.</div>
<div class="proofscript" id="proof874">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">set</span> (<span class="id">m</span> := -<span class="id">n</span>). <span class="tactic">replace</span> <span class="id">n</span> <span class="kwd">with</span> (-<span class="id">m</span>) <span class="tactic">by</span> (<span class="tactic">unfold</span> <span class="id">m</span>; <span class="tactic">omega</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> ! <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.mul_opp_l">Z.mul_opp_l</a></span>, ! <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow_opp">bpow_opp</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rinv_le">Rinv_le</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow_gt_0">bpow_gt_0</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#bpow_log_pos">bpow_log_pos</a></span>. <span class="tactic">unfold</span> <span class="id">m</span>; <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Overflow and underflow conditions. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="round_integer_overflow">round_integer_overflow</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">base</span>: <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix">radix</a></span>) <span class="id">e</span> <span class="id">m</span>,<br/>
&nbsp;&nbsp;0 &lt; <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#e">e</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span> &lt;= <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#e">e</a></span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.log2">Z.log2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#base">base</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow">bpow</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span> &lt;= <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.fexp">fexp</a></span> (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#round_mode">round_mode</a></span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#mode_NE">mode_NE</a></span>) (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Zpos">Zpos</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#m">m</a></span>) * <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow">bpow</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#base">base</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#e">e</a></span>))%<span class="id">R</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof875')">Proof.</div>
<div class="proofscript" id="proof875">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#round_generic">round_generic</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.fexp">fexp</a></span> (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#round_mode">round_mode</a></span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#mode_NE">mode_NE</a></span>) (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow">bpow</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span>)); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#round_le">round_le</a></span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#fexp_correct">fexp_correct</a></span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#valid_rnd_round_mode">valid_rnd_round_mode</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_1_l">Rmult_1_l</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow">bpow</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span>)). <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat">Rmult_le_compat</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_0_1">Rle_0_1</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow_ge_0">bpow_ge_0</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_le">Z2R_le</a></span> 1). <span class="id">zify</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow_le">bpow_le</a></span>. <span class="id">eassumption</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#bpow_log_pos">bpow_log_pos</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_FLT.html#generic_format_FLT">generic_format_FLT</a></span>. <span class="id">exists</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#Float">Float</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> 1 <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#F2R">F2R</a></span>; <span class="tactic">simpl</span>. <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">simpl</span>. <span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zpower_gt_1">Zpower_gt_1</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#emin">emin</a></span>; <span class="tactic">red</span> <span class="kwd">in</span> <span class="id">prec_gt_0_</span>; <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="round_NE_underflows">round_NE_underflows</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span>,<br/>
&nbsp;&nbsp;(0 &lt;= <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span> &lt;= <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow">bpow</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emin">emin</a></span> - 1))%<span class="id">R</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.fexp">fexp</a></span> (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#round_mode">round_mode</a></span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#mode_NE">mode_NE</a></span>) <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span> = 0%<span class="id">R</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof876')">Proof.</div>
<div class="proofscript" id="proof876">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">eps</span> := <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow">bpow</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emin">emin</a></span> - 1)) <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">A</span>: <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.fexp">fexp</a></span> (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#round_mode">round_mode</a></span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#mode_NE">mode_NE</a></span>) <span class="id">eps</span> = 0%<span class="id">R</span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#round">round</a></span>. <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">E</span>: <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#canonic_exp">canonic_exp</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.fexp">fexp</a></span> <span class="id">eps</span> = <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emin">emin</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#canonic_exp">canonic_exp</a></span>, <span class="id">eps</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#ln_beta_bpow">ln_beta_bpow</a></span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#fexp">fexp</a></span>, <span class="id"><a href="compcert.flocq.Core.Fcore_FLT.html#FLT_exp">FLT_exp</a></span>. <span class="id">zify</span>; <span class="tactic">red</span> <span class="kwd">in</span> <span class="id">prec_gt_0_</span>; <span class="tactic">omega</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#scaled_mantissa">scaled_mantissa</a></span>; <span class="tactic">rewrite</span> <span class="id">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">P</span>: (<span class="id">eps</span> * <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow">bpow</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> (-<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emin">emin</a></span>) = / 2)%<span class="id">R</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">unfold</span> <span class="id">eps</span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow_plus">bpow_plus</a></span>. <span class="tactic">replace</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emin">emin</a></span> - 1 + -<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emin">emin</a></span>) <span class="kwd">with</span> (-1) <span class="tactic">by</span> <span class="tactic">omega</span>. <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">P</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#Znearest">Znearest</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">F</span>: <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Zfloor">Zfloor</a></span> (/ 2)%<span class="id">R</span> = 0).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Zfloor_imp">Zfloor_imp</a></span>. <span class="tactic">simpl</span>. <span class="id">lra</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">F</span>. <span class="id">change</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> 0) <span class="kwd">with</span> 0%<span class="id">R</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rminus_0_r">Rminus_0_r</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rcompare_Eq">Rcompare_Eq</a></span> <span class="tactic">by</span> <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#F2R">F2R</a></span>; <span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_0_l">Rmult_0_l</a></span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_antisym">Rle_antisym</a></span>.<br/>
- <span class="tactic">rewrite</span> &lt;- <span class="id">A</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#round_le">round_le</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#fexp_correct">fexp_correct</a></span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#valid_rnd_round_mode">valid_rnd_round_mode</a></span>. <span class="tactic">tauto</span>.<br/>
- <span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#round_0">round_0</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.fexp">fexp</a></span> (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#round_mode">round_mode</a></span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#mode_NE">mode_NE</a></span>)).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#round_le">round_le</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#fexp_correct">fexp_correct</a></span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#valid_rnd_round_mode">valid_rnd_round_mode</a></span>. <span class="tactic">tauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="round_integer_underflow">round_integer_underflow</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">base</span>: <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix">radix</a></span>) <span class="id">e</span> <span class="id">m</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#e">e</a></span> &lt; 0 -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#e">e</a></span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.log2">Z.log2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#base">base</a></span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.log2_up">Z.log2_up</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Zpos">Zpos</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#m">m</a></span>) &lt; <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emin">emin</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.fexp">fexp</a></span> (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#round_mode">round_mode</a></span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#mode_NE">mode_NE</a></span>) (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Zpos">Zpos</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#m">m</a></span>) * <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow">bpow</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#base">base</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#e">e</a></span>) = 0%<span class="id">R</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof877')">Proof.</div>
<div class="proofscript" id="proof877">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#round_NE_underflows">round_NE_underflows</a></span>. <span class="tactic">split</span>.<br/>
- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_pos">Rmult_le_pos</a></span>. <span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_le">Z2R_le</a></span> 0). <span class="id">zify</span>; <span class="tactic">omega</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow_ge_0">bpow_ge_0</a></span>.<br/>
- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow">bpow</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.log2_up">Z.log2_up</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pos">Z.pos</a></span> <span class="id">m</span>) + <span class="id">e</span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.log2">Z.log2</a></span> <span class="id">base</span>)).<br/>
+ <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow_plus">bpow_plus</a></span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_compat">Rmult_le_compat</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_le">Z2R_le</a></span> 0); <span class="id">zify</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow_ge_0">bpow_ge_0</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_Zpower">Z2R_Zpower</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_le">Z2R_le</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.eq_dec">Z.eq_dec</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pos">Z.pos</a></span> <span class="id">m</span>) 1).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">e0</span>. <span class="tactic">simpl</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.log2_up_spec">Z.log2_up_spec</a></span>. <span class="id">zify</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.log2_up_nonneg">Z.log2_up_nonneg</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#bpow_log_neg">bpow_log_neg</a></span>. <span class="tactic">auto</span>.<br/>
+ <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow_le">bpow_le</a></span>. <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Correctness of Bparse </div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Bparse_correct">Bparse_correct</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span> <span class="id">m</span> <span class="id">e</span> (<span class="id">BASE</span>: 2 &lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Zpos">Zpos</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#b">b</a></span>),<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">base</span> := {| <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Build_radix">radix_val</a></span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Zpos">Zpos</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#b">b</a></span>; <span class="id">radix_prop</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zle_imp_le_bool">Zle_imp_le_bool</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BASE">BASE</a></span> |} <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">r</span> := <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.fexp">fexp</a></span> (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#round_mode">round_mode</a></span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#mode_NE">mode_NE</a></span>) (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Zpos">Zpos</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#m">m</a></span>) * <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow">bpow</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#base">base</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#e">e</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool">Rlt_bool</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#r">r</a></span>) (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow">bpow</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span>) <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2R">B2R</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Bparse">Bparse</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#b">b</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#m">m</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#e">e</a></span>) = <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#r">r</a></span><br/>
&nbsp;&nbsp;/\ <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#is_finite">is_finite</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Bparse">Bparse</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#b">b</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#m">m</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#e">e</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span><br/>
&nbsp;&nbsp;/\ <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#Bsign">Bsign</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Bparse">Bparse</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#b">b</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#m">m</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#e">e</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span><br/>
&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2FF">B2FF</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Bparse">Bparse</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#b">b</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#m">m</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#e">e</a></span>) = <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#F754_infinity">F754_infinity</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof878')">Proof.</div>
<div class="proofscript" id="proof878">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">A</span>: <span class="kwd">forall</span> <span class="id">x</span>, @<span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#F2R">F2R</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> {| <span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#Float">Fnum</a></span> := <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span>; <span class="id">Fexp</span> := 0 |} = <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#F2R">F2R</a></span>, <span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#Fnum">Fnum</a></span>; <span class="tactic">simpl</span>. <span class="tactic">ring</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Bparse">Bparse</a></span>, <span class="id">r</span>. <span class="tactic">destruct</span> <span class="id">e</span> <span class="kwd">as</span> [ | <span class="id">e</span> | <span class="id">e</span>].<br/>
- <span class="comment">(*&nbsp;e&nbsp;=&nbsp;Z0&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">change</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow">bpow</a></span> <span class="id">base</span> 0) <span class="kwd">with</span> 1%<span class="id">R</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_1_r">Rmult_1_r</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">exact</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ_correct">BofZ_correct</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pos">Z.pos</a></span> <span class="id">m</span>)).<br/>
- <span class="comment">(*&nbsp;e&nbsp;=&nbsp;Zpos&nbsp;e&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ltb_spec">Z.ltb_spec</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pos">Z.pos</a></span> <span class="id">e</span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.log2">Z.log2</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pos">Z.pos</a></span> <span class="id">b</span>)) <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span>).<br/>
+ <span class="comment">(*&nbsp;no&nbsp;overflow&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#pos_pow_spec">pos_pow_spec</a></span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_Zpower">Z2R_Zpower</a></span> <span class="tactic">by</span> (<span class="id">zify</span>; <span class="tactic">omega</span>). <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_mult">Z2R_mult</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pos">Z.pos</a></span> <span class="id">m</span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pos">Z.pos</a></span> <span class="id">b</span> ^ <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pos">Z.pos</a></span> <span class="id">e</span> &lt;? 0).<br/>
&nbsp;&nbsp;<span class="tactic">exact</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ_correct">BofZ_correct</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pos">Z.pos</a></span> <span class="id">m</span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pos">Z.pos</a></span> <span class="id">b</span> ^ <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pos">Z.pos</a></span> <span class="id">e</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ltb_ge">Z.ltb_ge</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.mul_comm">Z.mul_comm</a></span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zmult_gt_0_le_0_compat">Zmult_gt_0_le_0_compat</a></span>. <span class="id">zify</span>; <span class="tactic">omega</span>.  <span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zpower_ge_0">Zpower_ge_0</a></span> <span class="id">base</span>).<br/>
+ <span class="comment">(*&nbsp;overflow&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool_false">Rlt_bool_false</a></span>. <span class="tactic">auto</span>. <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_trans">Rle_trans</a></span>; [<span class="id">idtac</span>|<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rle_abs">Rle_abs</a></span>].<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#round_integer_overflow">round_integer_overflow</a></span> <span class="id">base</span>). <span class="id">zify</span>; <span class="tactic">omega</span>. <span class="tactic">auto</span>.<br/>
- <span class="comment">(*&nbsp;e&nbsp;=&nbsp;Zneg&nbsp;e&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ltb_spec">Z.ltb_spec</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.neg">Z.neg</a></span> <span class="id">e</span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.log2">Z.log2</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pos">Z.pos</a></span> <span class="id">b</span>) + <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.log2_up">Z.log2_up</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pos">Z.pos</a></span> <span class="id">m</span>)) <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emin">emin</a></span>).<br/>
+ <span class="comment">(*&nbsp;undeflow&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#round_integer_underflow">round_integer_underflow</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool_true">Rlt_bool_true</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> 0)%<span class="id">R</span> <span class="kwd">with</span> 0%<span class="id">R</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow_gt_0">bpow_gt_0</a></span>. <span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_abs">Z2R_abs</a></span> 0).<br/>
&nbsp;&nbsp;<span class="id">zify</span>; <span class="tactic">omega</span>.<br/>
+ <span class="comment">(*&nbsp;no&nbsp;underflow&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#Bdiv_correct_aux">Bdiv_correct_aux</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec_gt_0_">prec_gt_0_</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.Hmax">Hmax</a></span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#mode_NE">mode_NE</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> <span class="id">m</span> 0 <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#pos_pow">pos_pow</a></span> <span class="id">b</span> <span class="id">e</span>) 0).<br/>
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">f</span> := <span class="kwd">match</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#Fdiv_core_binary">Fdiv_core_binary</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pos">Z.pos</a></span> <span class="id">m</span>) 0 (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pos">Z.pos</a></span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#pos_pow">pos_pow</a></span> <span class="id">b</span> <span class="id">e</span>)) 0 <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (0, <span class="id">_</span>, <span class="id">_</span>) =&gt; <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#F754_nan">F754_nan</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id">Z.pos</span> <span class="id">mz0</span>, <span class="id">ez</span>, <span class="id">lz</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#binary_round_aux">binary_round_aux</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.prec">prec</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#mode_NE">mode_NE</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#xorb">xorb</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>) <span class="id">mz0</span> <span class="id">ez</span> <span class="id">lz</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id">Z.neg</span> <span class="id">_</span>, <span class="id">_</span>, <span class="id">_</span>) =&gt; <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#F754_nan">F754_nan</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>).<br/>
&nbsp;&nbsp;<span class="id">fold</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emin">emin</a></span>; <span class="id">fold</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.fexp">fexp</a></span>. <span class="tactic">rewrite</span> ! <span class="id">A</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#cond_Zopp">cond_Zopp</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#pos_pow_spec">pos_pow_spec</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">B</span>: (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pos">Z.pos</a></span> <span class="id">m</span>) / <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pos">Z.pos</a></span> <span class="id">b</span> ^ <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pos">Z.pos</a></span> <span class="id">e</span>) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pos">Z.pos</a></span> <span class="id">m</span>) * <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow">bpow</a></span> <span class="id">base</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.neg">Z.neg</a></span> <span class="id">e</span>))%<span class="id">R</span>).<br/>
&nbsp;&nbsp;{ <span class="id">change</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.neg">Z.neg</a></span> <span class="id">e</span>) <span class="kwd">with</span> (- (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pos">Z.pos</a></span> <span class="id">e</span>)). <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow_opp">bpow_opp</a></span>. <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">B</span>. <span class="tactic">intros</span> [<span class="id">P</span> <span class="id">Q</span>].<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool">Rlt_bool</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.fexp">fexp</a></span> (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#round_mode">round_mode</a></span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#mode_NE">mode_NE</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pos">Z.pos</a></span> <span class="id">m</span>) * <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow">bpow</a></span> <span class="id">base</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.neg">Z.neg</a></span> <span class="id">e</span>))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow">bpow</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops.emax">emax</a></span>)).<br/>
* <span class="tactic">destruct</span> <span class="id">Q</span> <span class="kwd">as</span> (<span class="id">Q1</span> &amp; <span class="id">Q2</span> &amp; <span class="id">Q3</span>).<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2R_FF2B">B2R_FF2B</a></span>, <span class="id">Q1</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#is_finite_FF2B">is_finite_FF2B</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#Bsign_FF2B">Bsign_FF2B</a></span>. <span class="tactic">auto</span>.<br/>
* <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2FF_FF2B">B2FF_FF2B</a></span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Extra_ops">Extra_ops</a></span>.<br/>
<br/>
<h2> Conversions between two FP formats </h2>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Conversions">Conversions</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Conversions.prec1">prec1</a></span> <span class="id"><a name="Conversions.emax1">emax1</a></span> <span class="id"><a name="Conversions.prec2">prec2</a></span> <span class="id"><a name="Conversions.emax2">emax2</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.<br/>
<span class="kwd">Context</span> (<span class="id">prec1_gt_0_</span> : <span class="id"><a href="compcert.flocq.Core.Fcore_FLX.html#Prec_gt_0">Prec_gt_0</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.prec1">prec1</a></span>) (<span class="id">prec2_gt_0_</span> : <span class="id"><a href="compcert.flocq.Core.Fcore_FLX.html#Prec_gt_0">Prec_gt_0</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.prec2">prec2</a></span>).<br/>
<span class="kwd">Let</span> <span class="id"><a name="Conversions.emin1">emin1</a></span> := (3 - <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.emax1">emax1</a></span> - <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.prec1">prec1</a></span>)%<span class="id">Z</span>.<br/>
<span class="kwd">Let</span> <span class="id"><a name="Conversions.fexp1">fexp1</a></span> := <span class="id"><a href="compcert.flocq.Core.Fcore_FLT.html#FLT_exp">FLT_exp</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.emin1">emin1</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.prec1">prec1</a></span>.<br/>
<span class="kwd">Let</span> <span class="id"><a name="Conversions.emin2">emin2</a></span> := (3 - <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.emax2">emax2</a></span> - <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.prec2">prec2</a></span>)%<span class="id">Z</span>.<br/>
<span class="kwd">Let</span> <span class="id"><a name="Conversions.fexp2">fexp2</a></span> := <span class="id"><a href="compcert.flocq.Core.Fcore_FLT.html#FLT_exp">FLT_exp</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.emin2">emin2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.prec2">prec2</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="Conversions.Hmax1">Hmax1</a></span> : (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.prec1">prec1</a></span> &lt; <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.emax1">emax1</a></span>)%<span class="id">Z</span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="Conversions.Hmax2">Hmax2</a></span> : (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.prec2">prec2</a></span> &lt; <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.emax2">emax2</a></span>)%<span class="id">Z</span>.<br/>
<span class="kwd">Let</span> <span class="id"><a name="Conversions.binary_float1">binary_float1</a></span> := <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#binary_float">binary_float</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.prec1">prec1</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.emax1">emax1</a></span>.<br/>
<span class="kwd">Let</span> <span class="id"><a name="Conversions.binary_float2">binary_float2</a></span> := <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#binary_float">binary_float</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.prec2">prec2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.emax2">emax2</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="Bconv">Bconv</a></span> (<span class="id">conv_nan</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> -&gt; <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#nan_pl">nan_pl</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.prec1">prec1</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> * <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#nan_pl">nan_pl</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.prec2">prec2</a></span>) (<span class="id">md</span>: <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#mode">mode</a></span>) (<span class="id">f</span>: <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.binary_float1">binary_float1</a></span>) : <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.binary_float2">binary_float2</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#f">f</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B754_nan">B754_nan</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">s</span> <span class="id">pl</span> =&gt; <span class="kwd">let</span> '(<span class="id">s</span>, <span class="id">pl</span>) := <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#conv_nan">conv_nan</a></span> <span class="id">s</span> <span class="id">pl</span> <span class="kwd">in</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B754_nan">B754_nan</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">s</span> <span class="id">pl</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B754_infinity">B754_infinity</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">s</span> =&gt; <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B754_infinity">B754_infinity</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">s</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B754_zero">B754_zero</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">s</span> =&gt; <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B754_zero">B754_zero</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">s</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B754_finite">B754_finite</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">s</span> <span class="id">m</span> <span class="id">e</span> <span class="id">_</span> =&gt; <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#binary_normalize">binary_normalize</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.Hmax2">Hmax2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#md">md</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#cond_Zopp">cond_Zopp</a></span> <span class="id">s</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Zpos">Zpos</a></span> <span class="id">m</span>)) <span class="id">e</span> <span class="id">s</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Bconv_correct">Bconv_correct</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">conv_nan</span> <span class="id">m</span> <span class="id">f</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#is_finite">is_finite</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#f">f</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool">Rlt_bool</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.fexp2">fexp2</a></span> (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#round_mode">round_mode</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#m">m</a></span>) (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2R">B2R</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#f">f</a></span>))) (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow">bpow</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.emax2">emax2</a></span>)<br/>
&nbsp;&nbsp;<span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2R">B2R</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Bconv">Bconv</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#conv_nan">conv_nan</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#m">m</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#f">f</a></span>) = <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.fexp2">fexp2</a></span> (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#round_mode">round_mode</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#m">m</a></span>) (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2R">B2R</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#f">f</a></span>)<br/>
&nbsp;&nbsp;/\ <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#is_finite">is_finite</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Bconv">Bconv</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#conv_nan">conv_nan</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#m">m</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#f">f</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span><br/>
&nbsp;&nbsp;/\ <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#Bsign">Bsign</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Bconv">Bconv</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#conv_nan">conv_nan</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#m">m</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#f">f</a></span>) = <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#Bsign">Bsign</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#f">f</a></span><br/>
&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2FF">B2FF</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Bconv">Bconv</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#conv_nan">conv_nan</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#m">m</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#f">f</a></span>) = <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#binary_overflow">binary_overflow</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.prec2">prec2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.emax2">emax2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#m">m</a></span> (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#Bsign">Bsign</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#f">f</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof879')">Proof.</div>
<div class="proofscript" id="proof879">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">f</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
- <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#round_0">round_0</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_R0">Rabs_R0</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool_true">Rlt_bool_true</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow_gt_0">bpow_gt_0</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#valid_rnd_round_mode">valid_rnd_round_mode</a></span>.<br/>
- <span class="tactic">generalize</span> (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#binary_normalize_correct">binary_normalize_correct</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.Hmax2">Hmax2</a></span> <span class="id">m</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#cond_Zopp">cond_Zopp</a></span> <span class="id">b</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Zpos">Zpos</a></span> <span class="id">m0</span>)) <span class="id">e</span> <span class="id">b</span>).<br/>
&nbsp;&nbsp;<span class="id">fold</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.emin2">emin2</a></span>; <span class="id">fold</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.fexp2">fexp2</a></span>. <span class="tactic">simpl</span>. <span class="tactic">destruct</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool">Rlt_bool</a></span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">intros</span> (<span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span>). <span class="tactic">split</span>. <span class="tactic">auto</span>. <span class="tactic">split</span>. <span class="tactic">auto</span>. <span class="tactic">rewrite</span> <span class="id">C</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">b</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rcompare_Lt">Rcompare_Lt</a></span>. <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_float_prop.html#F2R_lt_0_compat">F2R_lt_0_compat</a></span>. <span class="tactic">simpl</span>. <span class="tactic">compute</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rcompare_Gt">Rcompare_Gt</a></span>. <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_float_prop.html#F2R_gt_0_compat">F2R_gt_0_compat</a></span>. <span class="tactic">simpl</span>. <span class="tactic">compute</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">intros</span> <span class="id">A</span>. <span class="tactic">rewrite</span> <span class="id">A</span>. <span class="tactic">f_equal</span>. <span class="tactic">destruct</span> <span class="id">b</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool_true">Rlt_bool_true</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_float_prop.html#F2R_lt_0_compat">F2R_lt_0_compat</a></span>. <span class="tactic">simpl</span>. <span class="tactic">compute</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool_false">Rlt_bool_false</a></span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_lt">Rgt_lt</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_float_prop.html#F2R_gt_0_compat">F2R_gt_0_compat</a></span>. <span class="tactic">simpl</span>. <span class="tactic">compute</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Converting a finite FP number to higher or equal precision preserves its value. </div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Bconv_widen_exact">Bconv_widen_exact</a></span>:<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.prec2">prec2</a></span> &gt;= <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.prec1">prec1</a></span>)%<span class="id">Z</span> -&gt; (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.emax2">emax2</a></span> &gt;= <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.emax1">emax1</a></span>)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">conv_nan</span> <span class="id">m</span> <span class="id">f</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#is_finite">is_finite</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#f">f</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2R">B2R</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Bconv">Bconv</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#conv_nan">conv_nan</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#m">m</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#f">f</a></span>) = <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2R">B2R</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#f">f</a></span><br/>
&nbsp;&nbsp;/\ <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#is_finite">is_finite</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Bconv">Bconv</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#conv_nan">conv_nan</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#m">m</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#f">f</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span><br/>
&nbsp;&nbsp;/\ <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#Bsign">Bsign</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Bconv">Bconv</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#conv_nan">conv_nan</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#m">m</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#f">f</a></span>) = <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#Bsign">Bsign</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#f">f</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof880')">Proof.</div>
<div class="proofscript" id="proof880">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">PREC</span> <span class="id">EMAX</span>; <span class="tactic">intros</span>. <span class="tactic">generalize</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Bconv_correct">Bconv_correct</a></span> <span class="id">conv_nan</span> <span class="id">m</span> <span class="id">f</span> <span class="id">H</span>).<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">LT</span>: (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2R">B2R</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">f</span>) &lt; <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow">bpow</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.emax2">emax2</a></span>)%<span class="id">R</span>).<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">f</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_R0">Rabs_R0</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow_gt_0">bpow_gt_0</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow">bpow</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.emax1">emax1</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_float_prop.html#F2R_cond_Zopp">F2R_cond_Zopp</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#abs_cond_Ropp">abs_cond_Ropp</a></span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.flocq.Core.Fcore_float_prop.html#F2R_Zabs">F2R_Zabs</a></span>. <span class="tactic">simpl</span> <span class="id">Z.abs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#bounded_lt_emax">bounded_lt_emax</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow_le">bpow_le</a></span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">EQ</span>: <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.fexp2">fexp2</a></span> (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#round_mode">round_mode</a></span> <span class="id">m</span>) (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2R">B2R</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.prec1">prec1</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.emax1">emax1</a></span> <span class="id">f</span>) = <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2R">B2R</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.prec1">prec1</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.emax1">emax1</a></span> <span class="id">f</span>).<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#round_generic">round_generic</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#valid_rnd_round_mode">valid_rnd_round_mode</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#generic_inclusion_le">generic_inclusion_le</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;5: <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#generic_format_B2R">generic_format_B2R</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#fexp_correct">fexp_correct</a></span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#fexp_correct">fexp_correct</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (1 := <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.emax2">emax2</a></span>). <span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#fexp2">fexp2</a></span>, <span class="id"><a href="compcert.flocq.Core.Fcore_FLT.html#FLT_exp">FLT_exp</a></span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#emin2">emin2</a></span>. <span class="id">zify</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">EQ</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool_true">Rlt_bool_true</a></span> <span class="tactic">by</span> <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Conversion from integers and change of format </div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Bconv_BofZ">Bconv_BofZ</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">conv_nan</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#integer_representable">integer_representable</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.prec1">prec1</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.emax1">emax1</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Bconv">Bconv</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#conv_nan">conv_nan</a></span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#mode_NE">mode_NE</a></span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ">BofZ</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.prec1">prec1</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.emax1">emax1</a></span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.Hmax1">Hmax1</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span>) = <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ">BofZ</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.prec2">prec2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.emax2">emax2</a></span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.Hmax2">Hmax2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof881')">Proof.</div>
<div class="proofscript" id="proof881">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ_representable">BofZ_representable</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.Hmax1">Hmax1</a></span> <span class="id">n</span> <span class="id">H</span>) <span class="kwd">as</span> (<span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span>).<br/>
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">f</span> := <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ">BofZ</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.prec1">prec1</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.emax1">emax1</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.prec1_gt_0_">prec1_gt_0_</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.Hmax1">Hmax1</a></span> <span class="id">n</span>) <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Bconv_correct">Bconv_correct</a></span> <span class="id">conv_nan</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#mode_NE">mode_NE</a></span> <span class="id">f</span> <span class="id">B</span>).<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#BofZ">BofZ</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#binary_normalize_correct">binary_normalize_correct</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.Hmax2">Hmax2</a></span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#mode_NE">mode_NE</a></span> <span class="id">n</span> 0 <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>).<br/>
&nbsp;&nbsp;<span class="id">fold</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.emin2">emin2</a></span>; <span class="id">fold</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.fexp2">fexp2</a></span>. <span class="tactic">rewrite</span> <span class="id">A</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#F2R">F2R</a></span> {| <span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#Float">Fnum</a></span> := <span class="id">n</span>; <span class="id">Fexp</span> := 0 |}) <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> <span class="id">n</span>).<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool">Rlt_bool</a></span>.<br/>
- <span class="tactic">intros</span> (<span class="id">P</span> &amp; <span class="id">Q</span> &amp; <span class="id">R</span>) (<span class="id">D</span> &amp; <span class="id">E</span> &amp; <span class="id">F</span>). <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2R_Bsign_inj">B2R_Bsign_inj</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">congruence</span>. <span class="tactic">rewrite</span> <span class="id">F</span>, <span class="id">C</span>, <span class="id">R</span>. <span class="id">change</span> 0%<span class="id">R</span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> 0). <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rcompare_Z2R">Rcompare_Z2R</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.ltb">Z.ltb</a></span>. <span class="tactic">auto</span>.<br/>
- <span class="tactic">intros</span> <span class="id">P</span> <span class="id">Q</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2FF_inj">B2FF_inj</a></span>. <span class="tactic">rewrite</span> <span class="id">P</span>, <span class="id">Q</span>. <span class="tactic">rewrite</span> <span class="id">C</span>. <span class="tactic">f_equal</span>. <span class="id">change</span> 0%<span class="id">R</span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> 0).<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zlt_bool_spec">Zlt_bool_spec</a></span> <span class="id">n</span> 0); <span class="tactic">intros</span> <span class="id">LT</span>; <span class="tactic">inversion</span> <span class="id">LT</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool_true">Rlt_bool_true</a></span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_lt">Z2R_lt</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool_false">Rlt_bool_false</a></span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_le">Z2R_le</a></span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#F2R">F2R</a></span>; <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_1_r">Rmult_1_r</a></span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Change of format (to higher precision) and conversion to integer. </div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="ZofB_Bconv">ZofB_Bconv</a></span>:<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.prec2">prec2</a></span> &gt;= <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.prec1">prec1</a></span> -&gt; <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.emax2">emax2</a></span> &gt;= <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.emax1">emax1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">conv_nan</span> <span class="id">m</span> <span class="id">f</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#ZofB">ZofB</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#f">f</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span> -&gt; <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#ZofB">ZofB</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Bconv">Bconv</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#conv_nan">conv_nan</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#m">m</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#f">f</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof882')">Proof.</div>
<div class="proofscript" id="proof882">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#ZofB_correct">ZofB_correct</a></span> <span class="kwd">in</span> <span class="id">H1</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#is_finite">is_finite</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">f</span>) <span class="id">eqn</span>:<span class="id">FIN</span>; <span class="tactic">inversion</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Bconv_widen_exact">Bconv_widen_exact</a></span> <span class="id">H</span> <span class="id">H0</span> <span class="id">conv_nan</span> <span class="id">m</span> <span class="id">f</span>) <span class="kwd">as</span> (<span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span>). <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#ZofB_correct">ZofB_correct</a></span>. <span class="tactic">rewrite</span> <span class="id">B</span>. <span class="tactic">rewrite</span> <span class="id">A</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="ZofB_range_Bconv">ZofB_range_Bconv</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">min1</span> <span class="id">max1</span> <span class="id">min2</span> <span class="id">max2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.prec2">prec2</a></span> &gt;= <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.prec1">prec1</a></span> -&gt; <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.emax2">emax2</a></span> &gt;= <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.emax1">emax1</a></span> -&gt; <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#min2">min2</a></span> &lt;= <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#min1">min1</a></span> -&gt; <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#max1">max1</a></span> &lt;= <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#max2">max2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">conv_nan</span> <span class="id">m</span> <span class="id">f</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#ZofB_range">ZofB_range</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#f">f</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#min1">min1</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#max1">max1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#ZofB_range">ZofB_range</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Bconv">Bconv</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#conv_nan">conv_nan</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#m">m</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#f">f</a></span>) <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#min2">min2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#max2">max2</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#n">n</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof883')">Proof.</div>
<div class="proofscript" id="proof883">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#ZofB_range_inversion">ZofB_range_inversion</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H3</span>) <span class="kwd">as</span> (<span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span>).<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#ZofB_range">ZofB_range</a></span>. <span class="id">erewrite</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#ZofB_Bconv">ZofB_Bconv</a></span> <span class="tactic">by</span> <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> ! <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zle_bool_true">Zle_bool_true</a></span> <span class="tactic">by</span> <span class="tactic">omega</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Change of format (to higher precision) and comparison. </div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="Bcompare_Bconv_widen">Bcompare_Bconv_widen</a></span>:<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.prec2">prec2</a></span> &gt;= <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.prec1">prec1</a></span> -&gt; <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.emax2">emax2</a></span> &gt;= <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.emax1">emax1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">conv_nan</span> <span class="id">m</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#Bcompare">Bcompare</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Bconv">Bconv</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#conv_nan">conv_nan</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#m">m</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span>) (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Bconv">Bconv</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#conv_nan">conv_nan</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#m">m</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#y">y</a></span>) = <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#Bcompare">Bcompare</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#x">x</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#y">y</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof884')">Proof.</div>
<div class="proofscript" id="proof884">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#is_finite">is_finite</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">x</span> &amp;&amp; <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#is_finite">is_finite</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">y</span>) <span class="id">eqn</span>:<span class="id">FIN</span>.<br/>
- <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Bool.Bool.html#andb_true_iff">andb_true_iff</a></span> <span class="kwd">in</span> <span class="id">FIN</span>. <span class="tactic">destruct</span> <span class="id">FIN</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Bconv_widen_exact">Bconv_widen_exact</a></span> <span class="id">H</span> <span class="id">H0</span> <span class="id">conv_nan</span> <span class="id">m</span> <span class="id">x</span> <span class="id">H1</span>) <span class="kwd">as</span> (<span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span>).<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Bconv_widen_exact">Bconv_widen_exact</a></span> <span class="id">H</span> <span class="id">H0</span> <span class="id">conv_nan</span> <span class="id">m</span> <span class="id">y</span> <span class="id">H2</span>) <span class="kwd">as</span> (<span class="id">D</span> &amp; <span class="id">E</span> &amp; <span class="id">F</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> ! <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#Bcompare_correct">Bcompare_correct</a></span> <span class="tactic">by</span> <span class="tactic">auto</span>. <span class="tactic">rewrite</span> <span class="id">A</span>, <span class="id">D</span>. <span class="tactic">auto</span>.<br/>
- <span class="tactic">generalize</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Bconv_widen_exact">Bconv_widen_exact</a></span> <span class="id">H</span> <span class="id">H0</span> <span class="id">conv_nan</span> <span class="id">m</span> <span class="id">x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Bconv_widen_exact">Bconv_widen_exact</a></span> <span class="id">H</span> <span class="id">H0</span> <span class="id">conv_nan</span> <span class="id">m</span> <span class="id">y</span>); <span class="tactic">intros</span> <span class="id">P</span> <span class="id">Q</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">x</span>, <span class="id">y</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">P</span>, <span class="id">Q</span>; <span class="tactic">simpl</span>;<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> (<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span> |- <span class="id">context</span> [<span class="id">conv_nan</span> ?<span class="id">b</span> ?<span class="id">pl</span>] =&gt; <span class="tactic">destruct</span> (<span class="id">conv_nan</span> <span class="id">b</span> <span class="id">pl</span>) <span class="kwd">end</span>);<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">Q</span> <span class="kwd">as</span> (<span class="id">D</span> &amp; <span class="id">E</span> &amp; <span class="id">F</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#binary_normalize">binary_normalize</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.prec2">prec2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.emax2">emax2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.prec2_gt_0_">prec2_gt_0_</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.Hmax2">Hmax2</a></span> <span class="id">m</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#cond_Zopp">cond_Zopp</a></span> <span class="id">b0</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pos">Z.pos</a></span> <span class="id">m0</span>)) <span class="id">e</span> <span class="id">b0</span>);<br/>
&nbsp;&nbsp;<span class="tactic">discriminate</span> || <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">P</span> <span class="kwd">as</span> (<span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#binary_normalize">binary_normalize</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.prec2">prec2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.emax2">emax2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.prec2_gt_0_">prec2_gt_0_</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.Hmax2">Hmax2</a></span> <span class="id">m</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#cond_Zopp">cond_Zopp</a></span> <span class="id">b</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pos">Z.pos</a></span> <span class="id">m0</span>)) <span class="id">e</span> <span class="id">b</span>);<br/>
&nbsp;&nbsp;<span class="tactic">try</span> <span class="tactic">discriminate</span>; <span class="tactic">simpl</span>. <span class="tactic">destruct</span> <span class="id">b</span>; <span class="tactic">auto</span>. <span class="tactic">destruct</span> <span class="id">b</span>, <span class="id">b1</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">P</span> <span class="kwd">as</span> (<span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#binary_normalize">binary_normalize</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.prec2">prec2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.emax2">emax2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.prec2_gt_0_">prec2_gt_0_</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions.Hmax2">Hmax2</a></span> <span class="id">m</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#cond_Zopp">cond_Zopp</a></span> <span class="id">b</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pos">Z.pos</a></span> <span class="id">m0</span>)) <span class="id">e</span> <span class="id">b</span>);<br/>
&nbsp;&nbsp;<span class="tactic">try</span> <span class="tactic">discriminate</span>; <span class="tactic">simpl</span>. <span class="tactic">destruct</span> <span class="id">b</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">b</span>, <span class="id">b2</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Conversions">Conversions</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Compose_Conversions">Compose_Conversions</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Compose_Conversions.prec1">prec1</a></span> <span class="id"><a name="Compose_Conversions.emax1">emax1</a></span> <span class="id"><a name="Compose_Conversions.prec2">prec2</a></span> <span class="id"><a name="Compose_Conversions.emax2">emax2</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.<br/>
<span class="kwd">Context</span> (<span class="id">prec1_gt_0_</span> : <span class="id"><a href="compcert.flocq.Core.Fcore_FLX.html#Prec_gt_0">Prec_gt_0</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Compose_Conversions.prec1">prec1</a></span>) (<span class="id">prec2_gt_0_</span> : <span class="id"><a href="compcert.flocq.Core.Fcore_FLX.html#Prec_gt_0">Prec_gt_0</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Compose_Conversions.prec2">prec2</a></span>).<br/>
<span class="kwd">Let</span> <span class="id"><a name="Compose_Conversions.emin1">emin1</a></span> := (3 - <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Compose_Conversions.emax1">emax1</a></span> - <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Compose_Conversions.prec1">prec1</a></span>)%<span class="id">Z</span>.<br/>
<span class="kwd">Let</span> <span class="id"><a name="Compose_Conversions.fexp1">fexp1</a></span> := <span class="id"><a href="compcert.flocq.Core.Fcore_FLT.html#FLT_exp">FLT_exp</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Compose_Conversions.emin1">emin1</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Compose_Conversions.prec1">prec1</a></span>.<br/>
<span class="kwd">Let</span> <span class="id"><a name="Compose_Conversions.emin2">emin2</a></span> := (3 - <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Compose_Conversions.emax2">emax2</a></span> - <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Compose_Conversions.prec2">prec2</a></span>)%<span class="id">Z</span>.<br/>
<span class="kwd">Let</span> <span class="id"><a name="Compose_Conversions.fexp2">fexp2</a></span> := <span class="id"><a href="compcert.flocq.Core.Fcore_FLT.html#FLT_exp">FLT_exp</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Compose_Conversions.emin2">emin2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Compose_Conversions.prec2">prec2</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="Compose_Conversions.Hmax1">Hmax1</a></span> : (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Compose_Conversions.prec1">prec1</a></span> &lt; <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Compose_Conversions.emax1">emax1</a></span>)%<span class="id">Z</span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="Compose_Conversions.Hmax2">Hmax2</a></span> : (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Compose_Conversions.prec2">prec2</a></span> &lt; <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Compose_Conversions.emax2">emax2</a></span>)%<span class="id">Z</span>.<br/>
<span class="kwd">Let</span> <span class="id"><a name="Compose_Conversions.binary_float1">binary_float1</a></span> := <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#binary_float">binary_float</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Compose_Conversions.prec1">prec1</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Compose_Conversions.emax1">emax1</a></span>.<br/>
<span class="kwd">Let</span> <span class="id"><a name="Compose_Conversions.binary_float2">binary_float2</a></span> := <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#binary_float">binary_float</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Compose_Conversions.prec2">prec2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Compose_Conversions.emax2">emax2</a></span>.<br/>
<br/>
<div class="doc">Converting to a higher precision then down to the original format
    is the identity. </div>
<span class="kwd">Theorem</span> <span class="id"><a name="Bconv_narrow_widen">Bconv_narrow_widen</a></span>:<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Compose_Conversions.prec2">prec2</a></span> &gt;= <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Compose_Conversions.prec1">prec1</a></span> -&gt; <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Compose_Conversions.emax2">emax2</a></span> &gt;= <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Compose_Conversions.emax1">emax1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">narrow_nan</span> <span class="id">widen_nan</span> <span class="id">m</span> <span class="id">f</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#is_nan">is_nan</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#f">f</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Bconv">Bconv</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Compose_Conversions.prec2">prec2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Compose_Conversions.emax2">emax2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Compose_Conversions.prec1">prec1</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Compose_Conversions.emax1">emax1</a></span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Compose_Conversions.Hmax1">Hmax1</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#narrow_nan">narrow_nan</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#m">m</a></span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Bconv">Bconv</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Compose_Conversions.prec1">prec1</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Compose_Conversions.emax1">emax1</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Compose_Conversions.prec2">prec2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Compose_Conversions.emax2">emax2</a></span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Compose_Conversions.Hmax2">Hmax2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#widen_nan">widen_nan</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#m">m</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#f">f</a></span>) = <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#f">f</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof885')">Proof.</div>
<div class="proofscript" id="proof885">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#is_finite">is_finite</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">f</span>) <span class="id">eqn</span>:<span class="id">FIN</span>.<br/>
- <span class="tactic">assert</span> (<span class="id">EQ</span>: <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix2">radix2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Compose_Conversions.fexp1">fexp1</a></span> (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#round_mode">round_mode</a></span> <span class="id">m</span>) (<span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2R">B2R</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Compose_Conversions.prec1">prec1</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Compose_Conversions.emax1">emax1</a></span> <span class="id">f</span>) = <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2R">B2R</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Compose_Conversions.prec1">prec1</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Compose_Conversions.emax1">emax1</a></span> <span class="id">f</span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#round_generic">round_generic</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#valid_rnd_round_mode">valid_rnd_round_mode</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#generic_format_B2R">generic_format_B2R</a></span>. }<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Bconv_widen_exact">Bconv_widen_exact</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Compose_Conversions.Hmax2">Hmax2</a></span> <span class="id">H</span> <span class="id">H0</span> <span class="id">widen_nan</span> <span class="id">m</span> <span class="id">f</span> <span class="id">FIN</span>).<br/>
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">f</span>' := <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Bconv">Bconv</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Compose_Conversions.prec1">prec1</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Compose_Conversions.emax1">emax1</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Compose_Conversions.prec2">prec2</a></span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Compose_Conversions.emax2">emax2</a></span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Compose_Conversions.Hmax2">Hmax2</a></span> <span class="id">widen_nan</span> <span class="id">m</span> <span class="id">f</span>).<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span>).<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Bconv_correct">Bconv_correct</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Compose_Conversions.Hmax1">Hmax1</a></span> <span class="id">narrow_nan</span> <span class="id">m</span> <span class="id">f</span>' <span class="id">B</span>).<br/>
&nbsp;&nbsp;<span class="id">fold</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Compose_Conversions.emin1">emin1</a></span>. <span class="id">fold</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Compose_Conversions.fexp1">fexp1</a></span>. <span class="tactic">rewrite</span> <span class="id">A</span>, <span class="id">C</span>, <span class="id">EQ</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool_true">Rlt_bool_true</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">D</span> &amp; <span class="id">E</span> &amp; <span class="id">F</span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#B2R_Bsign_inj">B2R_Bsign_inj</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">f</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_R0">Rabs_R0</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow_gt_0">bpow_gt_0</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_float_prop.html#F2R_cond_Zopp">F2R_cond_Zopp</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#abs_cond_Ropp">abs_cond_Ropp</a></span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.flocq.Core.Fcore_float_prop.html#F2R_Zabs">F2R_Zabs</a></span>. <span class="tactic">simpl</span> <span class="id">Z.abs</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.flocq.Appli.Fappli_IEEE.html#bounded_lt_emax">bounded_lt_emax</a></span>; <span class="tactic">eauto</span>.<br/>
- <span class="tactic">destruct</span> <span class="id">f</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>. <span class="tactic">simpl</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.lib.Fappli_IEEE_extra.html#Compose_Conversions">Compose_Conversions</a></span>.<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</div>
</body>
</html>
