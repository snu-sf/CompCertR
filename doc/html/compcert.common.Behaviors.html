
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module Behaviors</title>
<meta name="description" content="Documentation of Coq module Behaviors" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module Behaviors</h1>
<div class="coq">
<br/>
<div class="doc">Whole-program behaviors </div>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical.html">Classical</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.ClassicalEpsilon.html">ClassicalEpsilon</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.lib.Coqlib.html">Coqlib</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.common.Events.html">Events</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.common.Globalenvs.html">Globalenvs</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.lib.Integers.html">Integers</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.common.Smallstep.html">Smallstep</a></span>.<br/>
<br/>
<span class="kwd">Set</span> <span class="kwd">Implicit</span> <span class="id">Arguments</span>.<br/>
<br/>
<h1> Behaviors for program executions </h1>
<br/>
<div class="doc">The four possible outcomes for the execution of a program:
<ul>
<li>
 Termination, with a finite trace of observable events
  and an integer value that stands for the process exit code
  (the return value of the main function).
</li>
<li>
 Divergence with a finite trace of observable events.
  (At some point, the program runs forever without doing any I/O.)
</li>
<li>
 Reactive divergence with an infinite trace of observable events.
  (The program performs infinitely many I/O operations separated
   by finite amounts of internal computations.)
</li>
<li>
 Going wrong, with a finite trace of observable events
  performed before the program gets stuck.
</li>
</ul>
</div>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="program_behavior">program_behavior</a></span>: <span class="kwd">Type</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="Terminates">Terminates</a></span>: <span class="id"><a href="compcert.common.Events.html#trace">trace</a></span> -&gt; <span class="id"><a href="compcert.lib.Integers.html#int">int</a></span> -&gt; <span class="id"><a href="compcert.common.Behaviors.html#program_behavior">program_behavior</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="Diverges">Diverges</a></span>: <span class="id"><a href="compcert.common.Events.html#trace">trace</a></span> -&gt; <span class="id"><a href="compcert.common.Behaviors.html#program_behavior">program_behavior</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="Reacts">Reacts</a></span>: <span class="id"><a href="compcert.common.Events.html#traceinf">traceinf</a></span> -&gt; <span class="id"><a href="compcert.common.Behaviors.html#program_behavior">program_behavior</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="Goes_wrong">Goes_wrong</a></span>: <span class="id"><a href="compcert.common.Events.html#trace">trace</a></span> -&gt; <span class="id"><a href="compcert.common.Behaviors.html#program_behavior">program_behavior</a></span>.<br/>
<br/>
<div class="doc">Operations and relations on behaviors </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="not_wrong">not_wrong</a></span> (<span class="id">beh</span>: <span class="id"><a href="compcert.common.Behaviors.html#program_behavior">program_behavior</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.common.Behaviors.html#beh">beh</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.common.Behaviors.html#Terminates">Terminates</a></span> <span class="id">_</span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.common.Behaviors.html#Diverges">Diverges</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.common.Behaviors.html#Reacts">Reacts</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.common.Behaviors.html#Goes_wrong">Goes_wrong</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="behavior_app">behavior_app</a></span> (<span class="id">t</span>: <span class="id"><a href="compcert.common.Events.html#trace">trace</a></span>) (<span class="id">beh</span>: <span class="id"><a href="compcert.common.Behaviors.html#program_behavior">program_behavior</a></span>): <span class="id"><a href="compcert.common.Behaviors.html#program_behavior">program_behavior</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.common.Behaviors.html#beh">beh</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.common.Behaviors.html#Terminates">Terminates</a></span> <span class="id">t1</span> <span class="id">r</span> =&gt; <span class="id"><a href="compcert.common.Behaviors.html#Terminates">Terminates</a></span> (<span class="id"><a href="compcert.common.Behaviors.html#t">t</a></span> ** <span class="id">t1</span>) <span class="id">r</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.common.Behaviors.html#Diverges">Diverges</a></span> <span class="id">t1</span> =&gt; <span class="id"><a href="compcert.common.Behaviors.html#Diverges">Diverges</a></span> (<span class="id"><a href="compcert.common.Behaviors.html#t">t</a></span> ** <span class="id">t1</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.common.Behaviors.html#Reacts">Reacts</a></span> <span class="id">T</span> =&gt; <span class="id"><a href="compcert.common.Behaviors.html#Reacts">Reacts</a></span> (<span class="id"><a href="compcert.common.Behaviors.html#t">t</a></span> *** <span class="id">T</span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.common.Behaviors.html#Goes_wrong">Goes_wrong</a></span> <span class="id">t1</span> =&gt; <span class="id"><a href="compcert.common.Behaviors.html#Goes_wrong">Goes_wrong</a></span> (<span class="id"><a href="compcert.common.Behaviors.html#t">t</a></span> ** <span class="id">t1</span>)<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="behavior_app_assoc">behavior_app_assoc</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t1</span> <span class="id">t2</span> <span class="id">beh</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Behaviors.html#behavior_app">behavior_app</a></span> (<span class="id"><a href="compcert.common.Behaviors.html#t1">t1</a></span> ** <span class="id"><a href="compcert.common.Behaviors.html#t2">t2</a></span>) <span class="id"><a href="compcert.common.Behaviors.html#beh">beh</a></span> = <span class="id"><a href="compcert.common.Behaviors.html#behavior_app">behavior_app</a></span> <span class="id"><a href="compcert.common.Behaviors.html#t1">t1</a></span> (<span class="id"><a href="compcert.common.Behaviors.html#behavior_app">behavior_app</a></span> <span class="id"><a href="compcert.common.Behaviors.html#t2">t2</a></span> <span class="id"><a href="compcert.common.Behaviors.html#beh">beh</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2044')">Proof.</div>
<div class="proofscript" id="proof2044">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">beh</span>; <span class="tactic">simpl</span>; <span class="tactic">f_equal</span>; <span class="id">traceEq</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="behavior_app_E0">behavior_app_E0</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">beh</span>, <span class="id"><a href="compcert.common.Behaviors.html#behavior_app">behavior_app</a></span> <span class="id"><a href="compcert.common.Events.html#E0">E0</a></span> <span class="id"><a href="compcert.common.Behaviors.html#beh">beh</a></span> = <span class="id"><a href="compcert.common.Behaviors.html#beh">beh</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2045')">Proof.</div>
<div class="proofscript" id="proof2045">
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">beh</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="behavior_prefix">behavior_prefix</a></span> (<span class="id">t</span>: <span class="id"><a href="compcert.common.Events.html#trace">trace</a></span>) (<span class="id">beh</span>: <span class="id"><a href="compcert.common.Behaviors.html#program_behavior">program_behavior</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">beh</span>', <span class="id"><a href="compcert.common.Behaviors.html#beh">beh</a></span> = <span class="id"><a href="compcert.common.Behaviors.html#behavior_app">behavior_app</a></span> <span class="id"><a href="compcert.common.Behaviors.html#t">t</a></span> <span class="id">beh</span>'.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="behavior_improves">behavior_improves</a></span> (<span class="id">beh1</span> <span class="id">beh2</span>: <span class="id"><a href="compcert.common.Behaviors.html#program_behavior">program_behavior</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Behaviors.html#beh1">beh1</a></span> = <span class="id"><a href="compcert.common.Behaviors.html#beh2">beh2</a></span> \/ <span class="id">exists</span> <span class="id">t</span>, <span class="id"><a href="compcert.common.Behaviors.html#beh1">beh1</a></span> = <span class="id"><a href="compcert.common.Behaviors.html#Goes_wrong">Goes_wrong</a></span> <span class="id"><a href="compcert.common.Behaviors.html#t">t</a></span> /\ <span class="id"><a href="compcert.common.Behaviors.html#behavior_prefix">behavior_prefix</a></span> <span class="id"><a href="compcert.common.Behaviors.html#t">t</a></span> <span class="id"><a href="compcert.common.Behaviors.html#beh2">beh2</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="behavior_improves_refl">behavior_improves_refl</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">beh</span>, <span class="id"><a href="compcert.common.Behaviors.html#behavior_improves">behavior_improves</a></span> <span class="id"><a href="compcert.common.Behaviors.html#beh">beh</a></span> <span class="id"><a href="compcert.common.Behaviors.html#beh">beh</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2046')">Proof.</div>
<div class="proofscript" id="proof2046">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="behavior_improves_trans">behavior_improves_trans</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">beh1</span> <span class="id">beh2</span> <span class="id">beh3</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Behaviors.html#behavior_improves">behavior_improves</a></span> <span class="id"><a href="compcert.common.Behaviors.html#beh1">beh1</a></span> <span class="id"><a href="compcert.common.Behaviors.html#beh2">beh2</a></span> -&gt; <span class="id"><a href="compcert.common.Behaviors.html#behavior_improves">behavior_improves</a></span> <span class="id"><a href="compcert.common.Behaviors.html#beh2">beh2</a></span> <span class="id"><a href="compcert.common.Behaviors.html#beh3">beh3</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Behaviors.html#behavior_improves">behavior_improves</a></span> <span class="id"><a href="compcert.common.Behaviors.html#beh1">beh1</a></span> <span class="id"><a href="compcert.common.Behaviors.html#beh3">beh3</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2047')">Proof.</div>
<div class="proofscript" id="proof2047">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">red</span>. <span class="tactic">destruct</span> <span class="id">H</span>; <span class="tactic">destruct</span> <span class="id">H0</span>; <span class="tactic">subst</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [<span class="id">t1</span> [<span class="id">EQ1</span> [<span class="id">beh2</span>' <span class="id">EQ1</span>']]].<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span> <span class="kwd">as</span> [<span class="id">t2</span> [<span class="id">EQ2</span> [<span class="id">beh3</span>' <span class="id">EQ2</span>']]].<br/>
&nbsp;&nbsp;<span class="tactic">subst</span>. <span class="tactic">destruct</span> <span class="id">beh2</span>'; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">EQ2</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>. <span class="id">inv</span> <span class="id">EQ2</span>.<br/>
&nbsp;&nbsp;<span class="id">right</span>. <span class="id">exists</span> <span class="id">t1</span>; <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="id">exists</span> (<span class="id"><a href="compcert.common.Behaviors.html#behavior_app">behavior_app</a></span> <span class="id">t</span> <span class="id">beh3</span>'). <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Behaviors.html#behavior_app_assoc">behavior_app_assoc</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="behavior_improves_bot">behavior_improves_bot</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">beh</span>, <span class="id"><a href="compcert.common.Behaviors.html#behavior_improves">behavior_improves</a></span> (<span class="id"><a href="compcert.common.Behaviors.html#Goes_wrong">Goes_wrong</a></span> <span class="id"><a href="compcert.common.Events.html#E0">E0</a></span>) <span class="id"><a href="compcert.common.Behaviors.html#beh">beh</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2048')">Proof.</div>
<div class="proofscript" id="proof2048">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">right</span>. <span class="id">exists</span> <span class="id"><a href="compcert.common.Events.html#E0">E0</a></span>; <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="id">exists</span> <span class="id">beh</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.common.Behaviors.html#behavior_app_E0">behavior_app_E0</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="behavior_improves_app">behavior_improves_app</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t</span> <span class="id">beh1</span> <span class="id">beh2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Behaviors.html#behavior_improves">behavior_improves</a></span> <span class="id"><a href="compcert.common.Behaviors.html#beh1">beh1</a></span> <span class="id"><a href="compcert.common.Behaviors.html#beh2">beh2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Behaviors.html#behavior_improves">behavior_improves</a></span> (<span class="id"><a href="compcert.common.Behaviors.html#behavior_app">behavior_app</a></span> <span class="id"><a href="compcert.common.Behaviors.html#t">t</a></span> <span class="id"><a href="compcert.common.Behaviors.html#beh1">beh1</a></span>) (<span class="id"><a href="compcert.common.Behaviors.html#behavior_app">behavior_app</a></span> <span class="id"><a href="compcert.common.Behaviors.html#t">t</a></span> <span class="id"><a href="compcert.common.Behaviors.html#beh2">beh2</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2049')">Proof.</div>
<div class="proofscript" id="proof2049">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">red</span>; <span class="tactic">destruct</span> <span class="id">H</span>. <span class="id">left</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [<span class="id">t</span>' [<span class="id">A</span> [<span class="id">beh</span>' <span class="id">B</span>]]]. <span class="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id">right</span>; <span class="id">exists</span> (<span class="id">t</span> ** <span class="id">t</span>'); <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="id">exists</span> <span class="id">beh</span>'. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.common.Behaviors.html#behavior_app_assoc">behavior_app_assoc</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Associating behaviors to programs. </div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="PROGRAM_BEHAVIORS">PROGRAM_BEHAVIORS</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PROGRAM_BEHAVIORS.L">L</a></span>: <span class="id"><a href="compcert.common.Smallstep.html#semantics">semantics</a></span>.<br/>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="state_behaves">state_behaves</a></span> (<span class="id">s</span>: <span class="id"><a href="compcert.common.Smallstep.html#state">state</a></span> <span class="id"><a href="compcert.common.Behaviors.html#PROGRAM_BEHAVIORS.L">L</a></span>): <span class="id"><a href="compcert.common.Behaviors.html#program_behavior">program_behavior</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="state_terminates">state_terminates</a></span>: <span class="kwd">forall</span> <span class="id">t</span> <span class="id">s</span>' <span class="id">r</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Star</span> <span class="id"><a href="compcert.common.Behaviors.html#PROGRAM_BEHAVIORS.L">L</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s">s</a></span> <span class="id"><a href="compcert.common.Behaviors.html#t">t</a></span> <span class="id">s</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Smallstep.html#final_state">final_state</a></span> <span class="id"><a href="compcert.common.Behaviors.html#PROGRAM_BEHAVIORS.L">L</a></span> <span class="id">s</span>' <span class="id"><a href="compcert.common.Behaviors.html#r">r</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Behaviors.html#state_behaves">state_behaves</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s">s</a></span> (<span class="id"><a href="compcert.common.Behaviors.html#Terminates">Terminates</a></span> <span class="id"><a href="compcert.common.Behaviors.html#t">t</a></span> <span class="id"><a href="compcert.common.Behaviors.html#r">r</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="state_diverges">state_diverges</a></span>: <span class="kwd">forall</span> <span class="id">t</span> <span class="id">s</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Star</span> <span class="id"><a href="compcert.common.Behaviors.html#PROGRAM_BEHAVIORS.L">L</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s">s</a></span> <span class="id"><a href="compcert.common.Behaviors.html#t">t</a></span> <span class="id">s</span>' -&gt; <span class="id">Forever_silent</span> <span class="id"><a href="compcert.common.Behaviors.html#PROGRAM_BEHAVIORS.L">L</a></span> <span class="id">s</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Behaviors.html#state_behaves">state_behaves</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s">s</a></span> (<span class="id"><a href="compcert.common.Behaviors.html#Diverges">Diverges</a></span> <span class="id"><a href="compcert.common.Behaviors.html#t">t</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="state_reacts">state_reacts</a></span>: <span class="kwd">forall</span> <span class="id">T</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Forever_reactive</span> <span class="id"><a href="compcert.common.Behaviors.html#PROGRAM_BEHAVIORS.L">L</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s">s</a></span> <span class="id"><a href="compcert.common.Behaviors.html#T">T</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Behaviors.html#state_behaves">state_behaves</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s">s</a></span> (<span class="id"><a href="compcert.common.Behaviors.html#Reacts">Reacts</a></span> <span class="id"><a href="compcert.common.Behaviors.html#T">T</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="state_goes_wrong">state_goes_wrong</a></span>: <span class="kwd">forall</span> <span class="id">t</span> <span class="id">s</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Star</span> <span class="id"><a href="compcert.common.Behaviors.html#PROGRAM_BEHAVIORS.L">L</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s">s</a></span> <span class="id"><a href="compcert.common.Behaviors.html#t">t</a></span> <span class="id">s</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Nostep</span> <span class="id"><a href="compcert.common.Behaviors.html#PROGRAM_BEHAVIORS.L">L</a></span> <span class="id">s</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">r</span>, ~<span class="id"><a href="compcert.common.Smallstep.html#final_state">final_state</a></span> <span class="id"><a href="compcert.common.Behaviors.html#PROGRAM_BEHAVIORS.L">L</a></span> <span class="id">s</span>' <span class="id"><a href="compcert.common.Behaviors.html#r">r</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Behaviors.html#state_behaves">state_behaves</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s">s</a></span> (<span class="id"><a href="compcert.common.Behaviors.html#Goes_wrong">Goes_wrong</a></span> <span class="id"><a href="compcert.common.Behaviors.html#t">t</a></span>).<br/>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="program_behaves">program_behaves</a></span>: <span class="id"><a href="compcert.common.Behaviors.html#program_behavior">program_behavior</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="program_runs">program_runs</a></span>: <span class="kwd">forall</span> <span class="id">s</span> <span class="id">beh</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Smallstep.html#initial_state">initial_state</a></span> <span class="id"><a href="compcert.common.Behaviors.html#PROGRAM_BEHAVIORS.L">L</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s">s</a></span> -&gt; <span class="id"><a href="compcert.common.Behaviors.html#state_behaves">state_behaves</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s">s</a></span> <span class="id"><a href="compcert.common.Behaviors.html#beh">beh</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Behaviors.html#program_behaves">program_behaves</a></span> <span class="id"><a href="compcert.common.Behaviors.html#beh">beh</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="program_goes_initially_wrong">program_goes_initially_wrong</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">s</span>, ~<span class="id"><a href="compcert.common.Smallstep.html#initial_state">initial_state</a></span> <span class="id"><a href="compcert.common.Behaviors.html#PROGRAM_BEHAVIORS.L">L</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s">s</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Behaviors.html#program_behaves">program_behaves</a></span> (<span class="id"><a href="compcert.common.Behaviors.html#Goes_wrong">Goes_wrong</a></span> <span class="id"><a href="compcert.common.Events.html#E0">E0</a></span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="state_behaves_app">state_behaves_app</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s1</span> <span class="id">t</span> <span class="id">s2</span> <span class="id">beh</span>,<br/>
&nbsp;&nbsp;<span class="id">Star</span> <span class="id"><a href="compcert.common.Behaviors.html#PROGRAM_BEHAVIORS.L">L</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s1">s1</a></span> <span class="id"><a href="compcert.common.Behaviors.html#t">t</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s2">s2</a></span> -&gt; <span class="id"><a href="compcert.common.Behaviors.html#state_behaves">state_behaves</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s2">s2</a></span> <span class="id"><a href="compcert.common.Behaviors.html#beh">beh</a></span> -&gt; <span class="id"><a href="compcert.common.Behaviors.html#state_behaves">state_behaves</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s1">s1</a></span> (<span class="id"><a href="compcert.common.Behaviors.html#behavior_app">behavior_app</a></span> <span class="id"><a href="compcert.common.Behaviors.html#t">t</a></span> <span class="id"><a href="compcert.common.Behaviors.html#beh">beh</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2050')">Proof.</div>
<div class="proofscript" id="proof2050">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H0</span>; <span class="tactic">simpl</span>; <span class="id">econstructor</span>; <span class="tactic">eauto</span>; <span class="tactic">try</span> (<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#star_trans">star_trans</a></span>; <span class="tactic">eauto</span>).<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#star_forever_reactive">star_forever_reactive</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<h1> Existence of behaviors </h1>
<br/>
<div class="doc">We now show that any program admits at least one behavior.
  The proof requires classical logic: the axiom of excluded middle
  and an axiom of description. </div>
<br/>
<div class="doc">The most difficult part of the proof is to show the existence
  of an infinite trace in the case of reactive divergence. </div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="PROGRAM_BEHAVIORS.TRACEINF_REACTS">TRACEINF_REACTS</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PROGRAM_BEHAVIORS.TRACEINF_REACTS.s0">s0</a></span>: <span class="id"><a href="compcert.common.Smallstep.html#state">state</a></span> <span class="id"><a href="compcert.common.Behaviors.html#PROGRAM_BEHAVIORS.L">L</a></span>.<br/>
<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="PROGRAM_BEHAVIORS.TRACEINF_REACTS.reacts">reacts</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s1</span> <span class="id">t1</span>, <span class="id">Star</span> <span class="id"><a href="compcert.common.Behaviors.html#PROGRAM_BEHAVIORS.L">L</a></span> <span class="id"><a href="compcert.common.Behaviors.html#PROGRAM_BEHAVIORS.TRACEINF_REACTS.s0">s0</a></span> <span class="id"><a href="compcert.common.Behaviors.html#t1">t1</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s1">s1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">s2</span>, <span class="id">exists</span> <span class="id">t2</span>, <span class="id">Star</span> <span class="id"><a href="compcert.common.Behaviors.html#PROGRAM_BEHAVIORS.L">L</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s1">s1</a></span> <span class="id"><a href="compcert.common.Behaviors.html#t2">t2</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s2">s2</a></span> /\ <span class="id"><a href="compcert.common.Behaviors.html#t2">t2</a></span> &lt;&gt; <span class="id"><a href="compcert.common.Events.html#E0">E0</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">reacts</span>':<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s1</span> <span class="id">t1</span>, <span class="id">Star</span> <span class="id"><a href="compcert.common.Behaviors.html#PROGRAM_BEHAVIORS.L">L</a></span> <span class="id"><a href="compcert.common.Behaviors.html#PROGRAM_BEHAVIORS.TRACEINF_REACTS.s0">s0</a></span> <span class="id"><a href="compcert.common.Behaviors.html#t1">t1</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s1">s1</a></span> -&gt;<br/>
&nbsp;&nbsp;{ <span class="id">s2</span> : <span class="id"><a href="compcert.common.Smallstep.html#state">state</a></span> <span class="id"><a href="compcert.common.Behaviors.html#PROGRAM_BEHAVIORS.L">L</a></span> &amp; { <span class="id">t2</span> : <span class="id"><a href="compcert.common.Events.html#trace">trace</a></span> | <span class="id">Star</span> <span class="id"><a href="compcert.common.Behaviors.html#PROGRAM_BEHAVIORS.L">L</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s1">s1</a></span> <span class="id"><a href="compcert.common.Behaviors.html#t2">t2</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s2">s2</a></span> /\ <span class="id"><a href="compcert.common.Behaviors.html#t2">t2</a></span> &lt;&gt; <span class="id"><a href="compcert.common.Events.html#E0">E0</a></span> } }.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2051')">Proof.</div>
<div class="proofscript" id="proof2051">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.ClassicalEpsilon.html#constructive_indefinite_description">constructive_indefinite_description</a></span> <span class="id">_</span> (<span class="id"><a href="compcert.common.Behaviors.html#PROGRAM_BEHAVIORS.TRACEINF_REACTS.reacts">reacts</a></span> <span class="id">H</span>)) <span class="kwd">as</span> [<span class="id">s2</span> <span class="id">A</span>].<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.ClassicalEpsilon.html#constructive_indefinite_description">constructive_indefinite_description</a></span> <span class="id">_</span> <span class="id">A</span>) <span class="kwd">as</span> [<span class="id">t2</span> [<span class="id">B</span> <span class="id">C</span>]].<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">s2</span>; <span class="id">exists</span> <span class="id">t2</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">CoFixpoint</span> <span class="id">build_traceinf</span>' (<span class="id">s1</span>: <span class="id"><a href="compcert.common.Smallstep.html#state">state</a></span> <span class="id"><a href="compcert.common.Behaviors.html#PROGRAM_BEHAVIORS.L">L</a></span>) (<span class="id">t1</span>: <span class="id"><a href="compcert.common.Events.html#trace">trace</a></span>) (<span class="id">ST</span>: <span class="id">Star</span> <span class="id"><a href="compcert.common.Behaviors.html#PROGRAM_BEHAVIORS.L">L</a></span> <span class="id"><a href="compcert.common.Behaviors.html#PROGRAM_BEHAVIORS.TRACEINF_REACTS.s0">s0</a></span> <span class="id"><a href="compcert.common.Behaviors.html#t1">t1</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s1">s1</a></span>) : <span class="id">traceinf</span>' :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">reacts</span>' <span class="id"><a href="compcert.common.Behaviors.html#ST">ST</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#existT">existT</a></span> <span class="id">s2</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#exist">exist</a></span> <span class="id">t2</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#conj">conj</a></span> <span class="id">A</span> <span class="id">B</span>)) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Econsinf</span>' <span class="id">t2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">build_traceinf</span>' (<span class="id"><a href="compcert.common.Smallstep.html#star_trans">star_trans</a></span> <span class="id"><a href="compcert.common.Behaviors.html#ST">ST</a></span> <span class="id">A</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq_refl">eq_refl</a></span> <span class="id">_</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">B</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="reacts_forever_reactive_rec">reacts_forever_reactive_rec</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s1</span> <span class="id">t1</span> (<span class="id">ST</span>: <span class="id">Star</span> <span class="id"><a href="compcert.common.Behaviors.html#PROGRAM_BEHAVIORS.L">L</a></span> <span class="id"><a href="compcert.common.Behaviors.html#PROGRAM_BEHAVIORS.TRACEINF_REACTS.s0">s0</a></span> <span class="id"><a href="compcert.common.Behaviors.html#t1">t1</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s1">s1</a></span>),<br/>
&nbsp;&nbsp;<span class="id">Forever_reactive</span> <span class="id"><a href="compcert.common.Behaviors.html#PROGRAM_BEHAVIORS.L">L</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s1">s1</a></span> (<span class="id">traceinf_of_traceinf</span>' (<span class="id">build_traceinf</span>' <span class="id"><a href="compcert.common.Behaviors.html#ST">ST</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2052')">Proof.</div>
<div class="proofscript" id="proof2052">
&nbsp;&nbsp;<span class="id">cofix</span> <span class="id">COINDHYP</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id">unroll_traceinf</span>' (<span class="id">build_traceinf</span>' <span class="id">ST</span>)). <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">reacts</span>' <span class="id">ST</span>) <span class="kwd">as</span> [<span class="id">s2</span> [<span class="id">t2</span> [<span class="id">A</span> <span class="id">B</span>]]].<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">traceinf_traceinf</span>'<span class="id">_app</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="id">eexact</span> <span class="id">A</span>. <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id">COINDHYP</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="reacts_forever_reactive">reacts_forever_reactive</a></span>:<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">T</span>, <span class="id">Forever_reactive</span> <span class="id"><a href="compcert.common.Behaviors.html#PROGRAM_BEHAVIORS.L">L</a></span> <span class="id"><a href="compcert.common.Behaviors.html#PROGRAM_BEHAVIORS.TRACEINF_REACTS.s0">s0</a></span> <span class="id"><a href="compcert.common.Behaviors.html#T">T</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2053')">Proof.</div>
<div class="proofscript" id="proof2053">
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id">traceinf_of_traceinf</span>' (<span class="id">build_traceinf</span>' (<span class="id"><a href="compcert.common.Smallstep.html#star_refl">star_refl</a></span> (<span class="id"><a href="compcert.common.Smallstep.html#step">step</a></span> <span class="id"><a href="compcert.common.Behaviors.html#PROGRAM_BEHAVIORS.L">L</a></span>) (<span class="id"><a href="compcert.common.Smallstep.html#symbolenv">symbolenv</a></span> <span class="id"><a href="compcert.common.Behaviors.html#PROGRAM_BEHAVIORS.L">L</a></span>) (<span class="id"><a href="compcert.common.Smallstep.html#globalenv">globalenv</a></span> <span class="id"><a href="compcert.common.Behaviors.html#PROGRAM_BEHAVIORS.L">L</a></span>) <span class="id"><a href="compcert.common.Behaviors.html#PROGRAM_BEHAVIORS.TRACEINF_REACTS.s0">s0</a></span>))).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Behaviors.html#reacts_forever_reactive_rec">reacts_forever_reactive_rec</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.common.Behaviors.html#PROGRAM_BEHAVIORS.TRACEINF_REACTS">TRACEINF_REACTS</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="diverges_forever_silent">diverges_forever_silent</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s0</span>,<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">s1</span> <span class="id">t1</span>, <span class="id">Star</span> <span class="id"><a href="compcert.common.Behaviors.html#PROGRAM_BEHAVIORS.L">L</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s0">s0</a></span> <span class="id"><a href="compcert.common.Behaviors.html#t1">t1</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s1">s1</a></span> -&gt; <span class="id">exists</span> <span class="id">s2</span>, <span class="id">Step</span> <span class="id"><a href="compcert.common.Behaviors.html#PROGRAM_BEHAVIORS.L">L</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s1">s1</a></span> <span class="id"><a href="compcert.common.Events.html#E0">E0</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s2">s2</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">Forever_silent</span> <span class="id"><a href="compcert.common.Behaviors.html#PROGRAM_BEHAVIORS.L">L</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s0">s0</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2054')">Proof.</div>
<div class="proofscript" id="proof2054">
&nbsp;&nbsp;<span class="id">cofix</span> <span class="id">COINDHYP</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">H</span> <span class="id">s0</span> <span class="id"><a href="compcert.common.Events.html#E0">E0</a></span>) <span class="kwd">as</span> [<span class="id">s1</span> <span class="id">ST</span>]. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="id">eexact</span> <span class="id">ST</span>. <span class="tactic">apply</span> <span class="id">COINDHYP</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id">H</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#star_left">star_left</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="state_behaves_exists">state_behaves_exists</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s</span>, <span class="id">exists</span> <span class="id">beh</span>, <span class="id"><a href="compcert.common.Behaviors.html#state_behaves">state_behaves</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s">s</a></span> <span class="id"><a href="compcert.common.Behaviors.html#beh">beh</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2055')">Proof.</div>
<div class="proofscript" id="proof2055">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">s0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#classic">classic</a></span> (<span class="kwd">forall</span> <span class="id">s1</span> <span class="id">t1</span>, <span class="id">Star</span> <span class="id"><a href="compcert.common.Behaviors.html#PROGRAM_BEHAVIORS.L">L</a></span> <span class="id">s0</span> <span class="id"><a href="compcert.common.Behaviors.html#t1">t1</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s1">s1</a></span> -&gt; <span class="id">exists</span> <span class="id">s2</span>, <span class="id">exists</span> <span class="id">t2</span>, <span class="id">Step</span> <span class="id"><a href="compcert.common.Behaviors.html#PROGRAM_BEHAVIORS.L">L</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s1">s1</a></span> <span class="id"><a href="compcert.common.Behaviors.html#t2">t2</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s2">s2</a></span>)).<br/>
<span class="comment">(*&nbsp;1&nbsp;Divergence&nbsp;(silent&nbsp;or&nbsp;reactive)&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#classic">classic</a></span> (<span class="id">exists</span> <span class="id">s1</span>, <span class="id">exists</span> <span class="id">t1</span>, <span class="id">Star</span> <span class="id"><a href="compcert.common.Behaviors.html#PROGRAM_BEHAVIORS.L">L</a></span> <span class="id">s0</span> <span class="id"><a href="compcert.common.Behaviors.html#t1">t1</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s1">s1</a></span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">s2</span> <span class="id">t2</span>, <span class="id">Star</span> <span class="id"><a href="compcert.common.Behaviors.html#PROGRAM_BEHAVIORS.L">L</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s1">s1</a></span> <span class="id"><a href="compcert.common.Behaviors.html#t2">t2</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s2">s2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">s3</span>, <span class="id">Step</span> <span class="id"><a href="compcert.common.Behaviors.html#PROGRAM_BEHAVIORS.L">L</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s2">s2</a></span> <span class="id"><a href="compcert.common.Events.html#E0">E0</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s3">s3</a></span>))).<br/>
<span class="comment">(*&nbsp;1.1&nbsp;Silent&nbsp;divergence&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span> <span class="kwd">as</span> [<span class="id">s1</span> [<span class="id">t1</span> [<span class="id">A</span> <span class="id">B</span>]]].<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="compcert.common.Behaviors.html#Diverges">Diverges</a></span> <span class="id">t1</span>); <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Behaviors.html#diverges_forever_silent">diverges_forever_silent</a></span>; <span class="tactic">auto</span>.<br/>
<span class="comment">(*&nbsp;1.2&nbsp;Reactive&nbsp;divergence&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (@<span class="id"><a href="compcert.common.Behaviors.html#reacts_forever_reactive">reacts_forever_reactive</a></span> <span class="id">s0</span>) <span class="kwd">as</span> [<span class="id">T</span> <span class="id">FR</span>].<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Pred_Type.html#not_ex_all_not">not_ex_all_not</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">H0</span> <span class="id">s1</span>). <span class="tactic">intro</span> <span class="id">A</span>; <span class="tactic">clear</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Pred_Type.html#not_ex_all_not">not_ex_all_not</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">A</span> <span class="id">t1</span>). <span class="tactic">intro</span> <span class="id">B</span>; <span class="tactic">clear</span> <span class="id">A</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#not_and_or">not_and_or</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">B</span>). <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Pred_Type.html#not_all_ex_not">not_all_ex_not</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">H0</span>) <span class="kwd">as</span> [<span class="id">s2</span> <span class="id">C</span>]; <span class="tactic">clear</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Pred_Type.html#not_all_ex_not">not_all_ex_not</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">C</span>) <span class="kwd">as</span> [<span class="id">t2</span> <span class="id">D</span>]; <span class="tactic">clear</span> <span class="id">C</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#imply_to_and">imply_to_and</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">D</span>) <span class="kwd">as</span> [<span class="id">E</span> <span class="id">F</span>]; <span class="tactic">clear</span> <span class="id">D</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">H</span> <span class="id">s2</span> (<span class="id">t1</span> ** <span class="id">t2</span>)) <span class="kwd">as</span> [<span class="id">s3</span> [<span class="id">t3</span> <span class="id">G</span>]]. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#star_trans">star_trans</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">s3</span>; <span class="id">exists</span> (<span class="id">t2</span> ** <span class="id">t3</span>); <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#star_right">star_right</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#app_eq_nil">app_eq_nil</a></span> <span class="id">t2</span> <span class="id">t3</span> <span class="id">H0</span>). <span class="tactic">subst</span>. <span class="tactic">elim</span> <span class="id">F</span>. <span class="id">exists</span> <span class="id">s3</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="compcert.common.Behaviors.html#Reacts">Reacts</a></span> <span class="id">T</span>); <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
<span class="comment">(*&nbsp;2&nbsp;Termination&nbsp;(normal&nbsp;or&nbsp;by&nbsp;going&nbsp;wrong)&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Pred_Type.html#not_all_ex_not">not_all_ex_not</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">H</span>) <span class="kwd">as</span> [<span class="id">s1</span> <span class="id">A</span>]; <span class="tactic">clear</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Pred_Type.html#not_all_ex_not">not_all_ex_not</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">A</span>) <span class="kwd">as</span> [<span class="id">t1</span> <span class="id">B</span>]; <span class="tactic">clear</span> <span class="id">A</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#imply_to_and">imply_to_and</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">B</span>) <span class="kwd">as</span> [<span class="id">C</span> <span class="id">D</span>]; <span class="tactic">clear</span> <span class="id">B</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#classic">classic</a></span> (<span class="id">exists</span> <span class="id">r</span>, <span class="id"><a href="compcert.common.Smallstep.html#final_state">final_state</a></span> <span class="id"><a href="compcert.common.Behaviors.html#PROGRAM_BEHAVIORS.L">L</a></span> <span class="id">s1</span> <span class="id"><a href="compcert.common.Behaviors.html#r">r</a></span>)) <span class="kwd">as</span> [[<span class="id">r</span> <span class="id">FINAL</span>] | <span class="id">NOTFINAL</span>].<br/>
<span class="comment">(*&nbsp;2.1&nbsp;Normal&nbsp;termination&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="compcert.common.Behaviors.html#Terminates">Terminates</a></span> <span class="id">t1</span> <span class="id">r</span>); <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
<span class="comment">(*&nbsp;2.2&nbsp;Going&nbsp;wrong&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="compcert.common.Behaviors.html#Goes_wrong">Goes_wrong</a></span> <span class="id">t1</span>); <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">red</span>. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Pred_Type.html#not_ex_all_not">not_ex_all_not</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">D</span> <span class="id">s</span>'); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Pred_Type.html#not_ex_all_not">not_ex_all_not</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">H</span> <span class="id">t</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="program_behaves_exists">program_behaves_exists</a></span>:<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">beh</span>, <span class="id"><a href="compcert.common.Behaviors.html#program_behaves">program_behaves</a></span> <span class="id"><a href="compcert.common.Behaviors.html#beh">beh</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2056')">Proof.</div>
<div class="proofscript" id="proof2056">
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#classic">classic</a></span> (<span class="id">exists</span> <span class="id">s</span>, <span class="id"><a href="compcert.common.Smallstep.html#initial_state">initial_state</a></span> <span class="id"><a href="compcert.common.Behaviors.html#PROGRAM_BEHAVIORS.L">L</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s">s</a></span>)) <span class="kwd">as</span> [[<span class="id">s0</span> <span class="id">INIT</span>] | <span class="id">NOTINIT</span>].<br/>
<span class="comment">(*&nbsp;1.&nbsp;Initial&nbsp;state&nbsp;is&nbsp;defined.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.Behaviors.html#state_behaves_exists">state_behaves_exists</a></span> <span class="id">s0</span>) <span class="kwd">as</span> [<span class="id">beh</span> <span class="id">SB</span>].<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">beh</span>; <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
<span class="comment">(*&nbsp;2.&nbsp;Initial&nbsp;state&nbsp;is&nbsp;undefined&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="compcert.common.Behaviors.html#Goes_wrong">Goes_wrong</a></span> <span class="id"><a href="compcert.common.Events.html#E0">E0</a></span>). <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Behaviors.html#program_goes_initially_wrong">program_goes_initially_wrong</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Pred_Type.html#not_ex_all_not">not_ex_all_not</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.common.Behaviors.html#PROGRAM_BEHAVIORS">PROGRAM_BEHAVIORS</a></span>.<br/>
<br/>
<h1> Forward simulations and program behaviors </h1>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="FORWARD_SIMULATIONS">FORWARD_SIMULATIONS</a></span>.<br/>
<br/>
<span class="kwd">Context</span> <span class="id">L1</span> <span class="id">L2</span> <span class="id">index</span> <span class="id">order</span> <span class="id">match_states</span> (<span class="id">S</span>: <span class="id"><a href="compcert.common.Smallstep.html#fsim_properties">fsim_properties</a></span> <span class="id"><a href="compcert.common.Behaviors.html#L1">L1</a></span> <span class="id"><a href="compcert.common.Behaviors.html#L2">L2</a></span> <span class="id"><a href="compcert.common.Behaviors.html#index">index</a></span> <span class="id"><a href="compcert.common.Behaviors.html#order">order</a></span> <span class="id"><a href="compcert.common.Behaviors.html#match_states">match_states</a></span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="forward_simulation_state_behaves">forward_simulation_state_behaves</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">i</span> <span class="id">s1</span> <span class="id">s2</span> <span class="id">beh1</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Behaviors.html#FORWARD_SIMULATIONS.match_states">match_states</a></span> <span class="id"><a href="compcert.common.Behaviors.html#i">i</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s1">s1</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s2">s2</a></span> -&gt; <span class="id"><a href="compcert.common.Behaviors.html#state_behaves">state_behaves</a></span> <span class="id"><a href="compcert.common.Behaviors.html#FORWARD_SIMULATIONS.L1">L1</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s1">s1</a></span> <span class="id"><a href="compcert.common.Behaviors.html#beh1">beh1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">beh2</span>, <span class="id"><a href="compcert.common.Behaviors.html#state_behaves">state_behaves</a></span> <span class="id"><a href="compcert.common.Behaviors.html#FORWARD_SIMULATIONS.L2">L2</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s2">s2</a></span> <span class="id"><a href="compcert.common.Behaviors.html#beh2">beh2</a></span> /\ <span class="id"><a href="compcert.common.Behaviors.html#behavior_improves">behavior_improves</a></span> <span class="id"><a href="compcert.common.Behaviors.html#beh1">beh1</a></span> <span class="id"><a href="compcert.common.Behaviors.html#beh2">beh2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2057')">Proof.</div>
<div class="proofscript" id="proof2057">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H0</span>.<br/>
- <span class="comment">(*&nbsp;termination&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Smallstep.html#simulation_star">simulation_star</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">i</span>' [<span class="id">s2</span>' [<span class="id">A</span> <span class="id">B</span>]]].<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="compcert.common.Behaviors.html#Terminates">Terminates</a></span> <span class="id">t</span> <span class="id">r</span>); <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#fsim_match_final_states">fsim_match_final_states</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Behaviors.html#behavior_improves_refl">behavior_improves_refl</a></span>.<br/>
- <span class="comment">(*&nbsp;silent&nbsp;divergence&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Smallstep.html#simulation_star">simulation_star</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">i</span>' [<span class="id">s2</span>' [<span class="id">A</span> <span class="id">B</span>]]].<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="compcert.common.Behaviors.html#Diverges">Diverges</a></span> <span class="id">t</span>); <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#simulation_forever_silent">simulation_forever_silent</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Behaviors.html#behavior_improves_refl">behavior_improves_refl</a></span>.<br/>
- <span class="comment">(*&nbsp;reactive&nbsp;divergence&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="compcert.common.Behaviors.html#Reacts">Reacts</a></span> <span class="id">T</span>); <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#simulation_forever_reactive">simulation_forever_reactive</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Behaviors.html#behavior_improves_refl">behavior_improves_refl</a></span>.<br/>
- <span class="comment">(*&nbsp;going&nbsp;wrong&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Smallstep.html#simulation_star">simulation_star</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">i</span>' [<span class="id">s2</span>' [<span class="id">A</span> <span class="id">B</span>]]].<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.Behaviors.html#state_behaves_exists">state_behaves_exists</a></span> <span class="id"><a href="compcert.common.Behaviors.html#FORWARD_SIMULATIONS.L2">L2</a></span> <span class="id">s2</span>') <span class="kwd">as</span> [<span class="id">beh</span>' <span class="id">SB</span>].<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="compcert.common.Behaviors.html#behavior_app">behavior_app</a></span> <span class="id">t</span> <span class="id">beh</span>'); <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Behaviors.html#state_behaves_app">state_behaves_app</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="compcert.common.Behaviors.html#Goes_wrong">Goes_wrong</a></span> <span class="id">t</span>) <span class="kwd">with</span> (<span class="id"><a href="compcert.common.Behaviors.html#behavior_app">behavior_app</a></span> <span class="id">t</span> (<span class="id"><a href="compcert.common.Behaviors.html#Goes_wrong">Goes_wrong</a></span> <span class="id"><a href="compcert.common.Events.html#E0">E0</a></span>)).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Behaviors.html#behavior_improves_app">behavior_improves_app</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Behaviors.html#behavior_improves_bot">behavior_improves_bot</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="id">decEq</span>. <span class="id">traceEq</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.common.Behaviors.html#FORWARD_SIMULATIONS">FORWARD_SIMULATIONS</a></span>.<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="forward_simulation_behavior_improves">forward_simulation_behavior_improves</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">L1</span> <span class="id">L2</span>, <span class="id"><a href="compcert.common.Smallstep.html#forward_simulation">forward_simulation</a></span> <span class="id"><a href="compcert.common.Behaviors.html#L1">L1</a></span> <span class="id"><a href="compcert.common.Behaviors.html#L2">L2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">beh1</span>, <span class="id"><a href="compcert.common.Behaviors.html#program_behaves">program_behaves</a></span> <span class="id"><a href="compcert.common.Behaviors.html#L1">L1</a></span> <span class="id"><a href="compcert.common.Behaviors.html#beh1">beh1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">beh2</span>, <span class="id"><a href="compcert.common.Behaviors.html#program_behaves">program_behaves</a></span> <span class="id"><a href="compcert.common.Behaviors.html#L2">L2</a></span> <span class="id"><a href="compcert.common.Behaviors.html#beh2">beh2</a></span> /\ <span class="id"><a href="compcert.common.Behaviors.html#behavior_improves">behavior_improves</a></span> <span class="id"><a href="compcert.common.Behaviors.html#beh1">beh1</a></span> <span class="id"><a href="compcert.common.Behaviors.html#beh2">beh2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2058')">Proof.</div>
<div class="proofscript" id="proof2058">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">L1</span> <span class="id">L2</span> <span class="id">FS</span>. <span class="tactic">destruct</span> <span class="id">FS</span> <span class="kwd">as</span> [<span class="id">init</span> <span class="id">order</span> <span class="id">match_states</span> <span class="id">S</span>]. <span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>.<br/>
- <span class="comment">(*&nbsp;initial&nbsp;state&nbsp;defined&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="compcert.common.Smallstep.html#fsim_match_initial_states">fsim_match_initial_states</a></span> <span class="id">S</span>); <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">i</span> [<span class="id">s</span>' [<span class="id">INIT</span> <span class="id">MATCH</span>]]].<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Behaviors.html#forward_simulation_state_behaves">forward_simulation_state_behaves</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">beh2</span> [<span class="id">A</span> <span class="id">B</span>]].<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">beh2</span>; <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
- <span class="comment">(*&nbsp;initial&nbsp;state&nbsp;undefined&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#classic">classic</a></span> (<span class="id">exists</span> <span class="id">s</span>', <span class="id"><a href="compcert.common.Smallstep.html#initial_state">initial_state</a></span> <span class="id">L2</span> <span class="id">s</span>')).<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> [<span class="id">s</span>' <span class="id">INIT</span>].<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.Behaviors.html#state_behaves_exists">state_behaves_exists</a></span> <span class="id">L2</span> <span class="id">s</span>') <span class="kwd">as</span> [<span class="id">beh</span>' <span class="id">SB</span>].<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">beh</span>'; <span class="tactic">split</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Behaviors.html#behavior_improves_bot">behavior_improves_bot</a></span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="compcert.common.Behaviors.html#Goes_wrong">Goes_wrong</a></span> <span class="id"><a href="compcert.common.Events.html#E0">E0</a></span>); <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Behaviors.html#program_goes_initially_wrong">program_goes_initially_wrong</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">elim</span> <span class="id">H</span>; <span class="id">exists</span> <span class="id">s</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Behaviors.html#behavior_improves_refl">behavior_improves_refl</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Corollary</span> <span class="id"><a name="forward_simulation_same_safe_behavior">forward_simulation_same_safe_behavior</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">L1</span> <span class="id">L2</span>, <span class="id"><a href="compcert.common.Smallstep.html#forward_simulation">forward_simulation</a></span> <span class="id"><a href="compcert.common.Behaviors.html#L1">L1</a></span> <span class="id"><a href="compcert.common.Behaviors.html#L2">L2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">beh</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Behaviors.html#program_behaves">program_behaves</a></span> <span class="id"><a href="compcert.common.Behaviors.html#L1">L1</a></span> <span class="id"><a href="compcert.common.Behaviors.html#beh">beh</a></span> -&gt; <span class="id"><a href="compcert.common.Behaviors.html#not_wrong">not_wrong</a></span> <span class="id"><a href="compcert.common.Behaviors.html#beh">beh</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Behaviors.html#program_behaves">program_behaves</a></span> <span class="id"><a href="compcert.common.Behaviors.html#L2">L2</a></span> <span class="id"><a href="compcert.common.Behaviors.html#beh">beh</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2059')">Proof.</div>
<div class="proofscript" id="proof2059">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.common.Behaviors.html#forward_simulation_behavior_improves">forward_simulation_behavior_improves</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">beh</span>' [<span class="id">A</span> <span class="id">B</span>]]. <span class="tactic">destruct</span> <span class="id">B</span>.<br/>
&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H2</span> <span class="kwd">as</span> [<span class="id">t</span> [<span class="id">C</span> <span class="id">D</span>]]. <span class="tactic">subst</span>. <span class="id">contradiction</span>.<br/>
Qed.</div>
<br/>
<h1> Backward simulations and program behaviors </h1>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="BACKWARD_SIMULATIONS">BACKWARD_SIMULATIONS</a></span>.<br/>
<br/>
<span class="kwd">Context</span> <span class="id">L1</span> <span class="id">L2</span> <span class="id">index</span> <span class="id">order</span> <span class="id">match_states</span> (<span class="id">S</span>: <span class="id"><a href="compcert.common.Smallstep.html#bsim_properties">bsim_properties</a></span> <span class="id"><a href="compcert.common.Behaviors.html#L1">L1</a></span> <span class="id"><a href="compcert.common.Behaviors.html#L2">L2</a></span> <span class="id"><a href="compcert.common.Behaviors.html#index">index</a></span> <span class="id"><a href="compcert.common.Behaviors.html#order">order</a></span> <span class="id"><a href="compcert.common.Behaviors.html#match_states">match_states</a></span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="safe_along_behavior">safe_along_behavior</a></span> (<span class="id">s</span>: <span class="id"><a href="compcert.common.Smallstep.html#state">state</a></span> <span class="id"><a href="compcert.common.Behaviors.html#BACKWARD_SIMULATIONS.L1">L1</a></span>) (<span class="id">b</span>: <span class="id"><a href="compcert.common.Behaviors.html#program_behavior">program_behavior</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t1</span> <span class="id">s</span>' <span class="id">b2</span>, <span class="id">Star</span> <span class="id"><a href="compcert.common.Behaviors.html#BACKWARD_SIMULATIONS.L1">L1</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s">s</a></span> <span class="id"><a href="compcert.common.Behaviors.html#t1">t1</a></span> <span class="id">s</span>' -&gt; <span class="id"><a href="compcert.common.Behaviors.html#b">b</a></span> = <span class="id"><a href="compcert.common.Behaviors.html#behavior_app">behavior_app</a></span> <span class="id"><a href="compcert.common.Behaviors.html#t1">t1</a></span> <span class="id"><a href="compcert.common.Behaviors.html#b2">b2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">exists</span> <span class="id">r</span>, <span class="id"><a href="compcert.common.Smallstep.html#final_state">final_state</a></span> <span class="id"><a href="compcert.common.Behaviors.html#BACKWARD_SIMULATIONS.L1">L1</a></span> <span class="id">s</span>' <span class="id"><a href="compcert.common.Behaviors.html#r">r</a></span>)<br/>
&nbsp;&nbsp;\/ (<span class="id">exists</span> <span class="id">t2</span>, <span class="id">exists</span> <span class="id">s</span>'', <span class="id">Step</span> <span class="id"><a href="compcert.common.Behaviors.html#BACKWARD_SIMULATIONS.L1">L1</a></span> <span class="id">s</span>' <span class="id"><a href="compcert.common.Behaviors.html#t2">t2</a></span> <span class="id">s</span>'').<br/>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="safe_along_safe">safe_along_safe</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s</span> <span class="id">b</span>, <span class="id"><a href="compcert.common.Behaviors.html#safe_along_behavior">safe_along_behavior</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s">s</a></span> <span class="id"><a href="compcert.common.Behaviors.html#b">b</a></span> -&gt; <span class="id"><a href="compcert.common.Smallstep.html#safe">safe</a></span> <span class="id"><a href="compcert.common.Behaviors.html#BACKWARD_SIMULATIONS.L1">L1</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s">s</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2060')">Proof.</div>
<div class="proofscript" id="proof2060">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id">H</span>; <span class="tactic">eauto</span>. <span class="tactic">symmetry</span>; <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Behaviors.html#behavior_app_E0">behavior_app_E0</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="star_safe_along">star_safe_along</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s</span> <span class="id">b</span> <span class="id">t1</span> <span class="id">s</span>' <span class="id">b2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Behaviors.html#safe_along_behavior">safe_along_behavior</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s">s</a></span> <span class="id"><a href="compcert.common.Behaviors.html#b">b</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">Star</span> <span class="id"><a href="compcert.common.Behaviors.html#BACKWARD_SIMULATIONS.L1">L1</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s">s</a></span> <span class="id"><a href="compcert.common.Behaviors.html#t1">t1</a></span> <span class="id">s</span>' -&gt; <span class="id"><a href="compcert.common.Behaviors.html#b">b</a></span> = <span class="id"><a href="compcert.common.Behaviors.html#behavior_app">behavior_app</a></span> <span class="id"><a href="compcert.common.Behaviors.html#t1">t1</a></span> <span class="id"><a href="compcert.common.Behaviors.html#b2">b2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Behaviors.html#safe_along_behavior">safe_along_behavior</a></span> <span class="id">s</span>' <span class="id"><a href="compcert.common.Behaviors.html#b2">b2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2061')">Proof.</div>
<div class="proofscript" id="proof2061">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id">H</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#star_trans">star_trans</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">subst</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.common.Behaviors.html#behavior_app_assoc">behavior_app_assoc</a></span>. <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="not_safe_along_behavior">not_safe_along_behavior</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s</span> <span class="id">b</span>,<br/>
&nbsp;&nbsp;~ <span class="id"><a href="compcert.common.Behaviors.html#safe_along_behavior">safe_along_behavior</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s">s</a></span> <span class="id"><a href="compcert.common.Behaviors.html#b">b</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">t</span>, <span class="id">exists</span> <span class="id">s</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Behaviors.html#behavior_prefix">behavior_prefix</a></span> <span class="id"><a href="compcert.common.Behaviors.html#t">t</a></span> <span class="id"><a href="compcert.common.Behaviors.html#b">b</a></span><br/>
&nbsp;&nbsp;/\ <span class="id">Star</span> <span class="id"><a href="compcert.common.Behaviors.html#BACKWARD_SIMULATIONS.L1">L1</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s">s</a></span> <span class="id"><a href="compcert.common.Behaviors.html#t">t</a></span> <span class="id">s</span>'<br/>
&nbsp;&nbsp;/\ <span class="id">Nostep</span> <span class="id"><a href="compcert.common.Behaviors.html#BACKWARD_SIMULATIONS.L1">L1</a></span> <span class="id">s</span>'<br/>
&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">r</span>, ~(<span class="id"><a href="compcert.common.Smallstep.html#final_state">final_state</a></span> <span class="id"><a href="compcert.common.Behaviors.html#BACKWARD_SIMULATIONS.L1">L1</a></span> <span class="id">s</span>' <span class="id"><a href="compcert.common.Behaviors.html#r">r</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2062')">Proof.</div>
<div class="proofscript" id="proof2062">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Pred_Type.html#not_all_ex_not">not_all_ex_not</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">H</span>) <span class="kwd">as</span> [<span class="id">t1</span> <span class="id">A</span>]; <span class="tactic">clear</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Pred_Type.html#not_all_ex_not">not_all_ex_not</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">A</span>) <span class="kwd">as</span> [<span class="id">s</span>' <span class="id">B</span>]; <span class="tactic">clear</span> <span class="id">A</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Pred_Type.html#not_all_ex_not">not_all_ex_not</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">B</span>) <span class="kwd">as</span> [<span class="id">b2</span> <span class="id">C</span>]; <span class="tactic">clear</span> <span class="id">B</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#imply_to_and">imply_to_and</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">C</span>) <span class="kwd">as</span> [<span class="id">D</span> <span class="id">E</span>]; <span class="tactic">clear</span> <span class="id">C</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#imply_to_and">imply_to_and</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">E</span>) <span class="kwd">as</span> [<span class="id">F</span> <span class="id">G</span>]; <span class="tactic">clear</span> <span class="id">E</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#not_or_and">not_or_and</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">G</span>) <span class="kwd">as</span> [<span class="id">P</span> <span class="id">Q</span>]; <span class="tactic">clear</span> <span class="id">G</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">t1</span>; <span class="id">exists</span> <span class="id">s</span>'.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="id">exists</span> <span class="id">b2</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">elim</span> <span class="id">Q</span>. <span class="id">exists</span> <span class="id">t</span>; <span class="id">exists</span> <span class="id">s</span>'0; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">elim</span> <span class="id">P</span>. <span class="id">exists</span> <span class="id">r</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="backward_simulation_star">backward_simulation_star</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s2</span> <span class="id">t</span> <span class="id">s2</span>', <span class="id">Star</span> <span class="id"><a href="compcert.common.Behaviors.html#BACKWARD_SIMULATIONS.L2">L2</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s2">s2</a></span> <span class="id"><a href="compcert.common.Behaviors.html#t">t</a></span> <span class="id">s2</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">i</span> <span class="id">s1</span> <span class="id">b</span>, <span class="id"><a href="compcert.common.Behaviors.html#BACKWARD_SIMULATIONS.match_states">match_states</a></span> <span class="id"><a href="compcert.common.Behaviors.html#i">i</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s1">s1</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s2">s2</a></span> -&gt; <span class="id"><a href="compcert.common.Behaviors.html#safe_along_behavior">safe_along_behavior</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s1">s1</a></span> (<span class="id"><a href="compcert.common.Behaviors.html#behavior_app">behavior_app</a></span> <span class="id"><a href="compcert.common.Behaviors.html#t">t</a></span> <span class="id"><a href="compcert.common.Behaviors.html#b">b</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">i</span>', <span class="id">exists</span> <span class="id">s1</span>', <span class="id">Star</span> <span class="id"><a href="compcert.common.Behaviors.html#BACKWARD_SIMULATIONS.L1">L1</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s1">s1</a></span> <span class="id"><a href="compcert.common.Behaviors.html#t">t</a></span> <span class="id">s1</span>' /\ <span class="id"><a href="compcert.common.Behaviors.html#BACKWARD_SIMULATIONS.match_states">match_states</a></span> <span class="id">i</span>' <span class="id">s1</span>' <span class="id">s2</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2063')">Proof.</div>
<div class="proofscript" id="proof2063">
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">i</span>; <span class="id">exists</span> <span class="id">s1</span>; <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Smallstep.html#star_refl">star_refl</a></span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="compcert.common.Smallstep.html#bsim_simulation">bsim_simulation</a></span> <span class="id"><a href="compcert.common.Behaviors.html#BACKWARD_SIMULATIONS.S">S</a></span>); <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Behaviors.html#safe_along_safe">safe_along_safe</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">i</span>' [<span class="id">s1</span>' [<span class="id">A</span> <span class="id">B</span>]]].<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Star</span> <span class="id"><a href="compcert.common.Behaviors.html#BACKWARD_SIMULATIONS.L1">L1</a></span> <span class="id">s0</span> <span class="id">t1</span> <span class="id">s1</span>'). <span class="tactic">intuition</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_star">plus_star</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">IHstar</span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Behaviors.html#star_safe_along">star_safe_along</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">t</span>; <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Behaviors.html#behavior_app_assoc">behavior_app_assoc</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">i</span>'' [<span class="id">s2</span>'' [<span class="id">C</span> <span class="id">D</span>]]].<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">i</span>''; <span class="id">exists</span> <span class="id">s2</span>''; <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#star_trans">star_trans</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="backward_simulation_forever_silent">backward_simulation_forever_silent</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">i</span> <span class="id">s1</span> <span class="id">s2</span>,<br/>
&nbsp;&nbsp;<span class="id">Forever_silent</span> <span class="id"><a href="compcert.common.Behaviors.html#BACKWARD_SIMULATIONS.L2">L2</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s2">s2</a></span> -&gt; <span class="id"><a href="compcert.common.Behaviors.html#BACKWARD_SIMULATIONS.match_states">match_states</a></span> <span class="id"><a href="compcert.common.Behaviors.html#i">i</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s1">s1</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s2">s2</a></span> -&gt; <span class="id"><a href="compcert.common.Smallstep.html#safe">safe</a></span> <span class="id"><a href="compcert.common.Behaviors.html#BACKWARD_SIMULATIONS.L1">L1</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s1">s1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">Forever_silent</span> <span class="id"><a href="compcert.common.Behaviors.html#BACKWARD_SIMULATIONS.L1">L1</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s1">s1</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2064')">Proof.</div>
<div class="proofscript" id="proof2064">
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">i</span> <span class="id">s1</span> <span class="id">s2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">Forever_silent</span> <span class="id"><a href="compcert.common.Behaviors.html#BACKWARD_SIMULATIONS.L2">L2</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s2">s2</a></span> -&gt; <span class="id"><a href="compcert.common.Behaviors.html#BACKWARD_SIMULATIONS.match_states">match_states</a></span> <span class="id"><a href="compcert.common.Behaviors.html#i">i</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s1">s1</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s2">s2</a></span> -&gt; <span class="id"><a href="compcert.common.Smallstep.html#safe">safe</a></span> <span class="id"><a href="compcert.common.Behaviors.html#BACKWARD_SIMULATIONS.L1">L1</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s1">s1</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Smallstep.html#forever_silent_N">forever_silent_N</a></span> (<span class="id"><a href="compcert.common.Smallstep.html#step">step</a></span> <span class="id"><a href="compcert.common.Behaviors.html#BACKWARD_SIMULATIONS.L1">L1</a></span>) (<span class="id"><a href="compcert.common.Smallstep.html#symbolenv">symbolenv</a></span> <span class="id"><a href="compcert.common.Behaviors.html#BACKWARD_SIMULATIONS.L1">L1</a></span>) <span class="id"><a href="compcert.common.Behaviors.html#BACKWARD_SIMULATIONS.order">order</a></span> (<span class="id"><a href="compcert.common.Smallstep.html#globalenv">globalenv</a></span> <span class="id"><a href="compcert.common.Behaviors.html#BACKWARD_SIMULATIONS.L1">L1</a></span>) <span class="id"><a href="compcert.common.Behaviors.html#i">i</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s1">s1</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">cofix</span> <span class="id">COINDHYP</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>.  <span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.Smallstep.html#bsim_simulation">bsim_simulation</a></span> <span class="id"><a href="compcert.common.Behaviors.html#BACKWARD_SIMULATIONS.S">S</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H2</span> <span class="id">_</span> <span class="id">H0</span> <span class="id">H1</span>) <span class="kwd">as</span> [<span class="id">i</span>' [<span class="id">s2</span>' [<span class="id">A</span> <span class="id">B</span>]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">A</span> <span class="kwd">as</span> [<span class="id">C</span> | [<span class="id">C</span> <span class="id">D</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#forever_silent_N_plus">forever_silent_N_plus</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id">COINDHYP</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#star_safe">star_safe</a></span>; <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_star">plus_star</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#forever_silent_N_star">forever_silent_N_star</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id">COINDHYP</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#star_safe">star_safe</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#forever_silent_N_forever">forever_silent_N_forever</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#bsim_order_wf">bsim_order_wf</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="backward_simulation_forever_reactive">backward_simulation_forever_reactive</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">i</span> <span class="id">s1</span> <span class="id">s2</span> <span class="id">T</span>,<br/>
&nbsp;&nbsp;<span class="id">Forever_reactive</span> <span class="id"><a href="compcert.common.Behaviors.html#BACKWARD_SIMULATIONS.L2">L2</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s2">s2</a></span> <span class="id"><a href="compcert.common.Behaviors.html#T">T</a></span> -&gt; <span class="id"><a href="compcert.common.Behaviors.html#BACKWARD_SIMULATIONS.match_states">match_states</a></span> <span class="id"><a href="compcert.common.Behaviors.html#i">i</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s1">s1</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s2">s2</a></span> -&gt; <span class="id"><a href="compcert.common.Behaviors.html#safe_along_behavior">safe_along_behavior</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s1">s1</a></span> (<span class="id"><a href="compcert.common.Behaviors.html#Reacts">Reacts</a></span> <span class="id"><a href="compcert.common.Behaviors.html#T">T</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">Forever_reactive</span> <span class="id"><a href="compcert.common.Behaviors.html#BACKWARD_SIMULATIONS.L1">L1</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s1">s1</a></span> <span class="id"><a href="compcert.common.Behaviors.html#T">T</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2065')">Proof.</div>
<div class="proofscript" id="proof2065">
&nbsp;&nbsp;<span class="id">cofix</span> <span class="id">COINDHYP</span>; <span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.Behaviors.html#backward_simulation_star">backward_simulation_star</a></span> <span class="id">H2</span> (<span class="id"><a href="compcert.common.Behaviors.html#Reacts">Reacts</a></span> <span class="id">T0</span>) <span class="id">H0</span>) <span class="kwd">as</span> [<span class="id">i</span>' [<span class="id">s1</span>' [<span class="id">A</span> <span class="id">B</span>]]]; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id">COINDHYP</span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Behaviors.html#star_safe_along">star_safe_along</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="backward_simulation_state_behaves">backward_simulation_state_behaves</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">i</span> <span class="id">s1</span> <span class="id">s2</span> <span class="id">beh2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Behaviors.html#BACKWARD_SIMULATIONS.match_states">match_states</a></span> <span class="id"><a href="compcert.common.Behaviors.html#i">i</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s1">s1</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s2">s2</a></span> -&gt; <span class="id"><a href="compcert.common.Behaviors.html#state_behaves">state_behaves</a></span> <span class="id"><a href="compcert.common.Behaviors.html#BACKWARD_SIMULATIONS.L2">L2</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s2">s2</a></span> <span class="id"><a href="compcert.common.Behaviors.html#beh2">beh2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">beh1</span>, <span class="id"><a href="compcert.common.Behaviors.html#state_behaves">state_behaves</a></span> <span class="id"><a href="compcert.common.Behaviors.html#BACKWARD_SIMULATIONS.L1">L1</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s1">s1</a></span> <span class="id"><a href="compcert.common.Behaviors.html#beh1">beh1</a></span> /\ <span class="id"><a href="compcert.common.Behaviors.html#behavior_improves">behavior_improves</a></span> <span class="id"><a href="compcert.common.Behaviors.html#beh1">beh1</a></span> <span class="id"><a href="compcert.common.Behaviors.html#beh2">beh2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2066')">Proof.</div>
<div class="proofscript" id="proof2066">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#classic">classic</a></span> (<span class="id"><a href="compcert.common.Behaviors.html#safe_along_behavior">safe_along_behavior</a></span> <span class="id">s1</span> <span class="id">beh2</span>)).<br/>
- <span class="comment">(*&nbsp;1.&nbsp;Safe&nbsp;along&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">beh2</span>; <span class="tactic">split</span>; [<span class="id">idtac</span>|<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Behaviors.html#behavior_improves_refl">behavior_improves_refl</a></span>].<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H0</span>.<br/>
+ <span class="comment">(*&nbsp;termination&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="compcert.common.Behaviors.html#Terminates">Terminates</a></span> <span class="id">t</span> <span class="id">r</span> = <span class="id"><a href="compcert.common.Behaviors.html#behavior_app">behavior_app</a></span> <span class="id">t</span> (<span class="id"><a href="compcert.common.Behaviors.html#Terminates">Terminates</a></span> <span class="id"><a href="compcert.common.Events.html#E0">E0</a></span> <span class="id">r</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.common.Events.html#E0_right">E0_right</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H0</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Behaviors.html#backward_simulation_star">backward_simulation_star</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">i</span>' [<span class="id">s1</span>' [<span class="id">A</span> <span class="id">B</span>]]].<br/>
&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="compcert.common.Smallstep.html#bsim_match_final_states">bsim_match_final_states</a></span> <span class="id"><a href="compcert.common.Behaviors.html#BACKWARD_SIMULATIONS.S">S</a></span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Behaviors.html#safe_along_safe">safe_along_safe</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Behaviors.html#star_safe_along">star_safe_along</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">s1</span>'' [<span class="id">C</span> <span class="id">D</span>]].<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#star_trans">star_trans</a></span>; <span class="tactic">eauto</span>. <span class="id">traceEq</span>. <span class="tactic">auto</span>.<br/>
+ <span class="comment">(*&nbsp;silent&nbsp;divergence&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="compcert.common.Behaviors.html#Diverges">Diverges</a></span> <span class="id">t</span> = <span class="id"><a href="compcert.common.Behaviors.html#behavior_app">behavior_app</a></span> <span class="id">t</span> (<span class="id"><a href="compcert.common.Behaviors.html#Diverges">Diverges</a></span> <span class="id"><a href="compcert.common.Events.html#E0">E0</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.common.Events.html#E0_right">E0_right</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H0</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Behaviors.html#backward_simulation_star">backward_simulation_star</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">i</span>' [<span class="id">s1</span>' [<span class="id">A</span> <span class="id">B</span>]]].<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Behaviors.html#backward_simulation_forever_silent">backward_simulation_forever_silent</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Behaviors.html#safe_along_safe">safe_along_safe</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Behaviors.html#star_safe_along">star_safe_along</a></span>; <span class="tactic">eauto</span>.<br/>
+ <span class="comment">(*&nbsp;reactive&nbsp;divergence&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Behaviors.html#backward_simulation_forever_reactive">backward_simulation_forever_reactive</a></span>; <span class="tactic">eauto</span>.<br/>
+ <span class="comment">(*&nbsp;goes&nbsp;wrong&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="compcert.common.Behaviors.html#Goes_wrong">Goes_wrong</a></span> <span class="id">t</span> = <span class="id"><a href="compcert.common.Behaviors.html#behavior_app">behavior_app</a></span> <span class="id">t</span> (<span class="id"><a href="compcert.common.Behaviors.html#Goes_wrong">Goes_wrong</a></span> <span class="id"><a href="compcert.common.Events.html#E0">E0</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.common.Events.html#E0_right">E0_right</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H0</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Behaviors.html#backward_simulation_star">backward_simulation_star</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">i</span>' [<span class="id">s1</span>' [<span class="id">A</span> <span class="id">B</span>]]].<br/>
&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="compcert.common.Smallstep.html#bsim_progress">bsim_progress</a></span> <span class="id"><a href="compcert.common.Behaviors.html#BACKWARD_SIMULATIONS.S">S</a></span>); <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Behaviors.html#safe_along_safe">safe_along_safe</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Behaviors.html#star_safe_along">star_safe_along</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [[<span class="id">r</span> <span class="id">FIN</span>] | [<span class="id">t</span>' [<span class="id">s2</span>' <span class="id">STEP2</span>]]].<br/>
&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id">H4</span> <span class="id">_</span> <span class="id">FIN</span>).<br/>
&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id">H3</span> <span class="id">_</span> <span class="id">_</span> <span class="id">STEP2</span>).<br/>
<br/>
- <span class="comment">(*&nbsp;2.&nbsp;Not&nbsp;safe&nbsp;along&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Behaviors.html#not_safe_along_behavior">not_safe_along_behavior</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">t</span> [<span class="id">s1</span>' [<span class="id">PREF</span> [<span class="id">STEPS</span> [<span class="id">NOSTEP</span> <span class="id">NOFIN</span>]]]]].<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="compcert.common.Behaviors.html#Goes_wrong">Goes_wrong</a></span> <span class="id">t</span>); <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">right</span>. <span class="id">exists</span> <span class="id">t</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.common.Behaviors.html#BACKWARD_SIMULATIONS">BACKWARD_SIMULATIONS</a></span>.<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="backward_simulation_behavior_improves">backward_simulation_behavior_improves</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">L1</span> <span class="id">L2</span>, <span class="id"><a href="compcert.common.Smallstep.html#backward_simulation">backward_simulation</a></span> <span class="id"><a href="compcert.common.Behaviors.html#L1">L1</a></span> <span class="id"><a href="compcert.common.Behaviors.html#L2">L2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">beh2</span>, <span class="id"><a href="compcert.common.Behaviors.html#program_behaves">program_behaves</a></span> <span class="id"><a href="compcert.common.Behaviors.html#L2">L2</a></span> <span class="id"><a href="compcert.common.Behaviors.html#beh2">beh2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">beh1</span>, <span class="id"><a href="compcert.common.Behaviors.html#program_behaves">program_behaves</a></span> <span class="id"><a href="compcert.common.Behaviors.html#L1">L1</a></span> <span class="id"><a href="compcert.common.Behaviors.html#beh1">beh1</a></span> /\ <span class="id"><a href="compcert.common.Behaviors.html#behavior_improves">behavior_improves</a></span> <span class="id"><a href="compcert.common.Behaviors.html#beh1">beh1</a></span> <span class="id"><a href="compcert.common.Behaviors.html#beh2">beh2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2067')">Proof.</div>
<div class="proofscript" id="proof2067">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">L1</span> <span class="id">L2</span> <span class="id">S</span> <span class="id">beh2</span> <span class="id">H</span>. <span class="tactic">destruct</span> <span class="id">S</span> <span class="kwd">as</span> [<span class="id">index</span> <span class="id">order</span> <span class="id">match_states</span> <span class="id">S</span>]. <span class="id">inv</span> <span class="id">H</span>.<br/>
- <span class="comment">(*&nbsp;L2's&nbsp;initial&nbsp;state&nbsp;is&nbsp;defined.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#classic">classic</a></span> (<span class="id">exists</span> <span class="id">s1</span>, <span class="id"><a href="compcert.common.Smallstep.html#initial_state">initial_state</a></span> <span class="id">L1</span> <span class="id"><a href="compcert.common.Behaviors.html#s1">s1</a></span>)) <span class="kwd">as</span> [[<span class="id">s1</span> <span class="id">INIT</span>] | <span class="id">NOINIT</span>].<br/>
+ <span class="comment">(*&nbsp;L1's&nbsp;initial&nbsp;state&nbsp;is&nbsp;defined&nbsp;too.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="compcert.common.Smallstep.html#bsim_match_initial_states">bsim_match_initial_states</a></span> <span class="id">S</span>); <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">i</span> [<span class="id">s1</span>' [<span class="id">INIT1</span>' <span class="id">MATCH</span>]]].<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Behaviors.html#backward_simulation_state_behaves">backward_simulation_state_behaves</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">beh1</span> [<span class="id">A</span> <span class="id">B</span>]].<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">beh1</span>; <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
+ <span class="comment">(*&nbsp;L1&nbsp;has&nbsp;no&nbsp;initial&nbsp;state&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="compcert.common.Behaviors.html#Goes_wrong">Goes_wrong</a></span> <span class="id"><a href="compcert.common.Events.html#E0">E0</a></span>); <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Behaviors.html#program_goes_initially_wrong">program_goes_initially_wrong</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">elim</span> <span class="id">NOINIT</span>; <span class="id">exists</span> <span class="id">s0</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Behaviors.html#behavior_improves_bot">behavior_improves_bot</a></span>.<br/>
- <span class="comment">(*&nbsp;L2&nbsp;has&nbsp;no&nbsp;initial&nbsp;state&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="compcert.common.Behaviors.html#Goes_wrong">Goes_wrong</a></span> <span class="id"><a href="compcert.common.Events.html#E0">E0</a></span>); <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Behaviors.html#program_goes_initially_wrong">program_goes_initially_wrong</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="compcert.common.Smallstep.html#bsim_initial_states_exist">bsim_initial_states_exist</a></span> <span class="id">S</span>); <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">s2</span> <span class="id">INIT2</span>].<br/>
&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id">H0</span> <span class="id">s2</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Behaviors.html#behavior_improves_refl">behavior_improves_refl</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Corollary</span> <span class="id"><a name="backward_simulation_same_safe_behavior">backward_simulation_same_safe_behavior</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">L1</span> <span class="id">L2</span>, <span class="id"><a href="compcert.common.Smallstep.html#backward_simulation">backward_simulation</a></span> <span class="id"><a href="compcert.common.Behaviors.html#L1">L1</a></span> <span class="id"><a href="compcert.common.Behaviors.html#L2">L2</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">beh</span>, <span class="id"><a href="compcert.common.Behaviors.html#program_behaves">program_behaves</a></span> <span class="id"><a href="compcert.common.Behaviors.html#L1">L1</a></span> <span class="id"><a href="compcert.common.Behaviors.html#beh">beh</a></span> -&gt; <span class="id"><a href="compcert.common.Behaviors.html#not_wrong">not_wrong</a></span> <span class="id"><a href="compcert.common.Behaviors.html#beh">beh</a></span>) -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">beh</span>, <span class="id"><a href="compcert.common.Behaviors.html#program_behaves">program_behaves</a></span> <span class="id"><a href="compcert.common.Behaviors.html#L2">L2</a></span> <span class="id"><a href="compcert.common.Behaviors.html#beh">beh</a></span> -&gt; <span class="id"><a href="compcert.common.Behaviors.html#program_behaves">program_behaves</a></span> <span class="id"><a href="compcert.common.Behaviors.html#L1">L1</a></span> <span class="id"><a href="compcert.common.Behaviors.html#beh">beh</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2068')">Proof.</div>
<div class="proofscript" id="proof2068">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.common.Behaviors.html#backward_simulation_behavior_improves">backward_simulation_behavior_improves</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">beh</span>' [<span class="id">A</span> <span class="id">B</span>]]. <span class="tactic">destruct</span> <span class="id">B</span>.<br/>
&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H2</span> <span class="kwd">as</span> [<span class="id">t</span> [<span class="id">C</span> <span class="id">D</span>]]. <span class="tactic">subst</span>. <span class="tactic">elim</span> (<span class="id">H0</span> (<span class="id"><a href="compcert.common.Behaviors.html#Goes_wrong">Goes_wrong</a></span> <span class="id">t</span>)). <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<h1> Program behaviors for the "atomic" construction </h1>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="ATOMIC">ATOMIC</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="ATOMIC.L">L</a></span>: <span class="id"><a href="compcert.common.Smallstep.html#semantics">semantics</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="ATOMIC.Lwb">Lwb</a></span>: <span class="id"><a href="compcert.common.Smallstep.html#well_behaved_traces">well_behaved_traces</a></span> <span class="id"><a href="compcert.common.Behaviors.html#ATOMIC.L">L</a></span>.<br/>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="atomic_finish">atomic_finish</a></span>: <span class="kwd">forall</span> <span class="id">s</span> <span class="id">t</span>, <span class="id"><a href="compcert.common.Events.html#output_trace">output_trace</a></span> <span class="id"><a href="compcert.common.Behaviors.html#t">t</a></span> -&gt; <span class="id">Star</span> (<span class="id"><a href="compcert.common.Smallstep.html#atomic">atomic</a></span> <span class="id"><a href="compcert.common.Behaviors.html#ATOMIC.L">L</a></span>) (<span class="id"><a href="compcert.common.Behaviors.html#t">t</a></span>, <span class="id"><a href="compcert.common.Behaviors.html#s">s</a></span>) <span class="id"><a href="compcert.common.Behaviors.html#t">t</a></span> (<span class="id"><a href="compcert.common.Events.html#E0">E0</a></span>, <span class="id"><a href="compcert.common.Behaviors.html#s">s</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2069')">Proof.</div>
<div class="proofscript" id="proof2069">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">t</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Smallstep.html#star_refl">star_refl</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">destruct</span> <span class="id">H</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#star_left">star_left</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Smallstep.html#atomic_step_continue">atomic_step_continue</a></span>; <span class="tactic">auto</span>. <span class="tactic">simpl</span>; <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="step_atomic_plus">step_atomic_plus</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s1</span> <span class="id">t</span> <span class="id">s2</span>, <span class="id">Step</span> <span class="id"><a href="compcert.common.Behaviors.html#ATOMIC.L">L</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s1">s1</a></span> <span class="id"><a href="compcert.common.Behaviors.html#t">t</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s2">s2</a></span> -&gt; <span class="id">Plus</span> (<span class="id"><a href="compcert.common.Smallstep.html#atomic">atomic</a></span> <span class="id"><a href="compcert.common.Behaviors.html#ATOMIC.L">L</a></span>) (<span class="id"><a href="compcert.common.Events.html#E0">E0</a></span>,<span class="id"><a href="compcert.common.Behaviors.html#s1">s1</a></span>) <span class="id"><a href="compcert.common.Behaviors.html#t">t</a></span> (<span class="id"><a href="compcert.common.Events.html#E0">E0</a></span>,<span class="id"><a href="compcert.common.Behaviors.html#s2">s2</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2070')">Proof.</div>
<div class="proofscript" id="proof2070">
&nbsp;&nbsp;<span class="tactic">intros</span>.  <span class="tactic">destruct</span> <span class="id">t</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one</a></span>. <span class="tactic">simpl</span>; <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Smallstep.html#atomic_step_silent">atomic_step_silent</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Behaviors.html#ATOMIC.Lwb">Lwb</a></span>; <span class="tactic">eauto</span>. <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_left">plus_left</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#atomic_step_start">atomic_step_start</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Behaviors.html#atomic_finish">atomic_finish</a></span>; <span class="tactic">eauto</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="star_atomic_star">star_atomic_star</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s1</span> <span class="id">t</span> <span class="id">s2</span>, <span class="id">Star</span> <span class="id"><a href="compcert.common.Behaviors.html#ATOMIC.L">L</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s1">s1</a></span> <span class="id"><a href="compcert.common.Behaviors.html#t">t</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s2">s2</a></span> -&gt; <span class="id">Star</span> (<span class="id"><a href="compcert.common.Smallstep.html#atomic">atomic</a></span> <span class="id"><a href="compcert.common.Behaviors.html#ATOMIC.L">L</a></span>) (<span class="id"><a href="compcert.common.Events.html#E0">E0</a></span>,<span class="id"><a href="compcert.common.Behaviors.html#s1">s1</a></span>) <span class="id"><a href="compcert.common.Behaviors.html#t">t</a></span> (<span class="id"><a href="compcert.common.Events.html#E0">E0</a></span>,<span class="id"><a href="compcert.common.Behaviors.html#s2">s2</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2071')">Proof.</div>
<div class="proofscript" id="proof2071">
&nbsp;&nbsp;<span class="tactic">induction</span> 1. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Smallstep.html#star_refl">star_refl</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#star_trans">star_trans</a></span> <span class="kwd">with</span> (<span class="id">s2</span> := (<span class="id"><a href="compcert.common.Events.html#E0">E0</a></span>,<span class="id">s2</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_star">plus_star</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Behaviors.html#step_atomic_plus">step_atomic_plus</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="atomic_forward_simulation">atomic_forward_simulation</a></span>: <span class="id"><a href="compcert.common.Smallstep.html#forward_simulation">forward_simulation</a></span> <span class="id"><a href="compcert.common.Behaviors.html#ATOMIC.L">L</a></span> (<span class="id"><a href="compcert.common.Smallstep.html#atomic">atomic</a></span> <span class="id"><a href="compcert.common.Behaviors.html#ATOMIC.L">L</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2072')">Proof.</div>
<div class="proofscript" id="proof2072">
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">ms</span> := <span class="kwd">fun</span> (<span class="id">s</span>: <span class="id"><a href="compcert.common.Smallstep.html#state">state</a></span> <span class="id"><a href="compcert.common.Behaviors.html#ATOMIC.L">L</a></span>) (<span class="id">ts</span>: <span class="id"><a href="compcert.common.Smallstep.html#state">state</a></span> (<span class="id"><a href="compcert.common.Smallstep.html#atomic">atomic</a></span> <span class="id"><a href="compcert.common.Behaviors.html#ATOMIC.L">L</a></span>)) =&gt; <span class="id"><a href="compcert.common.Behaviors.html#ts">ts</a></span> = (<span class="id"><a href="compcert.common.Events.html#E0">E0</a></span>,<span class="id"><a href="compcert.common.Behaviors.html#s">s</a></span>)).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Smallstep.html#forward_simulation_plus">forward_simulation_plus</a></span> <span class="kwd">with</span> <span class="id">ms</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="compcert.common.Events.html#E0">E0</a></span>,<span class="id">s1</span>); <span class="tactic">split</span>. <span class="tactic">simpl</span>; <span class="tactic">auto</span>. <span class="tactic">red</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">subst</span> <span class="id">s2</span>. <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="tactic">subst</span> <span class="id">s2</span>. <span class="id">exists</span> (<span class="id"><a href="compcert.common.Events.html#E0">E0</a></span>,<span class="id">s1</span>'); <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Behaviors.html#step_atomic_plus">step_atomic_plus</a></span>; <span class="tactic">auto</span>. <span class="tactic">red</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="atomic_star_star_gen">atomic_star_star_gen</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ts1</span> <span class="id">t</span> <span class="id">ts2</span>, <span class="id">Star</span> (<span class="id"><a href="compcert.common.Smallstep.html#atomic">atomic</a></span> <span class="id"><a href="compcert.common.Behaviors.html#ATOMIC.L">L</a></span>) <span class="id"><a href="compcert.common.Behaviors.html#ts1">ts1</a></span> <span class="id"><a href="compcert.common.Behaviors.html#t">t</a></span> <span class="id"><a href="compcert.common.Behaviors.html#ts2">ts2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">t</span>', <span class="id">Star</span> <span class="id"><a href="compcert.common.Behaviors.html#ATOMIC.L">L</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id"><a href="compcert.common.Behaviors.html#ts1">ts1</a></span>) <span class="id">t</span>' (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id"><a href="compcert.common.Behaviors.html#ts2">ts2</a></span>) /\ <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="compcert.common.Behaviors.html#ts1">ts1</a></span> ** <span class="id">t</span>' = <span class="id"><a href="compcert.common.Behaviors.html#t">t</a></span> ** <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="compcert.common.Behaviors.html#ts2">ts2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2073')">Proof.</div>
<div class="proofscript" id="proof2073">
&nbsp;&nbsp;<span class="tactic">induction</span> 1.<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id"><a href="compcert.common.Events.html#E0">E0</a></span>; <span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Smallstep.html#star_refl">star_refl</a></span>. <span class="id">traceEq</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">IHstar</span> <span class="kwd">as</span> [<span class="id">t</span>' [<span class="id">A</span> <span class="id">B</span>]].<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">inv</span> <span class="id">H</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">t</span>'; <span class="tactic">split</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#star_left">star_left</a></span>; <span class="tactic">eauto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id">ev</span> :: <span class="id">t0</span> ** <span class="id">t</span>'); <span class="tactic">split</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#star_left">star_left</a></span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id">B</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">t</span>'; <span class="tactic">split</span>. <span class="tactic">auto</span>. <span class="tactic">rewrite</span> <span class="id">B</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="atomic_star_star">atomic_star_star</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s1</span> <span class="id">t</span> <span class="id">s2</span>, <span class="id">Star</span> (<span class="id"><a href="compcert.common.Smallstep.html#atomic">atomic</a></span> <span class="id"><a href="compcert.common.Behaviors.html#ATOMIC.L">L</a></span>) (<span class="id"><a href="compcert.common.Events.html#E0">E0</a></span>,<span class="id"><a href="compcert.common.Behaviors.html#s1">s1</a></span>) <span class="id"><a href="compcert.common.Behaviors.html#t">t</a></span> (<span class="id"><a href="compcert.common.Events.html#E0">E0</a></span>,<span class="id"><a href="compcert.common.Behaviors.html#s2">s2</a></span>) -&gt; <span class="id">Star</span> <span class="id"><a href="compcert.common.Behaviors.html#ATOMIC.L">L</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s1">s1</a></span> <span class="id"><a href="compcert.common.Behaviors.html#t">t</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s2">s2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2074')">Proof.</div>
<div class="proofscript" id="proof2074">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.common.Behaviors.html#atomic_star_star_gen">atomic_star_star_gen</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">t</span>' [<span class="id">A</span> <span class="id">B</span>]].<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">replace</span> <span class="id">t</span> <span class="kwd">with</span> <span class="id">t</span>'. <span class="tactic">auto</span>. <span class="tactic">subst</span>; <span class="id">traceEq</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="atomic_forever_silent_forever_silent">atomic_forever_silent_forever_silent</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s</span>, <span class="id">Forever_silent</span> (<span class="id"><a href="compcert.common.Smallstep.html#atomic">atomic</a></span> <span class="id"><a href="compcert.common.Behaviors.html#ATOMIC.L">L</a></span>) <span class="id"><a href="compcert.common.Behaviors.html#s">s</a></span> -&gt; <span class="id">Forever_silent</span> <span class="id"><a href="compcert.common.Behaviors.html#ATOMIC.L">L</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s">s</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2075')">Proof.</div>
<div class="proofscript" id="proof2075">
&nbsp;&nbsp;<span class="id">cofix</span> <span class="id">COINDHYP</span>; <span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="id">inv</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Smallstep.html#forever_silent_intro">forever_silent_intro</a></span> <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> (<span class="id"><a href="compcert.common.Events.html#E0">E0</a></span>, <span class="id">s</span>')). <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id">COINDHYP</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="star_atomic_output_trace">star_atomic_output_trace</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s</span> <span class="id">t</span> <span class="id">t</span>' <span class="id">s</span>',<br/>
&nbsp;&nbsp;<span class="id">Star</span> (<span class="id"><a href="compcert.common.Smallstep.html#atomic">atomic</a></span> <span class="id"><a href="compcert.common.Behaviors.html#ATOMIC.L">L</a></span>) (<span class="id"><a href="compcert.common.Events.html#E0">E0</a></span>, <span class="id"><a href="compcert.common.Behaviors.html#s">s</a></span>) <span class="id"><a href="compcert.common.Behaviors.html#t">t</a></span> (<span class="id">t</span>', <span class="id">s</span>') -&gt; <span class="id"><a href="compcert.common.Events.html#output_trace">output_trace</a></span> <span class="id">t</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2076')">Proof.</div>
<div class="proofscript" id="proof2076">
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">ts1</span> <span class="id">t</span> <span class="id">ts2</span>, <span class="id">Star</span> (<span class="id"><a href="compcert.common.Smallstep.html#atomic">atomic</a></span> <span class="id"><a href="compcert.common.Behaviors.html#ATOMIC.L">L</a></span>) <span class="id"><a href="compcert.common.Behaviors.html#ts1">ts1</a></span> <span class="id"><a href="compcert.common.Behaviors.html#t">t</a></span> <span class="id"><a href="compcert.common.Behaviors.html#ts2">ts2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Events.html#output_trace">output_trace</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="compcert.common.Behaviors.html#ts1">ts1</a></span>) -&gt; <span class="id"><a href="compcert.common.Events.html#output_trace">output_trace</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="compcert.common.Behaviors.html#ts2">ts2</a></span>)).<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">intros</span>. <span class="tactic">auto</span>. <span class="id">inv</span> <span class="id">H</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHstar</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHstar</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.common.Behaviors.html#ATOMIC.Lwb">Lwb</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H2</span>. <span class="tactic">apply</span> <span class="id">IHstar</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">change</span> <span class="id">t</span>' <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id">t</span>',<span class="id">s</span>')). <span class="tactic">eapply</span> <span class="id">H</span>; <span class="tactic">eauto</span>. <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="atomic_forever_reactive_forever_reactive">atomic_forever_reactive_forever_reactive</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s</span> <span class="id">T</span>, <span class="id">Forever_reactive</span> (<span class="id"><a href="compcert.common.Smallstep.html#atomic">atomic</a></span> <span class="id"><a href="compcert.common.Behaviors.html#ATOMIC.L">L</a></span>) (<span class="id"><a href="compcert.common.Events.html#E0">E0</a></span>,<span class="id"><a href="compcert.common.Behaviors.html#s">s</a></span>) <span class="id"><a href="compcert.common.Behaviors.html#T">T</a></span> -&gt; <span class="id">Forever_reactive</span> <span class="id"><a href="compcert.common.Behaviors.html#ATOMIC.L">L</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s">s</a></span> <span class="id"><a href="compcert.common.Behaviors.html#T">T</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2077')">Proof.</div>
<div class="proofscript" id="proof2077">
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">t</span> <span class="id">s</span> <span class="id">T</span>, <span class="id">Forever_reactive</span> (<span class="id"><a href="compcert.common.Smallstep.html#atomic">atomic</a></span> <span class="id"><a href="compcert.common.Behaviors.html#ATOMIC.L">L</a></span>) (<span class="id"><a href="compcert.common.Behaviors.html#t">t</a></span>,<span class="id"><a href="compcert.common.Behaviors.html#s">s</a></span>) <span class="id"><a href="compcert.common.Behaviors.html#T">T</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">T</span>', <span class="id">Forever_reactive</span> (<span class="id"><a href="compcert.common.Smallstep.html#atomic">atomic</a></span> <span class="id"><a href="compcert.common.Behaviors.html#ATOMIC.L">L</a></span>) (<span class="id"><a href="compcert.common.Events.html#E0">E0</a></span>,<span class="id"><a href="compcert.common.Behaviors.html#s">s</a></span>) <span class="id">T</span>' /\ <span class="id"><a href="compcert.common.Behaviors.html#T">T</a></span> = <span class="id"><a href="compcert.common.Behaviors.html#t">t</a></span> *** <span class="id">T</span>').<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">t</span>; <span class="tactic">intros</span>. <span class="id">exists</span> <span class="id">T</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>. <span class="id">inv</span> <span class="id">H0</span>. <span class="tactic">congruence</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">IHt</span> <span class="id">s</span> (<span class="id">t2</span>***<span class="id">T0</span>)) <span class="kwd">as</span> [<span class="id">T</span>' [<span class="id">A</span> <span class="id">B</span>]]. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#star_forever_reactive">star_forever_reactive</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">T</span>'; <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">simpl</span>. <span class="tactic">congruence</span>.<br/>
<br/>
&nbsp;&nbsp;<span class="id">cofix</span> <span class="id">COINDHYP</span>; <span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H0</span>. <span class="tactic">destruct</span> <span class="id">s2</span> <span class="kwd">as</span> [<span class="id">t2</span> <span class="id">s2</span>].<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">H</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H3</span>) <span class="kwd">as</span> [<span class="id">T</span>' [<span class="id">A</span> <span class="id">B</span>]].<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">Star</span> (<span class="id"><a href="compcert.common.Smallstep.html#atomic">atomic</a></span> <span class="id"><a href="compcert.common.Behaviors.html#ATOMIC.L">L</a></span>) (<span class="id"><a href="compcert.common.Events.html#E0">E0</a></span>, <span class="id">s</span>) (<span class="id">t</span>**<span class="id">t2</span>) (<span class="id"><a href="compcert.common.Events.html#E0">E0</a></span>, <span class="id">s2</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#star_trans">star_trans</a></span>. <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Behaviors.html#atomic_finish">atomic_finish</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Behaviors.html#star_atomic_output_trace">star_atomic_output_trace</a></span>; <span class="tactic">eauto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">t</span> *** <span class="id">T0</span>) <span class="kwd">with</span> ((<span class="id">t</span> ** <span class="id">t2</span>) *** <span class="id">T</span>'). <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Smallstep.html#forever_reactive_intro">forever_reactive_intro</a></span> <span class="kwd">with</span> <span class="id">s2</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Behaviors.html#atomic_star_star">atomic_star_star</a></span>; <span class="tactic">auto</span>. <span class="tactic">destruct</span> <span class="id">t</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">unfold</span> <span class="id"><a href="compcert.common.Events.html#E0">E0</a></span> <span class="kwd">in</span> *; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">COINDHYP</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">T0</span>; <span class="id">traceEq</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="atomic_behaviors">atomic_behaviors</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">beh</span>, <span class="id"><a href="compcert.common.Behaviors.html#program_behaves">program_behaves</a></span> <span class="id"><a href="compcert.common.Behaviors.html#ATOMIC.L">L</a></span> <span class="id"><a href="compcert.common.Behaviors.html#beh">beh</a></span> &lt;-&gt; <span class="id"><a href="compcert.common.Behaviors.html#program_behaves">program_behaves</a></span> (<span class="id"><a href="compcert.common.Smallstep.html#atomic">atomic</a></span> <span class="id"><a href="compcert.common.Behaviors.html#ATOMIC.L">L</a></span>) <span class="id"><a href="compcert.common.Behaviors.html#beh">beh</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2078')">Proof.</div>
<div class="proofscript" id="proof2078">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">split</span>; <span class="tactic">intros</span>.<br/>
- <span class="comment">(*&nbsp;L&nbsp;-&gt;&nbsp;atomic&nbsp;L&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Behaviors.html#forward_simulation_behavior_improves">forward_simulation_behavior_improves</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Behaviors.html#atomic_forward_simulation">atomic_forward_simulation</a></span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">beh2</span> [<span class="id">A</span> <span class="id">B</span>]]. <span class="tactic">red</span> <span class="kwd">in</span> <span class="id">B</span>. <span class="tactic">destruct</span> <span class="id">B</span> <span class="kwd">as</span> [<span class="id">EQ</span> | [<span class="id">t</span> [<span class="id">C</span> <span class="id">D</span>]]].<br/>
&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">beh</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Behaviors.html#program_runs">program_runs</a></span> <span class="kwd">with</span> (<span class="id"><a href="compcert.common.Events.html#E0">E0</a></span>,<span class="id">s</span>). <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Behaviors.html#state_goes_wrong">state_goes_wrong</a></span> <span class="kwd">with</span> (<span class="id"><a href="compcert.common.Events.html#E0">E0</a></span>,<span class="id">s</span>'). <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Behaviors.html#star_atomic_star">star_atomic_star</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="id">eelim</span> <span class="id">H3</span>; <span class="tactic">eauto</span>. <span class="id">eelim</span> <span class="id">H3</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">destruct</span> <span class="id">H</span>. <span class="id">eelim</span> <span class="id">H4</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Behaviors.html#program_goes_initially_wrong">program_goes_initially_wrong</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">destruct</span> <span class="id">H</span>. <span class="id">eelim</span> <span class="id">H1</span>; <span class="tactic">eauto</span>.<br/>
- <span class="comment">(*&nbsp;atomic&nbsp;L&nbsp;-&gt;&nbsp;L&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>.<br/>
+ <span class="comment">(*&nbsp;initial&nbsp;state&nbsp;defined&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">s</span> <span class="kwd">as</span> [<span class="id">t</span> <span class="id">s</span>]. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="tactic">destruct</span> <span class="id">H0</span>; <span class="tactic">subst</span> <span class="id">t</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Behaviors.html#program_runs">program_runs</a></span> <span class="kwd">with</span> <span class="id">s</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H1</span>.<br/>
* <span class="comment">(*&nbsp;termination&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">s</span>' <span class="kwd">as</span> [<span class="id">t</span>' <span class="id">s</span>']. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H2</span>; <span class="tactic">destruct</span> <span class="id">H2</span>; <span class="tactic">subst</span> <span class="id">t</span>'.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Behaviors.html#atomic_star_star">atomic_star_star</a></span>; <span class="tactic">eauto</span>. <span class="tactic">auto</span>.<br/>
* <span class="comment">(*&nbsp;silent&nbsp;divergence&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">s</span>' <span class="kwd">as</span> [<span class="id">t</span>' <span class="id">s</span>'].<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">t</span>' = <span class="id"><a href="compcert.common.Events.html#E0">E0</a></span>). <span class="id">inv</span> <span class="id">H2</span>. <span class="id">inv</span> <span class="id">H1</span>; <span class="tactic">auto</span>. <span class="tactic">subst</span> <span class="id">t</span>'.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Behaviors.html#atomic_star_star">atomic_star_star</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">change</span> <span class="id">s</span>' <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> (<span class="id"><a href="compcert.common.Events.html#E0">E0</a></span>,<span class="id">s</span>')). <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Behaviors.html#atomic_forever_silent_forever_silent">atomic_forever_silent_forever_silent</a></span>. <span class="tactic">auto</span>.<br/>
* <span class="comment">(*&nbsp;reactive&nbsp;divergence&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Behaviors.html#atomic_forever_reactive_forever_reactive">atomic_forever_reactive_forever_reactive</a></span>. <span class="tactic">auto</span>.<br/>
* <span class="comment">(*&nbsp;going&nbsp;wrong&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">s</span>' <span class="kwd">as</span> [<span class="id">t</span>' <span class="id">s</span>'].<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">t</span>' = <span class="id"><a href="compcert.common.Events.html#E0">E0</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">t</span>'; <span class="tactic">auto</span>. <span class="id">eelim</span> <span class="id">H2</span>. <span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Smallstep.html#atomic_step_continue">atomic_step_continue</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Behaviors.html#star_atomic_output_trace">star_atomic_output_trace</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">t</span>'. <span class="id">econstructor</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Behaviors.html#atomic_star_star">atomic_star_star</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">t0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id">H2</span> <span class="id"><a href="compcert.common.Events.html#E0">E0</a></span> (<span class="id"><a href="compcert.common.Events.html#E0">E0</a></span>,<span class="id">s</span>'0)). <span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id">H2</span> (<span class="id">e</span>::<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) (<span class="id">t0</span>,<span class="id">s</span>'0)). <span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">elim</span> (<span class="id">H3</span> <span class="id">r</span>). <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
+ <span class="comment">(*&nbsp;initial&nbsp;state&nbsp;undefined&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Behaviors.html#program_goes_initially_wrong">program_goes_initially_wrong</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">elim</span> (<span class="id">H0</span> (<span class="id"><a href="compcert.common.Events.html#E0">E0</a></span>,<span class="id">s</span>)); <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.common.Behaviors.html#ATOMIC">ATOMIC</a></span>.<br/>
<br/>
<h1> Additional results about infinite reduction sequences </h1>
<br/>
<div class="doc">We now show that any infinite sequence of reductions is either of
  the "reactive" kind or of the "silent" kind (after a finite number
  of non-silent transitions).  The proof necessitates the axiom of
  excluded middle.  This result is used below to relate
  the coinductive big-step semantics for divergence with the
  small-step notions of divergence. </div>
<br/>
<span class="kwd">Unset</span> <span class="kwd">Implicit</span> <span class="id">Arguments</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="INF_SEQ_DECOMP">INF_SEQ_DECOMP</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="INF_SEQ_DECOMP.genv">genv</a></span>: <span class="kwd">Type</span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="INF_SEQ_DECOMP.state">state</a></span>: <span class="kwd">Type</span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="INF_SEQ_DECOMP.step">step</a></span>: <span class="id"><a href="compcert.common.Globalenvs.html#Senv.t">Senv.t</a></span> -&gt; <span class="id"><a href="compcert.common.Behaviors.html#INF_SEQ_DECOMP.genv">genv</a></span> -&gt; <span class="id"><a href="compcert.common.Behaviors.html#INF_SEQ_DECOMP.state">state</a></span> -&gt; <span class="id"><a href="compcert.common.Events.html#trace">trace</a></span> -&gt; <span class="id"><a href="compcert.common.Behaviors.html#INF_SEQ_DECOMP.state">state</a></span> -&gt; <span class="kwd">Prop</span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="INF_SEQ_DECOMP.se">se</a></span>: <span class="id"><a href="compcert.common.Globalenvs.html#Senv.t">Senv.t</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="INF_SEQ_DECOMP.ge">ge</a></span>: <span class="id"><a href="compcert.common.Behaviors.html#INF_SEQ_DECOMP.genv">genv</a></span>.<br/>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="tstate">tstate</a></span>: <span class="kwd">Type</span> :=<br/>
&nbsp;&nbsp;<span class="id"><a name="ST">ST</a></span>: <span class="kwd">forall</span> (<span class="id">s</span>: <span class="id"><a href="compcert.common.Behaviors.html#INF_SEQ_DECOMP.state">state</a></span>) (<span class="id">T</span>: <span class="id"><a href="compcert.common.Events.html#traceinf">traceinf</a></span>), <span class="id"><a href="compcert.common.Smallstep.html#forever">forever</a></span> <span class="id"><a href="compcert.common.Behaviors.html#INF_SEQ_DECOMP.step">step</a></span> <span class="id"><a href="compcert.common.Behaviors.html#INF_SEQ_DECOMP.se">se</a></span> <span class="id"><a href="compcert.common.Behaviors.html#INF_SEQ_DECOMP.ge">ge</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s">s</a></span> <span class="id"><a href="compcert.common.Behaviors.html#T">T</a></span> -&gt; <span class="id"><a href="compcert.common.Behaviors.html#tstate">tstate</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="state_of_tstate">state_of_tstate</a></span> (<span class="id">S</span>: <span class="id"><a href="compcert.common.Behaviors.html#tstate">tstate</a></span>): <span class="id"><a href="compcert.common.Behaviors.html#INF_SEQ_DECOMP.state">state</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.common.Behaviors.html#S">S</a></span> <span class="kwd">with</span> <span class="id"><a href="compcert.common.Behaviors.html#ST">ST</a></span> <span class="id">s</span> <span class="id">T</span> <span class="id">F</span> =&gt; <span class="id">s</span> <span class="kwd">end</span>.<br/>
<span class="kwd">Definition</span> <span class="id"><a name="traceinf_of_tstate">traceinf_of_tstate</a></span> (<span class="id">S</span>: <span class="id"><a href="compcert.common.Behaviors.html#tstate">tstate</a></span>) : <span class="id"><a href="compcert.common.Events.html#traceinf">traceinf</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.common.Behaviors.html#S">S</a></span> <span class="kwd">with</span> <span class="id"><a href="compcert.common.Behaviors.html#ST">ST</a></span> <span class="id">s</span> <span class="id">T</span> <span class="id">F</span> =&gt; <span class="id">T</span> <span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="tstep">tstep</a></span>: <span class="id"><a href="compcert.common.Events.html#trace">trace</a></span> -&gt; <span class="id"><a href="compcert.common.Behaviors.html#tstate">tstate</a></span> -&gt; <span class="id"><a href="compcert.common.Behaviors.html#tstate">tstate</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="tstep_intro">tstep_intro</a></span>: <span class="kwd">forall</span> <span class="id">s1</span> <span class="id">t</span> <span class="id">T</span> <span class="id">s2</span> <span class="id">S</span> <span class="id">F</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Behaviors.html#tstep">tstep</a></span> <span class="id"><a href="compcert.common.Behaviors.html#t">t</a></span> (<span class="id"><a href="compcert.common.Behaviors.html#ST">ST</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s1">s1</a></span> (<span class="id"><a href="compcert.common.Behaviors.html#t">t</a></span> *** <span class="id"><a href="compcert.common.Behaviors.html#T">T</a></span>) (@<span class="id"><a href="compcert.common.Smallstep.html#forever_intro">forever_intro</a></span> <span class="id"><a href="compcert.common.Behaviors.html#INF_SEQ_DECOMP.genv">genv</a></span> <span class="id"><a href="compcert.common.Behaviors.html#INF_SEQ_DECOMP.state">state</a></span> <span class="id"><a href="compcert.common.Behaviors.html#INF_SEQ_DECOMP.step">step</a></span> <span class="id"><a href="compcert.common.Behaviors.html#INF_SEQ_DECOMP.se">se</a></span> <span class="id"><a href="compcert.common.Behaviors.html#INF_SEQ_DECOMP.ge">ge</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s1">s1</a></span> <span class="id"><a href="compcert.common.Behaviors.html#t">t</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s2">s2</a></span> <span class="id"><a href="compcert.common.Behaviors.html#T">T</a></span> <span class="id"><a href="compcert.common.Behaviors.html#S">S</a></span> <span class="id"><a href="compcert.common.Behaviors.html#F">F</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.common.Behaviors.html#ST">ST</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s2">s2</a></span> <span class="id"><a href="compcert.common.Behaviors.html#T">T</a></span> <span class="id"><a href="compcert.common.Behaviors.html#F">F</a></span>).<br/>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="tsteps">tsteps</a></span>: <span class="id"><a href="compcert.common.Behaviors.html#tstate">tstate</a></span> -&gt; <span class="id"><a href="compcert.common.Behaviors.html#tstate">tstate</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="tsteps_refl">tsteps_refl</a></span>: <span class="kwd">forall</span> <span class="id">S</span>, <span class="id"><a href="compcert.common.Behaviors.html#tsteps">tsteps</a></span> <span class="id"><a href="compcert.common.Behaviors.html#S">S</a></span> <span class="id"><a href="compcert.common.Behaviors.html#S">S</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="tsteps_left">tsteps_left</a></span>: <span class="kwd">forall</span> <span class="id">t</span> <span class="id">S1</span> <span class="id">S2</span> <span class="id">S3</span>, <span class="id"><a href="compcert.common.Behaviors.html#tstep">tstep</a></span> <span class="id"><a href="compcert.common.Behaviors.html#t">t</a></span> <span class="id"><a href="compcert.common.Behaviors.html#S1">S1</a></span> <span class="id"><a href="compcert.common.Behaviors.html#S2">S2</a></span> -&gt; <span class="id"><a href="compcert.common.Behaviors.html#tsteps">tsteps</a></span> <span class="id"><a href="compcert.common.Behaviors.html#S2">S2</a></span> <span class="id"><a href="compcert.common.Behaviors.html#S3">S3</a></span> -&gt; <span class="id"><a href="compcert.common.Behaviors.html#tsteps">tsteps</a></span> <span class="id"><a href="compcert.common.Behaviors.html#S1">S1</a></span> <span class="id"><a href="compcert.common.Behaviors.html#S3">S3</a></span>.<br/>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="tsteps_trans">tsteps_trans</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">S1</span> <span class="id">S2</span>, <span class="id"><a href="compcert.common.Behaviors.html#tsteps">tsteps</a></span> <span class="id"><a href="compcert.common.Behaviors.html#S1">S1</a></span> <span class="id"><a href="compcert.common.Behaviors.html#S2">S2</a></span> -&gt; <span class="kwd">forall</span> <span class="id">S3</span>, <span class="id"><a href="compcert.common.Behaviors.html#tsteps">tsteps</a></span> <span class="id"><a href="compcert.common.Behaviors.html#S2">S2</a></span> <span class="id"><a href="compcert.common.Behaviors.html#S3">S3</a></span> -&gt; <span class="id"><a href="compcert.common.Behaviors.html#tsteps">tsteps</a></span> <span class="id"><a href="compcert.common.Behaviors.html#S1">S1</a></span> <span class="id"><a href="compcert.common.Behaviors.html#S3">S3</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2079')">Proof.</div>
<div class="proofscript" id="proof2079">
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">intros</span>. <span class="tactic">auto</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Let</span> <span class="id"><a name="INF_SEQ_DECOMP.treactive">treactive</a></span> (<span class="id">S</span>: <span class="id"><a href="compcert.common.Behaviors.html#tstate">tstate</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">S1</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Behaviors.html#tsteps">tsteps</a></span> <span class="id"><a href="compcert.common.Behaviors.html#S">S</a></span> <span class="id"><a href="compcert.common.Behaviors.html#S1">S1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">S2</span>, <span class="id">exists</span> <span class="id">S3</span>, <span class="id">exists</span> <span class="id">t</span>, <span class="id"><a href="compcert.common.Behaviors.html#tsteps">tsteps</a></span> <span class="id"><a href="compcert.common.Behaviors.html#S1">S1</a></span> <span class="id"><a href="compcert.common.Behaviors.html#S2">S2</a></span> /\ <span class="id"><a href="compcert.common.Behaviors.html#tstep">tstep</a></span> <span class="id"><a href="compcert.common.Behaviors.html#t">t</a></span> <span class="id"><a href="compcert.common.Behaviors.html#S2">S2</a></span> <span class="id"><a href="compcert.common.Behaviors.html#S3">S3</a></span> /\ <span class="id"><a href="compcert.common.Behaviors.html#t">t</a></span> &lt;&gt; <span class="id"><a href="compcert.common.Events.html#E0">E0</a></span>.<br/>
<br/>
<span class="kwd">Let</span> <span class="id"><a name="INF_SEQ_DECOMP.tsilent">tsilent</a></span> (<span class="id">S</span>: <span class="id"><a href="compcert.common.Behaviors.html#tstate">tstate</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">S1</span> <span class="id">t</span> <span class="id">S2</span>, <span class="id"><a href="compcert.common.Behaviors.html#tsteps">tsteps</a></span> <span class="id"><a href="compcert.common.Behaviors.html#S">S</a></span> <span class="id"><a href="compcert.common.Behaviors.html#S1">S1</a></span> -&gt; <span class="id"><a href="compcert.common.Behaviors.html#tstep">tstep</a></span> <span class="id"><a href="compcert.common.Behaviors.html#t">t</a></span> <span class="id"><a href="compcert.common.Behaviors.html#S1">S1</a></span> <span class="id"><a href="compcert.common.Behaviors.html#S2">S2</a></span> -&gt; <span class="id"><a href="compcert.common.Behaviors.html#t">t</a></span> = <span class="id"><a href="compcert.common.Events.html#E0">E0</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="treactive_or_tsilent">treactive_or_tsilent</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">S</span>, <span class="id"><a href="compcert.common.Behaviors.html#INF_SEQ_DECOMP.treactive">treactive</a></span> <span class="id"><a href="compcert.common.Behaviors.html#S">S</a></span> \/ (<span class="id">exists</span> <span class="id">S</span>', <span class="id"><a href="compcert.common.Behaviors.html#tsteps">tsteps</a></span> <span class="id"><a href="compcert.common.Behaviors.html#S">S</a></span> <span class="id">S</span>' /\ <span class="id"><a href="compcert.common.Behaviors.html#INF_SEQ_DECOMP.tsilent">tsilent</a></span> <span class="id">S</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2080')">Proof.</div>
<div class="proofscript" id="proof2080">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#classic">classic</a></span> (<span class="id">exists</span> <span class="id">S</span>', <span class="id"><a href="compcert.common.Behaviors.html#tsteps">tsteps</a></span> <span class="id">S</span> <span class="id">S</span>' /\ <span class="id"><a href="compcert.common.Behaviors.html#INF_SEQ_DECOMP.tsilent">tsilent</a></span> <span class="id">S</span>')).<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">red</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Pred_Type.html#not_ex_all_not">not_ex_all_not</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">H</span> <span class="id">S1</span>). <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#not_and_or">not_and_or</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">H1</span>). <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.common.Behaviors.html#tsilent">tsilent</a></span> <span class="kwd">in</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Pred_Type.html#not_all_ex_not">not_all_ex_not</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">H2</span>). <span class="tactic">intros</span> [<span class="id">S2</span> <span class="id">A</span>].<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Pred_Type.html#not_all_ex_not">not_all_ex_not</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">A</span>). <span class="tactic">intros</span> [<span class="id">t</span> <span class="id">B</span>].<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Pred_Type.html#not_all_ex_not">not_all_ex_not</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">B</span>). <span class="tactic">intros</span> [<span class="id">S3</span> <span class="id">C</span>].<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#imply_to_and">imply_to_and</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">C</span>). <span class="tactic">intros</span> [<span class="id">D</span> <span class="id">F</span>].<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#imply_to_and">imply_to_and</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">F</span>). <span class="tactic">intros</span> [<span class="id">G</span> <span class="id">J</span>].<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">S2</span>; <span class="id">exists</span> <span class="id">S3</span>; <span class="id">exists</span> <span class="id">t</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="tsteps_star">tsteps_star</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">S1</span> <span class="id">S2</span>, <span class="id"><a href="compcert.common.Behaviors.html#tsteps">tsteps</a></span> <span class="id"><a href="compcert.common.Behaviors.html#S1">S1</a></span> <span class="id"><a href="compcert.common.Behaviors.html#S2">S2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">t</span>, <span class="id"><a href="compcert.common.Smallstep.html#star">star</a></span> <span class="id"><a href="compcert.common.Behaviors.html#INF_SEQ_DECOMP.step">step</a></span> <span class="id"><a href="compcert.common.Behaviors.html#INF_SEQ_DECOMP.se">se</a></span> <span class="id"><a href="compcert.common.Behaviors.html#INF_SEQ_DECOMP.ge">ge</a></span> (<span class="id"><a href="compcert.common.Behaviors.html#state_of_tstate">state_of_tstate</a></span> <span class="id"><a href="compcert.common.Behaviors.html#S1">S1</a></span>) <span class="id"><a href="compcert.common.Behaviors.html#t">t</a></span> (<span class="id"><a href="compcert.common.Behaviors.html#state_of_tstate">state_of_tstate</a></span> <span class="id"><a href="compcert.common.Behaviors.html#S2">S2</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="compcert.common.Behaviors.html#traceinf_of_tstate">traceinf_of_tstate</a></span> <span class="id"><a href="compcert.common.Behaviors.html#S1">S1</a></span> = <span class="id"><a href="compcert.common.Behaviors.html#t">t</a></span> *** <span class="id"><a href="compcert.common.Behaviors.html#traceinf_of_tstate">traceinf_of_tstate</a></span> <span class="id"><a href="compcert.common.Behaviors.html#S2">S2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2081')">Proof.</div>
<div class="proofscript" id="proof2081">
&nbsp;&nbsp;<span class="tactic">induction</span> 1.<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id"><a href="compcert.common.Events.html#E0">E0</a></span>; <span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Smallstep.html#star_refl">star_refl</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">H</span>. <span class="tactic">destruct</span> <span class="id">IHtsteps</span> <span class="kwd">as</span> [<span class="id">t</span>' [<span class="id">A</span> <span class="id">B</span>]].<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id">t</span> ** <span class="id">t</span>'); <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#star_left">star_left</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">subst</span> <span class="id">T</span>. <span class="id">traceEq</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="tsilent_forever_silent">tsilent_forever_silent</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">S</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Behaviors.html#INF_SEQ_DECOMP.tsilent">tsilent</a></span> <span class="id"><a href="compcert.common.Behaviors.html#S">S</a></span> -&gt; <span class="id"><a href="compcert.common.Smallstep.html#forever_silent">forever_silent</a></span> <span class="id"><a href="compcert.common.Behaviors.html#INF_SEQ_DECOMP.step">step</a></span> <span class="id"><a href="compcert.common.Behaviors.html#INF_SEQ_DECOMP.se">se</a></span> <span class="id"><a href="compcert.common.Behaviors.html#INF_SEQ_DECOMP.ge">ge</a></span> (<span class="id"><a href="compcert.common.Behaviors.html#state_of_tstate">state_of_tstate</a></span> <span class="id"><a href="compcert.common.Behaviors.html#S">S</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2082')">Proof.</div>
<div class="proofscript" id="proof2082">
&nbsp;&nbsp;<span class="id">cofix</span> <span class="id">COINDHYP</span>; <span class="tactic">intro</span> <span class="id">S</span>. <span class="tactic">case</span> <span class="id">S</span>. <span class="tactic">intros</span> <span class="id">until</span> <span class="id">f</span>. <span class="tactic">simpl</span>. <span class="tactic">case</span> <span class="id">f</span>. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="compcert.common.Behaviors.html#tstep">tstep</a></span> <span class="id">t</span> (<span class="id"><a href="compcert.common.Behaviors.html#ST">ST</a></span> <span class="id">s1</span> (<span class="id">t</span> *** <span class="id">T0</span>) (<span class="id"><a href="compcert.common.Smallstep.html#forever_intro">forever_intro</a></span> <span class="id">s1</span> <span class="id">t</span> <span class="id">s0</span> <span class="id">f0</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.common.Behaviors.html#ST">ST</a></span> <span class="id">s2</span> <span class="id">T0</span> <span class="id">f0</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">t</span> = <span class="id"><a href="compcert.common.Events.html#E0">E0</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">red</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">eapply</span> <span class="id">H</span>; <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Behaviors.html#tsteps_refl">tsteps_refl</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Smallstep.html#forever_silent_intro">forever_silent_intro</a></span> <span class="kwd">with</span> (<span class="id"><a href="compcert.common.Behaviors.html#state_of_tstate">state_of_tstate</a></span> (<span class="id"><a href="compcert.common.Behaviors.html#ST">ST</a></span> <span class="id">s2</span> <span class="id">T0</span> <span class="id">f0</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">H1</span>. <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">COINDHYP</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id">H</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Behaviors.html#tsteps_left">tsteps_left</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="treactive_forever_reactive">treactive_forever_reactive</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">S</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Behaviors.html#INF_SEQ_DECOMP.treactive">treactive</a></span> <span class="id"><a href="compcert.common.Behaviors.html#S">S</a></span> -&gt; <span class="id"><a href="compcert.common.Smallstep.html#forever_reactive">forever_reactive</a></span> <span class="id"><a href="compcert.common.Behaviors.html#INF_SEQ_DECOMP.step">step</a></span> <span class="id"><a href="compcert.common.Behaviors.html#INF_SEQ_DECOMP.se">se</a></span> <span class="id"><a href="compcert.common.Behaviors.html#INF_SEQ_DECOMP.ge">ge</a></span> (<span class="id"><a href="compcert.common.Behaviors.html#state_of_tstate">state_of_tstate</a></span> <span class="id"><a href="compcert.common.Behaviors.html#S">S</a></span>) (<span class="id"><a href="compcert.common.Behaviors.html#traceinf_of_tstate">traceinf_of_tstate</a></span> <span class="id"><a href="compcert.common.Behaviors.html#S">S</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2083')">Proof.</div>
<div class="proofscript" id="proof2083">
&nbsp;&nbsp;<span class="id">cofix</span> <span class="id">COINDHYP</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">H</span> <span class="id">S</span>) <span class="kwd">as</span> [<span class="id">S1</span> [<span class="id">S2</span> [<span class="id">t</span> [<span class="id">A</span> [<span class="id">B</span> <span class="id">C</span>]]]]]. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Behaviors.html#tsteps_refl">tsteps_refl</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.Behaviors.html#tsteps_star">tsteps_star</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">A</span>) <span class="kwd">as</span> [<span class="id">t</span>' [<span class="id">P</span> <span class="id">Q</span>]].<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">B</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">rewrite</span> <span class="id">Q</span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.common.Events.html#Eappinf_assoc">Eappinf_assoc</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Smallstep.html#forever_reactive_intro">forever_reactive_intro</a></span> <span class="kwd">with</span> <span class="id">s2</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#star_right">star_right</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.Events.html#Eapp_E0_inv">Eapp_E0_inv</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">H0</span>). <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;<span class="id">change</span> (<span class="id"><a href="compcert.common.Smallstep.html#forever_reactive">forever_reactive</a></span> <span class="id"><a href="compcert.common.Behaviors.html#INF_SEQ_DECOMP.step">step</a></span> <span class="id"><a href="compcert.common.Behaviors.html#INF_SEQ_DECOMP.se">se</a></span> <span class="id"><a href="compcert.common.Behaviors.html#INF_SEQ_DECOMP.ge">ge</a></span> (<span class="id"><a href="compcert.common.Behaviors.html#state_of_tstate">state_of_tstate</a></span> (<span class="id"><a href="compcert.common.Behaviors.html#ST">ST</a></span> <span class="id">s2</span> <span class="id">T</span> <span class="id">F</span>)) (<span class="id"><a href="compcert.common.Behaviors.html#traceinf_of_tstate">traceinf_of_tstate</a></span> (<span class="id"><a href="compcert.common.Behaviors.html#ST">ST</a></span> <span class="id">s2</span> <span class="id">T</span> <span class="id">F</span>))).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">COINDHYP</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Behaviors.html#tsteps_trans">tsteps_trans</a></span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Behaviors.html#tsteps_left">tsteps_left</a></span>. <span class="id">constructor</span>. <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="forever_silent_or_reactive">forever_silent_or_reactive</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s</span> <span class="id">T</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Smallstep.html#forever">forever</a></span> <span class="id"><a href="compcert.common.Behaviors.html#INF_SEQ_DECOMP.step">step</a></span> <span class="id"><a href="compcert.common.Behaviors.html#INF_SEQ_DECOMP.se">se</a></span> <span class="id"><a href="compcert.common.Behaviors.html#INF_SEQ_DECOMP.ge">ge</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s">s</a></span> <span class="id"><a href="compcert.common.Behaviors.html#T">T</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Smallstep.html#forever_reactive">forever_reactive</a></span> <span class="id"><a href="compcert.common.Behaviors.html#INF_SEQ_DECOMP.step">step</a></span> <span class="id"><a href="compcert.common.Behaviors.html#INF_SEQ_DECOMP.se">se</a></span> <span class="id"><a href="compcert.common.Behaviors.html#INF_SEQ_DECOMP.ge">ge</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s">s</a></span> <span class="id"><a href="compcert.common.Behaviors.html#T">T</a></span> \/<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">t</span>, <span class="id">exists</span> <span class="id">s</span>', <span class="id">exists</span> <span class="id">T</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Smallstep.html#star">star</a></span> <span class="id"><a href="compcert.common.Behaviors.html#INF_SEQ_DECOMP.step">step</a></span> <span class="id"><a href="compcert.common.Behaviors.html#INF_SEQ_DECOMP.se">se</a></span> <span class="id"><a href="compcert.common.Behaviors.html#INF_SEQ_DECOMP.ge">ge</a></span> <span class="id"><a href="compcert.common.Behaviors.html#s">s</a></span> <span class="id"><a href="compcert.common.Behaviors.html#t">t</a></span> <span class="id">s</span>' /\ <span class="id"><a href="compcert.common.Smallstep.html#forever_silent">forever_silent</a></span> <span class="id"><a href="compcert.common.Behaviors.html#INF_SEQ_DECOMP.step">step</a></span> <span class="id"><a href="compcert.common.Behaviors.html#INF_SEQ_DECOMP.se">se</a></span> <span class="id"><a href="compcert.common.Behaviors.html#INF_SEQ_DECOMP.ge">ge</a></span> <span class="id">s</span>' /\ <span class="id"><a href="compcert.common.Behaviors.html#T">T</a></span> = <span class="id"><a href="compcert.common.Behaviors.html#t">t</a></span> *** <span class="id">T</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2084')">Proof.</div>
<div class="proofscript" id="proof2084">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.Behaviors.html#treactive_or_tsilent">treactive_or_tsilent</a></span> (<span class="id"><a href="compcert.common.Behaviors.html#ST">ST</a></span> <span class="id">s</span> <span class="id">T</span> <span class="id">H</span>)).<br/>
&nbsp;&nbsp;<span class="id">left</span>.<br/>
&nbsp;&nbsp;<span class="id">change</span> (<span class="id"><a href="compcert.common.Smallstep.html#forever_reactive">forever_reactive</a></span> <span class="id"><a href="compcert.common.Behaviors.html#INF_SEQ_DECOMP.step">step</a></span> <span class="id"><a href="compcert.common.Behaviors.html#INF_SEQ_DECOMP.se">se</a></span> <span class="id"><a href="compcert.common.Behaviors.html#INF_SEQ_DECOMP.ge">ge</a></span> (<span class="id"><a href="compcert.common.Behaviors.html#state_of_tstate">state_of_tstate</a></span> (<span class="id"><a href="compcert.common.Behaviors.html#ST">ST</a></span> <span class="id">s</span> <span class="id">T</span> <span class="id">H</span>)) (<span class="id"><a href="compcert.common.Behaviors.html#traceinf_of_tstate">traceinf_of_tstate</a></span> (<span class="id"><a href="compcert.common.Behaviors.html#ST">ST</a></span> <span class="id">s</span> <span class="id">T</span> <span class="id">H</span>))).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Behaviors.html#treactive_forever_reactive">treactive_forever_reactive</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span> <span class="kwd">as</span> [<span class="id">S</span>' [<span class="id">A</span> <span class="id">B</span>]].<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Behaviors.html#tsteps_star">tsteps_star</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">t</span> [<span class="id">C</span> <span class="id">D</span>]]. <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">right</span>. <span class="id">exists</span> <span class="id">t</span>; <span class="id">exists</span> (<span class="id"><a href="compcert.common.Behaviors.html#state_of_tstate">state_of_tstate</a></span> <span class="id">S</span>'); <span class="id">exists</span> (<span class="id"><a href="compcert.common.Behaviors.html#traceinf_of_tstate">traceinf_of_tstate</a></span> <span class="id">S</span>').<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Behaviors.html#tsilent_forever_silent">tsilent_forever_silent</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.common.Behaviors.html#INF_SEQ_DECOMP">INF_SEQ_DECOMP</a></span>.<br/>
<br/>
<span class="kwd">Set</span> <span class="kwd">Implicit</span> <span class="id">Arguments</span>.<br/>
<br/>
<h1> Big-step semantics and program behaviors </h1>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="BIGSTEP_BEHAVIORS">BIGSTEP_BEHAVIORS</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="BIGSTEP_BEHAVIORS.B">B</a></span>: <span class="id"><a href="compcert.common.Smallstep.html#bigstep_semantics">bigstep_semantics</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="BIGSTEP_BEHAVIORS.L">L</a></span>: <span class="id"><a href="compcert.common.Smallstep.html#semantics">semantics</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="BIGSTEP_BEHAVIORS.sound">sound</a></span>: <span class="id"><a href="compcert.common.Smallstep.html#bigstep_sound">bigstep_sound</a></span> <span class="id"><a href="compcert.common.Behaviors.html#BIGSTEP_BEHAVIORS.B">B</a></span> <span class="id"><a href="compcert.common.Behaviors.html#BIGSTEP_BEHAVIORS.L">L</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="behavior_bigstep_terminates">behavior_bigstep_terminates</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t</span> <span class="id">r</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Smallstep.html#bigstep_terminates">bigstep_terminates</a></span> <span class="id"><a href="compcert.common.Behaviors.html#BIGSTEP_BEHAVIORS.B">B</a></span> <span class="id"><a href="compcert.common.Behaviors.html#t">t</a></span> <span class="id"><a href="compcert.common.Behaviors.html#r">r</a></span> -&gt; <span class="id"><a href="compcert.common.Behaviors.html#program_behaves">program_behaves</a></span> <span class="id"><a href="compcert.common.Behaviors.html#BIGSTEP_BEHAVIORS.L">L</a></span> (<span class="id"><a href="compcert.common.Behaviors.html#Terminates">Terminates</a></span> <span class="id"><a href="compcert.common.Behaviors.html#t">t</a></span> <span class="id"><a href="compcert.common.Behaviors.html#r">r</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2085')">Proof.</div>
<div class="proofscript" id="proof2085">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> (<span class="id"><a href="compcert.common.Smallstep.html#bigstep_terminates_sound">bigstep_terminates_sound</a></span> <span class="id"><a href="compcert.common.Behaviors.html#BIGSTEP_BEHAVIORS.sound">sound</a></span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">s1</span> [<span class="id">s2</span> [<span class="id">P</span> [<span class="id">Q</span> <span class="id">R</span>]]]].<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="behavior_bigstep_diverges">behavior_bigstep_diverges</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">T</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Smallstep.html#bigstep_diverges">bigstep_diverges</a></span> <span class="id"><a href="compcert.common.Behaviors.html#BIGSTEP_BEHAVIORS.B">B</a></span> <span class="id"><a href="compcert.common.Behaviors.html#T">T</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Behaviors.html#program_behaves">program_behaves</a></span> <span class="id"><a href="compcert.common.Behaviors.html#BIGSTEP_BEHAVIORS.L">L</a></span> (<span class="id"><a href="compcert.common.Behaviors.html#Reacts">Reacts</a></span> <span class="id"><a href="compcert.common.Behaviors.html#T">T</a></span>)<br/>
&nbsp;&nbsp;\/ <span class="id">exists</span> <span class="id">t</span>, <span class="id"><a href="compcert.common.Behaviors.html#program_behaves">program_behaves</a></span> <span class="id"><a href="compcert.common.Behaviors.html#BIGSTEP_BEHAVIORS.L">L</a></span> (<span class="id"><a href="compcert.common.Behaviors.html#Diverges">Diverges</a></span> <span class="id"><a href="compcert.common.Behaviors.html#t">t</a></span>) /\ <span class="id"><a href="compcert.common.Events.html#traceinf_prefix">traceinf_prefix</a></span> <span class="id"><a href="compcert.common.Behaviors.html#t">t</a></span> <span class="id"><a href="compcert.common.Behaviors.html#T">T</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2086')">Proof.</div>
<div class="proofscript" id="proof2086">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> (<span class="id"><a href="compcert.common.Smallstep.html#bigstep_diverges_sound">bigstep_diverges_sound</a></span> <span class="id"><a href="compcert.common.Behaviors.html#BIGSTEP_BEHAVIORS.sound">sound</a></span>); <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">s1</span> [<span class="id">P</span> <span class="id">Q</span>]].<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Behaviors.html#forever_silent_or_reactive">forever_silent_or_reactive</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">X</span> | [<span class="id">t</span> [<span class="id">s</span>' [<span class="id">T</span>' [<span class="id">X</span> [<span class="id">Y</span> <span class="id">Z</span>]]]]]].<br/>
&nbsp;&nbsp;<span class="id">left</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">right</span>. <span class="id">exists</span> <span class="id">t</span>; <span class="tactic">split</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="id">exists</span> <span class="id">T</span>'; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.common.Behaviors.html#BIGSTEP_BEHAVIORS">BIGSTEP_BEHAVIORS</a></span>.<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</div>
</body>
</html>
