
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module Tunnelingproof</title>
<meta name="description" content="Documentation of Coq module Tunnelingproof" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module Tunnelingproof</h1>
<div class="coq">
<br/>
<div class="doc">Correctness proof for the branch tunneling optimization. </div>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.lib.Coqlib.html">Coqlib</a></span> <span class="id"><a href="compcert.lib.Maps.html">Maps</a></span> <span class="id"><a href="compcert.lib.UnionFind.html">UnionFind</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.common.AST.html">AST</a></span> <span class="id"><a href="compcert.common.Linking.html">Linking</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.common.Values.html">Values</a></span> <span class="id"><a href="compcert.common.Memory.html">Memory</a></span> <span class="id"><a href="compcert.common.Events.html">Events</a></span> <span class="id"><a href="compcert.common.Globalenvs.html">Globalenvs</a></span> <span class="id"><a href="compcert.common.Smallstep.html">Smallstep</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.x86.Op.html">Op</a></span> <span class="id"><a href="compcert.backend.Locations.html">Locations</a></span> <span class="id"><a href="compcert.backend.LTL.html">LTL</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.backend.Tunneling.html">Tunneling</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="match_prog">match_prog</a></span> (<span class="id">p</span> <span class="id">tp</span>: <span class="id"><a href="compcert.backend.LTL.html#program">program</a></span>) :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#match_program">match_program</a></span> (<span class="kwd">fun</span> <span class="id">ctx</span> <span class="id">f</span> <span class="id">tf</span> =&gt; <span class="id"><a href="compcert.backend.Tunnelingproof.html#tf">tf</a></span> = <span class="id"><a href="compcert.backend.Tunneling.html#tunnel_fundef">tunnel_fundef</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#f">f</a></span>) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#p">p</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#tp">tp</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="transf_program_match">transf_program_match</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">p</span>, <span class="id"><a href="compcert.backend.Tunnelingproof.html#match_prog">match_prog</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#p">p</a></span> (<span class="id"><a href="compcert.backend.Tunneling.html#tunnel_program">tunnel_program</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#p">p</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3802')">Proof.</div>
<div class="proofscript" id="proof3802">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Linking.html#match_transform_program">match_transform_program</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<h1> Properties of the branch map computed using union-find. </h1>
<br/>
<div class="doc">A variant of <span class="bracket"><span class="id">record_goto</span></span> that also incrementally computes a measure <span class="bracket"><span class="id">f</span>: <span class="id">node</span> -&gt; <span class="id">nat</span></span>
  counting the number of <span class="bracket"><span class="id">Lnop</span></span> instructions starting at a given <span class="bracket"><span class="id">pc</span></span> that were eliminated. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="measure_edge">measure_edge</a></span> (<span class="id">u</span>: <span class="id"><a href="compcert.backend.Tunneling.html#U.t">U.t</a></span>) (<span class="id">pc</span> <span class="id">s</span>: <span class="id"><a href="compcert.backend.LTL.html#node">node</a></span>) (<span class="id">f</span>: <span class="id"><a href="compcert.backend.LTL.html#node">node</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) : <span class="id"><a href="compcert.backend.LTL.html#node">node</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="kwd">if</span> <span class="id"><a href="compcert.lib.Coqlib.html#peq">peq</a></span> (<span class="id"><a href="compcert.backend.Tunneling.html#U.repr">U.repr</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#u">u</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#s">s</a></span>) <span class="id"><a href="compcert.backend.Tunnelingproof.html#pc">pc</a></span> <span class="kwd">then</span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#f">f</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#x">x</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="kwd">if</span> <span class="id"><a href="compcert.lib.Coqlib.html#peq">peq</a></span> (<span class="id"><a href="compcert.backend.Tunneling.html#U.repr">U.repr</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#u">u</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#x">x</a></span>) <span class="id"><a href="compcert.backend.Tunnelingproof.html#pc">pc</a></span> <span class="kwd">then</span> (<span class="id"><a href="compcert.backend.Tunnelingproof.html#f">f</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#x">x</a></span> + <span class="id"><a href="compcert.backend.Tunnelingproof.html#f">f</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#s">s</a></span> + 1)%<span class="id">nat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#f">f</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#x">x</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id">record_goto</span>' (<span class="id">uf</span>: <span class="id"><a href="compcert.backend.Tunneling.html#U.t">U.t</a></span> * (<span class="id"><a href="compcert.backend.LTL.html#node">node</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>)) (<span class="id">pc</span>: <span class="id"><a href="compcert.backend.LTL.html#node">node</a></span>) (<span class="id">b</span>: <span class="id"><a href="compcert.backend.LTL.html#bblock">bblock</a></span>) : <span class="id"><a href="compcert.backend.Tunneling.html#U.t">U.t</a></span> * (<span class="id"><a href="compcert.backend.LTL.html#node">node</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#b">b</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.LTL.html#Lbranch">Lbranch</a></span> <span class="id">s</span> :: <span class="id">b</span>' =&gt; <span class="kwd">let</span> (<span class="id">u</span>, <span class="id">f</span>) := <span class="id"><a href="compcert.backend.Tunnelingproof.html#uf">uf</a></span> <span class="kwd">in</span> (<span class="id"><a href="compcert.backend.Tunneling.html#U.union">U.union</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#u">u</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#pc">pc</a></span> <span class="id">s</span>, <span class="id"><a href="compcert.backend.Tunnelingproof.html#measure_edge">measure_edge</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#u">u</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#pc">pc</a></span> <span class="id">s</span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#f">f</a></span>)<br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="compcert.backend.Tunnelingproof.html#uf">uf</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="branch_map_correct">branch_map_correct</a></span> (<span class="id">c</span>: <span class="id"><a href="compcert.backend.LTL.html#code">code</a></span>) (<span class="id">uf</span>: <span class="id"><a href="compcert.backend.Tunneling.html#U.t">U.t</a></span> * (<span class="id"><a href="compcert.backend.LTL.html#node">node</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>)): <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">pc</span>,<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#c">c</a></span>!<span class="id"><a href="compcert.backend.Tunnelingproof.html#pc">pc</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="compcert.backend.LTL.html#Lbranch">Lbranch</a></span> <span class="id">s</span> :: <span class="id">b</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Tunneling.html#U.repr">U.repr</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#uf">uf</a></span>) <span class="id"><a href="compcert.backend.Tunnelingproof.html#pc">pc</a></span> = <span class="id"><a href="compcert.backend.Tunnelingproof.html#pc">pc</a></span> \/ (<span class="id"><a href="compcert.backend.Tunneling.html#U.repr">U.repr</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#uf">uf</a></span>) <span class="id"><a href="compcert.backend.Tunnelingproof.html#pc">pc</a></span> = <span class="id"><a href="compcert.backend.Tunneling.html#U.repr">U.repr</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#uf">uf</a></span>) <span class="id">s</span> /\ <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#uf">uf</a></span> <span class="id">s</span> &lt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#uf">uf</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#pc">pc</a></span>)%<span class="id">nat</span><br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Tunneling.html#U.repr">U.repr</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#uf">uf</a></span>) <span class="id"><a href="compcert.backend.Tunnelingproof.html#pc">pc</a></span> = <span class="id"><a href="compcert.backend.Tunnelingproof.html#pc">pc</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">record_gotos</span>'<span class="id">_correct</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">c</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Tunnelingproof.html#branch_map_correct">branch_map_correct</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#c">c</a></span> (<span class="id"><a href="compcert.lib.Maps.html#PTree.fold">PTree.fold</a></span> <span class="id">record_goto</span>' <span class="id"><a href="compcert.backend.Tunnelingproof.html#c">c</a></span> (<span class="id"><a href="compcert.backend.Tunneling.html#U.empty">U.empty</a></span>, <span class="kwd">fun</span> (<span class="id">x</span>: <span class="id"><a href="compcert.backend.LTL.html#node">node</a></span>) =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3803')">Proof.</div>
<div class="proofscript" id="proof3803">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Maps.html#PTree_Properties.fold_rec">PTree_Properties.fold_rec</a></span> <span class="kwd">with</span> (<span class="id">P</span> := <span class="kwd">fun</span> <span class="id">c</span> <span class="id">uf</span> =&gt; <span class="id"><a href="compcert.backend.Tunnelingproof.html#branch_map_correct">branch_map_correct</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#c">c</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#uf">uf</a></span>).<br/>
<br/>
- <span class="comment">(*&nbsp;extensionality&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">H</span>. <span class="tactic">apply</span> <span class="id">H0</span>.<br/>
<br/>
- <span class="comment">(*&nbsp;base&nbsp;case&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Maps.html#PTree.gempty">PTree.gempty</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Tunneling.html#U.repr_empty">U.repr_empty</a></span>.<br/>
<br/>
- <span class="comment">(*&nbsp;inductive&nbsp;case&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">m</span> <span class="id">uf</span> <span class="id">pc</span> <span class="id">bb</span>; <span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">uf</span> <span class="kwd">as</span> [<span class="id">u</span> <span class="id">f</span>].<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">PC</span>: <span class="id"><a href="compcert.backend.Tunneling.html#U.repr">U.repr</a></span> <span class="id">u</span> <span class="id">pc</span> = <span class="id">pc</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">H1</span> <span class="id">pc</span>). <span class="tactic">rewrite</span> <span class="id">H</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">record_goto</span>' (<span class="id">u</span>, <span class="id">f</span>) <span class="id">pc</span> <span class="id">bb</span> = (<span class="id">u</span>, <span class="id">f</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\/ <span class="id">exists</span> <span class="id">s</span>, <span class="id">exists</span> <span class="id">bb</span>', <span class="id">bb</span> = <span class="id"><a href="compcert.backend.LTL.html#Lbranch">Lbranch</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#s">s</a></span> :: <span class="id">bb</span>' /\ <span class="id">record_goto</span>' (<span class="id">u</span>, <span class="id">f</span>) <span class="id">pc</span> <span class="id">bb</span> = (<span class="id"><a href="compcert.backend.Tunneling.html#U.union">U.union</a></span> <span class="id">u</span> <span class="id">pc</span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#s">s</a></span>, <span class="id"><a href="compcert.backend.Tunnelingproof.html#measure_edge">measure_edge</a></span> <span class="id">u</span> <span class="id">pc</span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#s">s</a></span> <span class="id">f</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">record_goto</span>'; <span class="tactic">simpl</span>. <span class="tactic">destruct</span> <span class="id">bb</span>; <span class="tactic">auto</span>. <span class="tactic">destruct</span> <span class="id">i</span>; <span class="tactic">auto</span>. <span class="id">right</span>. <span class="id">exists</span> <span class="id">s</span>; <span class="id">exists</span> <span class="id">bb</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H2</span> <span class="kwd">as</span> [<span class="id">B</span> | [<span class="id">s</span> [<span class="id">bb</span>' [<span class="id">EQ</span> <span class="id">B</span>]]]].<br/>
<br/>
+ <span class="comment">(*&nbsp;u&nbsp;and&nbsp;f&nbsp;are&nbsp;unchanged&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">B</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>. <span class="tactic">intro</span> <span class="id">pc</span>'. <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Maps.html#PTree.gsspec">PTree.gsspec</a></span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#peq">peq</a></span> <span class="id">pc</span>' <span class="id">pc</span>). <span class="tactic">subst</span> <span class="id">pc</span>'.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">bb</span>; <span class="tactic">auto</span>. <span class="tactic">destruct</span> <span class="id">i</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H1</span>.<br/>
<br/>
+ <span class="comment">(*&nbsp;b&nbsp;is&nbsp;Lbranch&nbsp;s,&nbsp;u&nbsp;becomes&nbsp;union&nbsp;u&nbsp;pc&nbsp;s,&nbsp;f&nbsp;becomes&nbsp;measure_edge&nbsp;u&nbsp;pc&nbsp;s&nbsp;f&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">B</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>. <span class="tactic">intro</span> <span class="id">pc</span>'. <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Maps.html#PTree.gsspec">PTree.gsspec</a></span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#peq">peq</a></span> <span class="id">pc</span>' <span class="id">pc</span>). <span class="tactic">subst</span> <span class="id">pc</span>'. <span class="tactic">rewrite</span> <span class="id">EQ</span>.<br/>
<br/>
* <span class="comment">(*&nbsp;The&nbsp;new&nbsp;instruction&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="compcert.backend.Tunneling.html#U.repr_union_2">U.repr_union_2</a></span> <span class="id">u</span> <span class="id">pc</span> <span class="id">s</span>); <span class="tactic">auto</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Tunneling.html#U.repr_union_3">U.repr_union_3</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#measure_edge">measure_edge</a></span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#peq">peq</a></span> (<span class="id"><a href="compcert.backend.Tunneling.html#U.repr">U.repr</a></span> <span class="id">u</span> <span class="id">s</span>) <span class="id">pc</span>). <span class="tactic">auto</span>. <span class="id">right</span>. <span class="tactic">split</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">PC</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#peq_true">peq_true</a></span>. <span class="tactic">omega</span>.<br/>
<br/>
* <span class="comment">(*&nbsp;An&nbsp;old&nbsp;instruction&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="compcert.backend.Tunneling.html#U.repr">U.repr</a></span> <span class="id">u</span> <span class="id">pc</span>' = <span class="id">pc</span>' -&gt; <span class="id"><a href="compcert.backend.Tunneling.html#U.repr">U.repr</a></span> (<span class="id"><a href="compcert.backend.Tunneling.html#U.union">U.union</a></span> <span class="id">u</span> <span class="id">pc</span> <span class="id">s</span>) <span class="id">pc</span>' = <span class="id">pc</span>').<br/>
&nbsp;&nbsp;{ <span class="tactic">intro</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">H2</span> <span class="tactic">at</span> 2. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Tunneling.html#U.repr_union_1">U.repr_union_1</a></span>. <span class="tactic">congruence</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">H1</span> <span class="id">pc</span>'). <span class="tactic">simpl</span>. <span class="tactic">destruct</span> (<span class="id">m</span>!<span class="id">pc</span>'); <span class="tactic">auto</span>. <span class="tactic">destruct</span> <span class="id">b</span>; <span class="tactic">auto</span>. <span class="tactic">destruct</span> <span class="id">i</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">P</span> | [<span class="id">P</span> <span class="id">Q</span>]]. <span class="id">left</span>; <span class="tactic">auto</span>. <span class="id">right</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Tunneling.html#U.sameclass_union_2">U.sameclass_union_2</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#measure_edge">measure_edge</a></span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#peq">peq</a></span> (<span class="id"><a href="compcert.backend.Tunneling.html#U.repr">U.repr</a></span> <span class="id">u</span> <span class="id">s</span>) <span class="id">pc</span>). <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">P</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#peq">peq</a></span> (<span class="id"><a href="compcert.backend.Tunneling.html#U.repr">U.repr</a></span> <span class="id">u</span> <span class="id">s0</span>) <span class="id">pc</span>). <span class="tactic">omega</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id">record_gotos</span>' (<span class="id">f</span>: <span class="id"><a href="compcert.backend.LTL.html#function">function</a></span>) :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Maps.html#PTree.fold">PTree.fold</a></span> <span class="id">record_goto</span>' <span class="id"><a href="compcert.backend.Tunnelingproof.html#f">f</a></span>.(<span class="id"><a href="compcert.backend.LTL.html#fn_code">fn_code</a></span>) (<span class="id"><a href="compcert.backend.Tunneling.html#U.empty">U.empty</a></span>, <span class="kwd">fun</span> (<span class="id">x</span>: <span class="id"><a href="compcert.backend.LTL.html#node">node</a></span>) =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id">record_gotos_gotos</span>':<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id">record_gotos</span>' <span class="id"><a href="compcert.backend.Tunnelingproof.html#f">f</a></span>) = <span class="id"><a href="compcert.backend.Tunneling.html#record_gotos">record_gotos</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#f">f</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3804')">Proof.</div>
<div class="proofscript" id="proof3804">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id">record_gotos</span>', <span class="id"><a href="compcert.backend.Tunneling.html#record_gotos">record_gotos</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Maps.html#PTree.fold_spec">PTree.fold_spec</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="compcert.lib.Maps.html#PTree.elements">PTree.elements</a></span> (<span class="id"><a href="compcert.backend.LTL.html#fn_code">fn_code</a></span> <span class="id">f</span>)) (<span class="id"><a href="compcert.backend.Tunneling.html#U.empty">U.empty</a></span>) (<span class="kwd">fun</span> <span class="id">_</span> : <span class="id"><a href="compcert.backend.LTL.html#node">node</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">intros</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">record_goto</span>' <span class="tactic">at</span> 2. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Tunneling.html#record_goto">record_goto</a></span> <span class="tactic">at</span> 2.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id">a</span>). <span class="tactic">apply</span> <span class="id">IHl</span>. <span class="tactic">destruct</span> <span class="id">i</span>; <span class="tactic">apply</span> <span class="id">IHl</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="branch_target">branch_target</a></span> (<span class="id">f</span>: <span class="id"><a href="compcert.backend.LTL.html#function">function</a></span>) (<span class="id">pc</span>: <span class="id"><a href="compcert.backend.LTL.html#node">node</a></span>) : <span class="id"><a href="compcert.backend.LTL.html#node">node</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Tunneling.html#U.repr">U.repr</a></span> (<span class="id"><a href="compcert.backend.Tunneling.html#record_gotos">record_gotos</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#f">f</a></span>) <span class="id"><a href="compcert.backend.Tunnelingproof.html#pc">pc</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="count_gotos">count_gotos</a></span> (<span class="id">f</span>: <span class="id"><a href="compcert.backend.LTL.html#function">function</a></span>) (<span class="id">pc</span>: <span class="id"><a href="compcert.backend.LTL.html#node">node</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> (<span class="id">record_gotos</span>' <span class="id"><a href="compcert.backend.Tunnelingproof.html#f">f</a></span>) <span class="id"><a href="compcert.backend.Tunnelingproof.html#pc">pc</a></span>.<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="record_gotos_correct">record_gotos_correct</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">pc</span>,<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#f">f</a></span>.(<span class="id"><a href="compcert.backend.LTL.html#fn_code">fn_code</a></span>)!<span class="id"><a href="compcert.backend.Tunnelingproof.html#pc">pc</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="compcert.backend.LTL.html#Lbranch">Lbranch</a></span> <span class="id">s</span> :: <span class="id">b</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Tunnelingproof.html#branch_target">branch_target</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#f">f</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#pc">pc</a></span> = <span class="id"><a href="compcert.backend.Tunnelingproof.html#pc">pc</a></span> \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.Tunnelingproof.html#branch_target">branch_target</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#f">f</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#pc">pc</a></span> = <span class="id"><a href="compcert.backend.Tunnelingproof.html#branch_target">branch_target</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#f">f</a></span> <span class="id">s</span> /\ <span class="id"><a href="compcert.backend.Tunnelingproof.html#count_gotos">count_gotos</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#f">f</a></span> <span class="id">s</span> &lt; <span class="id"><a href="compcert.backend.Tunnelingproof.html#count_gotos">count_gotos</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#f">f</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#pc">pc</a></span>)%<span class="id">nat</span><br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="compcert.backend.Tunnelingproof.html#branch_target">branch_target</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#f">f</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#pc">pc</a></span> = <span class="id"><a href="compcert.backend.Tunnelingproof.html#pc">pc</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3805')">Proof.</div>
<div class="proofscript" id="proof3805">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">record_gotos</span>'<span class="id">_correct</span> <span class="id">f</span>.(<span class="id"><a href="compcert.backend.LTL.html#fn_code">fn_code</a></span>) <span class="id">pc</span>). <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id">fold</span> (<span class="id">record_gotos</span>' <span class="id">f</span>). <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#branch_map_correct">branch_map_correct</a></span>, <span class="id"><a href="compcert.backend.Tunnelingproof.html#branch_target">branch_target</a></span>, <span class="id"><a href="compcert.backend.Tunnelingproof.html#count_gotos">count_gotos</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">record_gotos_gotos</span>'. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<h1> Preservation of semantics </h1>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="PRESERVATION">PRESERVATION</a></span>.<br/>
<br/>
<span class="kwd">Variables</span> <span class="id"><a name="PRESERVATION.prog">prog</a></span> <span class="id"><a name="PRESERVATION.tprog">tprog</a></span>: <span class="id"><a href="compcert.backend.LTL.html#program">program</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="PRESERVATION.TRANSL">TRANSL</a></span>: <span class="id"><a href="compcert.backend.Tunnelingproof.html#match_prog">match_prog</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#PRESERVATION.prog">prog</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#PRESERVATION.tprog">tprog</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="PRESERVATION.CORELEMMA">CORELEMMA</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.CORELEMMA.se">se</a></span> <span class="id"><a name="PRESERVATION.CORELEMMA.tse">tse</a></span>: <span class="id"><a href="compcert.common.Globalenvs.html#Senv.t">Senv.t</a></span>.<br/>
<span class="kwd">Hypothesis</span> (<span class="id"><a name="PRESERVATION.CORELEMMA.MATCH_SENV">MATCH_SENV</a></span>: <span class="id"><a href="compcert.common.Globalenvs.html#Senv.equiv">Senv.equiv</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#PRESERVATION.CORELEMMA.se">se</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#PRESERVATION.CORELEMMA.tse">tse</a></span>).<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.CORELEMMA.ge">ge</a></span> <span class="id"><a name="PRESERVATION.CORELEMMA.tge">tge</a></span>: <span class="id"><a href="compcert.backend.LTL.html#genv">genv</a></span>.<br/>
<br/>
<span class="kwd">Hypothesis</span> (<span class="id"><a name="PRESERVATION.CORELEMMA.MATCH_GENV">MATCH_GENV</a></span>: <span class="id"><a href="compcert.common.Globalenvs.html#Genv.match_genvs">Genv.match_genvs</a></span> (<span class="id"><a href="compcert.common.Linking.html#match_globdef">match_globdef</a></span> (<span class="kwd">fun</span> <span class="id">ctx</span> <span class="id">f</span> <span class="id">tf</span> =&gt; <span class="id"><a href="compcert.backend.Tunnelingproof.html#tf">tf</a></span> = <span class="id"><a href="compcert.backend.Tunneling.html#tunnel_fundef">tunnel_fundef</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#f">f</a></span>) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#PRESERVATION.prog">prog</a></span>) <span class="id"><a href="compcert.backend.Tunnelingproof.html#PRESERVATION.CORELEMMA.ge">ge</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#PRESERVATION.CORELEMMA.tge">tge</a></span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="functions_translated">functions_translated</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">v</span> <span class="id">f</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_funct">Genv.find_funct</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#PRESERVATION.CORELEMMA.ge">ge</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#v">v</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#f">f</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_funct">Genv.find_funct</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#PRESERVATION.CORELEMMA.tge">tge</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#v">v</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="compcert.backend.Tunneling.html#tunnel_fundef">tunnel_fundef</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#f">f</a></span>).<br/>
<span class="kwd">Proof</span> (<span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_funct_transf_genv">Genv.find_funct_transf_genv</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#PRESERVATION.CORELEMMA.MATCH_GENV">MATCH_GENV</a></span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="function_ptr_translated">function_ptr_translated</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">v</span> <span class="id">f</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_funct_ptr">Genv.find_funct_ptr</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#PRESERVATION.CORELEMMA.ge">ge</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#v">v</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#f">f</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_funct_ptr">Genv.find_funct_ptr</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#PRESERVATION.CORELEMMA.tge">tge</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#v">v</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="compcert.backend.Tunneling.html#tunnel_fundef">tunnel_fundef</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#f">f</a></span>).<br/>
<span class="kwd">Proof</span> (<span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_funct_ptr_transf_genv">Genv.find_funct_ptr_transf_genv</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#PRESERVATION.CORELEMMA.MATCH_GENV">MATCH_GENV</a></span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="symbols_preserved">symbols_preserved</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">id</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_symbol">Genv.find_symbol</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#PRESERVATION.CORELEMMA.tge">tge</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#id">id</a></span> = <span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_symbol">Genv.find_symbol</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#PRESERVATION.CORELEMMA.ge">ge</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#id">id</a></span>.<br/>
<span class="kwd">Proof</span> (<span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_symbol_transf_genv">Genv.find_symbol_transf_genv</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#PRESERVATION.CORELEMMA.MATCH_GENV">MATCH_GENV</a></span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="senv_preserved">senv_preserved</a></span>:<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Globalenvs.html#Senv.equiv">Senv.equiv</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#PRESERVATION.CORELEMMA.ge">ge</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#PRESERVATION.CORELEMMA.tge">tge</a></span>.<br/>
<span class="kwd">Proof</span> (<span class="id"><a href="compcert.common.Globalenvs.html#Genv.senv_transf_genv">Genv.senv_transf_genv</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#PRESERVATION.CORELEMMA.MATCH_GENV">MATCH_GENV</a></span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sig_preserved">sig_preserved</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span>, <span class="id"><a href="compcert.backend.LTL.html#funsig">funsig</a></span> (<span class="id"><a href="compcert.backend.Tunneling.html#tunnel_fundef">tunnel_fundef</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#f">f</a></span>) = <span class="id"><a href="compcert.backend.LTL.html#funsig">funsig</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#f">f</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3806')">Proof.</div>
<div class="proofscript" id="proof3806">
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">f</span>; <span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<div class="doc">The proof of semantic preservation is a simulation argument
  based on diagrams of the following form:
<pre>
           st1 --------------- st2
            |                   |
           t|                  ?|t
            |                   |
            v                   v
           st1'--------------- st2'</pre>
  The <span class="bracket"><span class="id">match_states</span></span> predicate, defined below, captures the precondition
  between states <span class="bracket"><span class="id">st1</span></span> and <span class="bracket"><span class="id">st2</span></span>, as well as the postcondition between
  <span class="bracket"><span class="id">st1</span>'</span> and <span class="bracket"><span class="id">st2</span>'</span>.  One transition in the source code (left) can correspond
  to zero or one transition in the transformed code (right).  The
  "zero transition" case occurs when executing a <span class="bracket"><span class="id">Lgoto</span></span> instruction
  in the source code that has been removed by tunneling.
  In the definition of <span class="bracket"><span class="id">match_states</span></span>, what changes between the original and
  transformed codes is mainly the control-flow
  (in particular, the current program point <span class="bracket"><span class="id">pc</span></span>), but also some values
  and memory states, since some <span class="bracket"><span class="id">Vundef</span></span> values can become more defined
  as a consequence of eliminating useless <span class="bracket"><span class="id">Lcond</span></span> instructions. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="tunneled_block">tunneled_block</a></span> (<span class="id">f</span>: <span class="id"><a href="compcert.backend.LTL.html#function">function</a></span>) (<span class="id">b</span>: <span class="id"><a href="compcert.backend.LTL.html#bblock">bblock</a></span>) :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Tunneling.html#tunnel_block">tunnel_block</a></span> (<span class="id"><a href="compcert.backend.Tunneling.html#record_gotos">record_gotos</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#f">f</a></span>) <span class="id"><a href="compcert.backend.Tunnelingproof.html#b">b</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="tunneled_code">tunneled_code</a></span> (<span class="id">f</span>: <span class="id"><a href="compcert.backend.LTL.html#function">function</a></span>) :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Maps.html#PTree.map1">PTree.map1</a></span> (<span class="id"><a href="compcert.backend.Tunnelingproof.html#tunneled_block">tunneled_block</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#f">f</a></span>) (<span class="id"><a href="compcert.backend.LTL.html#fn_code">fn_code</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#f">f</a></span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="locmap_lessdef">locmap_lessdef</a></span> (<span class="id">ls1</span> <span class="id">ls2</span>: <span class="id"><a href="compcert.backend.LTL.html#locset">locset</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span>, <span class="id"><a href="compcert.common.Values.html#Val.lessdef">Val.lessdef</a></span> (<span class="id"><a href="compcert.backend.Tunnelingproof.html#ls1">ls1</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#l">l</a></span>) (<span class="id"><a href="compcert.backend.Tunnelingproof.html#ls2">ls2</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#l">l</a></span>).<br/>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="match_stackframes">match_stackframes</a></span>: <span class="id"><a href="compcert.backend.LTL.html#stackframe">stackframe</a></span> -&gt; <span class="id"><a href="compcert.backend.LTL.html#stackframe">stackframe</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="match_stackframes_dummy">match_stackframes_dummy</a></span>: <span class="kwd">forall</span> <span class="id">f</span> <span class="id">sp</span> <span class="id">ls</span> <span class="id">tls</span> <span class="id">tf</span> <span class="id">tc</span> (<span class="id">DUMMY</span>: <span class="id"><a href="compcert.backend.Tunnelingproof.html#f">f</a></span>.(<span class="id"><a href="compcert.backend.LTL.html#fn_code">LTL.fn_code</a></span>) = <span class="id"><a href="compcert.lib.Maps.html#PTree.empty">PTree.empty</a></span> <span class="id">_</span>) (<span class="id">SG</span>: <span class="id"><a href="compcert.backend.Tunnelingproof.html#f">f</a></span>.(<span class="id"><a href="compcert.backend.LTL.html#fn_sig">LTL.fn_sig</a></span>) = <span class="id"><a href="compcert.backend.Tunnelingproof.html#tf">tf</a></span>.(<span class="id"><a href="compcert.backend.LTL.html#fn_sig">fn_sig</a></span>)) (<span class="id">LS</span>: <span class="id"><a href="compcert.backend.Tunnelingproof.html#locmap_lessdef">locmap_lessdef</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#tls">tls</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Tunnelingproof.html#match_stackframes">match_stackframes</a></span> (<span class="id"><a href="compcert.backend.LTL.html#Stackframe">Stackframe</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#f">f</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ls">ls</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) (<span class="id"><a href="compcert.backend.LTL.html#Stackframe">Stackframe</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#tf">tf</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#tls">tls</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#tc">tc</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="match_stackframes_intro">match_stackframes_intro</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">sp</span> <span class="id">ls0</span> <span class="id">bb</span> <span class="id">tls0</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Tunnelingproof.html#locmap_lessdef">locmap_lessdef</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ls0">ls0</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#tls0">tls0</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Tunnelingproof.html#match_stackframes">match_stackframes</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.LTL.html#Stackframe">Stackframe</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#f">f</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ls0">ls0</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#bb">bb</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.LTL.html#Stackframe">Stackframe</a></span> (<span class="id"><a href="compcert.backend.Tunneling.html#tunnel_function">tunnel_function</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#f">f</a></span>) <span class="id"><a href="compcert.backend.Tunnelingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#tls0">tls0</a></span> (<span class="id"><a href="compcert.backend.Tunnelingproof.html#tunneled_block">tunneled_block</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#f">f</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#bb">bb</a></span>)).<br/>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="match_states">match_states</a></span>: <span class="id"><a href="compcert.backend.LTL.html#state">state</a></span> -&gt; <span class="id"><a href="compcert.backend.LTL.html#state">state</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="match_states_dummy">match_states_dummy</a></span>: <span class="kwd">forall</span> <span class="id">s</span> <span class="id">ts</span> <span class="id">f</span> <span class="id">sp</span> <span class="id">rs</span> <span class="id">trs</span> <span class="id">m</span> <span class="id">tm</span> <span class="id">tc</span> <span class="id">tf</span> (<span class="id">STACKS</span>: <span class="id"><a href="compcert.lib.Coqlib.html#list_forall2">list_forall2</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#match_stackframes">match_stackframes</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#s">s</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ts">ts</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Tunnelingproof.html#match_states">match_states</a></span> (<span class="id"><a href="compcert.backend.LTL.html#Block">Block</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#s">s</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#f">f</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#sp">sp</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#rs">rs</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#m">m</a></span>) (<span class="id"><a href="compcert.backend.LTL.html#Block">Block</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ts">ts</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#tf">tf</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#tc">tc</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#trs">trs</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#tm">tm</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="match_states_intro">match_states_intro</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s</span> <span class="id">f</span> <span class="id">sp</span> <span class="id">pc</span> <span class="id">ls</span> <span class="id">m</span> <span class="id">ts</span> <span class="id">tls</span> <span class="id">tm</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">STK</span>: <span class="id"><a href="compcert.lib.Coqlib.html#list_forall2">list_forall2</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#match_stackframes">match_stackframes</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#s">s</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ts">ts</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">LS</span>: <span class="id"><a href="compcert.backend.Tunnelingproof.html#locmap_lessdef">locmap_lessdef</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#tls">tls</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">MEM</span>: <span class="id"><a href="compcert.common.Memory.html#Mem.extends">Mem.extends</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#m">m</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#tm">tm</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Tunnelingproof.html#match_states">match_states</a></span> (<span class="id"><a href="compcert.backend.LTL.html#State">State</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#s">s</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#f">f</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#pc">pc</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#m">m</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.LTL.html#State">State</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ts">ts</a></span> (<span class="id"><a href="compcert.backend.Tunneling.html#tunnel_function">tunnel_function</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#f">f</a></span>) <span class="id"><a href="compcert.backend.Tunnelingproof.html#sp">sp</a></span> (<span class="id"><a href="compcert.backend.Tunnelingproof.html#branch_target">branch_target</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#f">f</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#pc">pc</a></span>) <span class="id"><a href="compcert.backend.Tunnelingproof.html#tls">tls</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#tm">tm</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="match_states_block">match_states_block</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s</span> <span class="id">f</span> <span class="id">sp</span> <span class="id">bb</span> <span class="id">ls</span> <span class="id">m</span> <span class="id">ts</span> <span class="id">tls</span> <span class="id">tm</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">STK</span>: <span class="id"><a href="compcert.lib.Coqlib.html#list_forall2">list_forall2</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#match_stackframes">match_stackframes</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#s">s</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ts">ts</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">LS</span>: <span class="id"><a href="compcert.backend.Tunnelingproof.html#locmap_lessdef">locmap_lessdef</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#tls">tls</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">MEM</span>: <span class="id"><a href="compcert.common.Memory.html#Mem.extends">Mem.extends</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#m">m</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#tm">tm</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Tunnelingproof.html#match_states">match_states</a></span> (<span class="id"><a href="compcert.backend.LTL.html#Block">Block</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#s">s</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#f">f</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#bb">bb</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#m">m</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.LTL.html#Block">Block</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ts">ts</a></span> (<span class="id"><a href="compcert.backend.Tunneling.html#tunnel_function">tunnel_function</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#f">f</a></span>) <span class="id"><a href="compcert.backend.Tunnelingproof.html#sp">sp</a></span> (<span class="id"><a href="compcert.backend.Tunnelingproof.html#tunneled_block">tunneled_block</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#f">f</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#bb">bb</a></span>) <span class="id"><a href="compcert.backend.Tunnelingproof.html#tls">tls</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#tm">tm</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="match_states_interm">match_states_interm</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s</span> <span class="id">f</span> <span class="id">sp</span> <span class="id">pc</span> <span class="id">bb</span> <span class="id">ls</span> <span class="id">m</span> <span class="id">ts</span> <span class="id">tls</span> <span class="id">tm</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">STK</span>: <span class="id"><a href="compcert.lib.Coqlib.html#list_forall2">list_forall2</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#match_stackframes">match_stackframes</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#s">s</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ts">ts</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">LS</span>: <span class="id"><a href="compcert.backend.Tunnelingproof.html#locmap_lessdef">locmap_lessdef</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#tls">tls</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">MEM</span>: <span class="id"><a href="compcert.common.Memory.html#Mem.extends">Mem.extends</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#m">m</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#tm">tm</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Tunnelingproof.html#match_states">match_states</a></span> (<span class="id"><a href="compcert.backend.LTL.html#Block">Block</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#s">s</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#f">f</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#sp">sp</a></span> (<span class="id"><a href="compcert.backend.LTL.html#Lbranch">Lbranch</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#pc">pc</a></span> :: <span class="id"><a href="compcert.backend.Tunnelingproof.html#bb">bb</a></span>) <span class="id"><a href="compcert.backend.Tunnelingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#m">m</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.LTL.html#State">State</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ts">ts</a></span> (<span class="id"><a href="compcert.backend.Tunneling.html#tunnel_function">tunnel_function</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#f">f</a></span>) <span class="id"><a href="compcert.backend.Tunnelingproof.html#sp">sp</a></span> (<span class="id"><a href="compcert.backend.Tunnelingproof.html#branch_target">branch_target</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#f">f</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#pc">pc</a></span>) <span class="id"><a href="compcert.backend.Tunnelingproof.html#tls">tls</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#tm">tm</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="match_states_call">match_states_call</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s</span> <span class="id">fptr</span> <span class="id">sg</span> <span class="id">ls</span> <span class="id">m</span> <span class="id">ts</span> <span class="id">tfptr</span> <span class="id">tls</span> <span class="id">tm</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">STK</span>: <span class="id"><a href="compcert.lib.Coqlib.html#list_forall2">list_forall2</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#match_stackframes">match_stackframes</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#s">s</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ts">ts</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">LS</span>: <span class="id"><a href="compcert.backend.Tunnelingproof.html#locmap_lessdef">locmap_lessdef</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#tls">tls</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">MEM</span>: <span class="id"><a href="compcert.common.Memory.html#Mem.extends">Mem.extends</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#m">m</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#tm">tm</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FPTR</span>: <span class="id"><a href="compcert.common.Values.html#Val.lessdef">Val.lessdef</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#fptr">fptr</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#tfptr">tfptr</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Tunnelingproof.html#match_states">match_states</a></span> (<span class="id"><a href="compcert.backend.LTL.html#Callstate">Callstate</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#s">s</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#fptr">fptr</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#sg">sg</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#m">m</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.LTL.html#Callstate">Callstate</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ts">ts</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#tfptr">tfptr</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#sg">sg</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#tls">tls</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#tm">tm</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a name="match_states_return">match_states_return</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s</span> <span class="id">ls</span> <span class="id">m</span> <span class="id">ts</span> <span class="id">tls</span> <span class="id">tm</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">STK</span>: <span class="id"><a href="compcert.lib.Coqlib.html#list_forall2">list_forall2</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#match_stackframes">match_stackframes</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#s">s</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ts">ts</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">LS</span>: <span class="id"><a href="compcert.backend.Tunnelingproof.html#locmap_lessdef">locmap_lessdef</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#tls">tls</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">MEM</span>: <span class="id"><a href="compcert.common.Memory.html#Mem.extends">Mem.extends</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#m">m</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#tm">tm</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Tunnelingproof.html#match_states">match_states</a></span> (<span class="id"><a href="compcert.backend.LTL.html#Returnstate">Returnstate</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#s">s</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#m">m</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.LTL.html#Returnstate">Returnstate</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ts">ts</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#tls">tls</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#tm">tm</a></span>).<br/>
<br/>
<div class="doc">Properties of <span class="bracket"><span class="id">locmap_lessdef</span></span> </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="reglist_lessdef">reglist_lessdef</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">rl</span> <span class="id">ls1</span> <span class="id">ls2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Tunnelingproof.html#locmap_lessdef">locmap_lessdef</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ls1">ls1</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ls2">ls2</a></span> -&gt; <span class="id"><a href="compcert.common.Values.html#Val.lessdef_list">Val.lessdef_list</a></span> (<span class="id"><a href="compcert.backend.LTL.html#reglist">reglist</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ls1">ls1</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#rl">rl</a></span>) (<span class="id"><a href="compcert.backend.LTL.html#reglist">reglist</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ls2">ls2</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#rl">rl</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3807')">Proof.</div>
<div class="proofscript" id="proof3807">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">rl</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="locmap_set_lessdef">locmap_set_lessdef</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ls1</span> <span class="id">ls2</span> <span class="id">v1</span> <span class="id">v2</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Tunnelingproof.html#locmap_lessdef">locmap_lessdef</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ls1">ls1</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ls2">ls2</a></span> -&gt; <span class="id"><a href="compcert.common.Values.html#Val.lessdef">Val.lessdef</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#v1">v1</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#v2">v2</a></span> -&gt; <span class="id"><a href="compcert.backend.Tunnelingproof.html#locmap_lessdef">locmap_lessdef</a></span> (<span class="id"><a href="compcert.backend.Locations.html#Locmap.set">Locmap.set</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#l">l</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#v1">v1</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ls1">ls1</a></span>) (<span class="id"><a href="compcert.backend.Locations.html#Locmap.set">Locmap.set</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#l">l</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#v2">v2</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ls2">ls2</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3808')">Proof.</div>
<div class="proofscript" id="proof3808">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span> <span class="id">l</span>'. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Locations.html#Locmap.set">Locmap.set</a></span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.backend.Locations.html#Loc.eq">Loc.eq</a></span> <span class="id">l</span> <span class="id">l</span>').<br/>
- <span class="tactic">destruct</span> <span class="id">l</span>; <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="compcert.common.Values.html#Val.load_result_lessdef">Val.load_result_lessdef</a></span>.<br/>
- <span class="tactic">destruct</span> (<span class="id"><a href="compcert.backend.Locations.html#Loc.diff_dec">Loc.diff_dec</a></span> <span class="id">l</span> <span class="id">l</span>'); <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="locmap_set_undef_lessdef">locmap_set_undef_lessdef</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ls1</span> <span class="id">ls2</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Tunnelingproof.html#locmap_lessdef">locmap_lessdef</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ls1">ls1</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ls2">ls2</a></span> -&gt; <span class="id"><a href="compcert.backend.Tunnelingproof.html#locmap_lessdef">locmap_lessdef</a></span> (<span class="id"><a href="compcert.backend.Locations.html#Locmap.set">Locmap.set</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#l">l</a></span> <span class="id"><a href="compcert.common.Values.html#Vundef">Vundef</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ls1">ls1</a></span>) <span class="id"><a href="compcert.backend.Tunnelingproof.html#ls2">ls2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3809')">Proof.</div>
<div class="proofscript" id="proof3809">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span> <span class="id">l</span>'. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Locations.html#Locmap.set">Locmap.set</a></span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.backend.Locations.html#Loc.eq">Loc.eq</a></span> <span class="id">l</span> <span class="id">l</span>').<br/>
- <span class="tactic">destruct</span> <span class="id">l</span>; <span class="tactic">auto</span>. <span class="tactic">destruct</span> <span class="id">ty</span>; <span class="tactic">auto</span>. <br/>
- <span class="tactic">destruct</span> (<span class="id"><a href="compcert.backend.Locations.html#Loc.diff_dec">Loc.diff_dec</a></span> <span class="id">l</span> <span class="id">l</span>'); <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="locmap_undef_regs_lessdef">locmap_undef_regs_lessdef</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">rl</span> <span class="id">ls1</span> <span class="id">ls2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Tunnelingproof.html#locmap_lessdef">locmap_lessdef</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ls1">ls1</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ls2">ls2</a></span> -&gt; <span class="id"><a href="compcert.backend.Tunnelingproof.html#locmap_lessdef">locmap_lessdef</a></span> (<span class="id"><a href="compcert.backend.LTL.html#undef_regs">undef_regs</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#rl">rl</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ls1">ls1</a></span>) (<span class="id"><a href="compcert.backend.LTL.html#undef_regs">undef_regs</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#rl">rl</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ls2">ls2</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3810')">Proof.</div>
<div class="proofscript" id="proof3810">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">rl</span> <span class="kwd">as</span> [ | <span class="id">r</span> <span class="id">rl</span>]; <span class="tactic">intros</span>; <span class="tactic">simpl</span>. <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#locmap_set_lessdef">locmap_set_lessdef</a></span>; <span class="tactic">auto</span>. <br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="locmap_undef_regs_lessdef_1">locmap_undef_regs_lessdef_1</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">rl</span> <span class="id">ls1</span> <span class="id">ls2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Tunnelingproof.html#locmap_lessdef">locmap_lessdef</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ls1">ls1</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ls2">ls2</a></span> -&gt; <span class="id"><a href="compcert.backend.Tunnelingproof.html#locmap_lessdef">locmap_lessdef</a></span> (<span class="id"><a href="compcert.backend.LTL.html#undef_regs">undef_regs</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#rl">rl</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ls1">ls1</a></span>) <span class="id"><a href="compcert.backend.Tunnelingproof.html#ls2">ls2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3811')">Proof.</div>
<div class="proofscript" id="proof3811">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">rl</span> <span class="kwd">as</span> [ | <span class="id">r</span> <span class="id">rl</span>]; <span class="tactic">intros</span>; <span class="tactic">simpl</span>. <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#locmap_set_undef_lessdef">locmap_set_undef_lessdef</a></span>; <span class="tactic">auto</span>. <br/>
Qed.</div>
<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="locmap_getpair_lessdef">locmap_getpair_lessdef</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">p</span> <span class="id">ls1</span> <span class="id">ls2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Tunnelingproof.html#locmap_lessdef">locmap_lessdef</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ls1">ls1</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ls2">ls2</a></span> -&gt; <span class="id"><a href="compcert.common.Values.html#Val.lessdef">Val.lessdef</a></span> (<span class="id"><a href="compcert.backend.Locations.html#Locmap.getpair">Locmap.getpair</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#p">p</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ls1">ls1</a></span>) (<span class="id"><a href="compcert.backend.Locations.html#Locmap.getpair">Locmap.getpair</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#p">p</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ls2">ls2</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3812')">Proof.</div>
<div class="proofscript" id="proof3812">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">destruct</span> <span class="id">p</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="compcert.common.Values.html#Val.longofwords_lessdef">Val.longofwords_lessdef</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="locmap_getpairs_lessdef">locmap_getpairs_lessdef</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">pl</span> <span class="id">ls1</span> <span class="id">ls2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Tunnelingproof.html#locmap_lessdef">locmap_lessdef</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ls1">ls1</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ls2">ls2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Values.html#Val.lessdef_list">Val.lessdef_list</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">p</span> =&gt; <span class="id"><a href="compcert.backend.Locations.html#Locmap.getpair">Locmap.getpair</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#p">p</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ls1">ls1</a></span>) <span class="id"><a href="compcert.backend.Tunnelingproof.html#pl">pl</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">p</span> =&gt; <span class="id"><a href="compcert.backend.Locations.html#Locmap.getpair">Locmap.getpair</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#p">p</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ls2">ls2</a></span>) <span class="id"><a href="compcert.backend.Tunnelingproof.html#pl">pl</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3813')">Proof.</div>
<div class="proofscript" id="proof3813">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">induction</span> <span class="id">pl</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#locmap_getpair_lessdef">locmap_getpair_lessdef</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="locmap_setpair_lessdef">locmap_setpair_lessdef</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">p</span> <span class="id">ls1</span> <span class="id">ls2</span> <span class="id">v1</span> <span class="id">v2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Tunnelingproof.html#locmap_lessdef">locmap_lessdef</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ls1">ls1</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ls2">ls2</a></span> -&gt; <span class="id"><a href="compcert.common.Values.html#Val.lessdef">Val.lessdef</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#v1">v1</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#v2">v2</a></span> -&gt; <span class="id"><a href="compcert.backend.Tunnelingproof.html#locmap_lessdef">locmap_lessdef</a></span> (<span class="id"><a href="compcert.backend.Locations.html#Locmap.setpair">Locmap.setpair</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#p">p</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#v1">v1</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ls1">ls1</a></span>) (<span class="id"><a href="compcert.backend.Locations.html#Locmap.setpair">Locmap.setpair</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#p">p</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#v2">v2</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ls2">ls2</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3814')">Proof.</div>
<div class="proofscript" id="proof3814">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">destruct</span> <span class="id">p</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#locmap_set_lessdef">locmap_set_lessdef</a></span>, <span class="id"><a href="compcert.common.Values.html#Val.loword_lessdef">Val.loword_lessdef</a></span>, <span class="id"><a href="compcert.common.Values.html#Val.hiword_lessdef">Val.hiword_lessdef</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="locmap_setres_lessdef">locmap_setres_lessdef</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">res</span> <span class="id">ls1</span> <span class="id">ls2</span> <span class="id">v1</span> <span class="id">v2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Tunnelingproof.html#locmap_lessdef">locmap_lessdef</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ls1">ls1</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ls2">ls2</a></span> -&gt; <span class="id"><a href="compcert.common.Values.html#Val.lessdef">Val.lessdef</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#v1">v1</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#v2">v2</a></span> -&gt; <span class="id"><a href="compcert.backend.Tunnelingproof.html#locmap_lessdef">locmap_lessdef</a></span> (<span class="id"><a href="compcert.backend.Locations.html#Locmap.setres">Locmap.setres</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#res">res</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#v1">v1</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ls1">ls1</a></span>) (<span class="id"><a href="compcert.backend.Locations.html#Locmap.setres">Locmap.setres</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#res">res</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#v2">v2</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ls2">ls2</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3815')">Proof.</div>
<div class="proofscript" id="proof3815">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">res</span>; <span class="tactic">intros</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#locmap_set_lessdef">locmap_set_lessdef</a></span>, <span class="id"><a href="compcert.common.Values.html#Val.loword_lessdef">Val.loword_lessdef</a></span>, <span class="id"><a href="compcert.common.Values.html#Val.hiword_lessdef">Val.hiword_lessdef</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="locmap_undef_caller_save_regs_lessdef">locmap_undef_caller_save_regs_lessdef</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ls1</span> <span class="id">ls2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Tunnelingproof.html#locmap_lessdef">locmap_lessdef</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ls1">ls1</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ls2">ls2</a></span> -&gt; <span class="id"><a href="compcert.backend.Tunnelingproof.html#locmap_lessdef">locmap_lessdef</a></span> (<span class="id"><a href="compcert.backend.LTL.html#undef_caller_save_regs">undef_caller_save_regs</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ls1">ls1</a></span>) (<span class="id"><a href="compcert.backend.LTL.html#undef_caller_save_regs">undef_caller_save_regs</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ls2">ls2</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3816')">Proof.</div>
<div class="proofscript" id="proof3816">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.LTL.html#undef_caller_save_regs">undef_caller_save_regs</a></span>. <br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">l</span>.<br/>
- <span class="tactic">destruct</span> (<span class="id"><a href="compcert.x86.Conventions1.html#is_callee_save">Conventions1.is_callee_save</a></span> <span class="id">r</span>); <span class="tactic">auto</span>.<br/>
- <span class="tactic">destruct</span> <span class="id">sl</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="find_function_translated">find_function_translated</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ros</span> <span class="id">ls</span> <span class="id">tls</span> <span class="id">fptr</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Tunnelingproof.html#locmap_lessdef">locmap_lessdef</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#tls">tls</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.LTL.html#find_function_ptr">find_function_ptr</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#PRESERVATION.CORELEMMA.ge">ge</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ros">ros</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ls">ls</a></span> = <span class="id"><a href="compcert.backend.Tunnelingproof.html#fptr">fptr</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">tfptr</span>, <span class="id"><a href="compcert.backend.LTL.html#find_function_ptr">find_function_ptr</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#PRESERVATION.CORELEMMA.tge">tge</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ros">ros</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#tls">tls</a></span> = <span class="id"><a href="compcert.backend.Tunnelingproof.html#tfptr">tfptr</a></span> /\ <span class="id"><a href="compcert.common.Values.html#Val.lessdef">Val.lessdef</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#fptr">fptr</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#tfptr">tfptr</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3817')">Proof.</div>
<div class="proofscript" id="proof3817">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.LTL.html#find_function_ptr">find_function_ptr</a></span>. <span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">ros</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
- <span class="tactic">rewrite</span> &lt;- <span class="id">H0</span>. <span class="id">esplit</span>; <span class="tactic">eauto</span>.<br/>
- <span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#symbols_preserved">symbols_preserved</a></span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_symbol">Genv.find_symbol</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#PRESERVATION.CORELEMMA.ge">ge</a></span> <span class="id">i</span>); <span class="id">inv</span> <span class="id">H0</span>; <span class="id">esplit</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="call_regs_lessdef">call_regs_lessdef</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ls1</span> <span class="id">ls2</span>, <span class="id"><a href="compcert.backend.Tunnelingproof.html#locmap_lessdef">locmap_lessdef</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ls1">ls1</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ls2">ls2</a></span> -&gt; <span class="id"><a href="compcert.backend.Tunnelingproof.html#locmap_lessdef">locmap_lessdef</a></span> (<span class="id"><a href="compcert.backend.LTL.html#call_regs">call_regs</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ls1">ls1</a></span>) (<span class="id"><a href="compcert.backend.LTL.html#call_regs">call_regs</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ls2">ls2</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3818')">Proof.</div>
<div class="proofscript" id="proof3818">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">l</span> <span class="kwd">as</span> [<span class="id">r</span> | [] <span class="id">ofs</span> <span class="id">ty</span>]; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="return_regs_lessdef">return_regs_lessdef</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">caller1</span> <span class="id">callee1</span> <span class="id">caller2</span> <span class="id">callee2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Tunnelingproof.html#locmap_lessdef">locmap_lessdef</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#caller1">caller1</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#caller2">caller2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Tunnelingproof.html#locmap_lessdef">locmap_lessdef</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#callee1">callee1</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#callee2">callee2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Tunnelingproof.html#locmap_lessdef">locmap_lessdef</a></span> (<span class="id"><a href="compcert.backend.LTL.html#return_regs">return_regs</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#caller1">caller1</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#callee1">callee1</a></span>) (<span class="id"><a href="compcert.backend.LTL.html#return_regs">return_regs</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#caller2">caller2</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#callee2">callee2</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3819')">Proof.</div>
<div class="proofscript" id="proof3819">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">l</span>; <span class="tactic">simpl</span>.<br/>
- <span class="tactic">destruct</span> (<span class="id"><a href="compcert.x86.Conventions1.html#is_callee_save">Conventions1.is_callee_save</a></span> <span class="id">r</span>); <span class="tactic">auto</span>.<br/>
- <span class="tactic">destruct</span> <span class="id">sl</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">To preserve non-terminating behaviours, we show that the transformed
  code cannot take an infinity of "zero transition" cases.
  We use the following <span class="bracket"><span class="kwd">measure</span></span> function over source states,
  which decreases strictly in the "zero transition" case. </div>
<br/>
<span class="kwd">Definition</span> <span class="kwd">measure</span> (<span class="id">st</span>: <span class="id"><a href="compcert.backend.LTL.html#state">state</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#st">st</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.LTL.html#State">State</a></span> <span class="id">s</span> <span class="id">f</span> <span class="id">sp</span> <span class="id">pc</span> <span class="id">ls</span> <span class="id">m</span> =&gt; (<span class="id"><a href="compcert.backend.Tunnelingproof.html#count_gotos">count_gotos</a></span> <span class="id">f</span> <span class="id">pc</span> * 2)%<span class="id">nat</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.LTL.html#Block">Block</a></span> <span class="id">s</span> <span class="id">f</span> <span class="id">sp</span> (<span class="id"><a href="compcert.backend.LTL.html#Lbranch">Lbranch</a></span> <span class="id">pc</span> :: <span class="id">_</span>) <span class="id">ls</span> <span class="id">m</span> =&gt; (<span class="id"><a href="compcert.backend.Tunnelingproof.html#count_gotos">count_gotos</a></span> <span class="id">f</span> <span class="id">pc</span> * 2 + 1)%<span class="id">nat</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.LTL.html#Block">Block</a></span> <span class="id">s</span> <span class="id">f</span> <span class="id">sp</span> <span class="id">bb</span> <span class="id">ls</span> <span class="id">m</span> =&gt; 0%<span class="id">nat</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.LTL.html#Callstate">Callstate</a></span> <span class="id">s</span> <span class="id">fptr</span> <span class="id">sg</span> <span class="id">ls</span> <span class="id">m</span> =&gt; 0%<span class="id">nat</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.LTL.html#Returnstate">Returnstate</a></span> <span class="id">s</span> <span class="id">ls</span> <span class="id">m</span> =&gt; 0%<span class="id">nat</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="match_parent_locset">match_parent_locset</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s</span> <span class="id">ts</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#list_forall2">list_forall2</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#match_stackframes">match_stackframes</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#s">s</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ts">ts</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Tunnelingproof.html#locmap_lessdef">locmap_lessdef</a></span> (<span class="id"><a href="compcert.backend.LTL.html#parent_locset">parent_locset</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#s">s</a></span>) (<span class="id"><a href="compcert.backend.LTL.html#parent_locset">parent_locset</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#ts">ts</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3820')">Proof.</div>
<div class="proofscript" id="proof3820">
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">simpl</span>.<br/>
- <span class="tactic">red</span>; <span class="tactic">auto</span>.<br/>
- <span class="id">inv</span> <span class="id">H</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="tunnel_step_correct">tunnel_step_correct</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">st1</span> <span class="id">t</span> <span class="id">st2</span>, <span class="id"><a href="compcert.backend.LTL.html#step">step</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#PRESERVATION.CORELEMMA.se">se</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#PRESERVATION.CORELEMMA.ge">ge</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#st1">st1</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#t">t</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#st2">st2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">st1</span>' (<span class="id">MS</span>: <span class="id"><a href="compcert.backend.Tunnelingproof.html#match_states">match_states</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#st1">st1</a></span> <span class="id">st1</span>'),<br/>
&nbsp;&nbsp;(<span class="id">exists</span> <span class="id">st2</span>', <span class="id"><a href="compcert.backend.LTL.html#step">step</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#PRESERVATION.CORELEMMA.tse">tse</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#PRESERVATION.CORELEMMA.tge">tge</a></span> <span class="id">st1</span>' <span class="id"><a href="compcert.backend.Tunnelingproof.html#t">t</a></span> <span class="id">st2</span>' /\ <span class="id"><a href="compcert.backend.Tunnelingproof.html#match_states">match_states</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#st2">st2</a></span> <span class="id">st2</span>')<br/>
&nbsp;&nbsp;\/ (<span class="kwd">measure</span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#st2">st2</a></span> &lt; <span class="kwd">measure</span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#st1">st1</a></span> /\ <span class="id"><a href="compcert.backend.Tunnelingproof.html#t">t</a></span> = <span class="id"><a href="compcert.common.Events.html#E0">E0</a></span> /\ <span class="id"><a href="compcert.backend.Tunnelingproof.html#match_states">match_states</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#st2">st2</a></span> <span class="id">st1</span>')%<span class="id">nat</span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3821')">Proof.</div>
<div class="proofscript" id="proof3821">
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">intros</span>; <span class="tactic">try</span> <span class="id">inv</span> <span class="id">MS</span>.<br/>
<br/>
- <span class="comment">(*&nbsp;entering&nbsp;a&nbsp;block&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">DEFAULT</span>: <span class="id"><a href="compcert.backend.Tunnelingproof.html#branch_target">branch_target</a></span> <span class="id">f</span> <span class="id">pc</span> = <span class="id">pc</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">exists</span> <span class="id">st2</span>' : <span class="id"><a href="compcert.backend.LTL.html#state">state</a></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.LTL.html#step">step</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#PRESERVATION.CORELEMMA.tse">tse</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#PRESERVATION.CORELEMMA.tge">tge</a></span> (<span class="id"><a href="compcert.backend.LTL.html#State">State</a></span> <span class="id">ts</span> (<span class="id"><a href="compcert.backend.Tunneling.html#tunnel_function">tunnel_function</a></span> <span class="id">f</span>) <span class="id">sp</span> (<span class="id"><a href="compcert.backend.Tunnelingproof.html#branch_target">branch_target</a></span> <span class="id">f</span> <span class="id">pc</span>) <span class="id">tls</span> <span class="id">tm</span>) <span class="id"><a href="compcert.common.Events.html#E0">E0</a></span> <span class="id">st2</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="compcert.backend.Tunnelingproof.html#match_states">match_states</a></span> (<span class="id"><a href="compcert.backend.LTL.html#Block">Block</a></span> <span class="id">s</span> <span class="id">f</span> <span class="id">sp</span> <span class="id">bb</span> <span class="id">rs</span> <span class="id">m</span>) <span class="id">st2</span>')).<br/>
&nbsp;&nbsp;{ <span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id">H0</span>. <span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Maps.html#PTree.gmap1">PTree.gmap1</a></span>. <span class="tactic">rewrite</span> <span class="id">H</span>. <span class="tactic">simpl</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>. }<br/>
<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="compcert.backend.Tunnelingproof.html#record_gotos_correct">record_gotos_correct</a></span> <span class="id">f</span> <span class="id">pc</span>). <span class="tactic">rewrite</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">bb</span>; <span class="tactic">auto</span>. <span class="tactic">destruct</span> <span class="id">i</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">A</span> | [<span class="id">B</span> <span class="id">C</span>]]. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">right</span>. <span class="tactic">split</span>. <span class="tactic">simpl</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">B</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
<br/>
- <span class="comment">(*&nbsp;Lop&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.x86.Op.html#eval_operation_lessdef">eval_operation_lessdef</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#reglist_lessdef">reglist_lessdef</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <br/>
&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">tv</span> &amp; <span class="id">EV</span> &amp; <span class="id">LD</span>).<br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="tactic">simpl</span>; <span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.LTL.html#exec_Lop">exec_Lop</a></span> <span class="kwd">with</span> (<span class="id">v</span> := <span class="id">tv</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">EV</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.x86.Op.html#eval_operation_preserved">eval_operation_preserved</a></span>. <span class="tactic">exact</span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#symbols_preserved">symbols_preserved</a></span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#locmap_set_lessdef">locmap_set_lessdef</a></span>, <span class="id"><a href="compcert.backend.Tunnelingproof.html#locmap_undef_regs_lessdef">locmap_undef_regs_lessdef</a></span>.<br/>
- <span class="comment">(*&nbsp;Lload&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.x86.Op.html#eval_addressing_lessdef">eval_addressing_lessdef</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#reglist_lessdef">reglist_lessdef</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <br/>
&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">ta</span> &amp; <span class="id">EV</span> &amp; <span class="id">LD</span>).<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Memory.html#Mem.loadv_extends">Mem.loadv_extends</a></span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="id">eexact</span> <span class="id">LD</span>. <br/>
&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">tv</span> &amp; <span class="id">LOAD</span> &amp; <span class="id">LD</span>').<br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="tactic">simpl</span>; <span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.LTL.html#exec_Lload">exec_Lload</a></span> <span class="kwd">with</span> (<span class="id">a</span> := <span class="id">ta</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">EV</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.x86.Op.html#eval_addressing_preserved">eval_addressing_preserved</a></span>. <span class="tactic">exact</span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#symbols_preserved">symbols_preserved</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">eauto</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#locmap_set_lessdef">locmap_set_lessdef</a></span>, <span class="id"><a href="compcert.backend.Tunnelingproof.html#locmap_undef_regs_lessdef">locmap_undef_regs_lessdef</a></span>.<br/>
- <span class="comment">(*&nbsp;Lgetstack&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="tactic">simpl</span>; <span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#locmap_set_lessdef">locmap_set_lessdef</a></span>, <span class="id"><a href="compcert.backend.Tunnelingproof.html#locmap_undef_regs_lessdef">locmap_undef_regs_lessdef</a></span>.<br/>
- <span class="comment">(*&nbsp;Lsetstack&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="tactic">simpl</span>; <span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#locmap_set_lessdef">locmap_set_lessdef</a></span>, <span class="id"><a href="compcert.backend.Tunnelingproof.html#locmap_undef_regs_lessdef">locmap_undef_regs_lessdef</a></span>.<br/>
- <span class="comment">(*&nbsp;Lstore&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.x86.Op.html#eval_addressing_lessdef">eval_addressing_lessdef</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#reglist_lessdef">reglist_lessdef</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <br/>
&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">ta</span> &amp; <span class="id">EV</span> &amp; <span class="id">LD</span>).<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Memory.html#Mem.storev_extends">Mem.storev_extends</a></span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="id">eexact</span> <span class="id">LD</span>. <span class="tactic">apply</span> <span class="id">LS</span>.  <br/>
&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">tm</span>' &amp; <span class="id">STORE</span> &amp; <span class="id">MEM</span>').<br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="tactic">simpl</span>; <span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.LTL.html#exec_Lstore">exec_Lstore</a></span> <span class="kwd">with</span> (<span class="id">a</span> := <span class="id">ta</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">EV</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.x86.Op.html#eval_addressing_preserved">eval_addressing_preserved</a></span>. <span class="tactic">exact</span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#symbols_preserved">symbols_preserved</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">eauto</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#locmap_undef_regs_lessdef">locmap_undef_regs_lessdef</a></span>.<br/>
- <span class="comment">(*&nbsp;Lcall&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#find_function_translated">find_function_translated</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">tfptr</span> &amp; <span class="id">FPTR</span>' &amp; <span class="id">LESSDEF</span>).<br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="tactic">simpl</span>; <span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.LTL.html#exec_Lcall">exec_Lcall</a></span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id">FPTR</span>'. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">FPTR</span>. <span class="tactic">eauto</span>.<br/>
- <span class="comment">(*&nbsp;Ltailcall&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">FPTR</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#find_function_translated">find_function_translated</a></span>; <span class="id">swap</span> 1 2; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#return_regs_lessdef">return_regs_lessdef</a></span>, <span class="id"><a href="compcert.backend.Tunnelingproof.html#match_parent_locset">match_parent_locset</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">tfptr</span> &amp; <span class="id">A</span> &amp; <span class="id">B</span>).<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Memory.html#Mem.free_parallel_extends">Mem.free_parallel_extends</a></span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">tm</span>' &amp; <span class="id">FREE</span> &amp; <span class="id">MEM</span>'). <br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="tactic">simpl</span>; <span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.LTL.html#exec_Ltailcall">exec_Ltailcall</a></span>; <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id">A</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#return_regs_lessdef">return_regs_lessdef</a></span>, <span class="id"><a href="compcert.backend.Tunnelingproof.html#match_parent_locset">match_parent_locset</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H</span>. <span class="tactic">eauto</span>.<br/>
- <span class="comment">(*&nbsp;Lbuiltin&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Events.html#eval_builtin_args_lessdef">eval_builtin_args_lessdef</a></span>. <span class="id">eexact</span> <span class="id">LS</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">tvargs</span> &amp; <span class="id">EVA</span> &amp; <span class="id">LDA</span>).<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Events.html#external_call_mem_extends">external_call_mem_extends</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">tvres</span> &amp; <span class="id">tm</span>' &amp; <span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span> &amp; <span class="id">D</span>).<br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="tactic">simpl</span>; <span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.LTL.html#exec_Lbuiltin">exec_Lbuiltin</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Events.html#eval_builtin_args_preserved">eval_builtin_args_preserved</a></span> <span class="kwd">with</span> (<span class="id">ge1</span> := <span class="id"><a href="compcert.backend.Tunnelingproof.html#PRESERVATION.CORELEMMA.ge">ge</a></span>); <span class="tactic">eauto</span>. <span class="tactic">exact</span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#symbols_preserved">symbols_preserved</a></span>. <br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Events.html#external_call_symbols_preserved">external_call_symbols_preserved</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#locmap_setres_lessdef">locmap_setres_lessdef</a></span>, <span class="id"><a href="compcert.backend.Tunnelingproof.html#locmap_undef_regs_lessdef">locmap_undef_regs_lessdef</a></span>.<br/>
- <span class="comment">(*&nbsp;Lbranch&nbsp;(preserved)&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="tactic">simpl</span>; <span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.LTL.html#exec_Lbranch">exec_Lbranch</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">fold</span> (<span class="id"><a href="compcert.backend.Tunnelingproof.html#branch_target">branch_target</a></span> <span class="id">f</span> <span class="id">pc</span>). <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
- <span class="comment">(*&nbsp;Lbranch&nbsp;(eliminated)&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">right</span>; <span class="tactic">split</span>. <span class="tactic">simpl</span>. <span class="tactic">omega</span>. <span class="tactic">split</span>. <span class="tactic">auto</span>. <span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
<br/>
- <span class="comment">(*&nbsp;Lcond&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="id">tunneled_block</span>.<br/>
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">s1</span> := <span class="id"><a href="compcert.backend.Tunneling.html#U.repr">U.repr</a></span> (<span class="id"><a href="compcert.backend.Tunneling.html#record_gotos">record_gotos</a></span> <span class="id">f</span>) <span class="id">pc1</span>). <span class="tactic">set</span> (<span class="id">s2</span> := <span class="id"><a href="compcert.backend.Tunneling.html#U.repr">U.repr</a></span> (<span class="id"><a href="compcert.backend.Tunneling.html#record_gotos">record_gotos</a></span> <span class="id">f</span>) <span class="id">pc2</span>).<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#peq">peq</a></span> <span class="id">s1</span> <span class="id">s2</span>).<br/>
+ <span class="id">left</span>; <span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.LTL.html#exec_Lbranch">exec_Lbranch</a></span>. <br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">b</span>.<br/>
* <span class="id">constructor</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#locmap_undef_regs_lessdef_1">locmap_undef_regs_lessdef_1</a></span>.<br/>
* <span class="tactic">rewrite</span> <span class="id">e</span>. <span class="id">constructor</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#locmap_undef_regs_lessdef_1">locmap_undef_regs_lessdef_1</a></span>.<br/>
+ <span class="id">left</span>; <span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.LTL.html#exec_Lcond">exec_Lcond</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.x86.Op.html#eval_condition_lessdef">eval_condition_lessdef</a></span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#reglist_lessdef">reglist_lessdef</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">b</span>; <span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#locmap_undef_regs_lessdef">locmap_undef_regs_lessdef</a></span>.<br/>
<br/>
- <span class="comment">(*&nbsp;Ljumptable&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">tls</span> (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id">arg</span>) = <span class="id"><a href="compcert.common.Values.html#Vint">Vint</a></span> <span class="id">n</span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">generalize</span> (<span class="id">LS</span> (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id">arg</span>)); <span class="tactic">rewrite</span> <span class="id">H</span>; <span class="tactic">intros</span> <span class="id">LD</span>; <span class="id">inv</span> <span class="id">LD</span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="tactic">simpl</span>; <span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.LTL.html#exec_Ljumptable">exec_Ljumptable</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#list_nth_z_map">list_nth_z_map</a></span>. <span class="id">change</span> <span class="id"><a href="compcert.backend.Tunneling.html#U.elt">U.elt</a></span> <span class="kwd">with</span> <span class="id"><a href="compcert.backend.LTL.html#node">node</a></span>. <span class="tactic">rewrite</span> <span class="id">H0</span>. <span class="tactic">reflexivity</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#locmap_undef_regs_lessdef">locmap_undef_regs_lessdef</a></span>.<br/>
- <span class="comment">(*&nbsp;Lreturn&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Memory.html#Mem.free_parallel_extends">Mem.free_parallel_extends</a></span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">tm</span>' &amp; <span class="id">FREE</span> &amp; <span class="id">MEM</span>'). <br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="tactic">simpl</span>; <span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.LTL.html#exec_Lreturn">exec_Lreturn</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#return_regs_lessdef">return_regs_lessdef</a></span>, <span class="id"><a href="compcert.backend.Tunnelingproof.html#match_parent_locset">match_parent_locset</a></span>.<br/>
- <span class="comment">(*&nbsp;internal&nbsp;function&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#functions_translated">functions_translated</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> <span class="id">FPTR</span>'.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">fptr</span> = <span class="id">tfptr</span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Globalenvs.html#find_funct_lessdef">find_funct_lessdef</a></span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Memory.html#Mem.alloc_extends">Mem.alloc_extends</a></span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.le_refl">Z.le_refl</a></span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.le_refl">Z.le_refl</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">tm</span>' &amp; <span class="id">ALLOC</span> &amp; <span class="id">MEM</span>'). <br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="tactic">simpl</span>; <span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.LTL.html#exec_function_internal">exec_function_internal</a></span>. <span class="tactic">rewrite</span> &lt;- <span class="id">H0</span>. <span class="tactic">apply</span> <span class="id">FPTR</span>'. <span class="tactic">auto</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#locmap_undef_regs_lessdef">locmap_undef_regs_lessdef</a></span>, <span class="id"><a href="compcert.backend.Tunnelingproof.html#call_regs_lessdef">call_regs_lessdef</a></span>.<br/>
- <span class="comment">(*&nbsp;external&nbsp;function&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#functions_translated">functions_translated</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> <span class="id">FPTR</span>'.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">fptr</span> = <span class="id">tfptr</span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Globalenvs.html#find_funct_lessdef">find_funct_lessdef</a></span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="kwd">Local</span> <span class="id">Opaque</span> <span class="id"><a href="compcert.x86.Conventions1.html#destroyed_at_call">Conventions1.destroyed_at_call</a></span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Events.html#external_call_mem_extends">external_call_mem_extends</a></span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#locmap_getpairs_lessdef">locmap_getpairs_lessdef</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">tvres</span> &amp; <span class="id">tm</span>' &amp; <span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span> &amp; <span class="id">D</span>).<br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="tactic">simpl</span>; <span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.LTL.html#exec_function_external">exec_function_external</a></span>. <span class="tactic">rewrite</span> &lt;- <span class="id">H</span>. <span class="tactic">apply</span> <span class="id">FPTR</span>'. <span class="tactic">auto</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Events.html#external_call_symbols_preserved">external_call_symbols_preserved</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#locmap_setpair_lessdef">locmap_setpair_lessdef</a></span>, <span class="id"><a href="compcert.backend.Tunnelingproof.html#locmap_undef_caller_save_regs_lessdef">locmap_undef_caller_save_regs_lessdef</a></span>.<br/>
- <span class="comment">(*&nbsp;return&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">STK</span>. <span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;{ <span class="id">left</span>; <span class="id">econstructor</span>; <span class="tactic">split</span>. - <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.LTL.html#exec_return">exec_return</a></span>; <span class="tactic">eauto</span>. - <span class="id">constructor</span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.LTL.html#exec_return">exec_return</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#PRESERVATION.CORELEMMA">CORELEMMA</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="PRESERVATION.WHOLE">WHOLE</a></span>.<br/>
<br/>
<span class="kwd">Let</span> <span class="id"><a name="PRESERVATION.WHOLE.ge">ge</a></span> := <span class="id"><a href="compcert.common.Globalenvs.html#Genv.globalenv">Genv.globalenv</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#PRESERVATION.prog">prog</a></span>.<br/>
<span class="kwd">Let</span> <span class="id"><a name="PRESERVATION.WHOLE.tge">tge</a></span> := <span class="id"><a href="compcert.common.Globalenvs.html#Genv.globalenv">Genv.globalenv</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#PRESERVATION.tprog">tprog</a></span>.<br/>
<br/>
<span class="kwd">Let</span> <span class="id"><a name="PRESERVATION.WHOLE.MATCH_GENV">MATCH_GENV</a></span>: <span class="id"><a href="compcert.common.Globalenvs.html#Genv.match_genvs">Genv.match_genvs</a></span> (<span class="id"><a href="compcert.common.Linking.html#match_globdef">match_globdef</a></span> (<span class="kwd">fun</span> <span class="id">ctx</span> <span class="id">f</span> <span class="id">tf</span> =&gt; <span class="id"><a href="compcert.backend.Tunnelingproof.html#tf">tf</a></span> = <span class="id"><a href="compcert.backend.Tunneling.html#tunnel_fundef">tunnel_fundef</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#f">f</a></span>) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#PRESERVATION.prog">prog</a></span>) <span class="id"><a href="compcert.backend.Tunnelingproof.html#PRESERVATION.WHOLE.ge">ge</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#PRESERVATION.WHOLE.tge">tge</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3822')">Proof.</div>
<div class="proofscript" id="proof3822">
 <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Globalenvs.html#Genv.globalenvs_match">Genv.globalenvs_match</a></span>; <span class="tactic">auto</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="transf_initial_states">transf_initial_states</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">st1</span>, <span class="id"><a href="compcert.backend.LTL.html#initial_state">initial_state</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#PRESERVATION.prog">prog</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#st1">st1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">st2</span>, <span class="id"><a href="compcert.backend.LTL.html#initial_state">initial_state</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#PRESERVATION.tprog">tprog</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#st2">st2</a></span> /\ <span class="id"><a href="compcert.backend.Tunnelingproof.html#match_states">match_states</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#st1">st1</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#st2">st2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3823')">Proof.</div>
<div class="proofscript" id="proof3823">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">inversion</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="compcert.backend.LTL.html#Callstate">Callstate</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">b</span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Integers.Ptrofs.zero</a></span>) <span class="id"><a href="compcert.common.AST.html#signature_main">signature_main</a></span> (<span class="id"><a href="compcert.backend.Locations.html#Locmap.init">Locmap.init</a></span> <span class="id"><a href="compcert.common.Values.html#Vundef">Vundef</a></span>) <span class="id">m0</span>); <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="compcert.common.Globalenvs.html#Genv.init_mem_transf">Genv.init_mem_transf</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#PRESERVATION.TRANSL">TRANSL</a></span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="compcert.common.Linking.html#match_program_main">match_program_main</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#PRESERVATION.TRANSL">TRANSL</a></span>).<br/>
&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#symbols_preserved">symbols_preserved</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>. <span class="id">constructor</span>. <span class="tactic">red</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.extends_refl">Mem.extends_refl</a></span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="transf_final_states">transf_final_states</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">st1</span> <span class="id">st2</span> <span class="id">r</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Tunnelingproof.html#match_states">match_states</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#st1">st1</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#st2">st2</a></span> -&gt; <span class="id"><a href="compcert.backend.LTL.html#final_state">final_state</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#st1">st1</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#r">r</a></span> -&gt; <span class="id"><a href="compcert.backend.LTL.html#final_state">final_state</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#st2">st2</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#r">r</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3824')">Proof.</div>
<div class="proofscript" id="proof3824">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H0</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="id">inv</span> <span class="id">STK</span>.<br/>
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">p</span> := <span class="id"><a href="compcert.common.AST.html#map_rpair">map_rpair</a></span> <span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> (<span class="id"><a href="compcert.x86.Conventions1.html#loc_result">Conventions1.loc_result</a></span> <span class="id"><a href="compcert.common.AST.html#signature_main">signature_main</a></span>)) <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="compcert.backend.Tunnelingproof.html#locmap_getpair_lessdef">locmap_getpair_lessdef</a></span> <span class="id">p</span> <span class="id">_</span> <span class="id">_</span> <span class="id">LS</span>). <span class="tactic">rewrite</span> <span class="id">H1</span>; <span class="tactic">intros</span> <span class="id">LD</span>; <span class="id">inv</span> <span class="id">LD</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="transf_program_correct">transf_program_correct</a></span>:<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Smallstep.html#forward_simulation">forward_simulation</a></span> (<span class="id"><a href="compcert.backend.LTL.html#semantics">LTL.semantics</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#PRESERVATION.prog">prog</a></span>) (<span class="id"><a href="compcert.backend.LTL.html#semantics">LTL.semantics</a></span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#PRESERVATION.tprog">tprog</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3825')">Proof.</div>
<div class="proofscript" id="proof3825">
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#forward_simulation_opt">forward_simulation_opt</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#senv_preserved">senv_preserved</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">eexact</span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#transf_initial_states">transf_initial_states</a></span>.<br/>
&nbsp;&nbsp;<span class="id">eexact</span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#transf_final_states">transf_final_states</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#tunnel_step_correct">tunnel_step_correct</a></span>; <span class="tactic">auto</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#senv_preserved">senv_preserved</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#PRESERVATION.WHOLE">WHOLE</a></span>.<br/>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.backend.Tunnelingproof.html#PRESERVATION">PRESERVATION</a></span>.<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</div>
</body>
</html>
