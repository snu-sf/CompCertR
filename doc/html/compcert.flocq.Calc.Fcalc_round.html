
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module Fcalc_round</title>
<meta name="description" content="Documentation of Coq module Fcalc_round" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module Fcalc_round</h1>
<div class="coq">
<br/>
<h1> Helper function for computing the rounded value of a real number. </h1>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.flocq.Core.Fcore.html">Fcore</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.flocq.Core.Fcore_digits.html">Fcore_digits</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html">Fcalc_bracket</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_digits.html">Fcalc_digits</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Fcalc_round">Fcalc_round</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Fcalc_round.beta">beta</a></span> : <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix">radix</a></span>.<br/>
<span class="kwd">Notation</span> <span class="id"><a name="bpow">bpow</a></span> <span class="id">e</span> := (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow">bpow</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id">e</span>).<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Fcalc_round.Fcalc_round_fexp">Fcalc_round_fexp</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.<br/>
<span class="kwd">Context</span> { <span class="id">valid_exp</span> : <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#Valid_exp">Valid_exp</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> }.<br/>
<span class="kwd">Notation</span> <span class="id"><a name="format">format</a></span> := (<span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span>).<br/>
<br/>
<div class="doc">Relates location and rounding. </div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="inbetween_float_round">inbetween_float_round</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">rnd</span> <span class="id">choice</span>,<br/>
&nbsp;&nbsp;( <span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span>, <span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#inbetween_int">inbetween_int</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span> -&gt; <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#rnd">rnd</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> = <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#choice">choice</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span> ) -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">e</span> := <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#canonic_exp">canonic_exp</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#e">e</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#rnd">rnd</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> = <span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#F2R">F2R</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#Float">Float</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#choice">choice</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#e">e</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof5656')">Proof.</div>
<div class="proofscript" id="proof5656">
<span class="tactic">intros</span> <span class="id">rnd</span> <span class="id">choice</span> <span class="id">Hc</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span> <span class="id">e</span> <span class="id">Hl</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#round">round</a></span>, <span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#F2R">F2R</a></span>. <span class="tactic">simpl</span>.<br/>
<span class="tactic">apply</span> (<span class="tactic">f_equal</span> (<span class="kwd">fun</span> <span class="id">m</span> =&gt; (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span> * <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#bpow">bpow</a></span> <span class="id">e</span>)%<span class="id">R</span>)).<br/>
<span class="tactic">apply</span> <span class="id">Hc</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#inbetween_mult_reg">inbetween_mult_reg</a></span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#bpow">bpow</a></span> <span class="id">e</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow_gt_0">bpow_gt_0</a></span>.<br/>
<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#scaled_mantissa_mult_bpow">scaled_mantissa_mult_bpow</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="cond_incr">cond_incr</a></span> (<span class="id">b</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>) <span class="id">m</span> := <span class="kwd">if</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#b">b</a></span> <span class="kwd">then</span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span> + 1)%<span class="id">Z</span> <span class="kwd">else</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>.<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="inbetween_float_round_sign">inbetween_float_round_sign</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">rnd</span> <span class="id">choice</span>,<br/>
&nbsp;&nbsp;( <span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span>, <span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#inbetween_int">inbetween_int</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#rnd">rnd</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> = <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#cond_Zopp">cond_Zopp</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> 0) (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#choice">choice</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> 0) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span>) ) -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">e</span> := <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#canonic_exp">canonic_exp</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#e">e</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#rnd">rnd</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> = <span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#F2R">F2R</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#Float">Float</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#cond_Zopp">cond_Zopp</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> 0) (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#choice">choice</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> 0) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span>)) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#e">e</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof5657')">Proof.</div>
<div class="proofscript" id="proof5657">
<span class="tactic">intros</span> <span class="id">rnd</span> <span class="id">choice</span> <span class="id">Hc</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span> <span class="id">e</span> <span class="id">Hx</span>.<br/>
<span class="tactic">apply</span> (<span class="tactic">f_equal</span> (<span class="kwd">fun</span> <span class="id">m</span> =&gt; (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span> * <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#bpow">bpow</a></span> <span class="id">e</span>)%<span class="id">R</span>)).<br/>
<span class="tactic">simpl</span>.<br/>
<span class="tactic">replace</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id">x</span> 0) <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool">Rlt_bool</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#scaled_mantissa">scaled_mantissa</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id">x</span>) 0).<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="tactic">apply</span> <span class="id">Hc</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#inbetween_mult_reg">inbetween_mult_reg</a></span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#bpow">bpow</a></span> <span class="id">e</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow_gt_0">bpow_gt_0</a></span>.<br/>
<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_right">Rabs_right</a></span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#bpow">bpow</a></span> <span class="id">e</span>)) <span class="tactic">at</span> 3.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_mult">Rabs_mult</a></span>.<br/>
<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#scaled_mantissa_mult_bpow">scaled_mantissa_mult_bpow</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_ge">Rle_ge</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow_ge_0">bpow_ge_0</a></span>.<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="tactic">destruct</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool_spec">Rlt_bool_spec</a></span> <span class="id">x</span> 0) <span class="kwd">as</span> [<span class="id">Zx</span>|<span class="id">Zx</span>] ; <span class="tactic">simpl</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool_true">Rlt_bool_true</a></span>.<br/>
<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_0_l">Rmult_0_l</a></span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#bpow">bpow</a></span> (-<span class="id">e</span>))).<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_lt_compat_r">Rmult_lt_compat_r</a></span> <span class="kwd">with</span> (2 := <span class="id">Zx</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow_gt_0">bpow_gt_0</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool_false">Rlt_bool_false</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rmult_le_pos">Rmult_le_pos</a></span> <span class="kwd">with</span> (1 := <span class="id">Zx</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow_ge_0">bpow_ge_0</a></span>.<br/>
Qed.</div>
<br/>
<div class="doc">Relates location and rounding down. </div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="inbetween_int_DN">inbetween_int_DN</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#inbetween_int">inbetween_int</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Zfloor">Zfloor</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> = <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof5658')">Proof.</div>
<div class="proofscript" id="proof5658">
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span> <span class="id">Hl</span>.<br/>
<span class="tactic">refine</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Zfloor_imp">Zfloor_imp</a></span> <span class="id">m</span> <span class="id">_</span> <span class="id">_</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#inbetween_bounds">inbetween_bounds</a></span> <span class="kwd">with</span> (2 := <span class="id">Hl</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_lt">Z2R_lt</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zlt_succ">Zlt_succ</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="inbetween_float_DN">inbetween_float_DN</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">e</span> := <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#canonic_exp">canonic_exp</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#e">e</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Zfloor">Zfloor</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> = <span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#F2R">F2R</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#Float">Float</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#e">e</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof5659')">Proof.</div>
<div class="proofscript" id="proof5659">
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#inbetween_float_round">inbetween_float_round</a></span> <span class="kwd">with</span> (<span class="id">choice</span> := <span class="kwd">fun</span> <span class="id">m</span> <span class="id">l</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>).<br/>
<span class="tactic">exact</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#inbetween_int_DN">inbetween_int_DN</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="round_sign_DN">round_sign_DN</a></span> <span class="id">s</span> <span class="id">l</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#loc_Exact">loc_Exact</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span><br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#s">s</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="inbetween_int_DN_sign">inbetween_int_DN_sign</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#inbetween_int">inbetween_int</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Zfloor">Zfloor</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> = <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#cond_Zopp">cond_Zopp</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> 0) (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#round_sign_DN">round_sign_DN</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> 0) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof5660')">Proof.</div>
<div class="proofscript" id="proof5660">
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span> <span class="id">Hl</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="kwd">in</span> <span class="id">Hl</span>.<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rcase_abs">Rcase_abs</a></span> <span class="id">x</span>) <span class="kwd">as</span> [<span class="id">Zx</span>|<span class="id">Zx</span>] .<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool_true">Rlt_bool_true</a></span> <span class="kwd">with</span> (1 := <span class="id">Zx</span>).<br/>
<span class="tactic">inversion_clear</span> <span class="id">Hl</span> ; <span class="tactic">simpl</span>.<br/>
<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_involutive">Ropp_involutive</a></span> <span class="id">x</span>).<br/>
<span class="tactic">rewrite</span> <span class="id">H</span>, &lt;- <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_opp">Z2R_opp</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Zfloor_Z2R">Zfloor_Z2R</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Zfloor_imp">Zfloor_imp</a></span>.<br/>
<span class="tactic">split</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_opp">Z2R_opp</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_lt_cancel">Ropp_lt_cancel</a></span>.<br/>
<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_involutive">Ropp_involutive</a></span>.<br/>
<span class="id">ring_simplify</span> (- (<span class="id">m</span> + 1) + 1)%<span class="id">Z</span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_opp">Z2R_opp</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_lt_cancel">Ropp_lt_cancel</a></span>.<br/>
<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_involutive">Ropp_involutive</a></span>.<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool_false">Rlt_bool_false</a></span>.<br/>
<span class="tactic">inversion_clear</span> <span class="id">Hl</span> ; <span class="tactic">simpl</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">H</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Zfloor_Z2R">Zfloor_Z2R</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Zfloor_imp">Zfloor_imp</a></span>.<br/>
<span class="tactic">split</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>.<br/>
<span class="tactic">apply</span> <span class="id">H</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rge_le">Rge_le</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="inbetween_float_DN_sign">inbetween_float_DN_sign</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">e</span> := <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#canonic_exp">canonic_exp</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#e">e</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Zfloor">Zfloor</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> = <span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#F2R">F2R</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#Float">Float</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#cond_Zopp">cond_Zopp</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> 0) (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#round_sign_DN">round_sign_DN</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> 0) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>)) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#e">e</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof5661')">Proof.</div>
<div class="proofscript" id="proof5661">
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#inbetween_float_round_sign">inbetween_float_round_sign</a></span> <span class="kwd">with</span> (<span class="id">choice</span> := <span class="kwd">fun</span> <span class="id">s</span> <span class="id">m</span> <span class="id">l</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#round_sign_DN">round_sign_DN</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#s">s</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>).<br/>
<span class="tactic">exact</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#inbetween_int_DN_sign">inbetween_int_DN_sign</a></span>.<br/>
Qed.</div>
<br/>
<div class="doc">Relates location and rounding up. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="round_UP">round_UP</a></span> <span class="id">l</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#loc_Exact">loc_Exact</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span><br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="inbetween_int_UP">inbetween_int_UP</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#inbetween_int">inbetween_int</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Zceil">Zceil</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> = <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#round_UP">round_UP</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof5662')">Proof.</div>
<div class="proofscript" id="proof5662">
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span> <span class="id">Hl</span>.<br/>
<span class="tactic">assert</span> (<span class="id">Hl</span>': <span class="id">l</span> = <span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#loc_Exact">loc_Exact</a></span> \/ (<span class="id">l</span> &lt;&gt; <span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#loc_Exact">loc_Exact</a></span> /\ <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#round_UP">round_UP</a></span> <span class="id">l</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>)).<br/>
<span class="tactic">case</span> <span class="id">l</span> ; <span class="tactic">try</span> (<span class="id">now</span> <span class="id">left</span>) ; <span class="id">now</span> <span class="id">right</span> ; <span class="tactic">split</span>.<br/>
<span class="tactic">destruct</span> <span class="id">Hl</span>' <span class="kwd">as</span> [<span class="id">Hl</span>'|(<span class="id">Hl1</span>, <span class="id">Hl2</span>)].<br/>
<span class="comment">(*&nbsp;Exact&nbsp;*)</span><br/>
<span class="tactic">rewrite</span> <span class="id">Hl</span>'.<br/>
<span class="tactic">destruct</span> <span class="id">Hl</span> ; <span class="tactic">try</span> <span class="id">easy</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">H</span>.<br/>
<span class="tactic">exact</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Zceil_Z2R">Zceil_Z2R</a></span> <span class="id">_</span>).<br/>
<span class="comment">(*&nbsp;not&nbsp;Exact&nbsp;*)</span><br/>
<span class="tactic">rewrite</span> <span class="id">Hl2</span>.<br/>
<span class="tactic">simpl</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Zceil_imp">Zceil_imp</a></span>.<br/>
<span class="id">ring_simplify</span> (<span class="id">m</span> + 1 - 1)%<span class="id">Z</span>.<br/>
<span class="tactic">refine</span> (<span class="kwd">let</span> <span class="id">H</span> := <span class="id">_</span> <span class="kwd">in</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#conj">conj</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#proj1">proj1</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#H">H</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#proj2">proj2</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#H">H</a></span>))).<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#inbetween_bounds_not_Eq">inbetween_bounds_not_Eq</a></span> <span class="kwd">with</span> (2 := <span class="id">Hl1</span>) (1 := <span class="id">Hl</span>).<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="inbetween_float_UP">inbetween_float_UP</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">e</span> := <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#canonic_exp">canonic_exp</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#e">e</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Zceil">Zceil</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> = <span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#F2R">F2R</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#Float">Float</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#round_UP">round_UP</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#e">e</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof5663')">Proof.</div>
<div class="proofscript" id="proof5663">
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#inbetween_float_round">inbetween_float_round</a></span> <span class="kwd">with</span> (<span class="id">choice</span> := <span class="kwd">fun</span> <span class="id">m</span> <span class="id">l</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#round_UP">round_UP</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>).<br/>
<span class="tactic">exact</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#inbetween_int_UP">inbetween_int_UP</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="round_sign_UP">round_sign_UP</a></span> <span class="id">s</span> <span class="id">l</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#loc_Exact">loc_Exact</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span><br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#s">s</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="inbetween_int_UP_sign">inbetween_int_UP_sign</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#inbetween_int">inbetween_int</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Zceil">Zceil</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> = <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#cond_Zopp">cond_Zopp</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> 0) (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#round_sign_UP">round_sign_UP</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> 0) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof5664')">Proof.</div>
<div class="proofscript" id="proof5664">
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span> <span class="id">Hl</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="kwd">in</span> <span class="id">Hl</span>.<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rcase_abs">Rcase_abs</a></span> <span class="id">x</span>) <span class="kwd">as</span> [<span class="id">Zx</span>|<span class="id">Zx</span>] .<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool_true">Rlt_bool_true</a></span> <span class="kwd">with</span> (1 := <span class="id">Zx</span>).<br/>
<span class="tactic">simpl</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Zceil">Zceil</a></span>.<br/>
<span class="tactic">apply</span> <span class="tactic">f_equal</span>.<br/>
<span class="tactic">inversion_clear</span> <span class="id">Hl</span> ; <span class="tactic">simpl</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">H</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Zfloor_Z2R">Zfloor_Z2R</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Zfloor_imp">Zfloor_imp</a></span>.<br/>
<span class="tactic">split</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>.<br/>
<span class="tactic">apply</span> <span class="id">H</span>.<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool_false">Rlt_bool_false</a></span>.<br/>
<span class="tactic">simpl</span>.<br/>
<span class="tactic">inversion_clear</span> <span class="id">Hl</span> ; <span class="tactic">simpl</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">H</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Zceil_Z2R">Zceil_Z2R</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Zceil_imp">Zceil_imp</a></span>.<br/>
<span class="tactic">split</span>.<br/>
<span class="id">change</span> (<span class="id">m</span> + 1 - 1)%<span class="id">Z</span> <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zpred">Zpred</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zsucc">Zsucc</a></span> <span class="id">m</span>)).<br/>
<span class="id">now</span> <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zpred_succ">Zpred_succ</a></span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rge_le">Rge_le</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="inbetween_float_UP_sign">inbetween_float_UP_sign</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">e</span> := <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#canonic_exp">canonic_exp</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#e">e</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Zceil">Zceil</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> = <span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#F2R">F2R</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#Float">Float</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#cond_Zopp">cond_Zopp</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> 0) (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#round_sign_UP">round_sign_UP</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> 0) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>)) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#e">e</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof5665')">Proof.</div>
<div class="proofscript" id="proof5665">
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#inbetween_float_round_sign">inbetween_float_round_sign</a></span> <span class="kwd">with</span> (<span class="id">choice</span> := <span class="kwd">fun</span> <span class="id">s</span> <span class="id">m</span> <span class="id">l</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#round_sign_UP">round_sign_UP</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#s">s</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>).<br/>
<span class="tactic">exact</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#inbetween_int_UP_sign">inbetween_int_UP_sign</a></span>.<br/>
Qed.</div>
<br/>
<div class="doc">Relates location and rounding toward zero. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="round_ZR">round_ZR</a></span> (<span class="id">s</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>) <span class="id">l</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#loc_Exact">loc_Exact</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span><br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#s">s</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="inbetween_int_ZR">inbetween_int_ZR</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#inbetween_int">inbetween_int</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Ztrunc">Ztrunc</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> = <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#round_ZR">round_ZR</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zlt_bool">Zlt_bool</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span> 0) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof5666')">Proof with</div>
<div class="proofscript" id="proof5666">
 <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">typeclass_instances</span>.<br/>
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span> <span class="id">Hl</span>.<br/>
<span class="tactic">inversion_clear</span> <span class="id">Hl</span> <span class="kwd">as</span> [<span class="id">Hx</span>|<span class="id">l</span>' <span class="id">Hx</span> <span class="id">Hl</span>'].<br/>
<span class="comment">(*&nbsp;Exact&nbsp;*)</span><br/>
<span class="tactic">rewrite</span> <span class="id">Hx</span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#Zrnd_Z2R">Zrnd_Z2R</a></span>...<br/>
<span class="comment">(*&nbsp;not&nbsp;Exact&nbsp;*)</span><br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Ztrunc">Ztrunc</a></span>.<br/>
<span class="tactic">assert</span> (<span class="id">Hm</span>: <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Zfloor">Zfloor</a></span> <span class="id">x</span> = <span class="id">m</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Zfloor_imp">Zfloor_imp</a></span>.<br/>
<span class="tactic">exact</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#conj">conj</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#proj1">proj1</a></span> <span class="id">Hx</span>)) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#proj2">proj2</a></span> <span class="id">Hx</span>)).<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Zceil_floor_neq">Zceil_floor_neq</a></span>.<br/>
<span class="tactic">rewrite</span> <span class="id">Hm</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#cond_incr">cond_incr</a></span>.<br/>
<span class="tactic">simpl</span>.<br/>
<span class="tactic">case</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool_spec">Rlt_bool_spec</a></span> ; <span class="tactic">intros</span> <span class="id">Hx</span>' ;<br/>
&nbsp;&nbsp;<span class="tactic">case</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zlt_bool_spec">Zlt_bool_spec</a></span> ; <span class="tactic">intros</span> <span class="id">Hm</span>' ; <span class="tactic">try</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#refl_equal">refl_equal</a></span>.<br/>
<span class="tactic">elim</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_not_le">Rlt_not_le</a></span> <span class="kwd">with</span> (1 := <span class="id">Hx</span>').<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="kwd">with</span> (2 := <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#proj1">proj1</a></span> <span class="id">Hx</span>).<br/>
<span class="id">now</span> <span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_le">Z2R_le</a></span> 0).<br/>
<span class="tactic">elim</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_not_lt">Rle_not_lt</a></span> <span class="kwd">with</span> (1 := <span class="id">Hx</span>').<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_trans">Rlt_le_trans</a></span> <span class="kwd">with</span> (1 := <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#proj2">proj2</a></span> <span class="id">Hx</span>).<br/>
<span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_le">Z2R_le</a></span> <span class="id">_</span> 0).<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zlt_le_succ">Zlt_le_succ</a></span>.<br/>
<span class="tactic">rewrite</span> <span class="id">Hm</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_not_eq">Rlt_not_eq</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="inbetween_float_ZR">inbetween_float_ZR</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">e</span> := <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#canonic_exp">canonic_exp</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#e">e</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Ztrunc">Ztrunc</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> = <span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#F2R">F2R</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#Float">Float</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#round_ZR">round_ZR</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zlt_bool">Zlt_bool</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span> 0) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#e">e</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof5667')">Proof.</div>
<div class="proofscript" id="proof5667">
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#inbetween_float_round">inbetween_float_round</a></span> <span class="kwd">with</span> (<span class="id">choice</span> := <span class="kwd">fun</span> <span class="id">m</span> <span class="id">l</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#round_ZR">round_ZR</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zlt_bool">Zlt_bool</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span> 0) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>).<br/>
<span class="tactic">exact</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#inbetween_int_ZR">inbetween_int_ZR</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="inbetween_int_ZR_sign">inbetween_int_ZR_sign</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#inbetween_int">inbetween_int</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Ztrunc">Ztrunc</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> = <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#cond_Zopp">cond_Zopp</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> 0) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof5668')">Proof.</div>
<div class="proofscript" id="proof5668">
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span> <span class="id">Hl</span>.<br/>
<span class="tactic">simpl</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Ztrunc">Ztrunc</a></span>.<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le_dec">Rlt_le_dec</a></span> <span class="id">x</span> 0) <span class="kwd">as</span> [<span class="id">Zx</span>|<span class="id">Zx</span>].<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool_true">Rlt_bool_true</a></span> <span class="kwd">with</span> (1 := <span class="id">Zx</span>).<br/>
<span class="tactic">simpl</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Zceil">Zceil</a></span>.<br/>
<span class="tactic">apply</span> <span class="tactic">f_equal</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Zfloor_imp">Zfloor_imp</a></span>.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_left">Rabs_left</a></span> <span class="kwd">with</span> (1 := <span class="id">Zx</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#inbetween_bounds">inbetween_bounds</a></span> <span class="kwd">with</span> (2 := <span class="id">Hl</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_lt">Z2R_lt</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zlt_succ">Zlt_succ</a></span>.<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool_false">Rlt_bool_false</a></span> <span class="kwd">with</span> (1 := <span class="id">Zx</span>).<br/>
<span class="tactic">simpl</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Zfloor_imp">Zfloor_imp</a></span>.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_pos_eq">Rabs_pos_eq</a></span> <span class="kwd">with</span> (1 := <span class="id">Zx</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#inbetween_bounds">inbetween_bounds</a></span> <span class="kwd">with</span> (2 := <span class="id">Hl</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_lt">Z2R_lt</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zlt_succ">Zlt_succ</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="inbetween_float_ZR_sign">inbetween_float_ZR_sign</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">e</span> := <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#canonic_exp">canonic_exp</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#e">e</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Ztrunc">Ztrunc</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> = <span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#F2R">F2R</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#Float">Float</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#cond_Zopp">cond_Zopp</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> 0) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#e">e</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof5669')">Proof.</div>
<div class="proofscript" id="proof5669">
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#inbetween_float_round_sign">inbetween_float_round_sign</a></span> <span class="kwd">with</span> (<span class="id">choice</span> := <span class="kwd">fun</span> <span class="id">s</span> <span class="id">m</span> <span class="id">l</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>).<br/>
<span class="tactic">exact</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#inbetween_int_ZR_sign">inbetween_int_ZR_sign</a></span>.<br/>
Qed.</div>
<br/>
<div class="doc">Relates location and rounding to nearest. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="round_N">round_N</a></span> (<span class="id">p</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>) <span class="id">l</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#loc_Exact">loc_Exact</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#loc_Inexact">loc_Inexact</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Lt">Lt</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#loc_Inexact">loc_Inexact</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Eq">Eq</a></span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#p">p</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#loc_Inexact">loc_Inexact</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Gt">Gt</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="inbetween_int_N">inbetween_int_N</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">choice</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#inbetween_int">inbetween_int</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#Znearest">Znearest</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#choice">choice</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> = <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#round_N">round_N</a></span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#choice">choice</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof5670')">Proof with</div>
<div class="proofscript" id="proof5670">
 <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">typeclass_instances</span>.<br/>
<span class="tactic">intros</span> <span class="id">choice</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span> <span class="id">Hl</span>.<br/>
<span class="tactic">inversion_clear</span> <span class="id">Hl</span> <span class="kwd">as</span> [<span class="id">Hx</span>|<span class="id">l</span>' <span class="id">Hx</span> <span class="id">Hl</span>'].<br/>
<span class="comment">(*&nbsp;Exact&nbsp;*)</span><br/>
<span class="tactic">rewrite</span> <span class="id">Hx</span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#Zrnd_Z2R">Zrnd_Z2R</a></span>...<br/>
<span class="comment">(*&nbsp;not&nbsp;Exact&nbsp;*)</span><br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#Znearest">Znearest</a></span>.<br/>
<span class="tactic">assert</span> (<span class="id">Hm</span>: <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Zfloor">Zfloor</a></span> <span class="id">x</span> = <span class="id">m</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Zfloor_imp">Zfloor_imp</a></span>.<br/>
<span class="tactic">exact</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#conj">conj</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#proj1">proj1</a></span> <span class="id">Hx</span>)) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#proj2">proj2</a></span> <span class="id">Hx</span>)).<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Zceil_floor_neq">Zceil_floor_neq</a></span>.<br/>
<span class="tactic">rewrite</span> <span class="id">Hm</span>.<br/>
<span class="tactic">replace</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rcompare">Rcompare</a></span> (<span class="id">x</span> - <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> <span class="id">m</span>) (/2)) <span class="kwd">with</span> <span class="id">l</span>'.<br/>
<span class="id">now</span> <span class="tactic">case</span> <span class="id">l</span>'.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id">Hl</span>'.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_plus">Z2R_plus</a></span>.<br/>
<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rcompare_plus_r">Rcompare_plus_r</a></span> (- <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> <span class="id">m</span>) <span class="id">x</span>).<br/>
<span class="tactic">apply</span> <span class="tactic">f_equal</span>.<br/>
<span class="tactic">simpl</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> 1).<br/>
<span class="id">field</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">Hm</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_not_eq">Rlt_not_eq</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="inbetween_int_N_sign">inbetween_int_N_sign</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">choice</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#inbetween_int">inbetween_int</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#Znearest">Znearest</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#choice">choice</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> = <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#cond_Zopp">cond_Zopp</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> 0) (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#round_N">round_N</a></span> (<span class="kwd">if</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> 0 <span class="kwd">then</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#choice">choice</a></span> (-(<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span> + 1))%<span class="id">Z</span>) <span class="kwd">else</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#choice">choice</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof5671')">Proof with</div>
<div class="proofscript" id="proof5671">
 <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">typeclass_instances</span>.<br/>
<span class="tactic">intros</span> <span class="id">choice</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span> <span class="id">Hl</span>.<br/>
<span class="tactic">simpl</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="kwd">in</span> <span class="id">Hl</span>.<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rcase_abs">Rcase_abs</a></span> <span class="id">x</span>) <span class="kwd">as</span> [<span class="id">Zx</span>|<span class="id">Zx</span>].<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool_true">Rlt_bool_true</a></span> <span class="kwd">with</span> (1 := <span class="id">Zx</span>).<br/>
<span class="tactic">simpl</span>.<br/>
<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_involutive">Ropp_involutive</a></span> <span class="id">x</span>).<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#Znearest_opp">Znearest_opp</a></span>.<br/>
<span class="tactic">apply</span> <span class="tactic">f_equal</span>.<br/>
<span class="tactic">inversion_clear</span> <span class="id">Hl</span> <span class="kwd">as</span> [<span class="id">Hx</span>|<span class="id">l</span>' <span class="id">Hx</span> <span class="id">Hl</span>'].<br/>
<span class="tactic">rewrite</span> <span class="id">Hx</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#Zrnd_Z2R">Zrnd_Z2R</a></span>...<br/>
<span class="tactic">assert</span> (<span class="id">Hm</span>: <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Zfloor">Zfloor</a></span> (-<span class="id">x</span>) = <span class="id">m</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Zfloor_imp">Zfloor_imp</a></span>.<br/>
<span class="tactic">exact</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#conj">conj</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#proj1">proj1</a></span> <span class="id">Hx</span>)) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#proj2">proj2</a></span> <span class="id">Hx</span>)).<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#Znearest">Znearest</a></span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Zceil_floor_neq">Zceil_floor_neq</a></span>.<br/>
<span class="tactic">rewrite</span> <span class="id">Hm</span>.<br/>
<span class="tactic">replace</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rcompare">Rcompare</a></span> (- <span class="id">x</span> - <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> <span class="id">m</span>) (/2)) <span class="kwd">with</span> <span class="id">l</span>'.<br/>
<span class="id">now</span> <span class="tactic">case</span> <span class="id">l</span>'.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id">Hl</span>'.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_plus">Z2R_plus</a></span>.<br/>
<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rcompare_plus_r">Rcompare_plus_r</a></span> (- <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> <span class="id">m</span>) (-<span class="id">x</span>)).<br/>
<span class="tactic">apply</span> <span class="tactic">f_equal</span>.<br/>
<span class="tactic">simpl</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> 1).<br/>
<span class="id">field</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">Hm</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_not_eq">Rlt_not_eq</a></span>.<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rge_le">Rge_le</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">Zx</span>).<br/>
<span class="tactic">clear</span> <span class="id">Zx</span>. <span class="tactic">intros</span> <span class="id">Zx</span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool_false">Rlt_bool_false</a></span> <span class="kwd">with</span> (1 := <span class="id">Zx</span>).<br/>
<span class="tactic">simpl</span>.<br/>
<span class="tactic">inversion_clear</span> <span class="id">Hl</span> <span class="kwd">as</span> [<span class="id">Hx</span>|<span class="id">l</span>' <span class="id">Hx</span> <span class="id">Hl</span>'].<br/>
<span class="tactic">rewrite</span> <span class="id">Hx</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#Zrnd_Z2R">Zrnd_Z2R</a></span>...<br/>
<span class="tactic">assert</span> (<span class="id">Hm</span>: <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Zfloor">Zfloor</a></span> <span class="id">x</span> = <span class="id">m</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Zfloor_imp">Zfloor_imp</a></span>.<br/>
<span class="tactic">exact</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#conj">conj</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#proj1">proj1</a></span> <span class="id">Hx</span>)) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#proj2">proj2</a></span> <span class="id">Hx</span>)).<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#Znearest">Znearest</a></span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Zceil_floor_neq">Zceil_floor_neq</a></span>.<br/>
<span class="tactic">rewrite</span> <span class="id">Hm</span>.<br/>
<span class="tactic">replace</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rcompare">Rcompare</a></span> (<span class="id">x</span> - <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> <span class="id">m</span>) (/2)) <span class="kwd">with</span> <span class="id">l</span>'.<br/>
<span class="id">now</span> <span class="tactic">case</span> <span class="id">l</span>'.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id">Hl</span>'.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_plus">Z2R_plus</a></span>.<br/>
<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rcompare_plus_r">Rcompare_plus_r</a></span> (- <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> <span class="id">m</span>) <span class="id">x</span>).<br/>
<span class="tactic">apply</span> <span class="tactic">f_equal</span>.<br/>
<span class="tactic">simpl</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> 1).<br/>
<span class="id">field</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">Hm</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_not_eq">Rlt_not_eq</a></span>.<br/>
Qed.</div>
<br/>
<div class="doc">Relates location and rounding to nearest even. </div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="inbetween_int_NE">inbetween_int_NE</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#inbetween_int">inbetween_int</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Fcore_rnd_ne.html#ZnearestE">ZnearestE</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> = <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#round_N">round_N</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zeven">Zeven</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>)) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof5672')">Proof.</div>
<div class="proofscript" id="proof5672">
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span> <span class="id">Hl</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#inbetween_int_N">inbetween_int_N</a></span> <span class="kwd">with</span> (<span class="id">choice</span> := <span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zeven">Zeven</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span>)).<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="inbetween_float_NE">inbetween_float_NE</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">e</span> := <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#canonic_exp">canonic_exp</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#e">e</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_rnd_ne.html#ZnearestE">ZnearestE</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> = <span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#F2R">F2R</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#Float">Float</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#round_N">round_N</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zeven">Zeven</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>)) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#e">e</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof5673')">Proof.</div>
<div class="proofscript" id="proof5673">
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#inbetween_float_round">inbetween_float_round</a></span> <span class="kwd">with</span> (<span class="id">choice</span> := <span class="kwd">fun</span> <span class="id">m</span> <span class="id">l</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#round_N">round_N</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zeven">Zeven</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>)) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>).<br/>
<span class="tactic">exact</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#inbetween_int_NE">inbetween_int_NE</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="inbetween_int_NE_sign">inbetween_int_NE_sign</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#inbetween_int">inbetween_int</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Fcore_rnd_ne.html#ZnearestE">ZnearestE</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> = <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#cond_Zopp">cond_Zopp</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> 0) (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#round_N">round_N</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zeven">Zeven</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>)) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof5674')">Proof.</div>
<div class="proofscript" id="proof5674">
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span> <span class="id">Hl</span>.<br/>
<span class="id">erewrite</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#inbetween_int_N_sign">inbetween_int_N_sign</a></span> <span class="kwd">with</span> (<span class="id">choice</span> := <span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zeven">Zeven</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span>)).<br/>
2: <span class="id">eexact</span> <span class="id">Hl</span>.<br/>
<span class="tactic">apply</span> <span class="tactic">f_equal</span>.<br/>
<span class="tactic">case</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool">Rlt_bool</a></span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zeven_opp">Zeven_opp</a></span>, <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zeven_plus">Zeven_plus</a></span>.<br/>
<span class="id">now</span> <span class="tactic">case</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zeven">Zeven</a></span> <span class="id">m</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#refl_equal">refl_equal</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="inbetween_float_NE_sign">inbetween_float_NE_sign</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">e</span> := <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#canonic_exp">canonic_exp</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#e">e</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_rnd_ne.html#ZnearestE">ZnearestE</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> = <span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#F2R">F2R</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#Float">Float</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#cond_Zopp">cond_Zopp</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> 0) (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#round_N">round_N</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zeven">Zeven</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>)) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>)) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#e">e</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof5675')">Proof.</div>
<div class="proofscript" id="proof5675">
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#inbetween_float_round_sign">inbetween_float_round_sign</a></span> <span class="kwd">with</span> (<span class="id">choice</span> := <span class="kwd">fun</span> <span class="id">s</span> <span class="id">m</span> <span class="id">l</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#round_N">round_N</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zeven">Zeven</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>)) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>).<br/>
<span class="tactic">exact</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#inbetween_int_NE_sign">inbetween_int_NE_sign</a></span>.<br/>
Qed.</div>
<br/>
<div class="doc">Relates location and rounding to nearest away. </div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="inbetween_int_NA">inbetween_int_NA</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#inbetween_int">inbetween_int</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#ZnearestA">ZnearestA</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> = <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#round_N">round_N</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zle_bool">Zle_bool</a></span> 0 <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof5676')">Proof.</div>
<div class="proofscript" id="proof5676">
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span> <span class="id">Hl</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#inbetween_int_N">inbetween_int_N</a></span> <span class="kwd">with</span> (<span class="id">choice</span> := <span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zle_bool">Zle_bool</a></span> 0 <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span>).<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="inbetween_float_NA">inbetween_float_NA</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">e</span> := <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#canonic_exp">canonic_exp</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#e">e</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#ZnearestA">ZnearestA</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> = <span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#F2R">F2R</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#Float">Float</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#round_N">round_N</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zle_bool">Zle_bool</a></span> 0 <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#e">e</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof5677')">Proof.</div>
<div class="proofscript" id="proof5677">
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#inbetween_float_round">inbetween_float_round</a></span> <span class="kwd">with</span> (<span class="id">choice</span> := <span class="kwd">fun</span> <span class="id">m</span> <span class="id">l</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#round_N">round_N</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zle_bool">Zle_bool</a></span> 0 <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>).<br/>
<span class="tactic">exact</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#inbetween_int_NA">inbetween_int_NA</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="inbetween_int_NA_sign">inbetween_int_NA_sign</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#inbetween_int">inbetween_int</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#ZnearestA">ZnearestA</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> = <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#cond_Zopp">cond_Zopp</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> 0) (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#round_N">round_N</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof5678')">Proof.</div>
<div class="proofscript" id="proof5678">
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span> <span class="id">Hl</span>.<br/>
<span class="id">erewrite</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#inbetween_int_N_sign">inbetween_int_N_sign</a></span> <span class="kwd">with</span> (<span class="id">choice</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zle_bool">Zle_bool</a></span> 0).<br/>
2: <span class="id">eexact</span> <span class="id">Hl</span>.<br/>
<span class="tactic">apply</span> <span class="tactic">f_equal</span>.<br/>
<span class="tactic">assert</span> (<span class="id">Hm</span>: (0 &lt;= <span class="id">m</span>)%<span class="id">Z</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zlt_succ_le">Zlt_succ_le</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#lt_Z2R">lt_Z2R</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id">x</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_pos">Rabs_pos</a></span>.<br/>
<span class="tactic">refine</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#proj2">proj2</a></span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#inbetween_bounds">inbetween_bounds</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hl</span>)).<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_lt">Z2R_lt</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zlt_succ">Zlt_succ</a></span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zle_bool_true">Zle_bool_true</a></span> <span class="kwd">with</span> (1 := <span class="id">Hm</span>).<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zle_bool_false">Zle_bool_false</a></span>.<br/>
<span class="id">now</span> <span class="tactic">case</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool">Rlt_bool</a></span>.<br/>
<span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="truncate_aux">truncate_aux</a></span> <span class="id">t</span> <span class="id">k</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">m</span>, <span class="id">e</span>, <span class="id">l</span>) := <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#t">t</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">p</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpow_def.html#Zpower">Zpower</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#k">k</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zdiv.html#Zdiv">Zdiv</a></span> <span class="id">m</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#p">p</a></span>, (<span class="id">e</span> + <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#k">k</a></span>)%<span class="id">Z</span>, <span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#new_location">new_location</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#p">p</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zdiv.html#Zmod">Zmod</a></span> <span class="id">m</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#p">p</a></span>) <span class="id">l</span>).<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="truncate_aux_comp">truncate_aux_comp</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">t</span> <span class="id">k1</span> <span class="id">k2</span>,<br/>
&nbsp;&nbsp;(0 &lt; <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#k1">k1</a></span>)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;(0 &lt; <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#k2">k2</a></span>)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#truncate_aux">truncate_aux</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#t">t</a></span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#k1">k1</a></span> + <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#k2">k2</a></span>) = <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#truncate_aux">truncate_aux</a></span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#truncate_aux">truncate_aux</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#t">t</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#k1">k1</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#k2">k2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof5679')">Proof.</div>
<div class="proofscript" id="proof5679">
<span class="tactic">intros</span> ((<span class="id">m</span>,<span class="id">e</span>),<span class="id">l</span>) <span class="id">k1</span> <span class="id">k2</span> <span class="id">Hk1</span> <span class="id">Hk2</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#truncate_aux">truncate_aux</a></span>.<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#inbetween_float_ex">inbetween_float_ex</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span>) <span class="kwd">as</span> (<span class="id">x</span>,<span class="id">Hx</span>).<br/>
<span class="tactic">assert</span> (<span class="id">B1</span> := <span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#inbetween_float_new_location">inbetween_float_new_location</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hk1</span> <span class="id">Hx</span>).<br/>
<span class="tactic">assert</span> (<span class="id">Hk3</span>: (0 &lt; <span class="id">k1</span> + <span class="id">k2</span>)%<span class="id">Z</span>).<br/>
<span class="id">change</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z0">Z0</a></span> <span class="kwd">with</span> (0 + 0)%<span class="id">Z</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zplus_lt_compat">Zplus_lt_compat</a></span>.<br/>
<span class="tactic">assert</span> (<span class="id">B3</span> := <span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#inbetween_float_new_location">inbetween_float_new_location</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hk3</span> <span class="id">Hx</span>).<br/>
<span class="tactic">assert</span> (<span class="id">B2</span> := <span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#inbetween_float_new_location">inbetween_float_new_location</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hk2</span> <span class="id">B1</span>).<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zplus_assoc">Zplus_assoc</a></span> <span class="kwd">in</span> <span class="id">B3</span>.<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#inbetween_float_unique">inbetween_float_unique</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">B2</span> <span class="id">B3</span>).<br/>
<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id">H</span>, <span class="id">H0</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zplus_assoc">Zplus_assoc</a></span>.<br/>
Qed.</div>
<br/>
<div class="doc">Given a triple (mantissa, exponent, position), this function
    computes a triple with a canonic exponent, assuming the
    original triple had enough precision. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="truncate">truncate</a></span> <span class="id">t</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">m</span>, <span class="id">e</span>, <span class="id">l</span>) := <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#t">t</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">k</span> := (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_digits.html#Zdigits">Zdigits</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id">m</span> + <span class="id">e</span>) - <span class="id">e</span>)%<span class="id">Z</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zlt_bool">Zlt_bool</a></span> 0 <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#k">k</a></span> <span class="kwd">then</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#truncate_aux">truncate_aux</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#t">t</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#k">k</a></span><br/>
&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#t">t</a></span>.<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="truncate_0">truncate_0</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">e</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">m</span>', <span class="id">e</span>', <span class="id">l</span>') := <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#truncate">truncate</a></span> (0, <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#e">e</a></span>, <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span>)%<span class="id">Z</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id">m</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z0">Z0</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof5680')">Proof.</div>
<div class="proofscript" id="proof5680">
<span class="tactic">intros</span> <span class="id">e</span> <span class="id">l</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#truncate">truncate</a></span>.<br/>
<span class="tactic">case</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zlt_bool">Zlt_bool</a></span>.<br/>
<span class="tactic">simpl</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zdiv.html#Zdiv_0_l">Zdiv_0_l</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#refl_equal">refl_equal</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="generic_format_truncate">generic_format_truncate</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;(0 &lt;= <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>)%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">m</span>', <span class="id">e</span>', <span class="id">l</span>') := <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#truncate">truncate</a></span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>, <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#e">e</a></span>, <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#format">format</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#F2R">F2R</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#Float">Float</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id">m</span>' <span class="id">e</span>')).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof5681')">Proof.</div>
<div class="proofscript" id="proof5681">
<span class="tactic">intros</span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span> <span class="id">Hm</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#truncate">truncate</a></span>.<br/>
<span class="tactic">set</span> (<span class="id">k</span> := (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_digits.html#Zdigits">Zdigits</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id">m</span> + <span class="id">e</span>) - <span class="id">e</span>)%<span class="id">Z</span>).<br/>
<span class="tactic">case</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zlt_bool_spec">Zlt_bool_spec</a></span> ; <span class="tactic">intros</span> <span class="id">Hk</span>.<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#truncate_aux">truncate_aux</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#generic_format_F2R">generic_format_F2R</a></span>.<br/>
<span class="tactic">intros</span> <span class="id">Hd</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#canonic_exp">canonic_exp</a></span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_digits.html#ln_beta_F2R_Zdigits">ln_beta_F2R_Zdigits</a></span> <span class="kwd">with</span> (1 := <span class="id">Hd</span>).<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_digits.html#Zdigits_div_Zpower">Zdigits_div_Zpower</a></span> <span class="kwd">with</span> (1 := <span class="id">Hm</span>).<br/>
<span class="tactic">replace</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_digits.html#Zdigits">Zdigits</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id">m</span> - <span class="id">k</span> + (<span class="id">e</span> + <span class="id">k</span>))%<span class="id">Z</span> <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_digits.html#Zdigits">Zdigits</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id">m</span> + <span class="id">e</span>)%<span class="id">Z</span> <span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
<span class="tactic">unfold</span> <span class="id">k</span>.<br/>
<span class="id">ring_simplify</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zle_refl">Zle_refl</a></span>.<br/>
<span class="tactic">split</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zlt_le_weak">Zlt_le_weak</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Znot_gt_le">Znot_gt_le</a></span>.<br/>
<span class="id">contradict</span> <span class="id">Hd</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zdiv.html#Zdiv_small">Zdiv_small</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#conj">conj</a></span> <span class="kwd">with</span> (1 := <span class="id">Hm</span>).<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zabs.html#Zabs_eq">Zabs_eq</a></span> <span class="kwd">with</span> (1 := <span class="id">Hm</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_digits.html#Zpower_gt_Zdigits">Zpower_gt_Zdigits</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zlt_le_weak">Zlt_le_weak</a></span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zgt_lt">Zgt_lt</a></span>.<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zle_lt_or_eq">Zle_lt_or_eq</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hm</span>) <span class="kwd">as</span> [<span class="id">Hm</span>'|<span class="id">Hm</span>'].<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#generic_format_F2R">generic_format_F2R</a></span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#canonic_exp">canonic_exp</a></span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_digits.html#ln_beta_F2R_Zdigits">ln_beta_F2R_Zdigits</a></span>.<br/>
2: <span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zgt_not_eq">Zgt_not_eq</a></span>.<br/>
<span class="tactic">unfold</span> <span class="id">k</span> <span class="kwd">in</span> <span class="id">Hk</span>. <span class="tactic">clear</span> -<span class="id">Hk</span>.<br/>
<span class="tactic">omega</span>.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id">Hm</span>', <span class="id"><a href="compcert.flocq.Core.Fcore_float_prop.html#F2R_0">F2R_0</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#generic_format_0">generic_format_0</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="truncate_correct_format">truncate_correct_format</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">e</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z0">Z0</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">x</span> := <span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#F2R">F2R</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#Float">Float</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#e">e</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#e">e</a></span> &lt;= <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_digits.html#Zdigits">Zdigits</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span> + <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#e">e</a></span>))%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">m</span>', <span class="id">e</span>', <span class="id">l</span>') := <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#truncate">truncate</a></span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>, <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#e">e</a></span>, <span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#loc_Exact">loc_Exact</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> = <span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#F2R">F2R</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#Float">Float</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id">m</span>' <span class="id">e</span>') /\ <span class="id">e</span>' = <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#canonic_exp">canonic_exp</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof5682')">Proof.</div>
<div class="proofscript" id="proof5682">
<span class="tactic">intros</span> <span class="id">m</span> <span class="id">e</span> <span class="id">Hm</span> <span class="id">x</span> <span class="id">Fx</span> <span class="id">He</span>.<br/>
<span class="tactic">assert</span> (<span class="id">Hc</span>: <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#canonic_exp">canonic_exp</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id">x</span> = <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_digits.html#Zdigits">Zdigits</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id">m</span> + <span class="id">e</span>)).<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#canonic_exp">canonic_exp</a></span>, <span class="id">x</span>.<br/>
<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_digits.html#ln_beta_F2R_Zdigits">ln_beta_F2R_Zdigits</a></span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#truncate">truncate</a></span>.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id">Hc</span>.<br/>
<span class="tactic">set</span> (<span class="id">k</span> := (<span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#canonic_exp">canonic_exp</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id">x</span> - <span class="id">e</span>)%<span class="id">Z</span>).<br/>
<span class="tactic">case</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zlt_bool_spec">Zlt_bool_spec</a></span> ; <span class="tactic">intros</span> <span class="id">Hk</span>.<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#truncate_aux">truncate_aux</a></span>.<br/>
<span class="tactic">rewrite</span> <span class="id">Fx</span> <span class="tactic">at</span> 1.<br/>
<span class="tactic">assert</span> (<span class="id">H</span>: (<span class="id">e</span> + <span class="id">k</span>)%<span class="id">Z</span> = <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#canonic_exp">canonic_exp</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id">x</span>).<br/>
<span class="tactic">unfold</span> <span class="id">k</span>. <span class="tactic">ring</span>.<br/>
<span class="tactic">refine</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#conj">conj</a></span> <span class="id">_</span> <span class="id">H</span>).<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id">H</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_float_prop.html#F2R_eq_compat">F2R_eq_compat</a></span>.<br/>
<span class="tactic">replace</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#scaled_mantissa">scaled_mantissa</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id">x</span>) <span class="kwd">with</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Zfloor">Zfloor</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#scaled_mantissa">scaled_mantissa</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id">x</span>))).<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Ztrunc_Z2R">Ztrunc_Z2R</a></span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#scaled_mantissa">scaled_mantissa</a></span>.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id">H</span>.<br/>
<span class="tactic">unfold</span> <span class="id">x</span>, <span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#F2R">F2R</a></span>. <span class="tactic">simpl</span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rmult_assoc">Rmult_assoc</a></span>, &lt;- <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow_plus">bpow_plus</a></span>.<br/>
<span class="id">ring_simplify</span> (<span class="id">e</span> + - (<span class="id">e</span> + <span class="id">k</span>))%<span class="id">Z</span>.<br/>
<span class="tactic">clear</span> -<span class="id">Hm</span> <span class="id">Hk</span>.<br/>
<span class="tactic">destruct</span> <span class="id">k</span> <span class="kwd">as</span> [|<span class="id">k</span>|<span class="id">k</span>] ; <span class="tactic">try</span> <span class="id">easy</span>.<br/>
<span class="tactic">simpl</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Zfloor_div">Zfloor_div</a></span>.<br/>
<span class="tactic">intros</span> <span class="id">H</span>.<br/>
<span class="tactic">generalize</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zpower_pos_gt_0">Zpower_pos_gt_0</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id">k</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zle_bool_imp_le">Zle_bool_imp_le</a></span> <span class="id">_</span> <span class="id">_</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#radix_prop">radix_prop</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span>)).<br/>
<span class="tactic">omega</span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#scaled_mantissa_generic">scaled_mantissa_generic</a></span> <span class="kwd">with</span> (1 := <span class="id">Fx</span>).<br/>
<span class="id">now</span> <span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Zfloor_Z2R">Zfloor_Z2R</a></span>.<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="tactic">split</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#refl_equal">refl_equal</a></span>.<br/>
<span class="tactic">unfold</span> <span class="id">k</span> <span class="kwd">in</span> <span class="id">Hk</span>.<br/>
<span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="truncate_correct_partial">truncate_correct_partial</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;(0 &lt; <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span>)%<span class="id">R</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#e">e</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#e">e</a></span> &lt;= <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_digits.html#Zdigits">Zdigits</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span> + <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#e">e</a></span>))%<span class="id">Z</span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">m</span>', <span class="id">e</span>', <span class="id">l</span>') := <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#truncate">truncate</a></span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>, <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#e">e</a></span>, <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id">m</span>' <span class="id">e</span>' <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> <span class="id">l</span>' /\ <span class="id">e</span>' = <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#canonic_exp">canonic_exp</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof5683')">Proof.</div>
<div class="proofscript" id="proof5683">
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span> <span class="id">Hx</span> <span class="id">H1</span> <span class="id">H2</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#truncate">truncate</a></span>.<br/>
<span class="tactic">set</span> (<span class="id">k</span> := (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_digits.html#Zdigits">Zdigits</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id">m</span> + <span class="id">e</span>) - <span class="id">e</span>)%<span class="id">Z</span>).<br/>
<span class="tactic">set</span> (<span class="id">p</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpow_def.html#Zpower">Zpower</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id">k</span>).<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="tactic">assert</span> (<span class="id">Hx</span>': (<span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#F2R">F2R</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#Float">Float</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id">m</span> <span class="id">e</span>) &lt;= <span class="id">x</span> &lt; <span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#F2R">F2R</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#Float">Float</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> (<span class="id">m</span> + 1) <span class="id">e</span>))%<span class="id">R</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#inbetween_float_bounds">inbetween_float_bounds</a></span> <span class="kwd">with</span> (1 := <span class="id">H1</span>).<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="tactic">assert</span> (<span class="id">Hm</span>: (0 &lt;= <span class="id">m</span>)%<span class="id">Z</span>).<br/>
<span class="tactic">cut</span> (0 &lt; <span class="id">m</span> + 1)%<span class="id">Z</span>. <span class="tactic">omega</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_float_prop.html#F2R_lt_reg">F2R_lt_reg</a></span> <span class="kwd">with</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id">e</span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_float_prop.html#F2R_0">F2R_0</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Raxioms.html#Rlt_trans">Rlt_trans</a></span> <span class="kwd">with</span>  (1 := <span class="id">Hx</span>).<br/>
<span class="tactic">apply</span> <span class="id">Hx</span>'.<br/>
<span class="tactic">assert</span> (<span class="id">He</span>: (<span class="id">e</span> + <span class="id">k</span> = <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#canonic_exp">canonic_exp</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id">x</span>)%<span class="id">Z</span>).<br/>
<span class="comment">(*&nbsp;.&nbsp;*)</span><br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#canonic_exp">canonic_exp</a></span>.<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zle_lt_or_eq">Zle_lt_or_eq</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hm</span>) <span class="kwd">as</span> [<span class="id">Hm</span>'|<span class="id">Hm</span>'].<br/>
<span class="comment">(*&nbsp;..&nbsp;0&nbsp;&lt;&nbsp;m&nbsp;*)</span><br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_float_prop.html#ln_beta_F2R_bounds">ln_beta_F2R_bounds</a></span> <span class="kwd">with</span> (1 := <span class="id">Hm</span>') (2 := <span class="id">Hx</span>').<br/>
<span class="tactic">assert</span> (<span class="id">H</span>: <span class="id">m</span> &lt;&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z0">Z0</a></span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#sym_not_eq">sym_not_eq</a></span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zlt_not_eq">Zlt_not_eq</a></span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_float_prop.html#ln_beta_F2R">ln_beta_F2R</a></span> <span class="kwd">with</span> (1 := <span class="id">H</span>).<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.flocq.Calc.Fcalc_digits.html#Zdigits_ln_beta">Zdigits_ln_beta</a></span> <span class="kwd">with</span> (1 := <span class="id">H</span>).<br/>
<span class="tactic">unfold</span> <span class="id">k</span>.<br/>
<span class="tactic">ring</span>.<br/>
<span class="comment">(*&nbsp;..&nbsp;m&nbsp;=&nbsp;0&nbsp;*)</span><br/>
<span class="tactic">rewrite</span> &lt;- <span class="id">Hm</span>' <span class="kwd">in</span> <span class="id">H2</span>.<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#ln_beta">ln_beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id">x</span>) <span class="kwd">as</span> (<span class="id">ex</span>, <span class="id">Hex</span>).<br/>
<span class="tactic">simpl</span>.<br/>
<span class="id">specialize</span> (<span class="id">Hex</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rgt_not_eq">Rgt_not_eq</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">Hx</span>)).<br/>
<span class="tactic">unfold</span> <span class="id">k</span>.<br/>
<span class="id">ring_simplify</span>.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id">Hm</span>'.<br/>
<span class="tactic">simpl</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#sym_eq">sym_eq</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.valid_exp">valid_exp</a></span>.<br/>
<span class="tactic">exact</span> <span class="id">H2</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zle_trans">Zle_trans</a></span> <span class="kwd">with</span> <span class="id">e</span>.<br/>
<span class="tactic">eapply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#bpow_lt_bpow">bpow_lt_bpow</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rle_lt_trans">Rle_lt_trans</a></span> <span class="kwd">with</span> (1 := <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#proj1">proj1</a></span> <span class="id">Hex</span>).<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_pos_eq">Rabs_pos_eq</a></span>.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.flocq.Core.Fcore_float_prop.html#F2R_bpow">F2R_bpow</a></span>.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id">Hm</span>' <span class="kwd">in</span> <span class="id">Hx</span>'.<br/>
<span class="tactic">apply</span> <span class="id">Hx</span>'.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_le">Rlt_le</a></span>.<br/>
<span class="tactic">exact</span> <span class="id">H2</span>.<br/>
<span class="comment">(*&nbsp;.&nbsp;*)</span><br/>
<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zlt_cases">Zlt_cases</a></span> 0 <span class="id">k</span>).<br/>
<span class="tactic">case</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zlt_bool">Zlt_bool</a></span> 0 <span class="id">k</span>) ; <span class="tactic">intros</span> <span class="id">Hk</span> ; <span class="tactic">unfold</span> <span class="id">k</span> <span class="kwd">in</span> <span class="id">Hk</span>.<br/>
<span class="tactic">split</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#inbetween_float_new_location">inbetween_float_new_location</a></span>.<br/>
<span class="tactic">exact</span> <span class="id">He</span>.<br/>
<span class="tactic">split</span>.<br/>
<span class="tactic">exact</span> <span class="id">H1</span>.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id">He</span>.<br/>
<span class="tactic">unfold</span> <span class="id">k</span>.<br/>
<span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="truncate_correct">truncate_correct</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;(0 &lt;= <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span>)%<span class="id">R</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#e">e</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#e">e</a></span> &lt;= <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_digits.html#Zdigits">Zdigits</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span> + <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#e">e</a></span>))%<span class="id">Z</span> \/ <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span> = <span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#loc_Exact">loc_Exact</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">m</span>', <span class="id">e</span>', <span class="id">l</span>') := <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#truncate">truncate</a></span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>, <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#e">e</a></span>, <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id">m</span>' <span class="id">e</span>' <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> <span class="id">l</span>' /\<br/>
&nbsp;&nbsp;(<span class="id">e</span>' = <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#canonic_exp">canonic_exp</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> \/ (<span class="id">l</span>' = <span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#loc_Exact">loc_Exact</a></span> /\ <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#format">format</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof5684')">Proof.</div>
<div class="proofscript" id="proof5684">
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span> [<span class="id">Hx</span>|<span class="id">Hx</span>] <span class="id">H1</span> <span class="id">H2</span>.<br/>
<span class="comment">(*&nbsp;0&nbsp;&lt;&nbsp;x&nbsp;*)</span><br/>
<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zle_or_lt">Zle_or_lt</a></span> <span class="id">e</span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_digits.html#Zdigits">Zdigits</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id">m</span> + <span class="id">e</span>))) <span class="kwd">as</span> [<span class="id">H3</span>|<span class="id">H3</span>].<br/>
<span class="comment">(*&nbsp;.&nbsp;enough&nbsp;digits&nbsp;*)</span><br/>
<span class="tactic">generalize</span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#truncate_correct_partial">truncate_correct_partial</a></span> <span class="id">x</span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span> <span class="id">Hx</span> <span class="id">H1</span> <span class="id">H3</span>).<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#truncate">truncate</a></span> (<span class="id">m</span>, <span class="id">e</span>, <span class="id">l</span>)) <span class="kwd">as</span> ((<span class="id">m</span>', <span class="id">e</span>'), <span class="id">l</span>').<br/>
<span class="tactic">intros</span> (<span class="id">H4</span>, <span class="id">H5</span>).<br/>
<span class="tactic">split</span>.<br/>
<span class="tactic">exact</span> <span class="id">H4</span>.<br/>
<span class="id">now</span> <span class="id">left</span>.<br/>
<span class="comment">(*&nbsp;.&nbsp;not&nbsp;enough&nbsp;digits&nbsp;but&nbsp;loc_Exact&nbsp;*)</span><br/>
<span class="tactic">destruct</span> <span class="id">H2</span> <span class="kwd">as</span> [<span class="id">H2</span>|<span class="id">H2</span>].<br/>
<span class="tactic">elim</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zlt_irrefl">Zlt_irrefl</a></span> <span class="id">e</span>).<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zle_lt_trans">Zle_lt_trans</a></span> <span class="kwd">with</span> (1 := <span class="id">H2</span>).<br/>
<span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">in</span> <span class="id">H1</span> |- *.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#truncate">truncate</a></span>.<br/>
<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zlt_cases">Zlt_cases</a></span> 0 (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_digits.html#Zdigits">Zdigits</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id">m</span> + <span class="id">e</span>) - <span class="id">e</span>)).<br/>
<span class="tactic">case</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zlt_bool">Zlt_bool</a></span>.<br/>
<span class="tactic">intros</span> <span class="id">H</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False_ind">False_ind</a></span>.<br/>
<span class="tactic">omega</span>.<br/>
<span class="tactic">intros</span> <span class="id">_</span>.<br/>
<span class="tactic">split</span>.<br/>
<span class="tactic">exact</span> <span class="id">H1</span>.<br/>
<span class="id">right</span>.<br/>
<span class="tactic">split</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#refl_equal">refl_equal</a></span>.<br/>
<span class="tactic">inversion_clear</span> <span class="id">H1</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">H</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#generic_format_F2R">generic_format_F2R</a></span>.<br/>
<span class="tactic">intros</span> <span class="id">Zm</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#canonic_exp">canonic_exp</a></span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_digits.html#ln_beta_F2R_Zdigits">ln_beta_F2R_Zdigits</a></span> <span class="kwd">with</span> (1 := <span class="id">Zm</span>).<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zlt_le_weak">Zlt_le_weak</a></span>.<br/>
<span class="comment">(*&nbsp;x&nbsp;=&nbsp;0&nbsp;*)</span><br/>
<span class="tactic">assert</span> (<span class="id">Hm</span>: <span class="id">m</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z0">Z0</a></span>).<br/>
<span class="tactic">cut</span> (<span class="id">m</span> &lt;= 0 &lt; <span class="id">m</span> + 1)%<span class="id">Z</span>. <span class="tactic">omega</span>.<br/>
<span class="tactic">assert</span> (<span class="id">Hx</span>': (<span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#F2R">F2R</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#Float">Float</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id">m</span> <span class="id">e</span>) &lt;= <span class="id">x</span> &lt; <span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#F2R">F2R</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#Float">Float</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> (<span class="id">m</span> + 1) <span class="id">e</span>))%<span class="id">R</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#inbetween_float_bounds">inbetween_float_bounds</a></span> <span class="kwd">with</span> (1 := <span class="id">H1</span>).<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id">Hx</span> <span class="kwd">in</span> <span class="id">Hx</span>'.<br/>
<span class="tactic">split</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_float_prop.html#F2R_le_0_reg">F2R_le_0_reg</a></span> <span class="kwd">with</span> (1 := <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#proj1">proj1</a></span> <span class="id">Hx</span>').<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_float_prop.html#F2R_gt_0_reg">F2R_gt_0_reg</a></span> <span class="kwd">with</span> (1 := <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#proj2">proj2</a></span> <span class="id">Hx</span>').<br/>
<span class="tactic">rewrite</span> <span class="id">Hm</span>, &lt;- <span class="id">Hx</span> <span class="kwd">in</span> <span class="id">H1</span> |- *.<br/>
<span class="tactic">clear</span> -<span class="id">H1</span>.<br/>
<span class="tactic">case</span> <span class="id">H1</span>.<br/>
<span class="comment">(*&nbsp;.&nbsp;*)</span><br/>
<span class="tactic">intros</span> <span class="id">_</span>.<br/>
<span class="tactic">assert</span> (<span class="id">exists</span> <span class="id">e</span>', <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#truncate">truncate</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z0">Z0</a></span>, <span class="id">e</span>, <span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#loc_Exact">loc_Exact</a></span>) = (<span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z0">Z0</a></span>, <span class="id">e</span>', <span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#loc_Exact">loc_Exact</a></span>)).<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#truncate">truncate</a></span>, <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#truncate_aux">truncate_aux</a></span>.<br/>
<span class="tactic">case</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zlt_bool">Zlt_bool</a></span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zdiv.html#Zdiv_0_l">Zdiv_0_l</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zdiv.html#Zmod_0_l">Zmod_0_l</a></span>.<br/>
<span class="id">eexists</span>.<br/>
<span class="tactic">apply</span> <span class="tactic">f_equal</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#new_location">new_location</a></span>.<br/>
<span class="id">now</span> <span class="tactic">case</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zeven">Zeven</a></span>.<br/>
<span class="id">now</span> <span class="id">eexists</span>.<br/>
<span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> (<span class="id">e</span>', <span class="id">H</span>).<br/>
<span class="tactic">rewrite</span> <span class="id">H</span>.<br/>
<span class="tactic">split</span>.<br/>
<span class="id">constructor</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#sym_eq">sym_eq</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_float_prop.html#F2R_0">F2R_0</a></span>.<br/>
<span class="id">right</span>.<br/>
<span class="tactic">repeat</span> <span class="tactic">split</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#generic_format_0">generic_format_0</a></span>.<br/>
<span class="comment">(*&nbsp;.&nbsp;*)</span><br/>
<span class="tactic">intros</span> <span class="id">l</span>' (<span class="id">H</span>, <span class="id">_</span>) <span class="id">_</span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_float_prop.html#F2R_0">F2R_0</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
<span class="tactic">elim</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_irrefl">Rlt_irrefl</a></span> <span class="kwd">with</span> (1 := <span class="id">H</span>).<br/>
Qed.</div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Fcalc_round.Fcalc_round_fexp.round_dir">round_dir</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Fcalc_round.Fcalc_round_fexp.round_dir.rnd">rnd</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#R">R</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.<br/>
<span class="kwd">Context</span> { <span class="id">valid_rnd</span> : <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#Valid_rnd">Valid_rnd</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.round_dir.rnd">rnd</a></span> }.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Fcalc_round.Fcalc_round_fexp.round_dir.choice">choice</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#location">location</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="Fcalc_round.Fcalc_round_fexp.round_dir.inbetween_int_valid">inbetween_int_valid</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#inbetween_int">inbetween_int</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.round_dir.rnd">rnd</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> = <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.round_dir.choice">choice</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span>.<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="round_any_correct">round_any_correct</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#e">e</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#e">e</a></span> = <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#canonic_exp">canonic_exp</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> \/ (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span> = <span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#loc_Exact">loc_Exact</a></span> /\ <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#format">format</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span>)) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.round_dir.rnd">rnd</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> = <span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#F2R">F2R</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#Float">Float</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.round_dir.choice">choice</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#e">e</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof5685')">Proof with</div>
<div class="proofscript" id="proof5685">
 <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">typeclass_instances</span>.<br/>
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span> <span class="id">Hin</span> [<span class="id">He</span>|(<span class="id">Hl</span>,<span class="id">Hf</span>)].<br/>
<span class="tactic">rewrite</span> <span class="id">He</span> <span class="kwd">in</span> <span class="id">Hin</span> |- *.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#inbetween_float_round">inbetween_float_round</a></span> <span class="kwd">with</span> (2 := <span class="id">Hin</span>).<br/>
<span class="tactic">exact</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.round_dir.inbetween_int_valid">inbetween_int_valid</a></span>.<br/>
<span class="tactic">rewrite</span> <span class="id">Hl</span> <span class="kwd">in</span> <span class="id">Hin</span>.<br/>
<span class="tactic">inversion_clear</span> <span class="id">Hin</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">Hl</span>.<br/>
<span class="tactic">replace</span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.round_dir.choice">choice</a></span> <span class="id">m</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#loc_Exact">loc_Exact</a></span>) <span class="kwd">with</span> <span class="id">m</span>.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id">H</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#round_generic">round_generic</a></span>...<br/>
<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#Zrnd_Z2R">Zrnd_Z2R</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.round_dir.rnd">rnd</a></span> <span class="id">m</span>) <span class="tactic">at</span> 1.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.round_dir.inbetween_int_valid">inbetween_int_valid</a></span>.<br/>
<span class="id">now</span> <span class="id">constructor</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Truncating a triple is sufficient to round a real number. </div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="round_trunc_any_correct">round_trunc_any_correct</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;(0 &lt;= <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span>)%<span class="id">R</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#e">e</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#e">e</a></span> &lt;= <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_digits.html#Zdigits">Zdigits</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span> + <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#e">e</a></span>))%<span class="id">Z</span> \/ <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span> = <span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#loc_Exact">loc_Exact</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.round_dir.rnd">rnd</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> = <span class="kwd">let</span> '(<span class="id">m</span>', <span class="id">e</span>', <span class="id">l</span>') := <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#truncate">truncate</a></span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>, <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#e">e</a></span>, <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span>) <span class="kwd">in</span> <span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#F2R">F2R</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#Float">Float</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.round_dir.choice">choice</a></span> <span class="id">m</span>' <span class="id">l</span>') <span class="id">e</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof5686')">Proof.</div>
<div class="proofscript" id="proof5686">
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span> <span class="id">Hx</span> <span class="id">Hl</span> <span class="id">He</span>.<br/>
<span class="tactic">generalize</span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#truncate_correct">truncate_correct</a></span> <span class="id">x</span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span> <span class="id">Hx</span> <span class="id">Hl</span> <span class="id">He</span>).<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#truncate">truncate</a></span> (<span class="id">m</span>, <span class="id">e</span>, <span class="id">l</span>)) <span class="kwd">as</span> ((<span class="id">m</span>', <span class="id">e</span>'), <span class="id">l</span>').<br/>
<span class="tactic">intros</span> (<span class="id">H1</span>, <span class="id">H2</span>).<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#round_any_correct">round_any_correct</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.round_dir">round_dir</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Fcalc_round.Fcalc_round_fexp.round_dir_sign">round_dir_sign</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Fcalc_round.Fcalc_round_fexp.round_dir_sign.rnd">rnd</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rdefinitions.html#R">R</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.<br/>
<span class="kwd">Context</span> { <span class="id">valid_rnd</span> : <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#Valid_rnd">Valid_rnd</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.round_dir_sign.rnd">rnd</a></span> }.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Fcalc_round.Fcalc_round_fexp.round_dir_sign.choice">choice</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#location">location</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="Fcalc_round.Fcalc_round_fexp.round_dir_sign.inbetween_int_valid">inbetween_int_valid</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#inbetween_int">inbetween_int</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.round_dir_sign.rnd">rnd</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> = <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#cond_Zopp">cond_Zopp</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> 0) (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.round_dir_sign.choice">choice</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> 0) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span>).<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="round_sign_any_correct">round_sign_any_correct</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#e">e</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#e">e</a></span> = <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#canonic_exp">canonic_exp</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> \/ (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span> = <span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#loc_Exact">loc_Exact</a></span> /\ <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#format">format</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span>)) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.round_dir_sign.rnd">rnd</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> = <span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#F2R">F2R</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#Float">Float</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#cond_Zopp">cond_Zopp</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> 0) (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.round_dir_sign.choice">choice</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> 0) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span>)) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#e">e</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof5687')">Proof with</div>
<div class="proofscript" id="proof5687">
 <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">typeclass_instances</span>.<br/>
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span> <span class="id">Hin</span> [<span class="id">He</span>|(<span class="id">Hl</span>,<span class="id">Hf</span>)].<br/>
<span class="tactic">rewrite</span> <span class="id">He</span> <span class="kwd">in</span> <span class="id">Hin</span> |- *.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#inbetween_float_round_sign">inbetween_float_round_sign</a></span> <span class="kwd">with</span> (2 := <span class="id">Hin</span>).<br/>
<span class="tactic">exact</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.round_dir_sign.inbetween_int_valid">inbetween_int_valid</a></span>.<br/>
<span class="tactic">rewrite</span> <span class="id">Hl</span> <span class="kwd">in</span> <span class="id">Hin</span>.<br/>
<span class="tactic">inversion_clear</span> <span class="id">Hin</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">Hl</span>.<br/>
<span class="tactic">replace</span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.round_dir_sign.choice">choice</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id">x</span> 0) <span class="id">m</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#loc_Exact">loc_Exact</a></span>) <span class="kwd">with</span> <span class="id">m</span>.<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rcase_abs">Rcase_abs</a></span> <span class="id">x</span>) <span class="kwd">as</span> [<span class="id">Zx</span>|<span class="id">Zx</span>].<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool_true">Rlt_bool_true</a></span> <span class="kwd">with</span> (1 := <span class="id">Zx</span>).<br/>
<span class="tactic">simpl</span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_float_prop.html#F2R_Zopp">F2R_Zopp</a></span>.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id">H</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_involutive">Ropp_involutive</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#round_generic">round_generic</a></span>...<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool_false">Rlt_bool_false</a></span>.<br/>
<span class="tactic">simpl</span>.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id">H</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#round_generic">round_generic</a></span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rge_le">Rge_le</a></span>.<br/>
<span class="comment">(*&nbsp;*)</span><br/>
<span class="tactic">destruct</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool_spec">Rlt_bool_spec</a></span> <span class="id">x</span> 0) <span class="kwd">as</span> [<span class="id">Zx</span>|<span class="id">Zx</span>].<br/>
<span class="comment">(*&nbsp;.&nbsp;*)</span><br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Zopp_inj">Zopp_inj</a></span>.<br/>
<span class="id">change</span> (- <span class="id">m</span> = <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#cond_Zopp">cond_Zopp</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.round_dir_sign.choice">choice</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> <span class="id">m</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#loc_Exact">loc_Exact</a></span>))%<span class="id">Z</span>.<br/>
<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#Zrnd_Z2R">Zrnd_Z2R</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.round_dir_sign.rnd">rnd</a></span> (-<span class="id">m</span>)) <span class="tactic">at</span> 1.<br/>
<span class="tactic">assert</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> (-<span class="id">m</span>) &lt; 0)%<span class="id">R</span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_opp">Z2R_opp</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_lt_gt_0_contravar">Ropp_lt_gt_0_contravar</a></span>.<br/>
<span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_lt">Z2R_lt</a></span> 0).<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_float_prop.html#F2R_gt_0_reg">F2R_gt_0_reg</a></span> <span class="kwd">with</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id">e</span>.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id">H</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_pos_lt">Rabs_pos_lt</a></span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Rlt_not_eq">Rlt_not_eq</a></span>.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool_true">Rlt_bool_true</a></span> <span class="kwd">with</span> (1 := <span class="id">H0</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.round_dir_sign.inbetween_int_valid">inbetween_int_valid</a></span>.<br/>
<span class="id">constructor</span>.<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_left">Rabs_left</a></span> <span class="kwd">with</span> (1 := <span class="id">H0</span>).<br/>
<span class="tactic">rewrite</span> <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_opp">Z2R_opp</a></span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_involutive">Ropp_involutive</a></span>.<br/>
<span class="comment">(*&nbsp;.&nbsp;*)</span><br/>
<span class="id">change</span> (<span class="id">m</span> = <span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#cond_Zopp">cond_Zopp</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.round_dir_sign.choice">choice</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> <span class="id">m</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#loc_Exact">loc_Exact</a></span>))%<span class="id">Z</span>.<br/>
<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#Zrnd_Z2R">Zrnd_Z2R</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.round_dir_sign.rnd">rnd</a></span> <span class="id">m</span>) <span class="tactic">at</span> 1.<br/>
<span class="tactic">assert</span> (0 &lt;= <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R">Z2R</a></span> <span class="id">m</span>)%<span class="id">R</span>.<br/>
<span class="tactic">apply</span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Z2R_le">Z2R_le</a></span> 0).<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_float_prop.html#F2R_ge_0_reg">F2R_ge_0_reg</a></span> <span class="kwd">with</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id">e</span>.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id">H</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_pos">Rabs_pos</a></span>.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool_false">Rlt_bool_false</a></span> <span class="kwd">with</span> (1 := <span class="id">H0</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.round_dir_sign.inbetween_int_valid">inbetween_int_valid</a></span>.<br/>
<span class="id">constructor</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_pos_eq">Rabs_pos_eq</a></span>.<br/>
Qed.</div>
<br/>
<div class="doc">Truncating a triple is sufficient to round a real number. </div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="round_trunc_sign_any_correct">round_trunc_sign_any_correct</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#e">e</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#e">e</a></span> &lt;= <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_digits.html#Zdigits">Zdigits</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span> + <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#e">e</a></span>))%<span class="id">Z</span> \/ <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span> = <span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#loc_Exact">loc_Exact</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#round">round</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.fexp">fexp</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.round_dir_sign.rnd">rnd</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> = <span class="kwd">let</span> '(<span class="id">m</span>', <span class="id">e</span>', <span class="id">l</span>') := <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#truncate">truncate</a></span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>, <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#e">e</a></span>, <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span>) <span class="kwd">in</span> <span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#F2R">F2R</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_defs.html#Float">Float</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#cond_Zopp">cond_Zopp</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> 0) (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.round_dir_sign.choice">choice</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Raux.html#Rlt_bool">Rlt_bool</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> 0) <span class="id">m</span>' <span class="id">l</span>')) <span class="id">e</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof5688')">Proof.</div>
<div class="proofscript" id="proof5688">
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span> <span class="id">Hl</span> <span class="id">He</span>.<br/>
<span class="tactic">generalize</span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#truncate_correct">truncate_correct</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="id">x</span>) <span class="id">m</span> <span class="id">e</span> <span class="id">l</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs_pos">Rabs_pos</a></span> <span class="id">_</span>) <span class="id">Hl</span> <span class="id">He</span>).<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#truncate">truncate</a></span> (<span class="id">m</span>, <span class="id">e</span>, <span class="id">l</span>)) <span class="kwd">as</span> ((<span class="id">m</span>', <span class="id">e</span>'), <span class="id">l</span>').<br/>
<span class="tactic">intros</span> (<span class="id">H1</span>, <span class="id">H2</span>).<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#round_sign_any_correct">round_sign_any_correct</a></span>.<br/>
<span class="tactic">exact</span> <span class="id">H1</span>.<br/>
<span class="tactic">destruct</span> <span class="id">H2</span> <span class="kwd">as</span> [<span class="id">H2</span>|(<span class="id">H2</span>,<span class="id">H3</span>)].<br/>
<span class="id">left</span>.<br/>
<span class="id">now</span> <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#canonic_exp_abs">canonic_exp_abs</a></span>.<br/>
<span class="id">right</span>.<br/>
<span class="tactic">split</span>.<br/>
<span class="tactic">exact</span> <span class="id">H2</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rabs">Rabs</a></span> <span class="kwd">in</span> <span class="id">H3</span>.<br/>
<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.Rbasic_fun.html#Rcase_abs">Rcase_abs</a></span> <span class="id">x</span>) <span class="kwd">in</span> <span class="id">H3</span>.<br/>
<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Reals.RIneq.html#Ropp_involutive">Ropp_involutive</a></span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#generic_format_opp">generic_format_opp</a></span>.<br/>
<span class="tactic">exact</span> <span class="id">H3</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp.round_dir_sign">round_dir_sign</a></span>.<br/>
<br/>
<h1> Instances of the theorems above, for the usual rounding modes. </h1>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="round_DN_correct">round_DN_correct</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#round_any_correct">round_any_correct</a></span> <span class="id">_</span> (<span class="kwd">fun</span> <span class="id">m</span> <span class="id">_</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#inbetween_int_DN">inbetween_int_DN</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="round_trunc_DN_correct">round_trunc_DN_correct</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#round_trunc_any_correct">round_trunc_any_correct</a></span> <span class="id">_</span> (<span class="kwd">fun</span> <span class="id">m</span> <span class="id">_</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#inbetween_int_DN">inbetween_int_DN</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="round_sign_DN_correct">round_sign_DN_correct</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#round_sign_any_correct">round_sign_any_correct</a></span> <span class="id">_</span> (<span class="kwd">fun</span> <span class="id">s</span> <span class="id">m</span> <span class="id">l</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#round_sign_DN">round_sign_DN</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#s">s</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#inbetween_int_DN_sign">inbetween_int_DN_sign</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="round_trunc_sign_DN_correct">round_trunc_sign_DN_correct</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#round_trunc_sign_any_correct">round_trunc_sign_any_correct</a></span> <span class="id">_</span> (<span class="kwd">fun</span> <span class="id">s</span> <span class="id">m</span> <span class="id">l</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#round_sign_DN">round_sign_DN</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#s">s</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#inbetween_int_DN_sign">inbetween_int_DN_sign</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="round_UP_correct">round_UP_correct</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#round_any_correct">round_any_correct</a></span> <span class="id">_</span> (<span class="kwd">fun</span> <span class="id">m</span> <span class="id">l</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#round_UP">round_UP</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#inbetween_int_UP">inbetween_int_UP</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="round_trunc_UP_correct">round_trunc_UP_correct</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#round_trunc_any_correct">round_trunc_any_correct</a></span> <span class="id">_</span> (<span class="kwd">fun</span> <span class="id">m</span> <span class="id">l</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#round_UP">round_UP</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#inbetween_int_UP">inbetween_int_UP</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="round_sign_UP_correct">round_sign_UP_correct</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#round_sign_any_correct">round_sign_any_correct</a></span> <span class="id">_</span> (<span class="kwd">fun</span> <span class="id">s</span> <span class="id">m</span> <span class="id">l</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#round_sign_UP">round_sign_UP</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#s">s</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#inbetween_int_UP_sign">inbetween_int_UP_sign</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="round_trunc_sign_UP_correct">round_trunc_sign_UP_correct</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#round_trunc_sign_any_correct">round_trunc_sign_any_correct</a></span> <span class="id">_</span> (<span class="kwd">fun</span> <span class="id">s</span> <span class="id">m</span> <span class="id">l</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#round_sign_UP">round_sign_UP</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#s">s</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#inbetween_int_UP_sign">inbetween_int_UP_sign</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="round_ZR_correct">round_ZR_correct</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#round_any_correct">round_any_correct</a></span> <span class="id">_</span> (<span class="kwd">fun</span> <span class="id">m</span> <span class="id">l</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#round_ZR">round_ZR</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zlt_bool">Zlt_bool</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span> 0) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#inbetween_int_ZR">inbetween_int_ZR</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="round_trunc_ZR_correct">round_trunc_ZR_correct</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#round_trunc_any_correct">round_trunc_any_correct</a></span> <span class="id">_</span> (<span class="kwd">fun</span> <span class="id">m</span> <span class="id">l</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#round_ZR">round_ZR</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zlt_bool">Zlt_bool</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span> 0) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#inbetween_int_ZR">inbetween_int_ZR</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="round_sign_ZR_correct">round_sign_ZR_correct</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#round_sign_any_correct">round_sign_any_correct</a></span> <span class="id">_</span> (<span class="kwd">fun</span> <span class="id">s</span> <span class="id">m</span> <span class="id">l</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#inbetween_int_ZR_sign">inbetween_int_ZR_sign</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="round_trunc_sign_ZR_correct">round_trunc_sign_ZR_correct</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#round_trunc_sign_any_correct">round_trunc_sign_any_correct</a></span> <span class="id">_</span> (<span class="kwd">fun</span> <span class="id">s</span> <span class="id">m</span> <span class="id">l</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#inbetween_int_ZR_sign">inbetween_int_ZR_sign</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="round_NE_correct">round_NE_correct</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#round_any_correct">round_any_correct</a></span> <span class="id">_</span> (<span class="kwd">fun</span> <span class="id">m</span> <span class="id">l</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#round_N">round_N</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zeven">Zeven</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>)) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#inbetween_int_NE">inbetween_int_NE</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="round_trunc_NE_correct">round_trunc_NE_correct</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#round_trunc_any_correct">round_trunc_any_correct</a></span> <span class="id">_</span> (<span class="kwd">fun</span> <span class="id">m</span> <span class="id">l</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#round_N">round_N</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zeven">Zeven</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>)) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#inbetween_int_NE">inbetween_int_NE</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="round_sign_NE_correct">round_sign_NE_correct</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#round_sign_any_correct">round_sign_any_correct</a></span> <span class="id">_</span> (<span class="kwd">fun</span> <span class="id">s</span> <span class="id">m</span> <span class="id">l</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#round_N">round_N</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zeven">Zeven</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>)) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#inbetween_int_NE_sign">inbetween_int_NE_sign</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="round_trunc_sign_NE_correct">round_trunc_sign_NE_correct</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#round_trunc_sign_any_correct">round_trunc_sign_any_correct</a></span> <span class="id">_</span> (<span class="kwd">fun</span> <span class="id">s</span> <span class="id">m</span> <span class="id">l</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#round_N">round_N</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#negb">negb</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_Zaux.html#Zeven">Zeven</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>)) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#inbetween_int_NE_sign">inbetween_int_NE_sign</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="round_NA_correct">round_NA_correct</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#round_any_correct">round_any_correct</a></span> <span class="id">_</span> (<span class="kwd">fun</span> <span class="id">m</span> <span class="id">l</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#round_N">round_N</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zle_bool">Zle_bool</a></span> 0 <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#inbetween_int_NA">inbetween_int_NA</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="round_trunc_NA_correct">round_trunc_NA_correct</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#round_trunc_any_correct">round_trunc_any_correct</a></span> <span class="id">_</span> (<span class="kwd">fun</span> <span class="id">m</span> <span class="id">l</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#round_N">round_N</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zle_bool">Zle_bool</a></span> 0 <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#inbetween_int_NA">inbetween_int_NA</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="round_sign_NA_correct">round_sign_NA_correct</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#round_sign_any_correct">round_sign_any_correct</a></span> <span class="id">_</span> (<span class="kwd">fun</span> <span class="id">s</span> <span class="id">m</span> <span class="id">l</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#round_N">round_N</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#inbetween_int_NA_sign">inbetween_int_NA_sign</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="round_trunc_sign_NA_correct">round_trunc_sign_NA_correct</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#round_trunc_sign_any_correct">round_trunc_sign_any_correct</a></span> <span class="id">_</span> (<span class="kwd">fun</span> <span class="id">s</span> <span class="id">m</span> <span class="id">l</span> =&gt; <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#cond_incr">cond_incr</a></span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#round_N">round_N</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#inbetween_int_NA_sign">inbetween_int_NA_sign</a></span>.<br/>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.Fcalc_round_fexp">Fcalc_round_fexp</a></span>.<br/>
<br/>
<div class="doc">Specialization of truncate for FIX formats. </div>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Fcalc_round.emin">emin</a></span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="truncate_FIX">truncate_FIX</a></span> <span class="id">t</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">m</span>, <span class="id">e</span>, <span class="id">l</span>) := <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#t">t</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">k</span> := (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.emin">emin</a></span> - <span class="id">e</span>)%<span class="id">Z</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zlt_bool">Zlt_bool</a></span> 0 <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#k">k</a></span> <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">p</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpow_def.html#Zpower">Zpower</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#k">k</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zdiv.html#Zdiv">Zdiv</a></span> <span class="id">m</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#p">p</a></span>, (<span class="id">e</span> + <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#k">k</a></span>)%<span class="id">Z</span>, <span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#new_location">new_location</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#p">p</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zdiv.html#Zmod">Zmod</a></span> <span class="id">m</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#p">p</a></span>) <span class="id">l</span>)<br/>
&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#t">t</a></span>.<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="truncate_FIX_correct">truncate_FIX_correct</a></span> :<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#e">e</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#e">e</a></span> &lt;= <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.emin">emin</a></span>)%<span class="id">Z</span> \/ <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span> = <span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#loc_Exact">loc_Exact</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">let</span> '(<span class="id">m</span>', <span class="id">e</span>', <span class="id">l</span>') := <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#truncate_FIX">truncate_FIX</a></span> (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#m">m</a></span>, <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#e">e</a></span>, <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#l">l</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#inbetween_float">inbetween_float</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id">m</span>' <span class="id">e</span>' <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> <span class="id">l</span>' /\<br/>
&nbsp;&nbsp;(<span class="id">e</span>' = <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#canonic_exp">canonic_exp</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_FIX.html#FIX_exp">FIX_exp</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.emin">emin</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span> \/ (<span class="id">l</span>' = <span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#loc_Exact">loc_Exact</a></span> /\ <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#generic_format">generic_format</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> (<span class="id"><a href="compcert.flocq.Core.Fcore_FIX.html#FIX_exp">FIX_exp</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.emin">emin</a></span>) <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#x">x</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof5689')">Proof.</div>
<div class="proofscript" id="proof5689">
<span class="tactic">intros</span> <span class="id">x</span> <span class="id">m</span> <span class="id">e</span> <span class="id">l</span> <span class="id">H1</span> <span class="id">H2</span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#truncate_FIX">truncate_FIX</a></span>.<br/>
<span class="tactic">set</span> (<span class="id">k</span> := (<span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.emin">emin</a></span> - <span class="id">e</span>)%<span class="id">Z</span>).<br/>
<span class="tactic">set</span> (<span class="id">p</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpow_def.html#Zpower">Zpower</a></span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round.beta">beta</a></span> <span class="id">k</span>).<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#canonic_exp">canonic_exp</a></span>, <span class="id"><a href="compcert.flocq.Core.Fcore_FIX.html#FIX_exp">FIX_exp</a></span>.<br/>
<span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zlt_cases">Zlt_cases</a></span> 0 <span class="id">k</span>).<br/>
<span class="tactic">case</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zbool.html#Zlt_bool">Zlt_bool</a></span> 0 <span class="id">k</span>) ; <span class="tactic">intros</span> <span class="id">Hk</span>.<br/>
<span class="comment">(*&nbsp;shift&nbsp;*)</span><br/>
<span class="tactic">split</span>.<br/>
<span class="id">now</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_bracket.html#inbetween_float_new_location">inbetween_float_new_location</a></span>.<br/>
<span class="tactic">clear</span> <span class="id">H2</span>.<br/>
<span class="id">left</span>.<br/>
<span class="tactic">unfold</span> <span class="id">k</span>.<br/>
<span class="tactic">ring</span>.<br/>
<span class="comment">(*&nbsp;no&nbsp;shift&nbsp;*)</span><br/>
<span class="tactic">split</span>.<br/>
<span class="tactic">exact</span> <span class="id">H1</span>.<br/>
<span class="tactic">unfold</span> <span class="id">k</span> <span class="kwd">in</span> <span class="id">Hk</span>.<br/>
<span class="tactic">destruct</span> <span class="id">H2</span> <span class="kwd">as</span> [<span class="id">H2</span>|<span class="id">H2</span>].<br/>
<span class="id">left</span>.<br/>
<span class="tactic">omega</span>.<br/>
<span class="id">right</span>.<br/>
<span class="tactic">split</span>.<br/>
<span class="tactic">exact</span> <span class="id">H2</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">H2</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
<span class="tactic">inversion_clear</span> <span class="id">H1</span>.<br/>
<span class="tactic">rewrite</span> <span class="id">H</span>.<br/>
<span class="tactic">apply</span> <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#generic_format_F2R">generic_format_F2R</a></span>.<br/>
<span class="tactic">unfold</span> <span class="id"><a href="compcert.flocq.Core.Fcore_generic_fmt.html#canonic_exp">canonic_exp</a></span>.<br/>
<span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.flocq.Calc.Fcalc_round.html#Fcalc_round">Fcalc_round</a></span>.<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</div>
</body>
</html>
