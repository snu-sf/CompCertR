
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module RTLgen</title>
<meta name="description" content="Documentation of Coq module RTLgen" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module RTLgen</h1>
<div class="coq">
<br/>
<div class="doc">Translation from CminorSel to RTL. </div>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.lib.Coqlib.html">Coqlib</a></span>.<br/>
<span class="kwd">Require</span> <span class="id"><a href="compcert.common.Errors.html">Errors</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.lib.Maps.html">Maps</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.common.AST.html">AST</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.lib.Integers.html">Integers</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.common.Switch.html">Switch</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.x86.Op.html">Op</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.backend.Registers.html">Registers</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.backend.CminorSel.html">CminorSel</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.backend.RTL.html">RTL</a></span>.<br/>
<br/>
<span class="kwd">Local</span> <span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">string_scope</span>.<br/>
<br/>
<h1> Translation environments and state </h1>
<br/>
<div class="doc">The translation functions are parameterized by the following
  compile-time environment, which maps CminorSel local variables and
  let-bound variables to RTL registers.   The mapping for local variables
  is computed from the CminorSel variable declarations at the beginning of
  the translation of a function, and does not change afterwards.
  The mapping for let-bound variables is initially empty and updated
  during translation of expressions, when crossing a <span class="bracket"><span class="id">Elet</span></span> binding. </div>
<br/>
<span class="kwd">Record</span> <span class="id"><a name="mapping">mapping</a></span>: <span class="kwd">Type</span> := <span class="id"><a name="mkmapping">mkmapping</a></span> {<br/>
&nbsp;&nbsp;<span class="id"><a name="map_vars">map_vars</a></span>: <span class="id"><a href="compcert.lib.Maps.html#PTree.t">PTree.t</a></span> <span class="id"><a href="compcert.backend.Registers.html#reg">reg</a></span>;<br/>
&nbsp;&nbsp;<span class="id"><a name="map_letvars">map_letvars</a></span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.backend.Registers.html#reg">reg</a></span><br/>
}.<br/>
<br/>
<div class="doc">The translation functions modify a global state, comprising the
  current state of the control-flow graph for the function being translated,
  as well as sources of fresh RTL registers and fresh CFG nodes. </div>
<br/>
<span class="kwd">Record</span> <span class="id"><a name="state">state</a></span>: <span class="kwd">Type</span> := <span class="id"><a name="mkstate">mkstate</a></span> {<br/>
&nbsp;&nbsp;<span class="id"><a name="st_nextreg">st_nextreg</a></span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#positive">positive</a></span>;<br/>
&nbsp;&nbsp;<span class="id"><a name="st_nextnode">st_nextnode</a></span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#positive">positive</a></span>;<br/>
&nbsp;&nbsp;<span class="id"><a name="st_code">st_code</a></span>: <span class="id"><a href="compcert.backend.RTL.html#code">code</a></span>;<br/>
&nbsp;&nbsp;<span class="id"><a name="st_wf">st_wf</a></span>: <span class="kwd">forall</span> (<span class="id">pc</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#positive">positive</a></span>), <span class="id"><a href="compcert.lib.Coqlib.html#Plt">Plt</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#pc">pc</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#st_nextnode">st_nextnode</a></span> \/ <span class="id"><a href="compcert.backend.RTLgen.html#st_code">st_code</a></span>!<span class="id"><a href="compcert.backend.RTLgen.html#pc">pc</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
}.<br/>
<br/>
<div class="doc">Operations over the global state satisfy a crucial monotonicity property:
  nodes are only added to the CFG, but are never removed nor their
  instructions are changed; similarly, fresh nodes and fresh registers
  are only consumed, but never reused.  This property is captured by
  the following predicate over states, which we show is a partial
  order. </div>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="state_incr">state_incr</a></span>: <span class="id"><a href="compcert.backend.RTLgen.html#state">state</a></span> -&gt; <span class="id"><a href="compcert.backend.RTLgen.html#state">state</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id"><a name="state_incr_intro">state_incr_intro</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">s1</span> <span class="id">s2</span>: <span class="id"><a href="compcert.backend.RTLgen.html#state">state</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#s1">s1</a></span>.(<span class="id"><a href="compcert.backend.RTLgen.html#st_nextnode">st_nextnode</a></span>) <span class="id"><a href="compcert.backend.RTLgen.html#s2">s2</a></span>.(<span class="id"><a href="compcert.backend.RTLgen.html#st_nextnode">st_nextnode</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#s1">s1</a></span>.(<span class="id"><a href="compcert.backend.RTLgen.html#st_nextreg">st_nextreg</a></span>) <span class="id"><a href="compcert.backend.RTLgen.html#s2">s2</a></span>.(<span class="id"><a href="compcert.backend.RTLgen.html#st_nextreg">st_nextreg</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">pc</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.RTLgen.html#s1">s1</a></span>.(<span class="id"><a href="compcert.backend.RTLgen.html#st_code">st_code</a></span>)!<span class="id"><a href="compcert.backend.RTLgen.html#pc">pc</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> \/ <span class="id"><a href="compcert.backend.RTLgen.html#s2">s2</a></span>.(<span class="id"><a href="compcert.backend.RTLgen.html#st_code">st_code</a></span>)!<span class="id"><a href="compcert.backend.RTLgen.html#pc">pc</a></span> = <span class="id"><a href="compcert.backend.RTLgen.html#s1">s1</a></span>.(<span class="id"><a href="compcert.backend.RTLgen.html#st_code">st_code</a></span>)!<span class="id"><a href="compcert.backend.RTLgen.html#pc">pc</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.RTLgen.html#state_incr">state_incr</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#s1">s1</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#s2">s2</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="state_incr_refl">state_incr_refl</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s</span>, <span class="id"><a href="compcert.backend.RTLgen.html#state_incr">state_incr</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2579')">Proof.</div>
<div class="proofscript" id="proof2579">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.RTLgen.html#state_incr_intro">state_incr_intro</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#Ple_refl">Ple_refl</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#Ple_refl">Ple_refl</a></span>. <span class="tactic">intros</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="state_incr_trans">state_incr_trans</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s1</span> <span class="id">s2</span> <span class="id">s3</span>, <span class="id"><a href="compcert.backend.RTLgen.html#state_incr">state_incr</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#s1">s1</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#s2">s2</a></span> -&gt; <span class="id"><a href="compcert.backend.RTLgen.html#state_incr">state_incr</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#s2">s2</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#s3">s3</a></span> -&gt; <span class="id"><a href="compcert.backend.RTLgen.html#state_incr">state_incr</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#s1">s1</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#s3">s3</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2580')">Proof.</div>
<div class="proofscript" id="proof2580">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>; <span class="id">inv</span> <span class="id">H0</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.RTLgen.html#state_incr_intro">state_incr_intro</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#Ple_trans">Ple_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="compcert.backend.RTLgen.html#st_nextnode">st_nextnode</a></span> <span class="id">s2</span>); <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#Ple_trans">Ple_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="compcert.backend.RTLgen.html#st_nextreg">st_nextreg</a></span> <span class="id">s2</span>); <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">generalize</span> (<span class="id">H3</span> <span class="id">pc</span>) (<span class="id">H5</span> <span class="id">pc</span>). <span class="tactic">intuition</span> <span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<h2> The state and error monad </h2>
<br/>
<div class="doc">The translation functions can fail to produce RTL code, for instance
  if a non-declared variable is referenced.  They must also modify
  the global state, adding new nodes to the control-flow graph and
  generating fresh temporary registers.  In a language like ML or Java,
  we would use exceptions to report errors and mutable data structures
  to modify the global state.  These luxuries are not available in Coq,
  however.  Instead, we use a monadic encoding of the translation:
  translation functions take the current global state as argument,
  and return either <span class="bracket"><span class="id">Error</span> <span class="id">msg</span></span> to denote an error,
  or <span class="bracket"><span class="id">OK</span> <span class="id">r</span> <span class="id">s</span> <span class="id">incr</span></span> to denote success.  <span class="bracket"><span class="id">s</span></span> is the modified state, <span class="bracket"><span class="id">r</span></span>
  the result value of the translation function.  and <span class="bracket"><span class="id">incr</span></span> a proof
  that the final state is in the <span class="bracket"><span class="id">state_incr</span></span> relation with the
  initial state.  In the error case, <span class="bracket"><span class="id">msg</span></span> is an error message (see
  modules <span class="bracket"><span class="id">Errors</span></span>) describing the problem.
  We now define this monadic encoding -- the ``state and error'' monad --
  as well as convenient syntax to express monadic computations. </div>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="res">res</a></span> (<span class="id">A</span>: <span class="kwd">Type</span>) (<span class="id">s</span>: <span class="id"><a href="compcert.backend.RTLgen.html#state">state</a></span>): <span class="kwd">Type</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="Error">Error</a></span>: <span class="id"><a href="compcert.common.Errors.html#errmsg">Errors.errmsg</a></span> -&gt; <span class="id"><a href="compcert.backend.RTLgen.html#res">res</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#A">A</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="OK">OK</a></span>: <span class="id"><a href="compcert.backend.RTLgen.html#A">A</a></span> -&gt; <span class="kwd">forall</span> (<span class="id">s</span>': <span class="id"><a href="compcert.backend.RTLgen.html#state">state</a></span>), <span class="id"><a href="compcert.backend.RTLgen.html#state_incr">state_incr</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span> <span class="id">s</span>' -&gt; <span class="id"><a href="compcert.backend.RTLgen.html#res">res</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#A">A</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span>.<br/>
<br/>
<span class="id">Arguments</span> <span class="id"><a href="compcert.backend.RTLgen.html#OK">OK</a></span> [<span class="id">A</span> <span class="id">s</span>].<br/>
<span class="id">Arguments</span> <span class="id"><a href="compcert.backend.RTLgen.html#Error">Error</a></span> [<span class="id">A</span> <span class="id">s</span>].<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="mon">mon</a></span> (<span class="id">A</span>: <span class="kwd">Type</span>) : <span class="kwd">Type</span> := <span class="kwd">forall</span> (<span class="id">s</span>: <span class="id"><a href="compcert.backend.RTLgen.html#state">state</a></span>), <span class="id"><a href="compcert.backend.RTLgen.html#res">res</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#A">A</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="ret">ret</a></span> {<span class="id">A</span>: <span class="kwd">Type</span>} (<span class="id">x</span>: <span class="id"><a href="compcert.backend.RTLgen.html#A">A</a></span>) : <span class="id"><a href="compcert.backend.RTLgen.html#mon">mon</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#A">A</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">fun</span> (<span class="id">s</span>: <span class="id"><a href="compcert.backend.RTLgen.html#state">state</a></span>) =&gt; <span class="id"><a href="compcert.backend.RTLgen.html#OK">OK</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#x">x</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span> (<span class="id"><a href="compcert.backend.RTLgen.html#state_incr_refl">state_incr_refl</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span>).<br/>
<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="error">error</a></span> {<span class="id">A</span>: <span class="kwd">Type</span>} (<span class="id">msg</span>: <span class="id"><a href="compcert.common.Errors.html#errmsg">Errors.errmsg</a></span>) : <span class="id"><a href="compcert.backend.RTLgen.html#mon">mon</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#A">A</a></span> := <span class="kwd">fun</span> (<span class="id">s</span>: <span class="id"><a href="compcert.backend.RTLgen.html#state">state</a></span>) =&gt; <span class="id"><a href="compcert.backend.RTLgen.html#Error">Error</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#msg">msg</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="bind">bind</a></span> {<span class="id">A</span> <span class="id">B</span>: <span class="kwd">Type</span>} (<span class="id">f</span>: <span class="id"><a href="compcert.backend.RTLgen.html#mon">mon</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#A">A</a></span>) (<span class="id">g</span>: <span class="id"><a href="compcert.backend.RTLgen.html#A">A</a></span> -&gt; <span class="id"><a href="compcert.backend.RTLgen.html#mon">mon</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#B">B</a></span>) : <span class="id"><a href="compcert.backend.RTLgen.html#mon">mon</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#B">B</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">fun</span> (<span class="id">s</span>: <span class="id"><a href="compcert.backend.RTLgen.html#state">state</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.backend.RTLgen.html#f">f</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.RTLgen.html#Error">Error</a></span> <span class="id">msg</span> =&gt; <span class="id"><a href="compcert.backend.RTLgen.html#Error">Error</a></span> <span class="id">msg</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.RTLgen.html#OK">OK</a></span> <span class="id">a</span> <span class="id">s</span>' <span class="id">i</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.backend.RTLgen.html#g">g</a></span> <span class="id">a</span> <span class="id">s</span>' <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.RTLgen.html#Error">Error</a></span> <span class="id">msg</span> =&gt; <span class="id"><a href="compcert.backend.RTLgen.html#Error">Error</a></span> <span class="id">msg</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.RTLgen.html#OK">OK</a></span> <span class="id">b</span> <span class="id">s</span>'' <span class="id">i</span>' =&gt; <span class="id"><a href="compcert.backend.RTLgen.html#OK">OK</a></span> <span class="id">b</span> <span class="id">s</span>'' (<span class="id"><a href="compcert.backend.RTLgen.html#state_incr_trans">state_incr_trans</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span> <span class="id">s</span>' <span class="id">s</span>'' <span class="id">i</span> <span class="id">i</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="bind2">bind2</a></span> {<span class="id">A</span> <span class="id">B</span> <span class="id">C</span>: <span class="kwd">Type</span>} (<span class="id">f</span>: <span class="id"><a href="compcert.backend.RTLgen.html#mon">mon</a></span> (<span class="id"><a href="compcert.backend.RTLgen.html#A">A</a></span> * <span class="id"><a href="compcert.backend.RTLgen.html#B">B</a></span>)) (<span class="id">g</span>: <span class="id"><a href="compcert.backend.RTLgen.html#A">A</a></span> -&gt; <span class="id"><a href="compcert.backend.RTLgen.html#B">B</a></span> -&gt; <span class="id"><a href="compcert.backend.RTLgen.html#mon">mon</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#C">C</a></span>) : <span class="id"><a href="compcert.backend.RTLgen.html#mon">mon</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#C">C</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.RTLgen.html#bind">bind</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#f">f</a></span> (<span class="kwd">fun</span> <span class="id">xy</span> =&gt; <span class="id"><a href="compcert.backend.RTLgen.html#g">g</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#xy">xy</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#xy">xy</a></span>)).<br/>
<br/>
<span class="kwd">Notation</span> "'<span class="tactic">do</span>' <span class="id">X</span> &lt;- <span class="id">A</span> ; <span class="id">B</span>" := (<span class="id"><a href="compcert.backend.RTLgen.html#bind">bind</a></span> <span class="id">A</span> (<span class="kwd">fun</span> <span class="id">X</span> =&gt; <span class="id">B</span>))<br/>
&nbsp;&nbsp;&nbsp;(<span class="tactic">at</span> <span class="id">level</span> 200, <span class="id">X</span> <span class="id">ident</span>, <span class="id">A</span> <span class="tactic">at</span> <span class="id">level</span> 100, <span class="id">B</span> <span class="tactic">at</span> <span class="id">level</span> 200).<br/>
<span class="kwd">Notation</span> "'<span class="tactic">do</span>' ( <span class="id">X</span> , <span class="id">Y</span> ) &lt;- <span class="id">A</span> ; <span class="id">B</span>" := (<span class="id"><a href="compcert.backend.RTLgen.html#bind2">bind2</a></span> <span class="id">A</span> (<span class="kwd">fun</span> <span class="id">X</span> <span class="id">Y</span> =&gt; <span class="id">B</span>))<br/>
&nbsp;&nbsp;&nbsp;(<span class="tactic">at</span> <span class="id">level</span> 200, <span class="id">X</span> <span class="id">ident</span>, <span class="id">Y</span> <span class="id">ident</span>, <span class="id">A</span> <span class="tactic">at</span> <span class="id">level</span> 100, <span class="id">B</span> <span class="tactic">at</span> <span class="id">level</span> 200).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="handle_error">handle_error</a></span> {<span class="id">A</span>: <span class="kwd">Type</span>} (<span class="id">f</span> <span class="id">g</span>: <span class="id"><a href="compcert.backend.RTLgen.html#mon">mon</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#A">A</a></span>) : <span class="id"><a href="compcert.backend.RTLgen.html#mon">mon</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#A">A</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">fun</span> (<span class="id">s</span>: <span class="id"><a href="compcert.backend.RTLgen.html#state">state</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.backend.RTLgen.html#f">f</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.RTLgen.html#OK">OK</a></span> <span class="id">a</span> <span class="id">s</span>' <span class="id">i</span> =&gt; <span class="id"><a href="compcert.backend.RTLgen.html#OK">OK</a></span> <span class="id">a</span> <span class="id">s</span>' <span class="id">i</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.RTLgen.html#Error">Error</a></span> <span class="id">_</span> =&gt; <span class="id"><a href="compcert.backend.RTLgen.html#g">g</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<h2> Operations on state </h2>
<br/>
<div class="doc">The initial state (empty CFG). </div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="init_state_wf">init_state_wf</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">pc</span>, <span class="id"><a href="compcert.lib.Coqlib.html#Plt">Plt</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#pc">pc</a></span> 1%<span class="id">positive</span> \/ (<span class="id"><a href="compcert.lib.Maps.html#PTree.empty">PTree.empty</a></span> <span class="id"><a href="compcert.backend.RTL.html#instruction">instruction</a></span>)!<span class="id"><a href="compcert.backend.RTLgen.html#pc">pc</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2581')">Proof.</div>
<div class="proofscript" id="proof2581">
 <span class="tactic">intros</span>; <span class="id">right</span>; <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Maps.html#PTree.gempty">PTree.gempty</a></span>. Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="init_state">init_state</a></span> : <span class="id"><a href="compcert.backend.RTLgen.html#state">state</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.RTLgen.html#mkstate">mkstate</a></span> 1%<span class="id">positive</span> 1%<span class="id">positive</span> (<span class="id"><a href="compcert.lib.Maps.html#PTree.empty">PTree.empty</a></span> <span class="id"><a href="compcert.backend.RTL.html#instruction">instruction</a></span>) <span class="id"><a href="compcert.backend.RTLgen.html#init_state_wf">init_state_wf</a></span>.<br/>
<br/>
<div class="doc">Adding a node with the given instruction to the CFG.  Return the
    label of the new node. </div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="add_instr_wf">add_instr_wf</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s</span> <span class="id">i</span> <span class="id">pc</span>,<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">n</span> := <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.RTLgen.html#st_nextnode">st_nextnode</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#Plt">Plt</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#pc">pc</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.succ">Pos.succ</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#n">n</a></span>) \/ (<span class="id"><a href="compcert.lib.Maps.html#PTree.set">PTree.set</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#n">n</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#i">i</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.RTLgen.html#st_code">st_code</a></span>))!<span class="id"><a href="compcert.backend.RTLgen.html#pc">pc</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2582')">Proof.</div>
<div class="proofscript" id="proof2582">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">case</span> (<span class="id"><a href="compcert.lib.Coqlib.html#peq">peq</a></span> <span class="id">pc</span> <span class="id">n</span>); <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">pc</span>; <span class="id">left</span>; <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#Plt_succ">Plt_succ</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Maps.html#PTree.gso">PTree.gso</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id"><a href="compcert.backend.RTLgen.html#st_wf">st_wf</a></span> <span class="id">s</span> <span class="id">pc</span>); <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#Plt_trans_succ">Plt_trans_succ</a></span>. <span class="tactic">exact</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">right</span>; <span class="tactic">assumption</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="add_instr_incr">add_instr_incr</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s</span> <span class="id">i</span>,<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">n</span> := <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.RTLgen.html#st_nextnode">st_nextnode</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.RTLgen.html#state_incr">state_incr</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span> (<span class="id"><a href="compcert.backend.RTLgen.html#mkstate">mkstate</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.RTLgen.html#st_nextreg">st_nextreg</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.succ">Pos.succ</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#n">n</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.lib.Maps.html#PTree.set">PTree.set</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#n">n</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#i">i</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.RTLgen.html#st_code">st_code</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.RTLgen.html#add_instr_wf">add_instr_wf</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#i">i</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2583')">Proof.</div>
<div class="proofscript" id="proof2583">
&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#Ple_succ">Ple_succ</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#Ple_refl">Ple_refl</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.backend.RTLgen.html#st_wf">st_wf</a></span> <span class="id">s</span> <span class="id">pc</span>). <span class="id">right</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Maps.html#PTree.gso">PTree.gso</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#Plt_ne">Plt_ne</a></span>; <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="add_instr">add_instr</a></span> (<span class="id">i</span>: <span class="id"><a href="compcert.backend.RTL.html#instruction">instruction</a></span>) : <span class="id"><a href="compcert.backend.RTLgen.html#mon">mon</a></span> <span class="id"><a href="compcert.backend.RTL.html#node">node</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">s</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">n</span> := <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.RTLgen.html#st_nextnode">st_nextnode</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.RTLgen.html#OK">OK</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#n">n</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.RTLgen.html#mkstate">mkstate</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.RTLgen.html#st_nextreg">st_nextreg</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.succ">Pos.succ</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#n">n</a></span>) (<span class="id"><a href="compcert.lib.Maps.html#PTree.set">PTree.set</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#n">n</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#i">i</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.RTLgen.html#st_code">st_code</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.RTLgen.html#add_instr_wf">add_instr_wf</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#i">i</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.RTLgen.html#add_instr_incr">add_instr_incr</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#i">i</a></span>).<br/>
<br/>
<div class="doc"><span class="bracket"><span class="id">add_instr</span></span> can be decomposed in two steps: reserving a fresh
  CFG node, and filling it later with an instruction.  This is needed
  to compile loops. </div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="reserve_instr_wf">reserve_instr_wf</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s</span> <span class="id">pc</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#Plt">Plt</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#pc">pc</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.succ">Pos.succ</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.RTLgen.html#st_nextnode">st_nextnode</a></span>)) \/ <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.RTLgen.html#st_code">st_code</a></span>)!<span class="id"><a href="compcert.backend.RTLgen.html#pc">pc</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2584')">Proof.</div>
<div class="proofscript" id="proof2584">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">elim</span> (<span class="id"><a href="compcert.backend.RTLgen.html#st_wf">st_wf</a></span> <span class="id">s</span> <span class="id">pc</span>); <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;<span class="id">left</span>; <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#Plt_trans_succ">Plt_trans_succ</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">right</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="reserve_instr_incr">reserve_instr_incr</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s</span>,<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">n</span> := <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.RTLgen.html#st_nextnode">st_nextnode</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.RTLgen.html#state_incr">state_incr</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span> (<span class="id"><a href="compcert.backend.RTLgen.html#mkstate">mkstate</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.RTLgen.html#st_nextreg">st_nextreg</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.succ">Pos.succ</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#n">n</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.RTLgen.html#st_code">st_code</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.RTLgen.html#reserve_instr_wf">reserve_instr_wf</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2585')">Proof.</div>
<div class="proofscript" id="proof2585">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="id">constructor</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#Ple_succ">Ple_succ</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#Ple_refl">Ple_refl</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="reserve_instr">reserve_instr</a></span>: <span class="id"><a href="compcert.backend.RTLgen.html#mon">mon</a></span> <span class="id"><a href="compcert.backend.RTL.html#node">node</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">fun</span> (<span class="id">s</span>: <span class="id"><a href="compcert.backend.RTLgen.html#state">state</a></span>) =&gt;<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">n</span> := <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.RTLgen.html#st_nextnode">st_nextnode</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.RTLgen.html#OK">OK</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#n">n</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.RTLgen.html#mkstate">mkstate</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.RTLgen.html#st_nextreg">st_nextreg</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.succ">Pos.succ</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#n">n</a></span>) <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.RTLgen.html#st_code">st_code</a></span>) (<span class="id"><a href="compcert.backend.RTLgen.html#reserve_instr_wf">reserve_instr_wf</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.RTLgen.html#reserve_instr_incr">reserve_instr_incr</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span>).<br/>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="update_instr_wf">update_instr_wf</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s</span> <span class="id">n</span> <span class="id">i</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#Plt">Plt</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#n">n</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.RTLgen.html#st_nextnode">st_nextnode</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">pc</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#Plt">Plt</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#pc">pc</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.RTLgen.html#st_nextnode">st_nextnode</a></span>) \/ (<span class="id"><a href="compcert.lib.Maps.html#PTree.set">PTree.set</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#n">n</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#i">i</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.RTLgen.html#st_code">st_code</a></span>))!<span class="id"><a href="compcert.backend.RTLgen.html#pc">pc</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2586')">Proof.</div>
<div class="proofscript" id="proof2586">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">case</span> (<span class="id"><a href="compcert.lib.Coqlib.html#peq">peq</a></span> <span class="id">pc</span> <span class="id">n</span>); <span class="tactic">intro</span>.<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">pc</span>; <span class="id">left</span>; <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Maps.html#PTree.gso">PTree.gso</a></span>; <span class="tactic">auto</span>. <span class="tactic">exact</span> (<span class="id"><a href="compcert.backend.RTLgen.html#st_wf">st_wf</a></span> <span class="id">s</span> <span class="id">pc</span>).<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="update_instr_incr">update_instr_incr</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s</span> <span class="id">n</span> <span class="id">i</span> (<span class="id">LT</span>: <span class="id"><a href="compcert.lib.Coqlib.html#Plt">Plt</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#n">n</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.RTLgen.html#st_nextnode">st_nextnode</a></span>)),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.RTLgen.html#st_code">st_code</a></span>)!<span class="id"><a href="compcert.backend.RTLgen.html#n">n</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.RTLgen.html#state_incr">state_incr</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.RTLgen.html#mkstate">mkstate</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.RTLgen.html#st_nextreg">st_nextreg</a></span>) <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.RTLgen.html#st_nextnode">st_nextnode</a></span>) (<span class="id"><a href="compcert.lib.Maps.html#PTree.set">PTree.set</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#n">n</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#i">i</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.RTLgen.html#st_code">st_code</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.RTLgen.html#update_instr_wf">update_instr_wf</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#n">n</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#i">i</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#LT">LT</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2587')">Proof.</div>
<div class="proofscript" id="proof2587">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#Ple_refl">Ple_refl</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#Ple_refl">Ple_refl</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Maps.html#PTree.gsspec">PTree.gsspec</a></span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#peq">peq</a></span> <span class="id">pc</span> <span class="id">n</span>). <span class="id">left</span>; <span class="tactic">congruence</span>. <span class="id">right</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="check_empty_node">check_empty_node</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">s</span>: <span class="id"><a href="compcert.backend.RTLgen.html#state">state</a></span>) (<span class="id">n</span>: <span class="id"><a href="compcert.backend.RTL.html#node">node</a></span>), { <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.RTLgen.html#st_code">st_code</a></span>)!<span class="id"><a href="compcert.backend.RTLgen.html#n">n</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> } + { <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span> }.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2588')">Proof.</div>
<div class="proofscript" id="proof2588">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">case</span> (<span class="id">s</span>.(<span class="id"><a href="compcert.backend.RTLgen.html#st_code">st_code</a></span>)!<span class="id">n</span>); <span class="tactic">intros</span>. <span class="id">right</span>; <span class="tactic">auto</span>. <span class="id">left</span>; <span class="tactic">auto</span>.<br/>
Defined.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="update_instr">update_instr</a></span> (<span class="id">n</span>: <span class="id"><a href="compcert.backend.RTL.html#node">node</a></span>) (<span class="id">i</span>: <span class="id"><a href="compcert.backend.RTL.html#instruction">instruction</a></span>) : <span class="id"><a href="compcert.backend.RTLgen.html#mon">mon</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#unit">unit</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">s</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.lib.Coqlib.html#plt">plt</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#n">n</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.RTLgen.html#st_nextnode">st_nextnode</a></span>), <span class="id"><a href="compcert.backend.RTLgen.html#check_empty_node">check_empty_node</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#n">n</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#left">left</a></span> <span class="id">LT</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Specif.html#left">left</a></span> <span class="id">EMPTY</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.RTLgen.html#OK">OK</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.RTLgen.html#mkstate">mkstate</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.RTLgen.html#st_nextreg">st_nextreg</a></span>) <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.RTLgen.html#st_nextnode">st_nextnode</a></span>) (<span class="id"><a href="compcert.lib.Maps.html#PTree.set">PTree.set</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#n">n</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#i">i</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.RTLgen.html#st_code">st_code</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.RTLgen.html#update_instr_wf">update_instr_wf</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#n">n</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#i">i</a></span> <span class="id">LT</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.RTLgen.html#update_instr_incr">update_instr_incr</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#n">n</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#i">i</a></span> <span class="id">LT</span> <span class="id">EMPTY</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.RTLgen.html#Error">Error</a></span> (<span class="id"><a href="compcert.common.Errors.html#msg">Errors.msg</a></span> "<span class="id">RTLgen.update_instr</span>")<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<div class="doc">Generate a fresh RTL register. </div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="new_reg_incr">new_reg_incr</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.RTLgen.html#state_incr">state_incr</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span> (<span class="id"><a href="compcert.backend.RTLgen.html#mkstate">mkstate</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.succ">Pos.succ</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.RTLgen.html#st_nextreg">st_nextreg</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.RTLgen.html#st_nextnode">st_nextnode</a></span>) <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.RTLgen.html#st_code">st_code</a></span>) <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.RTLgen.html#st_wf">st_wf</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2589')">Proof.</div>
<div class="proofscript" id="proof2589">
&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#Ple_refl">Ple_refl</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#Ple_succ">Ple_succ</a></span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="new_reg">new_reg</a></span> : <span class="id"><a href="compcert.backend.RTLgen.html#mon">mon</a></span> <span class="id"><a href="compcert.backend.Registers.html#reg">reg</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">fun</span> <span class="id">s</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.RTLgen.html#OK">OK</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.RTLgen.html#st_nextreg">st_nextreg</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.RTLgen.html#mkstate">mkstate</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.succ">Pos.succ</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.RTLgen.html#st_nextreg">st_nextreg</a></span>)) <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.RTLgen.html#st_nextnode">st_nextnode</a></span>) <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.RTLgen.html#st_code">st_code</a></span>) <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.RTLgen.html#st_wf">st_wf</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.RTLgen.html#new_reg_incr">new_reg_incr</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span>).<br/>
<br/>
<h2> Operations on mappings </h2>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="init_mapping">init_mapping</a></span> : <span class="id"><a href="compcert.backend.RTLgen.html#mapping">mapping</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.RTLgen.html#mkmapping">mkmapping</a></span> (<span class="id"><a href="compcert.lib.Maps.html#PTree.empty">PTree.empty</a></span> <span class="id"><a href="compcert.backend.Registers.html#reg">reg</a></span>) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="add_var">add_var</a></span> (<span class="id">map</span>: <span class="id"><a href="compcert.backend.RTLgen.html#mapping">mapping</a></span>) (<span class="id">name</span>: <span class="id"><a href="compcert.common.AST.html#ident">ident</a></span>) : <span class="id"><a href="compcert.backend.RTLgen.html#mon">mon</a></span> (<span class="id"><a href="compcert.backend.Registers.html#reg">reg</a></span> * <span class="id"><a href="compcert.backend.RTLgen.html#mapping">mapping</a></span>) :=<br/>
&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">r</span> &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#new_reg">new_reg</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.RTLgen.html#ret">ret</a></span> (<span class="id"><a href="compcert.backend.RTLgen.html#r">r</a></span>, <span class="id"><a href="compcert.backend.RTLgen.html#mkmapping">mkmapping</a></span> (<span class="id"><a href="compcert.lib.Maps.html#PTree.set">PTree.set</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#name">name</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#r">r</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span>.(<span class="id"><a href="compcert.backend.RTLgen.html#map_vars">map_vars</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span>.(<span class="id"><a href="compcert.backend.RTLgen.html#map_letvars">map_letvars</a></span>)).<br/>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="add_vars">add_vars</a></span> (<span class="id">map</span>: <span class="id"><a href="compcert.backend.RTLgen.html#mapping">mapping</a></span>) (<span class="id">names</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.common.AST.html#ident">ident</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="kwd">struct</span> <span class="id">names</span>} : <span class="id"><a href="compcert.backend.RTLgen.html#mon">mon</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.backend.Registers.html#reg">reg</a></span> * <span class="id"><a href="compcert.backend.RTLgen.html#mapping">mapping</a></span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.backend.RTLgen.html#names">names</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; <span class="id"><a href="compcert.backend.RTLgen.html#ret">ret</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>, <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span>)<br/>
&nbsp;&nbsp;| <span class="id">n1</span> :: <span class="id">nl</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> (<span class="id">rl</span>, <span class="id">map1</span>) &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#add_vars">add_vars</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id">nl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> (<span class="id">r1</span>, <span class="id">map2</span>) &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#add_var">add_var</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map1">map1</a></span> <span class="id">n1</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.RTLgen.html#ret">ret</a></span> (<span class="id"><a href="compcert.backend.RTLgen.html#r1">r1</a></span> :: <span class="id"><a href="compcert.backend.RTLgen.html#rl">rl</a></span>, <span class="id"><a href="compcert.backend.RTLgen.html#map2">map2</a></span>)<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="find_var">find_var</a></span> (<span class="id">map</span>: <span class="id"><a href="compcert.backend.RTLgen.html#mapping">mapping</a></span>) (<span class="id">name</span>: <span class="id"><a href="compcert.common.AST.html#ident">ident</a></span>) : <span class="id"><a href="compcert.backend.RTLgen.html#mon">mon</a></span> <span class="id"><a href="compcert.backend.Registers.html#reg">reg</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.lib.Maps.html#PTree.get">PTree.get</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#name">name</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span>.(<span class="id"><a href="compcert.backend.RTLgen.html#map_vars">map_vars</a></span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="compcert.backend.RTLgen.html#error">error</a></span> (<span class="id"><a href="compcert.common.Errors.html#MSG">Errors.MSG</a></span> "<span class="id">RTLgen</span>: <span class="id">unbound</span> <span class="id">variable</span> " :: <span class="id"><a href="compcert.common.Errors.html#CTX">Errors.CTX</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#name">name</a></span> :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">r</span> =&gt; <span class="id"><a href="compcert.backend.RTLgen.html#ret">ret</a></span> <span class="id">r</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="add_letvar">add_letvar</a></span> (<span class="id">map</span>: <span class="id"><a href="compcert.backend.RTLgen.html#mapping">mapping</a></span>) (<span class="id">r</span>: <span class="id"><a href="compcert.backend.Registers.html#reg">reg</a></span>) : <span class="id"><a href="compcert.backend.RTLgen.html#mapping">mapping</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.RTLgen.html#mkmapping">mkmapping</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span>.(<span class="id"><a href="compcert.backend.RTLgen.html#map_vars">map_vars</a></span>) (<span class="id"><a href="compcert.backend.RTLgen.html#r">r</a></span> :: <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span>.(<span class="id"><a href="compcert.backend.RTLgen.html#map_letvars">map_letvars</a></span>)).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="find_letvar">find_letvar</a></span> (<span class="id">map</span>: <span class="id"><a href="compcert.backend.RTLgen.html#mapping">mapping</a></span>) (<span class="id">idx</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) : <span class="id"><a href="compcert.backend.RTLgen.html#mon">mon</a></span> <span class="id"><a href="compcert.backend.Registers.html#reg">reg</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth_error">List.nth_error</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span>.(<span class="id"><a href="compcert.backend.RTLgen.html#map_letvars">map_letvars</a></span>) <span class="id"><a href="compcert.backend.RTLgen.html#idx">idx</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="compcert.backend.RTLgen.html#error">error</a></span> (<span class="id"><a href="compcert.common.Errors.html#msg">Errors.msg</a></span> "<span class="id">RTLgen</span>: <span class="id">unbound</span> <span class="kwd">let</span> <span class="id">variable</span>")<br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">r</span> =&gt; <span class="id"><a href="compcert.backend.RTLgen.html#ret">ret</a></span> <span class="id">r</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<h2> Optimized temporary generation </h2>
<br/>
<div class="doc"><span class="bracket"><span class="id">alloc_reg</span> <span class="id">map</span> <span class="id">a</span></span> returns the RTL register where the evaluation
  of expression <span class="bracket"><span class="id">a</span></span> should leave its result -- the ``target register''
  for evaluating <span class="bracket"><span class="id">a</span></span>.  In general, this is a
  fresh temporary register.  Exception: if <span class="bracket"><span class="id">a</span></span> is a let-bound variable
  or a local variable, we return the RTL register associated
  with that variable instead.  Returning a fresh temporary in all cases
  would be semantically correct, but would generate less efficient
  RTL code. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="alloc_reg">alloc_reg</a></span> (<span class="id">map</span>: <span class="id"><a href="compcert.backend.RTLgen.html#mapping">mapping</a></span>) (<span class="id">a</span>: <span class="id"><a href="compcert.backend.CminorSel.html#expr">expr</a></span>) : <span class="id"><a href="compcert.backend.RTLgen.html#mon">mon</a></span> <span class="id"><a href="compcert.backend.Registers.html#reg">reg</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.backend.RTLgen.html#a">a</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.CminorSel.html#Evar">Evar</a></span> <span class="id">id</span>   =&gt; <span class="id"><a href="compcert.backend.RTLgen.html#find_var">find_var</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id">id</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.CminorSel.html#Eletvar">Eletvar</a></span> <span class="id">n</span> =&gt; <span class="id"><a href="compcert.backend.RTLgen.html#find_letvar">find_letvar</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id">n</span><br/>
&nbsp;&nbsp;| <span class="id">_</span>         =&gt; <span class="id"><a href="compcert.backend.RTLgen.html#new_reg">new_reg</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<div class="doc"><span class="bracket"><span class="id">alloc_regs</span></span> is similar, but for a list of expressions. </div>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="alloc_regs">alloc_regs</a></span> (<span class="id">map</span>: <span class="id"><a href="compcert.backend.RTLgen.html#mapping">mapping</a></span>) (<span class="id">al</span>: <span class="id"><a href="compcert.backend.CminorSel.html#exprlist">exprlist</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="kwd">struct</span> <span class="id">al</span>}: <span class="id"><a href="compcert.backend.RTLgen.html#mon">mon</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.backend.Registers.html#reg">reg</a></span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.backend.RTLgen.html#al">al</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.CminorSel.html#Enil">Enil</a></span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.RTLgen.html#ret">ret</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.CminorSel.html#Econs">Econs</a></span> <span class="id">a</span> <span class="id">bl</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">r</span>  &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#alloc_reg">alloc_reg</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id">a</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">rl</span> &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#alloc_regs">alloc_regs</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id">bl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.RTLgen.html#ret">ret</a></span> (<span class="id"><a href="compcert.backend.RTLgen.html#r">r</a></span> :: <span class="id"><a href="compcert.backend.RTLgen.html#rl">rl</a></span>)<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<div class="doc"><span class="bracket"><span class="id">alloc_optreg</span></span> is used for function calls.  If a destination is
  specified for the call, it is returned.  Otherwise, a fresh
  register is returned. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="alloc_optreg">alloc_optreg</a></span> (<span class="id">map</span>: <span class="id"><a href="compcert.backend.RTLgen.html#mapping">mapping</a></span>) (<span class="kwd">dest</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="compcert.common.AST.html#ident">ident</a></span>) : <span class="id"><a href="compcert.backend.RTLgen.html#mon">mon</a></span> <span class="id"><a href="compcert.backend.Registers.html#reg">reg</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="kwd">dest</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">id</span> =&gt; <span class="id"><a href="compcert.backend.RTLgen.html#find_var">find_var</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id">id</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="compcert.backend.RTLgen.html#new_reg">new_reg</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<h1> RTL generation *</h1>
<br/>
<div class="doc">Insertion of a register-to-register move instruction. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="add_move">add_move</a></span> (<span class="id">rs</span> <span class="id">rd</span>: <span class="id"><a href="compcert.backend.Registers.html#reg">reg</a></span>) (<span class="id">nd</span>: <span class="id"><a href="compcert.backend.RTL.html#node">node</a></span>) : <span class="id"><a href="compcert.backend.RTLgen.html#mon">mon</a></span> <span class="id"><a href="compcert.backend.RTL.html#node">node</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="compcert.backend.Registers.html#Reg.eq">Reg.eq</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#rs">rs</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#rd">rd</a></span><br/>
&nbsp;&nbsp;<span class="kwd">then</span> <span class="id"><a href="compcert.backend.RTLgen.html#ret">ret</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#nd">nd</a></span><br/>
&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="compcert.backend.RTLgen.html#add_instr">add_instr</a></span> (<span class="id"><a href="compcert.backend.RTL.html#Iop">Iop</a></span> <span class="id"><a href="compcert.x86.Op.html#Omove">Omove</a></span> (<span class="id"><a href="compcert.backend.RTLgen.html#rs">rs</a></span>::<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) <span class="id"><a href="compcert.backend.RTLgen.html#rd">rd</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#nd">nd</a></span>).<br/>
<br/>
<div class="doc">Translation of arguments and results of builtins. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="exprlist_of_expr_list">exprlist_of_expr_list</a></span> (<span class="id">l</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.backend.CminorSel.html#expr">expr</a></span>) : <span class="id"><a href="compcert.backend.CminorSel.html#exprlist">exprlist</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right">List.fold_right</a></span> <span class="id"><a href="compcert.backend.CminorSel.html#Econs">Econs</a></span> <span class="id"><a href="compcert.backend.CminorSel.html#Enil">Enil</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#l">l</a></span>.<br/>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="convert_builtin_arg">convert_builtin_arg</a></span> {<span class="id">A</span>: <span class="kwd">Type</span>} (<span class="id">a</span>: <span class="id"><a href="compcert.common.AST.html#builtin_arg">builtin_arg</a></span> <span class="id"><a href="compcert.backend.CminorSel.html#expr">expr</a></span>) (<span class="id">rl</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#A">A</a></span>) : <span class="id"><a href="compcert.common.AST.html#builtin_arg">builtin_arg</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#A">A</a></span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#A">A</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.backend.RTLgen.html#a">a</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.common.AST.html#BA">BA</a></span> <span class="id">a</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.backend.RTLgen.html#rl">rl</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">r</span> :: <span class="id">rs</span> =&gt; (<span class="id"><a href="compcert.common.AST.html#BA">BA</a></span> <span class="id">r</span>, <span class="id">rs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>     =&gt; (<span class="id"><a href="compcert.common.AST.html#BA_int">BA_int</a></span> <span class="id"><a href="compcert.lib.Integers.html#Int.zero">Int.zero</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)   <span class="docright">(* never happens  *)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.common.AST.html#BA_int">BA_int</a></span> <span class="id">n</span> =&gt; (<span class="id"><a href="compcert.common.AST.html#BA_int">BA_int</a></span> <span class="id">n</span>, <span class="id"><a href="compcert.backend.RTLgen.html#rl">rl</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.common.AST.html#BA_long">BA_long</a></span> <span class="id">n</span> =&gt; (<span class="id"><a href="compcert.common.AST.html#BA_long">BA_long</a></span> <span class="id">n</span>, <span class="id"><a href="compcert.backend.RTLgen.html#rl">rl</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.common.AST.html#BA_float">BA_float</a></span> <span class="id">n</span> =&gt; (<span class="id"><a href="compcert.common.AST.html#BA_float">BA_float</a></span> <span class="id">n</span>, <span class="id"><a href="compcert.backend.RTLgen.html#rl">rl</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.common.AST.html#BA_single">BA_single</a></span> <span class="id">n</span> =&gt; (<span class="id"><a href="compcert.common.AST.html#BA_single">BA_single</a></span> <span class="id">n</span>, <span class="id"><a href="compcert.backend.RTLgen.html#rl">rl</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.common.AST.html#BA_loadstack">BA_loadstack</a></span> <span class="id">chunk</span> <span class="id">ofs</span> =&gt; (<span class="id"><a href="compcert.common.AST.html#BA_loadstack">BA_loadstack</a></span> <span class="id">chunk</span> <span class="id">ofs</span>, <span class="id"><a href="compcert.backend.RTLgen.html#rl">rl</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.common.AST.html#BA_addrstack">BA_addrstack</a></span> <span class="id">ofs</span> =&gt; (<span class="id"><a href="compcert.common.AST.html#BA_addrstack">BA_addrstack</a></span> <span class="id">ofs</span>, <span class="id"><a href="compcert.backend.RTLgen.html#rl">rl</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.common.AST.html#BA_loadglobal">BA_loadglobal</a></span> <span class="id">chunk</span> <span class="id">id</span> <span class="id">ofs</span> =&gt; (<span class="id"><a href="compcert.common.AST.html#BA_loadglobal">BA_loadglobal</a></span> <span class="id">chunk</span> <span class="id">id</span> <span class="id">ofs</span>, <span class="id"><a href="compcert.backend.RTLgen.html#rl">rl</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.common.AST.html#BA_addrglobal">BA_addrglobal</a></span> <span class="id">id</span> <span class="id">ofs</span> =&gt; (<span class="id"><a href="compcert.common.AST.html#BA_addrglobal">BA_addrglobal</a></span> <span class="id">id</span> <span class="id">ofs</span>, <span class="id"><a href="compcert.backend.RTLgen.html#rl">rl</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.common.AST.html#BA_splitlong">BA_splitlong</a></span> <span class="id">hi</span> <span class="id">lo</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> (<span class="id">hi</span>', <span class="id">rl1</span>) := <span class="id"><a href="compcert.backend.RTLgen.html#convert_builtin_arg">convert_builtin_arg</a></span> <span class="id">hi</span> <span class="id"><a href="compcert.backend.RTLgen.html#rl">rl</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> (<span class="id">lo</span>', <span class="id">rl2</span>) := <span class="id"><a href="compcert.backend.RTLgen.html#convert_builtin_arg">convert_builtin_arg</a></span> <span class="id">lo</span> <span class="id"><a href="compcert.backend.RTLgen.html#rl1">rl1</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.common.AST.html#BA_splitlong">BA_splitlong</a></span> <span class="id">hi</span>' <span class="id">lo</span>', <span class="id"><a href="compcert.backend.RTLgen.html#rl2">rl2</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.common.AST.html#BA_addptr">BA_addptr</a></span> <span class="id">a1</span> <span class="id">a2</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> (<span class="id">a1</span>', <span class="id">rl1</span>) := <span class="id"><a href="compcert.backend.RTLgen.html#convert_builtin_arg">convert_builtin_arg</a></span> <span class="id">a1</span> <span class="id"><a href="compcert.backend.RTLgen.html#rl">rl</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> (<span class="id">a2</span>', <span class="id">rl2</span>) := <span class="id"><a href="compcert.backend.RTLgen.html#convert_builtin_arg">convert_builtin_arg</a></span> <span class="id">a2</span> <span class="id"><a href="compcert.backend.RTLgen.html#rl1">rl1</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.common.AST.html#BA_addptr">BA_addptr</a></span> <span class="id">a1</span>' <span class="id">a2</span>', <span class="id"><a href="compcert.backend.RTLgen.html#rl2">rl2</a></span>)<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="convert_builtin_args">convert_builtin_args</a></span> {<span class="id">A</span>: <span class="kwd">Type</span>} (<span class="id">al</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="compcert.common.AST.html#builtin_arg">builtin_arg</a></span> <span class="id"><a href="compcert.backend.CminorSel.html#expr">expr</a></span>)) (<span class="id">rl</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#A">A</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="compcert.common.AST.html#builtin_arg">builtin_arg</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#A">A</a></span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.backend.RTLgen.html#al">al</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span><br/>
&nbsp;&nbsp;| <span class="id">a1</span> :: <span class="id">al</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> (<span class="id">a1</span>', <span class="id">rl1</span>) := <span class="id"><a href="compcert.backend.RTLgen.html#convert_builtin_arg">convert_builtin_arg</a></span> <span class="id">a1</span> <span class="id"><a href="compcert.backend.RTLgen.html#rl">rl</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">a1</span>' :: <span class="id"><a href="compcert.backend.RTLgen.html#convert_builtin_args">convert_builtin_args</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#al">al</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#rl1">rl1</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="convert_builtin_res">convert_builtin_res</a></span> (<span class="id">map</span>: <span class="id"><a href="compcert.backend.RTLgen.html#mapping">mapping</a></span>) (<span class="id">oty</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="compcert.common.AST.html#typ">typ</a></span>) (<span class="id">r</span>: <span class="id"><a href="compcert.common.AST.html#builtin_res">builtin_res</a></span> <span class="id"><a href="compcert.common.AST.html#ident">ident</a></span>) : <span class="id"><a href="compcert.backend.RTLgen.html#mon">mon</a></span> (<span class="id"><a href="compcert.common.AST.html#builtin_res">builtin_res</a></span> <span class="id"><a href="compcert.backend.Registers.html#reg">reg</a></span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.backend.RTLgen.html#r">r</a></span>, <span class="id"><a href="compcert.backend.RTLgen.html#oty">oty</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.common.AST.html#BR">BR</a></span> <span class="id">id</span>, <span class="id">_</span> =&gt; <span class="tactic">do</span> <span class="id">r</span> &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#find_var">find_var</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id">id</span>; <span class="id"><a href="compcert.backend.RTLgen.html#ret">ret</a></span> (<span class="id"><a href="compcert.common.AST.html#BR">BR</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#r">r</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.common.AST.html#BR_none">BR_none</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="compcert.backend.RTLgen.html#ret">ret</a></span> <span class="id"><a href="compcert.common.AST.html#BR_none">BR_none</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.common.AST.html#BR_none">BR_none</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">_</span> =&gt; <span class="tactic">do</span> <span class="id">r</span> &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#new_reg">new_reg</a></span>; <span class="id"><a href="compcert.backend.RTLgen.html#ret">ret</a></span> (<span class="id"><a href="compcert.common.AST.html#BR">BR</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#r">r</a></span>)<br/>
&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="compcert.backend.RTLgen.html#error">error</a></span> (<span class="id"><a href="compcert.common.Errors.html#msg">Errors.msg</a></span> "<span class="id">RTLgen</span>: <span class="id">bad</span> <span class="id">builtin_res</span>")<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<div class="doc">Translation of an expression.  <span class="bracket"><span class="id">transl_expr</span> <span class="id">map</span> <span class="id">a</span> <span class="id">rd</span> <span class="id">nd</span></span>
  enriches the current CFG with the RTL instructions necessary
  to compute the value of CminorSel expression <span class="bracket"><span class="id">a</span></span>, leave its result
  in register <span class="bracket"><span class="id">rd</span></span>, and branch to node <span class="bracket"><span class="id">nd</span></span>.  It returns the node
  of the first instruction in this sequence.  <span class="bracket"><span class="id">map</span></span> is the compile-time
  translation environment. </div>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="transl_expr">transl_expr</a></span> (<span class="id">map</span>: <span class="id"><a href="compcert.backend.RTLgen.html#mapping">mapping</a></span>) (<span class="id">a</span>: <span class="id"><a href="compcert.backend.CminorSel.html#expr">expr</a></span>) (<span class="id">rd</span>: <span class="id"><a href="compcert.backend.Registers.html#reg">reg</a></span>) (<span class="id">nd</span>: <span class="id"><a href="compcert.backend.RTL.html#node">node</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="kwd">struct</span> <span class="id">a</span>}: <span class="id"><a href="compcert.backend.RTLgen.html#mon">mon</a></span> <span class="id"><a href="compcert.backend.RTL.html#node">node</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.backend.RTLgen.html#a">a</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.CminorSel.html#Evar">Evar</a></span> <span class="id">v</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">r</span> &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#find_var">find_var</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id">v</span>; <span class="id"><a href="compcert.backend.RTLgen.html#add_move">add_move</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#r">r</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#rd">rd</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#nd">nd</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.CminorSel.html#Eop">Eop</a></span> <span class="id">op</span> <span class="id">al</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">rl</span> &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#alloc_regs">alloc_regs</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id">al</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">no</span> &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#add_instr">add_instr</a></span> (<span class="id"><a href="compcert.backend.RTL.html#Iop">Iop</a></span> <span class="id">op</span> <span class="id"><a href="compcert.backend.RTLgen.html#rl">rl</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#rd">rd</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#nd">nd</a></span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.RTLgen.html#transl_exprlist">transl_exprlist</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id">al</span> <span class="id"><a href="compcert.backend.RTLgen.html#rl">rl</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#no">no</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.CminorSel.html#Eload">Eload</a></span> <span class="id">chunk</span> <span class="id">addr</span> <span class="id">al</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">rl</span> &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#alloc_regs">alloc_regs</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id">al</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">no</span> &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#add_instr">add_instr</a></span> (<span class="id"><a href="compcert.backend.RTL.html#Iload">Iload</a></span> <span class="id">chunk</span> <span class="id">addr</span> <span class="id"><a href="compcert.backend.RTLgen.html#rl">rl</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#rd">rd</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#nd">nd</a></span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.RTLgen.html#transl_exprlist">transl_exprlist</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id">al</span> <span class="id"><a href="compcert.backend.RTLgen.html#rl">rl</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#no">no</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.CminorSel.html#Econdition">Econdition</a></span> <span class="id">a</span> <span class="id">b</span> <span class="id">c</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">nfalse</span> &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#transl_expr">transl_expr</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id">c</span> <span class="id"><a href="compcert.backend.RTLgen.html#rd">rd</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#nd">nd</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">ntrue</span>  &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#transl_expr">transl_expr</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id">b</span> <span class="id"><a href="compcert.backend.RTLgen.html#rd">rd</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#nd">nd</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.RTLgen.html#transl_condexpr">transl_condexpr</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#a">a</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#ntrue">ntrue</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#nfalse">nfalse</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.CminorSel.html#Elet">Elet</a></span> <span class="id">b</span> <span class="id">c</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">r</span>  &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#new_reg">new_reg</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">nc</span> &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#transl_expr">transl_expr</a></span> (<span class="id"><a href="compcert.backend.RTLgen.html#add_letvar">add_letvar</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#r">r</a></span>) <span class="id">c</span> <span class="id"><a href="compcert.backend.RTLgen.html#rd">rd</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#nd">nd</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.RTLgen.html#transl_expr">transl_expr</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id">b</span> <span class="id"><a href="compcert.backend.RTLgen.html#r">r</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#nc">nc</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.CminorSel.html#Eletvar">Eletvar</a></span> <span class="id">n</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">r</span> &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#find_letvar">find_letvar</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id">n</span>; <span class="id"><a href="compcert.backend.RTLgen.html#add_move">add_move</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#r">r</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#rd">rd</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#nd">nd</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.CminorSel.html#Ebuiltin">Ebuiltin</a></span> <span class="id">ef</span> <span class="id">al</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">rl</span> &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#alloc_regs">alloc_regs</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id">al</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">no</span> &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#add_instr">add_instr</a></span> (<span class="id"><a href="compcert.backend.RTL.html#Ibuiltin">Ibuiltin</a></span> <span class="id">ef</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (@<span class="id"><a href="compcert.common.AST.html#BA">BA</a></span> <span class="id"><a href="compcert.backend.Registers.html#reg">reg</a></span>) <span class="id"><a href="compcert.backend.RTLgen.html#rl">rl</a></span>) (<span class="id"><a href="compcert.common.AST.html#BR">BR</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#rd">rd</a></span>) <span class="id"><a href="compcert.backend.RTLgen.html#nd">nd</a></span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.RTLgen.html#transl_exprlist">transl_exprlist</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id">al</span> <span class="id"><a href="compcert.backend.RTLgen.html#rl">rl</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#no">no</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.CminorSel.html#Eexternal">Eexternal</a></span> <span class="id">id</span> <span class="id">sg</span> <span class="id">al</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">rl</span> &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#alloc_regs">alloc_regs</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id">al</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">no</span> &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#add_instr">add_instr</a></span> (<span class="id"><a href="compcert.backend.RTL.html#Icall">Icall</a></span> <span class="id">sg</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#inr">inr</a></span> <span class="id">id</span>) <span class="id"><a href="compcert.backend.RTLgen.html#rl">rl</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#rd">rd</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#nd">nd</a></span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.RTLgen.html#transl_exprlist">transl_exprlist</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id">al</span> <span class="id"><a href="compcert.backend.RTLgen.html#rl">rl</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#no">no</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span><br/>
<br/>
<div class="doc">Translation of a list of expressions.  The expressions are evaluated
  left-to-right, and their values stored in the given list of registers. </div>
<br/>
<span class="kwd">with</span> <span class="id"><a name="transl_exprlist">transl_exprlist</a></span> (<span class="id">map</span>: <span class="id"><a href="compcert.backend.RTLgen.html#mapping">mapping</a></span>) (<span class="id">al</span>: <span class="id"><a href="compcert.backend.CminorSel.html#exprlist">exprlist</a></span>) (<span class="id">rl</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.backend.Registers.html#reg">reg</a></span>) (<span class="id">nd</span>: <span class="id"><a href="compcert.backend.RTL.html#node">node</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="kwd">struct</span> <span class="id">al</span>} : <span class="id"><a href="compcert.backend.RTLgen.html#mon">mon</a></span> <span class="id"><a href="compcert.backend.RTL.html#node">node</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.backend.RTLgen.html#al">al</a></span>, <span class="id"><a href="compcert.backend.RTLgen.html#rl">rl</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.CminorSel.html#Enil">Enil</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.RTLgen.html#ret">ret</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#nd">nd</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.CminorSel.html#Econs">Econs</a></span> <span class="id">b</span> <span class="id">bs</span>, <span class="id">r</span> :: <span class="id">rs</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">no</span> &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#transl_exprlist">transl_exprlist</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id">bs</span> <span class="id">rs</span> <span class="id"><a href="compcert.backend.RTLgen.html#nd">nd</a></span>; <span class="id"><a href="compcert.backend.RTLgen.html#transl_expr">transl_expr</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id">b</span> <span class="id">r</span> <span class="id"><a href="compcert.backend.RTLgen.html#no">no</a></span><br/>
&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.RTLgen.html#error">error</a></span> (<span class="id"><a href="compcert.common.Errors.html#msg">Errors.msg</a></span> "<span class="id">RTLgen.transl_exprlist</span>")<br/>
&nbsp;&nbsp;<span class="kwd">end</span><br/>
<br/>
<div class="doc">Translation of a conditional expression.  Branches to <span class="bracket"><span class="id">ntrue</span></span> or
  to <span class="bracket"><span class="id">nfalse</span></span> depending on the truth value of the expression. </div>
<br/>
<span class="kwd">with</span> <span class="id"><a name="transl_condexpr">transl_condexpr</a></span> (<span class="id">map</span>: <span class="id"><a href="compcert.backend.RTLgen.html#mapping">mapping</a></span>) (<span class="id">a</span>: <span class="id"><a href="compcert.backend.CminorSel.html#condexpr">condexpr</a></span>) (<span class="id">ntrue</span> <span class="id">nfalse</span>: <span class="id"><a href="compcert.backend.RTL.html#node">node</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="kwd">struct</span> <span class="id">a</span>} : <span class="id"><a href="compcert.backend.RTLgen.html#mon">mon</a></span> <span class="id"><a href="compcert.backend.RTL.html#node">node</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.backend.RTLgen.html#a">a</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.CminorSel.html#CEcond">CEcond</a></span> <span class="id">c</span> <span class="id">al</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">rl</span> &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#alloc_regs">alloc_regs</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id">al</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">nt</span> &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#add_instr">add_instr</a></span> (<span class="id"><a href="compcert.backend.RTL.html#Icond">Icond</a></span> <span class="id">c</span> <span class="id"><a href="compcert.backend.RTLgen.html#rl">rl</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#ntrue">ntrue</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#nfalse">nfalse</a></span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.RTLgen.html#transl_exprlist">transl_exprlist</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id">al</span> <span class="id"><a href="compcert.backend.RTLgen.html#rl">rl</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#nt">nt</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.CminorSel.html#CEcondition">CEcondition</a></span> <span class="id">a</span> <span class="id">b</span> <span class="id">c</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">nc</span> &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#transl_condexpr">transl_condexpr</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id">c</span> <span class="id"><a href="compcert.backend.RTLgen.html#ntrue">ntrue</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#nfalse">nfalse</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">nb</span> &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#transl_condexpr">transl_condexpr</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id">b</span> <span class="id"><a href="compcert.backend.RTLgen.html#ntrue">ntrue</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#nfalse">nfalse</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.RTLgen.html#transl_condexpr">transl_condexpr</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#a">a</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#nb">nb</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#nc">nc</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.CminorSel.html#CElet">CElet</a></span> <span class="id">b</span> <span class="id">c</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">r</span>  &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#new_reg">new_reg</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">nc</span> &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#transl_condexpr">transl_condexpr</a></span> (<span class="id"><a href="compcert.backend.RTLgen.html#add_letvar">add_letvar</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#r">r</a></span>) <span class="id">c</span> <span class="id"><a href="compcert.backend.RTLgen.html#ntrue">ntrue</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#nfalse">nfalse</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.RTLgen.html#transl_expr">transl_expr</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id">b</span> <span class="id"><a href="compcert.backend.RTLgen.html#r">r</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#nc">nc</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<div class="doc">Auxiliary for translating exit expressions. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="transl_exit">transl_exit</a></span> (<span class="id">nexits</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.backend.RTL.html#node">node</a></span>) (<span class="id">n</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) : <span class="id"><a href="compcert.backend.RTLgen.html#mon">mon</a></span> <span class="id"><a href="compcert.backend.RTL.html#node">node</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth_error">nth_error</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#nexits">nexits</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#n">n</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="compcert.backend.RTLgen.html#error">error</a></span> (<span class="id"><a href="compcert.common.Errors.html#msg">Errors.msg</a></span> "<span class="id">RTLgen</span>: <span class="id">wrong</span> <span class="id">exit</span>")<br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ne</span> =&gt; <span class="id"><a href="compcert.backend.RTLgen.html#ret">ret</a></span> <span class="id">ne</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="transl_jumptable">transl_jumptable</a></span> (<span class="id">nexits</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.backend.RTL.html#node">node</a></span>) (<span class="id">tbl</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat">nat</a></span>) : <span class="id"><a href="compcert.backend.RTLgen.html#mon">mon</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.backend.RTL.html#node">node</a></span>) :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.backend.RTLgen.html#tbl">tbl</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; <span class="id"><a href="compcert.backend.RTLgen.html#ret">ret</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span><br/>
&nbsp;&nbsp;| <span class="id">t1</span> :: <span class="id">tl</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">n1</span> &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#transl_exit">transl_exit</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#nexits">nexits</a></span> <span class="id">t1</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">nl</span> &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#transl_jumptable">transl_jumptable</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#nexits">nexits</a></span> <span class="id">tl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.RTLgen.html#ret">ret</a></span> (<span class="id"><a href="compcert.backend.RTLgen.html#n1">n1</a></span> :: <span class="id"><a href="compcert.backend.RTLgen.html#nl">nl</a></span>)<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<div class="doc">Translation of an exit expression.  Branches to the node corresponding
  to the exit number denoted by the expression. </div>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="transl_exitexpr">transl_exitexpr</a></span> (<span class="id">map</span>: <span class="id"><a href="compcert.backend.RTLgen.html#mapping">mapping</a></span>) (<span class="id">a</span>: <span class="id"><a href="compcert.backend.CminorSel.html#exitexpr">exitexpr</a></span>) (<span class="id">nexits</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.backend.RTL.html#node">node</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="kwd">struct</span> <span class="id">a</span>} : <span class="id"><a href="compcert.backend.RTLgen.html#mon">mon</a></span> <span class="id"><a href="compcert.backend.RTL.html#node">node</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.backend.RTLgen.html#a">a</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.CminorSel.html#XEexit">XEexit</a></span> <span class="id">n</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.RTLgen.html#transl_exit">transl_exit</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#nexits">nexits</a></span> <span class="id">n</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.CminorSel.html#XEjumptable">XEjumptable</a></span> <span class="id">a</span> <span class="id">tbl</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">r</span> &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#alloc_reg">alloc_reg</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#a">a</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">tbl</span>' &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#transl_jumptable">transl_jumptable</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#nexits">nexits</a></span> <span class="id">tbl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">n1</span> &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#add_instr">add_instr</a></span> (<span class="id"><a href="compcert.backend.RTL.html#Ijumptable">Ijumptable</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#r">r</a></span> <span class="id">tbl</span>');<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.RTLgen.html#transl_expr">transl_expr</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#a">a</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#r">r</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#n1">n1</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.CminorSel.html#XEcondition">XEcondition</a></span> <span class="id">a</span> <span class="id">b</span> <span class="id">c</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">nc</span> &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#transl_exitexpr">transl_exitexpr</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id">c</span> <span class="id"><a href="compcert.backend.RTLgen.html#nexits">nexits</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">nb</span> &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#transl_exitexpr">transl_exitexpr</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id">b</span> <span class="id"><a href="compcert.backend.RTLgen.html#nexits">nexits</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.RTLgen.html#transl_condexpr">transl_condexpr</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#a">a</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#nb">nb</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#nc">nc</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.CminorSel.html#XElet">XElet</a></span> <span class="id">a</span> <span class="id">b</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">r</span>  &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#new_reg">new_reg</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">n1</span> &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#transl_exitexpr">transl_exitexpr</a></span> (<span class="id"><a href="compcert.backend.RTLgen.html#add_letvar">add_letvar</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#r">r</a></span>) <span class="id">b</span> <span class="id"><a href="compcert.backend.RTLgen.html#nexits">nexits</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.RTLgen.html#transl_expr">transl_expr</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#a">a</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#r">r</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#n1">n1</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<div class="doc">Auxiliary for branch prediction.  When compiling an if/then/else
  statement, we have a choice between translating the ``then'' branch
  first or the ``else'' branch first.  Linearization of RTL control-flow
  graph, performed later, will exploit this choice as a hint about
  which branch is most frequently executed.  However, this choice has
  no impact on program correctness.  We delegate the choice to an
  external heuristic (written in OCaml), declared below.  </div>
<br/>
<span class="kwd">Parameter</span> <span class="id"><a name="more_likely">more_likely</a></span>: <span class="id"><a href="compcert.backend.CminorSel.html#condexpr">condexpr</a></span> -&gt; <span class="id"><a href="compcert.backend.CminorSel.html#stmt">stmt</a></span> -&gt; <span class="id"><a href="compcert.backend.CminorSel.html#stmt">stmt</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool">bool</a></span>.<br/>
<br/>
<div class="doc">Translation of statements.  <span class="bracket"><span class="id">transl_stmt</span> <span class="id">map</span> <span class="id">s</span> <span class="id">nd</span> <span class="id">nexits</span> <span class="id">nret</span> <span class="id">rret</span></span>
  enriches the current CFG with the RTL instructions necessary to
  execute the CminorSel statement <span class="bracket"><span class="id">s</span></span>, and returns the node of the first
  instruction in this sequence.  The generated instructions continue
  at node <span class="bracket"><span class="id">nd</span></span> if the statement terminates normally, at node <span class="bracket"><span class="id">nret</span></span>
  if it terminates by early return, and at the <span class="bracket"><span class="id">n</span></span>-th node in the list
  <span class="bracket"><span class="id">nlist</span></span> if it terminates by an <span class="bracket"><span class="id">exit</span> <span class="id">n</span></span> construct.  <span class="bracket"><span class="id">rret</span></span> is the
  register where the return value of the function must be stored, if any. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="labelmap">labelmap</a></span> : <span class="kwd">Type</span> := <span class="id"><a href="compcert.lib.Maps.html#PTree.t">PTree.t</a></span> <span class="id"><a href="compcert.backend.RTL.html#node">node</a></span>.<br/>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="transl_stmt">transl_stmt</a></span> (<span class="id">map</span>: <span class="id"><a href="compcert.backend.RTLgen.html#mapping">mapping</a></span>) (<span class="id">s</span>: <span class="id"><a href="compcert.backend.CminorSel.html#stmt">stmt</a></span>) (<span class="id">nd</span>: <span class="id"><a href="compcert.backend.RTL.html#node">node</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">nexits</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.backend.RTL.html#node">node</a></span>) (<span class="id">ngoto</span>: <span class="id"><a href="compcert.backend.RTLgen.html#labelmap">labelmap</a></span>) (<span class="id">nret</span>: <span class="id"><a href="compcert.backend.RTL.html#node">node</a></span>) (<span class="id">rret</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="compcert.backend.Registers.html#reg">reg</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="kwd">struct</span> <span class="id">s</span>} : <span class="id"><a href="compcert.backend.RTLgen.html#mon">mon</a></span> <span class="id"><a href="compcert.backend.RTL.html#node">node</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.CminorSel.html#Sskip">Sskip</a></span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.RTLgen.html#ret">ret</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#nd">nd</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.CminorSel.html#Sassign">Sassign</a></span> <span class="id">v</span> <span class="id">b</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">r</span> &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#find_var">find_var</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id">v</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.RTLgen.html#transl_expr">transl_expr</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id">b</span> <span class="id"><a href="compcert.backend.RTLgen.html#r">r</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#nd">nd</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.CminorSel.html#Sstore">Sstore</a></span> <span class="id">chunk</span> <span class="id">addr</span> <span class="id">al</span> <span class="id">b</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">rl</span> &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#alloc_regs">alloc_regs</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id">al</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">r</span> &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#alloc_reg">alloc_reg</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id">b</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">no</span> &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#add_instr">add_instr</a></span> (<span class="id"><a href="compcert.backend.RTL.html#Istore">Istore</a></span> <span class="id">chunk</span> <span class="id">addr</span> <span class="id"><a href="compcert.backend.RTLgen.html#rl">rl</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#r">r</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#nd">nd</a></span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">ns</span> &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#transl_expr">transl_expr</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id">b</span> <span class="id"><a href="compcert.backend.RTLgen.html#r">r</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#no">no</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.RTLgen.html#transl_exprlist">transl_exprlist</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id">al</span> <span class="id"><a href="compcert.backend.RTLgen.html#rl">rl</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#ns">ns</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.CminorSel.html#Scall">Scall</a></span> <span class="id">optid</span> <span class="id">sig</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#inl">inl</a></span> <span class="id">b</span>) <span class="id">cl</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">rf</span> &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#alloc_reg">alloc_reg</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id">b</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">rargs</span> &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#alloc_regs">alloc_regs</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id">cl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">r</span> &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#alloc_optreg">alloc_optreg</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id">optid</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">n1</span> &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#add_instr">add_instr</a></span> (<span class="id"><a href="compcert.backend.RTL.html#Icall">Icall</a></span> <span class="id">sig</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#inl">inl</a></span> <span class="id">_</span> <span class="id"><a href="compcert.backend.RTLgen.html#rf">rf</a></span>) <span class="id"><a href="compcert.backend.RTLgen.html#rargs">rargs</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#r">r</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#nd">nd</a></span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">n2</span> &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#transl_exprlist">transl_exprlist</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id">cl</span> <span class="id"><a href="compcert.backend.RTLgen.html#rargs">rargs</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#n1">n1</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.RTLgen.html#transl_expr">transl_expr</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id">b</span> <span class="id"><a href="compcert.backend.RTLgen.html#rf">rf</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#n2">n2</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.CminorSel.html#Scall">Scall</a></span> <span class="id">optid</span> <span class="id">sig</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#inr">inr</a></span> <span class="id">id</span>) <span class="id">cl</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">rargs</span> &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#alloc_regs">alloc_regs</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id">cl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">r</span> &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#alloc_optreg">alloc_optreg</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id">optid</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">n1</span> &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#add_instr">add_instr</a></span> (<span class="id"><a href="compcert.backend.RTL.html#Icall">Icall</a></span> <span class="id">sig</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#inr">inr</a></span> <span class="id">_</span> <span class="id">id</span>) <span class="id"><a href="compcert.backend.RTLgen.html#rargs">rargs</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#r">r</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#nd">nd</a></span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.RTLgen.html#transl_exprlist">transl_exprlist</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id">cl</span> <span class="id"><a href="compcert.backend.RTLgen.html#rargs">rargs</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#n1">n1</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.CminorSel.html#Stailcall">Stailcall</a></span> <span class="id">sig</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#inl">inl</a></span> <span class="id">b</span>) <span class="id">cl</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">rf</span> &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#alloc_reg">alloc_reg</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id">b</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">rargs</span> &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#alloc_regs">alloc_regs</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id">cl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">n1</span> &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#add_instr">add_instr</a></span> (<span class="id"><a href="compcert.backend.RTL.html#Itailcall">Itailcall</a></span> <span class="id">sig</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#inl">inl</a></span> <span class="id">_</span> <span class="id"><a href="compcert.backend.RTLgen.html#rf">rf</a></span>) <span class="id"><a href="compcert.backend.RTLgen.html#rargs">rargs</a></span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">n2</span> &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#transl_exprlist">transl_exprlist</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id">cl</span> <span class="id"><a href="compcert.backend.RTLgen.html#rargs">rargs</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#n1">n1</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.RTLgen.html#transl_expr">transl_expr</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id">b</span> <span class="id"><a href="compcert.backend.RTLgen.html#rf">rf</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#n2">n2</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.CminorSel.html#Stailcall">Stailcall</a></span> <span class="id">sig</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#inr">inr</a></span> <span class="id">id</span>) <span class="id">cl</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">rargs</span> &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#alloc_regs">alloc_regs</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id">cl</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">n1</span> &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#add_instr">add_instr</a></span> (<span class="id"><a href="compcert.backend.RTL.html#Itailcall">Itailcall</a></span> <span class="id">sig</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#inr">inr</a></span> <span class="id">_</span> <span class="id">id</span>) <span class="id"><a href="compcert.backend.RTLgen.html#rargs">rargs</a></span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.RTLgen.html#transl_exprlist">transl_exprlist</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id">cl</span> <span class="id"><a href="compcert.backend.RTLgen.html#rargs">rargs</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#n1">n1</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.CminorSel.html#Sbuiltin">Sbuiltin</a></span> <span class="id">res</span> <span class="id">ef</span> <span class="id">args</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">al</span> := <span class="id"><a href="compcert.backend.RTLgen.html#exprlist_of_expr_list">exprlist_of_expr_list</a></span> (<span class="id"><a href="compcert.common.AST.html#params_of_builtin_args">params_of_builtin_args</a></span> <span class="id">args</span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">rargs</span> &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#alloc_regs">alloc_regs</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#al">al</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">args</span>' := <span class="id"><a href="compcert.backend.RTLgen.html#convert_builtin_args">convert_builtin_args</a></span> <span class="id">args</span> <span class="id"><a href="compcert.backend.RTLgen.html#rargs">rargs</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">res</span>' &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#convert_builtin_res">convert_builtin_res</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> (<span class="id"><a href="compcert.common.AST.html#sig_res">sig_res</a></span> (<span class="id"><a href="compcert.common.AST.html#ef_sig">ef_sig</a></span> <span class="id">ef</span>)) <span class="id">res</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">n1</span> &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#add_instr">add_instr</a></span> (<span class="id"><a href="compcert.backend.RTL.html#Ibuiltin">Ibuiltin</a></span> <span class="id">ef</span> <span class="id">args</span>' <span class="id">res</span>' <span class="id"><a href="compcert.backend.RTLgen.html#nd">nd</a></span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.RTLgen.html#transl_exprlist">transl_exprlist</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#al">al</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#rargs">rargs</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#n1">n1</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.CminorSel.html#Sseq">Sseq</a></span> <span class="id">s1</span> <span class="id">s2</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">ns</span> &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#transl_stmt">transl_stmt</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id">s2</span> <span class="id"><a href="compcert.backend.RTLgen.html#nd">nd</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#nexits">nexits</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#ngoto">ngoto</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#nret">nret</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#rret">rret</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.RTLgen.html#transl_stmt">transl_stmt</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id">s1</span> <span class="id"><a href="compcert.backend.RTLgen.html#ns">ns</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#nexits">nexits</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#ngoto">ngoto</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#nret">nret</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#rret">rret</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.CminorSel.html#Sifthenelse">Sifthenelse</a></span> <span class="id">c</span> <span class="id">strue</span> <span class="id">sfalse</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">if</span> <span class="id"><a href="compcert.backend.RTLgen.html#more_likely">more_likely</a></span> <span class="id">c</span> <span class="id">strue</span> <span class="id">sfalse</span> <span class="kwd">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">nfalse</span> &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#transl_stmt">transl_stmt</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id">sfalse</span> <span class="id"><a href="compcert.backend.RTLgen.html#nd">nd</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#nexits">nexits</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#ngoto">ngoto</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#nret">nret</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#rret">rret</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">ntrue</span>  &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#transl_stmt">transl_stmt</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id">strue</span>  <span class="id"><a href="compcert.backend.RTLgen.html#nd">nd</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#nexits">nexits</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#ngoto">ngoto</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#nret">nret</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#rret">rret</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.RTLgen.html#transl_condexpr">transl_condexpr</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id">c</span> <span class="id"><a href="compcert.backend.RTLgen.html#ntrue">ntrue</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#nfalse">nfalse</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">ntrue</span>  &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#transl_stmt">transl_stmt</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id">strue</span>  <span class="id"><a href="compcert.backend.RTLgen.html#nd">nd</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#nexits">nexits</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#ngoto">ngoto</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#nret">nret</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#rret">rret</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">nfalse</span> &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#transl_stmt">transl_stmt</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id">sfalse</span> <span class="id"><a href="compcert.backend.RTLgen.html#nd">nd</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#nexits">nexits</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#ngoto">ngoto</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#nret">nret</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#rret">rret</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.RTLgen.html#transl_condexpr">transl_condexpr</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id">c</span> <span class="id"><a href="compcert.backend.RTLgen.html#ntrue">ntrue</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#nfalse">nfalse</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.CminorSel.html#Sloop">Sloop</a></span> <span class="id">sbody</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">n1</span> &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#reserve_instr">reserve_instr</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">n2</span> &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#transl_stmt">transl_stmt</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id">sbody</span> <span class="id"><a href="compcert.backend.RTLgen.html#n1">n1</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#nexits">nexits</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#ngoto">ngoto</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#nret">nret</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#rret">rret</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">xx</span> &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#update_instr">update_instr</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#n1">n1</a></span> (<span class="id"><a href="compcert.backend.RTL.html#Inop">Inop</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#n2">n2</a></span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.RTLgen.html#add_instr">add_instr</a></span> (<span class="id"><a href="compcert.backend.RTL.html#Inop">Inop</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#n2">n2</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.CminorSel.html#Sblock">Sblock</a></span> <span class="id">sbody</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.RTLgen.html#transl_stmt">transl_stmt</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id">sbody</span> <span class="id"><a href="compcert.backend.RTLgen.html#nd">nd</a></span> (<span class="id"><a href="compcert.backend.RTLgen.html#nd">nd</a></span> :: <span class="id"><a href="compcert.backend.RTLgen.html#nexits">nexits</a></span>) <span class="id"><a href="compcert.backend.RTLgen.html#ngoto">ngoto</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#nret">nret</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#rret">rret</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.CminorSel.html#Sexit">Sexit</a></span> <span class="id">n</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.RTLgen.html#transl_exit">transl_exit</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#nexits">nexits</a></span> <span class="id">n</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.CminorSel.html#Sswitch">Sswitch</a></span> <span class="id">a</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.RTLgen.html#transl_exitexpr">transl_exitexpr</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id">a</span> <span class="id"><a href="compcert.backend.RTLgen.html#nexits">nexits</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.CminorSel.html#Sreturn">Sreturn</a></span> <span class="id">opt_a</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">opt_a</span>, <span class="id"><a href="compcert.backend.RTLgen.html#rret">rret</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span>, <span class="id">_</span> =&gt; <span class="id"><a href="compcert.backend.RTLgen.html#ret">ret</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#nret">nret</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">a</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">r</span> =&gt; <span class="id"><a href="compcert.backend.RTLgen.html#transl_expr">transl_expr</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id">a</span> <span class="id">r</span> <span class="id"><a href="compcert.backend.RTLgen.html#nret">nret</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="compcert.backend.RTLgen.html#error">error</a></span> (<span class="id"><a href="compcert.common.Errors.html#msg">Errors.msg</a></span> "<span class="id">RTLgen</span>: <span class="id">type</span> <span class="id">mismatch</span> <span class="id">on</span> <span class="kwd">return</span>")<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.CminorSel.html#Slabel">Slabel</a></span> <span class="id">lbl</span> <span class="id">s</span>' =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">ns</span> &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#transl_stmt">transl_stmt</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span> <span class="id">s</span>' <span class="id"><a href="compcert.backend.RTLgen.html#nd">nd</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#nexits">nexits</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#ngoto">ngoto</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#nret">nret</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#rret">rret</a></span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.backend.RTLgen.html#ngoto">ngoto</a></span>!<span class="id">lbl</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="compcert.backend.RTLgen.html#error">error</a></span> (<span class="id"><a href="compcert.common.Errors.html#msg">Errors.msg</a></span> "<span class="id">RTLgen</span>: <span class="id">unbound</span> <span class="id">label</span>")<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">n</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">xx</span> &lt;-<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.RTLgen.html#handle_error">handle_error</a></span> (<span class="id"><a href="compcert.backend.RTLgen.html#update_instr">update_instr</a></span> <span class="id">n</span> (<span class="id"><a href="compcert.backend.RTL.html#Inop">Inop</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#ns">ns</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.RTLgen.html#error">error</a></span> (<span class="id"><a href="compcert.common.Errors.html#MSG">Errors.MSG</a></span> "<span class="id">Multiply</span>-<span class="id">defined</span> <span class="id">label</span> " ::<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Errors.html#CTX">Errors.CTX</a></span> <span class="id">lbl</span> :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.RTLgen.html#ret">ret</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#ns">ns</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.CminorSel.html#Sgoto">Sgoto</a></span> <span class="id">lbl</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.backend.RTLgen.html#ngoto">ngoto</a></span>!<span class="id">lbl</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="compcert.backend.RTLgen.html#error">error</a></span> (<span class="id"><a href="compcert.common.Errors.html#MSG">Errors.MSG</a></span> "<span class="id">Undefined</span> <span class="id">defined</span> <span class="id">label</span> " ::<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Errors.html#CTX">Errors.CTX</a></span> <span class="id">lbl</span> :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">n</span> =&gt; <span class="id"><a href="compcert.backend.RTLgen.html#ret">ret</a></span> <span class="id">n</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<div class="doc">Preallocate CFG nodes for each label defined in the function body. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="alloc_label">alloc_label</a></span> (<span class="id">lbl</span>: <span class="id"><a href="compcert.backend.Cminor.html#label">Cminor.label</a></span>) (<span class="id">maps</span>: <span class="id"><a href="compcert.backend.RTLgen.html#labelmap">labelmap</a></span> * <span class="id"><a href="compcert.backend.RTLgen.html#state">state</a></span>) : <span class="id"><a href="compcert.backend.RTLgen.html#labelmap">labelmap</a></span> * <span class="id"><a href="compcert.backend.RTLgen.html#state">state</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> (<span class="id">map</span>, <span class="id">s</span>) := <span class="id"><a href="compcert.backend.RTLgen.html#maps">maps</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">n</span> := <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.RTLgen.html#st_nextnode">st_nextnode</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.lib.Maps.html#PTree.set">PTree.set</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#lbl">lbl</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#n">n</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map">map</a></span>,<br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.RTLgen.html#mkstate">mkstate</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.RTLgen.html#st_nextreg">st_nextreg</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.succ">Pos.succ</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.RTLgen.html#st_nextnode">st_nextnode</a></span>)) <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.RTLgen.html#st_code">st_code</a></span>) (<span class="id"><a href="compcert.backend.RTLgen.html#reserve_instr_wf">reserve_instr_wf</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span>)).<br/>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="reserve_labels">reserve_labels</a></span> (<span class="id">s</span>: <span class="id"><a href="compcert.backend.CminorSel.html#stmt">stmt</a></span>) (<span class="id">ms</span>: <span class="id"><a href="compcert.backend.RTLgen.html#labelmap">labelmap</a></span> * <span class="id"><a href="compcert.backend.RTLgen.html#state">state</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="kwd">struct</span> <span class="id">s</span>} : <span class="id"><a href="compcert.backend.RTLgen.html#labelmap">labelmap</a></span> * <span class="id"><a href="compcert.backend.RTLgen.html#state">state</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.backend.RTLgen.html#s">s</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.CminorSel.html#Sseq">Sseq</a></span> <span class="id">s1</span> <span class="id">s2</span> =&gt; <span class="id"><a href="compcert.backend.RTLgen.html#reserve_labels">reserve_labels</a></span> <span class="id">s1</span> (<span class="id"><a href="compcert.backend.RTLgen.html#reserve_labels">reserve_labels</a></span> <span class="id">s2</span> <span class="id"><a href="compcert.backend.RTLgen.html#ms">ms</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.CminorSel.html#Sifthenelse">Sifthenelse</a></span> <span class="id">c</span> <span class="id">s1</span> <span class="id">s2</span> =&gt; <span class="id"><a href="compcert.backend.RTLgen.html#reserve_labels">reserve_labels</a></span> <span class="id">s1</span> (<span class="id"><a href="compcert.backend.RTLgen.html#reserve_labels">reserve_labels</a></span> <span class="id">s2</span> <span class="id"><a href="compcert.backend.RTLgen.html#ms">ms</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.CminorSel.html#Sloop">Sloop</a></span> <span class="id">s1</span> =&gt; <span class="id"><a href="compcert.backend.RTLgen.html#reserve_labels">reserve_labels</a></span> <span class="id">s1</span> <span class="id"><a href="compcert.backend.RTLgen.html#ms">ms</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.CminorSel.html#Sblock">Sblock</a></span> <span class="id">s1</span> =&gt; <span class="id"><a href="compcert.backend.RTLgen.html#reserve_labels">reserve_labels</a></span> <span class="id">s1</span> <span class="id"><a href="compcert.backend.RTLgen.html#ms">ms</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.CminorSel.html#Slabel">Slabel</a></span> <span class="id">lbl</span> <span class="id">s1</span> =&gt; <span class="id"><a href="compcert.backend.RTLgen.html#alloc_label">alloc_label</a></span> <span class="id">lbl</span> (<span class="id"><a href="compcert.backend.RTLgen.html#reserve_labels">reserve_labels</a></span> <span class="id">s1</span> <span class="id"><a href="compcert.backend.RTLgen.html#ms">ms</a></span>)<br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id"><a href="compcert.backend.RTLgen.html#ms">ms</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<div class="doc">Translation of a CminorSel function. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="ret_reg">ret_reg</a></span> (<span class="id">sig</span>: <span class="id"><a href="compcert.common.AST.html#signature">signature</a></span>) (<span class="id">rd</span>: <span class="id"><a href="compcert.backend.Registers.html#reg">reg</a></span>) : <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#option">option</a></span> <span class="id"><a href="compcert.backend.Registers.html#reg">reg</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.backend.RTLgen.html#sig">sig</a></span>.(<span class="id"><a href="compcert.common.AST.html#sig_res">sig_res</a></span>) <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">ty</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#rd">rd</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="transl_fun">transl_fun</a></span> (<span class="id">f</span>: <span class="id"><a href="compcert.backend.CminorSel.html#function">CminorSel.function</a></span>) (<span class="id">ngoto</span>: <span class="id"><a href="compcert.backend.RTLgen.html#labelmap">labelmap</a></span>): <span class="id"><a href="compcert.backend.RTLgen.html#mon">mon</a></span> (<span class="id"><a href="compcert.backend.RTL.html#node">node</a></span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.backend.Registers.html#reg">reg</a></span>) :=<br/>
&nbsp;&nbsp;<span class="tactic">do</span> (<span class="id">rparams</span>, <span class="id">map1</span>) &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#add_vars">add_vars</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#init_mapping">init_mapping</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#f">f</a></span>.(<span class="id"><a href="compcert.backend.CminorSel.html#fn_params">CminorSel.fn_params</a></span>);<br/>
&nbsp;&nbsp;<span class="tactic">do</span> (<span class="id">rvars</span>, <span class="id">map2</span>) &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#add_vars">add_vars</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map1">map1</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#f">f</a></span>.(<span class="id"><a href="compcert.backend.CminorSel.html#fn_vars">CminorSel.fn_vars</a></span>);<br/>
&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">rret</span> &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#new_reg">new_reg</a></span>;<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">orret</span> := <span class="id"><a href="compcert.backend.RTLgen.html#ret_reg">ret_reg</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#f">f</a></span>.(<span class="id"><a href="compcert.backend.CminorSel.html#fn_sig">CminorSel.fn_sig</a></span>) <span class="id"><a href="compcert.backend.RTLgen.html#rret">rret</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">nret</span> &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#add_instr">add_instr</a></span> (<span class="id"><a href="compcert.backend.RTL.html#Ireturn">Ireturn</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#orret">orret</a></span>);<br/>
&nbsp;&nbsp;<span class="tactic">do</span> <span class="id">nentry</span> &lt;- <span class="id"><a href="compcert.backend.RTLgen.html#transl_stmt">transl_stmt</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#map2">map2</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#f">f</a></span>.(<span class="id"><a href="compcert.backend.CminorSel.html#fn_body">CminorSel.fn_body</a></span>) <span class="id"><a href="compcert.backend.RTLgen.html#nret">nret</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#ngoto">ngoto</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#nret">nret</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#orret">orret</a></span>;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.RTLgen.html#ret">ret</a></span> (<span class="id"><a href="compcert.backend.RTLgen.html#nentry">nentry</a></span>, <span class="id"><a href="compcert.backend.RTLgen.html#rparams">rparams</a></span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="transl_function">transl_function</a></span> (<span class="id">f</span>: <span class="id"><a href="compcert.backend.CminorSel.html#function">CminorSel.function</a></span>) : <span class="id"><a href="compcert.common.Errors.html#res">Errors.res</a></span> <span class="id"><a href="compcert.backend.RTL.html#function">RTL.function</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">let</span> (<span class="id">ngoto</span>, <span class="id">s0</span>) := <span class="id"><a href="compcert.backend.RTLgen.html#reserve_labels">reserve_labels</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#f">f</a></span>.(<span class="id"><a href="compcert.backend.CminorSel.html#fn_body">fn_body</a></span>) (<span class="id"><a href="compcert.lib.Maps.html#PTree.empty">PTree.empty</a></span> <span class="id"><a href="compcert.backend.RTL.html#node">node</a></span>, <span class="id"><a href="compcert.backend.RTLgen.html#init_state">init_state</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.backend.RTLgen.html#transl_fun">transl_fun</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#f">f</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#ngoto">ngoto</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#s0">s0</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.RTLgen.html#Error">Error</a></span> <span class="id">msg</span> =&gt; <span class="id"><a href="compcert.common.Errors.html#Error">Errors.Error</a></span> <span class="id">msg</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.RTLgen.html#OK">OK</a></span> (<span class="id">nentry</span>, <span class="id">rparams</span>) <span class="id">s</span> <span class="id">i</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Errors.html#OK">Errors.OK</a></span> (<span class="id"><a href="compcert.backend.RTL.html#mkfunction">RTL.mkfunction</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.RTLgen.html#f">f</a></span>.(<span class="id"><a href="compcert.backend.CminorSel.html#fn_sig">CminorSel.fn_sig</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">rparams</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.RTLgen.html#f">f</a></span>.(<span class="id"><a href="compcert.backend.CminorSel.html#fn_stackspace">CminorSel.fn_stackspace</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">s</span>.(<span class="id"><a href="compcert.backend.RTLgen.html#st_code">st_code</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">nentry</span>)<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="transl_fundef">transl_fundef</a></span> := <span class="id"><a href="compcert.common.AST.html#transf_partial_fundef">transf_partial_fundef</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#transl_function">transl_function</a></span>.<br/>
<br/>
<div class="doc">Translation of a whole program. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="transl_program">transl_program</a></span> (<span class="id">p</span>: <span class="id"><a href="compcert.backend.CminorSel.html#program">CminorSel.program</a></span>) : <span class="id"><a href="compcert.common.Errors.html#res">Errors.res</a></span> <span class="id"><a href="compcert.backend.RTL.html#program">RTL.program</a></span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.AST.html#transform_partial_program">transform_partial_program</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#transl_fundef">transl_fundef</a></span> <span class="id"><a href="compcert.backend.RTLgen.html#p">p</a></span>.<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</div>
</body>
</html>
