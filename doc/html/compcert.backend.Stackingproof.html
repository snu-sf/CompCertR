
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module Stackingproof</title>
<meta name="description" content="Documentation of Coq module Stackingproof" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module Stackingproof</h1>
<div class="coq">
<br/>
<div class="doc">Correctness proof for the translation from Linear to Mach. </div>
<br/>
<div class="doc">This file proves semantic preservation for the <span class="bracket"><span class="id">Stacking</span></span> pass. </div>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.lib.Coqlib.html">Coqlib</a></span> <span class="id"><a href="compcert.common.Errors.html">Errors</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.lib.Integers.html">Integers</a></span> <span class="id"><a href="compcert.common.AST.html">AST</a></span> <span class="id"><a href="compcert.common.Linking.html">Linking</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.common.Values.html">Values</a></span> <span class="id"><a href="compcert.common.Memory.html">Memory</a></span> <span class="id"><a href="compcert.common.Separation.html">Separation</a></span> <span class="id"><a href="compcert.common.Events.html">Events</a></span> <span class="id"><a href="compcert.common.Globalenvs.html">Globalenvs</a></span> <span class="id"><a href="compcert.common.Smallstep.html">Smallstep</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.backend.LTL.html">LTL</a></span> <span class="id"><a href="compcert.x86.Op.html">Op</a></span> <span class="id"><a href="compcert.backend.Locations.html">Locations</a></span> <span class="id"><a href="compcert.backend.Linear.html">Linear</a></span> <span class="id"><a href="compcert.backend.Mach.html">Mach</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.backend.Bounds.html">Bounds</a></span> <span class="id"><a href="compcert.backend.Conventions.html">Conventions</a></span> <span class="id"><a href="compcert.x86.Stacklayout.html">Stacklayout</a></span> <span class="id"><a href="compcert.backend.Lineartyping.html">Lineartyping</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.backend.Stacking.html">Stacking</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.lib.sflib.html">sflib</a></span>.<br/>
<span class="kwd">Require</span> <span class="id"><a href="compcert.common.SimMemInj.html">SimMemInj</a></span>.<br/>
<br/>
<span class="kwd">Local</span> <span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">sep_scope</span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="match_prog">match_prog</a></span> (<span class="id">p</span>: <span class="id"><a href="compcert.backend.Linear.html#program">Linear.program</a></span>) (<span class="id">tp</span>: <span class="id"><a href="compcert.backend.Mach.html#program">Mach.program</a></span>) :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#match_program">match_program</a></span> (<span class="kwd">fun</span> <span class="id">_</span> <span class="id">f</span> <span class="id">tf</span> =&gt; <span class="id"><a href="compcert.backend.Stacking.html#transf_fundef">transf_fundef</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f">f</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#tf">tf</a></span>) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#p">p</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#tp">tp</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="transf_program_match">transf_program_match</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">p</span> <span class="id">tp</span>, <span class="id"><a href="compcert.backend.Stacking.html#transf_program">transf_program</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#p">p</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#tp">tp</a></span> -&gt; <span class="id"><a href="compcert.backend.Stackingproof.html#match_prog">match_prog</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#p">p</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#tp">tp</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3975')">Proof.</div>
<div class="proofscript" id="proof3975">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Linking.html#match_transform_partial_program">match_transform_partial_program</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<h1> Basic properties of the translation </h1>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="typesize_typesize">typesize_typesize</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ty</span>, <span class="id"><a href="compcert.common.AST.html#typesize">AST.typesize</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span> = 4 * <span class="id"><a href="compcert.backend.Locations.html#typesize">Locations.typesize</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3976')">Proof.</div>
<div class="proofscript" id="proof3976">
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">ty</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="size_type_chunk">size_type_chunk</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ty</span>, <span class="id"><a href="compcert.common.Memdata.html#size_chunk">size_chunk</a></span> (<span class="id"><a href="compcert.common.AST.html#chunk_of_type">chunk_of_type</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span>) = <span class="id"><a href="compcert.common.AST.html#typesize">AST.typesize</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3977')">Proof.</div>
<div class="proofscript" id="proof3977">
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">ty</span>; <span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="align_type_chunk">align_type_chunk</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ty</span>, <span class="id"><a href="compcert.common.Memdata.html#align_chunk">align_chunk</a></span> (<span class="id"><a href="compcert.common.AST.html#chunk_of_type">chunk_of_type</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span>) = 4 * <span class="id"><a href="compcert.backend.Locations.html#typealign">Locations.typealign</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3978')">Proof.</div>
<div class="proofscript" id="proof3978">
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">ty</span>; <span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="slot_outgoing_argument_valid">slot_outgoing_argument_valid</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">ofs</span> <span class="id">ty</span> <span class="id">sg</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="compcert.backend.Locations.html#S">S</a></span> <span class="id"><a href="compcert.backend.Locations.html#Outgoing">Outgoing</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span>) (<span class="id"><a href="compcert.common.AST.html#regs_of_rpairs">regs_of_rpairs</a></span> (<span class="id"><a href="compcert.x86.Conventions1.html#loc_arguments">loc_arguments</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sg">sg</a></span>)) -&gt; <span class="id"><a href="compcert.backend.Lineartyping.html#slot_valid">slot_valid</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f">f</a></span> <span class="id"><a href="compcert.backend.Locations.html#Outgoing">Outgoing</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3979')">Proof.</div>
<div class="proofscript" id="proof3979">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.backend.Conventions.html#loc_arguments_acceptable_2">loc_arguments_acceptable_2</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">A</span> <span class="id">B</span>].<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Lineartyping.html#slot_valid">slot_valid</a></span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.lib.Coqlib.html#proj_sumbool">proj_sumbool</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#zle_true">zle_true</a></span> <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#pred_dec_true">pred_dec_true</a></span> <span class="tactic">by</span> <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="load_stack_transf_ofs">load_stack_transf_ofs</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">m</span> <span class="id">sp</span> <span class="id">spofs</span> <span class="id">ty</span> <span class="id">ofs</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;<span class="id">EQ</span>: <span class="id"><a href="compcert.backend.Mach.html#load_stack">load_stack</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#spofs">spofs</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> = <span class="id"><a href="compcert.backend.Mach.html#load_stack">load_stack</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Ptrofs.add">Ptrofs.add</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#spofs">spofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span>)&gt;&gt;.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3980')">Proof.</div>
<div class="proofscript" id="proof3980">
 <span class="tactic">red</span>. <span class="id">cbn</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.add_zero_l">Ptrofs.add_zero_l</a></span>. <span class="id">ss</span>. Qed.</div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="PRESERVATION">PRESERVATION</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.prog">prog</a></span>: <span class="id"><a href="compcert.backend.Linear.html#program">Linear.program</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.tprog">tprog</a></span>: <span class="id"><a href="compcert.backend.Mach.html#program">Mach.program</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="PRESERVATION.TRANSF">TRANSF</a></span>: <span class="id"><a href="compcert.backend.Stackingproof.html#match_prog">match_prog</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.prog">prog</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.tprog">tprog</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.return_address_offset">return_address_offset</a></span>: <span class="id"><a href="compcert.backend.Mach.html#function">Mach.function</a></span> -&gt; <span class="id"><a href="compcert.backend.Mach.html#code">Mach.code</a></span> -&gt; <span class="id"><a href="compcert.lib.Integers.html#ptrofs">ptrofs</a></span> -&gt; <span class="kwd">Prop</span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="PRESERVATION.CORELEMMA">CORELEMMA</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.CORELEMMA.se">se</a></span> <span class="id"><a name="PRESERVATION.CORELEMMA.tse">tse</a></span>: <span class="id"><a href="compcert.common.Globalenvs.html#Senv.t">Senv.t</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.CORELEMMA.ge">ge</a></span> : <span class="id"><a href="compcert.backend.Linear.html#genv">Linear.genv</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.CORELEMMA.tge">tge</a></span> : <span class="id"><a href="compcert.backend.Mach.html#genv">genv</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="PRESERVATION.CORELEMMA.SECOMPATSRC">SECOMPATSRC</a></span>: <span class="id"><a href="compcert.common.Globalenvs.html#senv_genv_compat">senv_genv_compat</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.se">se</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.ge">ge</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="PRESERVATION.CORELEMMA.SECOMPATTGT">SECOMPATTGT</a></span>: <span class="id"><a href="compcert.common.Globalenvs.html#senv_genv_compat">senv_genv_compat</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.tse">tse</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.tge">tge</a></span>.<br/>
<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="PRESERVATION.CORELEMMA.return_address_offset_exists">return_address_offset_exists</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">sg</span> <span class="id">ros</span> <span class="id">c</span> <span class="id">v</span> (<span class="id">FUNCT</span>: <span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_funct">Genv.find_funct</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.tge">tge</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v">v</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="compcert.common.AST.html#Internal">Internal</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f">f</a></span>)),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#is_tail">is_tail</a></span> (<span class="id"><a href="compcert.backend.Mach.html#Mcall">Mcall</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sg">sg</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ros">ros</a></span> :: <span class="id"><a href="compcert.backend.Stackingproof.html#c">c</a></span>) (<span class="id"><a href="compcert.backend.Mach.html#fn_code">fn_code</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f">f</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">ofs</span>, <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.return_address_offset">return_address_offset</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f">f</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#c">c</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span>.<br/>
<br/>
<span class="kwd">Context</span> `{<span class="id">CTX0</span>: <span class="id"><a href="compcert.backend.Conventions.html#main_args_ctx">main_args_ctx</a></span>}.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="load_result_inject">load_result_inject</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">j</span> <span class="id">ty</span> <span class="id">v</span> <span class="id">v</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v">v</a></span> <span class="id">v</span>' -&gt; <span class="id"><a href="compcert.common.Values.html#Val.has_type">Val.has_type</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v">v</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span> -&gt; <span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v">v</a></span> (<span class="id"><a href="compcert.common.Values.html#Val.load_result">Val.load_result</a></span> (<span class="id"><a href="compcert.common.AST.html#chunk_of_type">chunk_of_type</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span>) <span class="id">v</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3981')">Proof.</div>
<div class="proofscript" id="proof3981">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> <span class="id">v</span>'; <span class="tactic">unfold</span> <span class="id"><a href="compcert.common.Values.html#Val.has_type">Val.has_type</a></span>, <span class="id"><a href="compcert.common.Values.html#Val.load_result">Val.load_result</a></span>; <span class="tactic">destruct</span> <span class="id"><a href="compcert.x86_64.Archi.html#ptr64">Archi.ptr64</a></span>;<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> 1; <span class="tactic">intros</span>; <span class="tactic">auto</span>; <span class="tactic">destruct</span> <span class="id">ty</span>; <span class="tactic">simpl</span>;<br/>
&nbsp;&nbsp;<span class="tactic">try</span> <span class="id">contradiction</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>; <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="PRESERVATION.CORELEMMA.FRAME_PROPERTIES">FRAME_PROPERTIES</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.CORELEMMA.FRAME_PROPERTIES.f">f</a></span>: <span class="id"><a href="compcert.backend.Linear.html#function">Linear.function</a></span>.<br/>
<span class="kwd">Let</span> <span class="id"><a name="PRESERVATION.CORELEMMA.FRAME_PROPERTIES.b">b</a></span> := <span class="id"><a href="compcert.backend.Bounds.html#function_bounds">function_bounds</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.f">f</a></span>.<br/>
<span class="kwd">Let</span> <span class="id"><a name="PRESERVATION.CORELEMMA.FRAME_PROPERTIES.fe">fe</a></span> := <span class="id"><a href="compcert.x86.Stacklayout.html#make_env">make_env</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.b">b</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.CORELEMMA.FRAME_PROPERTIES.tf">tf</a></span>: <span class="id"><a href="compcert.backend.Mach.html#function">Mach.function</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="PRESERVATION.CORELEMMA.FRAME_PROPERTIES.TRANSF_F">TRANSF_F</a></span>: <span class="id"><a href="compcert.backend.Stacking.html#transf_function">transf_function</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.f">f</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.tf">tf</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="unfold_transf_function">unfold_transf_function</a></span>:<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.tf">tf</a></span> = <span class="id"><a href="compcert.backend.Mach.html#mkfunction">Mach.mkfunction</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.f">f</a></span>.(<span class="id"><a href="compcert.backend.Linear.html#fn_sig">Linear.fn_sig</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.Stacking.html#transl_body">transl_body</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.f">f</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.fe">fe</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.fe">fe</a></span>.(<span class="id"><a href="compcert.backend.Bounds.html#fe_size">fe_size</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.lib.Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.fe">fe</a></span>.(<span class="id"><a href="compcert.backend.Bounds.html#fe_ofs_link">fe_ofs_link</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.lib.Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.fe">fe</a></span>.(<span class="id"><a href="compcert.backend.Bounds.html#fe_ofs_retaddr">fe_ofs_retaddr</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3982')">Proof.</div>
<div class="proofscript" id="proof3982">
&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.TRANSF_F">TRANSF_F</a></span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Stacking.html#transf_function">transf_function</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.backend.Lineartyping.html#wt_function">wt_function</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.f">f</a></span>); <span class="tactic">simpl</span> <span class="id">negb</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.max_unsigned">Ptrofs.max_unsigned</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#fe_size">fe_size</a></span> (<span class="id"><a href="compcert.x86.Stacklayout.html#make_env">make_env</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#function_bounds">function_bounds</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.f">f</a></span>)))).<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Stackingproof.html#fe">fe</a></span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Stackingproof.html#b">b</a></span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">discriminate</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="transf_function_well_typed">transf_function_well_typed</a></span>:<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Lineartyping.html#wt_function">wt_function</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.f">f</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3983')">Proof.</div>
<div class="proofscript" id="proof3983">
&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.TRANSF_F">TRANSF_F</a></span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Stacking.html#transf_function">transf_function</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.backend.Lineartyping.html#wt_function">wt_function</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.f">f</a></span>); <span class="tactic">simpl</span> <span class="id">negb</span>. <span class="tactic">auto</span>. <span class="tactic">intros</span>; <span class="tactic">discriminate</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="size_no_overflow">size_no_overflow</a></span>: <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.fe">fe</a></span>.(<span class="id"><a href="compcert.backend.Bounds.html#fe_size">fe_size</a></span>) &lt;= <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.max_unsigned">Ptrofs.max_unsigned</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3984')">Proof.</div>
<div class="proofscript" id="proof3984">
&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.TRANSF_F">TRANSF_F</a></span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Stacking.html#transf_function">transf_function</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.backend.Lineartyping.html#wt_function">wt_function</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.f">f</a></span>); <span class="tactic">simpl</span> <span class="id">negb</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.max_unsigned">Ptrofs.max_unsigned</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#fe_size">fe_size</a></span> (<span class="id"><a href="compcert.x86.Stacklayout.html#make_env">make_env</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#function_bounds">function_bounds</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.f">f</a></span>)))).<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Stackingproof.html#fe">fe</a></span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Stackingproof.html#b">b</a></span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">discriminate</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="bound_stack_data_stacksize">bound_stack_data_stacksize</a></span>:<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.f">f</a></span>.(<span class="id"><a href="compcert.backend.Linear.html#fn_stacksize">Linear.fn_stacksize</a></span>) &lt;= <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.b">b</a></span>.(<span class="id"><a href="compcert.backend.Bounds.html#bound_stack_data">bound_stack_data</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3985')">Proof.</div>
<div class="proofscript" id="proof3985">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Stackingproof.html#b">b</a></span>, <span class="id"><a href="compcert.backend.Bounds.html#function_bounds">function_bounds</a></span>, <span class="id"><a href="compcert.backend.Bounds.html#bound_stack_data">bound_stack_data</a></span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.le_max_l">Z.le_max_l</a></span>.<br/>
Qed.</div>
<br/>
<h1> Memory assertions used to describe the contents of stack frames </h1>
<br/>
<span class="kwd">Local</span> <span class="id">Opaque</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.add">Z.add</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.mul">Z.mul</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide">Z.divide</a></span>.<br/>
<br/>
<div class="doc">Accessing the stack frame using <span class="bracket"><span class="id">load_stack</span></span> and <span class="bracket"><span class="id">store_stack</span></span>. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="contains_get_stack">contains_get_stack</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">spec</span> <span class="id">m</span> <span class="id">ty</span> <span class="id">sp</span> <span class="id">ofs</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span> |= <span class="id"><a href="compcert.common.Separation.html#contains">contains</a></span> (<span class="id"><a href="compcert.common.AST.html#chunk_of_type">chunk_of_type</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#spec">spec</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v</span>, <span class="id"><a href="compcert.backend.Mach.html#load_stack">load_stack</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v">v</a></span> /\ <span class="id"><a href="compcert.backend.Stackingproof.html#spec">spec</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v">v</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3986')">Proof.</div>
<div class="proofscript" id="proof3986">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Mach.html#load_stack">load_stack</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="compcert.common.Values.html#Val.offset_ptr">Val.offset_ptr</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">sp</span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) (<span class="id"><a href="compcert.lib.Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> <span class="id">ofs</span>)) <span class="kwd">with</span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">sp</span> (<span class="id"><a href="compcert.lib.Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> <span class="id">ofs</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Separation.html#loadv_rule">loadv_rule</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.add_zero_l">Ptrofs.add_zero_l</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="hasvalue_get_stack">hasvalue_get_stack</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ty</span> <span class="id">m</span> <span class="id">sp</span> <span class="id">ofs</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span> |= <span class="id"><a href="compcert.common.Separation.html#hasvalue">hasvalue</a></span> (<span class="id"><a href="compcert.common.AST.html#chunk_of_type">chunk_of_type</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v">v</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Mach.html#load_stack">load_stack</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v">v</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3987')">Proof.</div>
<div class="proofscript" id="proof3987">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.backend.Stackingproof.html#contains_get_stack">contains_get_stack</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">v</span>' &amp; <span class="id">A</span> &amp; <span class="id">B</span>). <span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="contains_set_stack">contains_set_stack</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">spec</span>: <span class="id"><a href="compcert.common.Values.html#val">val</a></span> -&gt; <span class="kwd">Prop</span>) <span class="id">v</span> <span class="id">spec1</span> <span class="id">m</span> <span class="id">ty</span> <span class="id">sp</span> <span class="id">ofs</span> <span class="id">P</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span> |= <span class="id"><a href="compcert.common.Separation.html#contains">contains</a></span> (<span class="id"><a href="compcert.common.AST.html#chunk_of_type">chunk_of_type</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#spec1">spec1</a></span> ** <span class="id"><a href="compcert.backend.Stackingproof.html#P">P</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#spec">spec</a></span> (<span class="id"><a href="compcert.common.Values.html#Val.load_result">Val.load_result</a></span> (<span class="id"><a href="compcert.common.AST.html#chunk_of_type">chunk_of_type</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#v">v</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">m</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Mach.html#store_stack">store_stack</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#v">v</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m</span>'<br/>
&nbsp;&nbsp;/\ <span class="id">m</span>' |= <span class="id"><a href="compcert.common.Separation.html#contains">contains</a></span> (<span class="id"><a href="compcert.common.AST.html#chunk_of_type">chunk_of_type</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#spec">spec</a></span> ** <span class="id"><a href="compcert.backend.Stackingproof.html#P">P</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3988')">Proof.</div>
<div class="proofscript" id="proof3988">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Mach.html#store_stack">store_stack</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="compcert.common.Values.html#Val.offset_ptr">Val.offset_ptr</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">sp</span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) (<span class="id"><a href="compcert.lib.Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> <span class="id">ofs</span>)) <span class="kwd">with</span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">sp</span> (<span class="id"><a href="compcert.lib.Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> <span class="id">ofs</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Separation.html#storev_rule">storev_rule</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.add_zero_l">Ptrofs.add_zero_l</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<div class="doc"><span class="bracket"><span class="id">contains_locations</span> <span class="id">j</span> <span class="id">sp</span> <span class="id">pos</span> <span class="id">bound</span> <span class="id">sl</span> <span class="id">ls</span></span> is a separation logic assertion
  that holds if the memory area at block <span class="bracket"><span class="id">sp</span></span>, offset <span class="bracket"><span class="id">pos</span></span>, size <span class="bracket">4 * <span class="id">bound</span></span>,
  reflects the values of the stack locations of kind <span class="bracket"><span class="id">sl</span></span> given by the
  location map <span class="bracket"><span class="id">ls</span></span>, up to the memory injection <span class="bracket"><span class="id">j</span></span>.
  Two such <span class="bracket"><span class="id">contains_locations</span></span> assertions will be used later, one to
  reason about the values of <span class="bracket"><span class="kwd">Local</span></span> slots, the other about the values of
  <span class="bracket"><span class="id">Outgoing</span></span> slots. </div>
<br/>
<span class="kwd">Program</span> <span class="kwd">Definition</span> <span class="id"><a name="contains_locations">contains_locations</a></span> (<span class="id">j</span>: <span class="id"><a href="compcert.common.Values.html#meminj">meminj</a></span>) (<span class="id">sp</span>: <span class="id"><a href="compcert.common.Values.html#block">block</a></span>) (<span class="id">pos</span> <span class="id">bound</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) (<span class="id">sl</span>: <span class="id"><a href="compcert.backend.Locations.html#slot">slot</a></span>) (<span class="id">ls</span>: <span class="id"><a href="compcert.backend.Linear.html#locset">locset</a></span>) : <span class="id"><a href="compcert.common.Separation.html#massert">massert</a></span> := {|<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Separation.html#Build_massert">m_pred</a></span> := <span class="kwd">fun</span> <span class="id">m</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(8 | <span class="id"><a href="compcert.backend.Stackingproof.html#pos">pos</a></span>) /\ 0 &lt;= <span class="id"><a href="compcert.backend.Stackingproof.html#pos">pos</a></span> /\ <span class="id"><a href="compcert.backend.Stackingproof.html#pos">pos</a></span> + 4 * <span class="id"><a href="compcert.backend.Stackingproof.html#bound">bound</a></span> &lt;= <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.modulus">Ptrofs.modulus</a></span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Memory.html#Mem.range_perm">Mem.range_perm</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#pos">pos</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#pos">pos</a></span> + 4 * <span class="id"><a href="compcert.backend.Stackingproof.html#bound">bound</a></span>) <span class="id"><a href="compcert.common.Memtype.html#Cur">Cur</a></span> <span class="id"><a href="compcert.common.Memtype.html#Freeable">Freeable</a></span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ofs</span> <span class="id">ty</span>, 0 &lt;= <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> -&gt; <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> + <span class="id"><a href="compcert.backend.Locations.html#typesize">typesize</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span> &lt;= <span class="id"><a href="compcert.backend.Stackingproof.html#bound">bound</a></span> -&gt; (<span class="id"><a href="compcert.backend.Locations.html#typealign">typealign</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span> | <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v</span>, <span class="id"><a href="compcert.common.Memory.html#Mem.load">Mem.load</a></span> (<span class="id"><a href="compcert.common.AST.html#chunk_of_type">chunk_of_type</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#pos">pos</a></span> + 4 * <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v">v</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> (<span class="id"><a href="compcert.backend.Locations.html#S">S</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sl">sl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span>)) <span class="id"><a href="compcert.backend.Stackingproof.html#v">v</a></span>;<br/>
&nbsp;&nbsp;<span class="id">m_footprint</span> := <span class="kwd">fun</span> <span class="id">b</span> <span class="id">ofs</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#b">b</a></span> = <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> /\ <span class="id"><a href="compcert.backend.Stackingproof.html#pos">pos</a></span> &lt;= <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> &lt; <span class="id"><a href="compcert.backend.Stackingproof.html#pos">pos</a></span> + 4 * <span class="id"><a href="compcert.backend.Stackingproof.html#bound">bound</a></span><br/>
|}.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3989')">Next Obligation.</div>
<div class="proofscript" id="proof3989">
&nbsp;&nbsp;<span class="tactic">intuition</span> <span class="tactic">auto</span>.<br/>
- <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_unchanged_on">Mem.perm_unchanged_on</a></span>; <span class="tactic">eauto</span>. <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
- <span class="id">exploit</span> <span class="id">H4</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">v</span> &amp; <span class="id">A</span> &amp; <span class="id">B</span>). <span class="id">exists</span> <span class="id">v</span>; <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.load_unchanged_on">Mem.load_unchanged_on</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Stackingproof.html#size_type_chunk">size_type_chunk</a></span>, <span class="id"><a href="compcert.backend.Stackingproof.html#typesize_typesize">typesize_typesize</a></span> <span class="kwd">in</span> <span class="id">H8</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">omega</span>.<br/>
Qed.</div>
<div class="toggleproof" onclick="toggleDisplay('proof3990')">Next Obligation.</div>
<div class="proofscript" id="proof3990">
&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="valid_access_location">valid_access_location</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">sp</span> <span class="id">pos</span> <span class="id">bound</span> <span class="id">ofs</span> <span class="id">ty</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;(8 | <span class="id"><a href="compcert.backend.Stackingproof.html#pos">pos</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Memory.html#Mem.range_perm">Mem.range_perm</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#pos">pos</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#pos">pos</a></span> + 4 * <span class="id"><a href="compcert.backend.Stackingproof.html#bound">bound</a></span>) <span class="id"><a href="compcert.common.Memtype.html#Cur">Cur</a></span> <span class="id"><a href="compcert.common.Memtype.html#Freeable">Freeable</a></span> -&gt;<br/>
&nbsp;&nbsp;0 &lt;= <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> -&gt; <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> + <span class="id"><a href="compcert.backend.Locations.html#typesize">typesize</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span> &lt;= <span class="id"><a href="compcert.backend.Stackingproof.html#bound">bound</a></span> -&gt; (<span class="id"><a href="compcert.backend.Locations.html#typealign">typealign</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span> | <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Memory.html#Mem.valid_access">Mem.valid_access</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span> (<span class="id"><a href="compcert.common.AST.html#chunk_of_type">chunk_of_type</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#pos">pos</a></span> + 4 * <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#p">p</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3991')">Proof.</div>
<div class="proofscript" id="proof3991">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">split</span>.<br/>
- <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_implies">Mem.perm_implies</a></span> <span class="kwd">with</span> <span class="id"><a href="compcert.common.Memtype.html#Freeable">Freeable</a></span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H0</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Stackingproof.html#size_type_chunk">size_type_chunk</a></span>, <span class="id"><a href="compcert.backend.Stackingproof.html#typesize_typesize">typesize_typesize</a></span> <span class="kwd">in</span> <span class="id">H4</span>. <span class="tactic">omega</span>.<br/>
- <span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Stackingproof.html#align_type_chunk">align_type_chunk</a></span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_add_r">Z.divide_add_r</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_trans">Z.divide_trans</a></span> <span class="kwd">with</span> 8; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> (8 / (4 * <span class="id"><a href="compcert.backend.Locations.html#typealign">typealign</a></span> <span class="id">ty</span>)); <span class="tactic">destruct</span> <span class="id">ty</span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.mul_divide_mono_l">Z.mul_divide_mono_l</a></span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="get_location">get_location</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">j</span> <span class="id">sp</span> <span class="id">pos</span> <span class="id">bound</span> <span class="id">sl</span> <span class="id">ls</span> <span class="id">ofs</span> <span class="id">ty</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span> |= <span class="id"><a href="compcert.backend.Stackingproof.html#contains_locations">contains_locations</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#pos">pos</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#bound">bound</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sl">sl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> -&gt;<br/>
&nbsp;&nbsp;0 &lt;= <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> -&gt; <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> + <span class="id"><a href="compcert.backend.Locations.html#typesize">typesize</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span> &lt;= <span class="id"><a href="compcert.backend.Stackingproof.html#bound">bound</a></span> -&gt; (<span class="id"><a href="compcert.backend.Locations.html#typealign">typealign</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span> | <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Mach.html#load_stack">load_stack</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#pos">pos</a></span> + 4 * <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span>)) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v">v</a></span><br/>
&nbsp;&nbsp;/\ <span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> (<span class="id"><a href="compcert.backend.Locations.html#S">S</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sl">sl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span>)) <span class="id"><a href="compcert.backend.Stackingproof.html#v">v</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3992')">Proof.</div>
<div class="proofscript" id="proof3992">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> (<span class="id">D</span> &amp; <span class="id">E</span> &amp; <span class="id">F</span> &amp; <span class="id">G</span> &amp; <span class="id">H</span>).<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">v</span> &amp; <span class="id">U</span> &amp; <span class="id">V</span>). <span class="id">exists</span> <span class="id">v</span>; <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Mach.html#load_stack">load_stack</a></span>; <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.add_zero_l">Ptrofs.add_zero_l</a></span>, <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.unsigned_repr">Ptrofs.unsigned_repr</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.max_unsigned">Ptrofs.max_unsigned</a></span>. <span class="tactic">generalize</span> (<span class="id"><a href="compcert.backend.Locations.html#typesize_pos">typesize_pos</a></span> <span class="id">ty</span>). <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="set_location">set_location</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">j</span> <span class="id">sp</span> <span class="id">pos</span> <span class="id">bound</span> <span class="id">sl</span> <span class="id">ls</span> <span class="id">P</span> <span class="id">ofs</span> <span class="id">ty</span> <span class="id">v</span> <span class="id">v</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span> |= <span class="id"><a href="compcert.backend.Stackingproof.html#contains_locations">contains_locations</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#pos">pos</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#bound">bound</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sl">sl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> ** <span class="id"><a href="compcert.backend.Stackingproof.html#P">P</a></span> -&gt;<br/>
&nbsp;&nbsp;0 &lt;= <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> -&gt; <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> + <span class="id"><a href="compcert.backend.Locations.html#typesize">typesize</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span> &lt;= <span class="id"><a href="compcert.backend.Stackingproof.html#bound">bound</a></span> -&gt; (<span class="id"><a href="compcert.backend.Locations.html#typealign">typealign</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span> | <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v">v</a></span> <span class="id">v</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">m</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Mach.html#store_stack">store_stack</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#pos">pos</a></span> + 4 * <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span>)) <span class="id">v</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m</span>'<br/>
&nbsp;&nbsp;/\ <span class="id">m</span>' |= <span class="id"><a href="compcert.backend.Stackingproof.html#contains_locations">contains_locations</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#pos">pos</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#bound">bound</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sl">sl</a></span> (<span class="id"><a href="compcert.backend.Locations.html#Locmap.set">Locmap.set</a></span> (<span class="id"><a href="compcert.backend.Locations.html#S">S</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sl">sl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#v">v</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span>) ** <span class="id"><a href="compcert.backend.Stackingproof.html#P">P</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3993')">Proof.</div>
<div class="proofscript" id="proof3993">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> (<span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span>). <span class="tactic">destruct</span> <span class="id">A</span> <span class="kwd">as</span> (<span class="id">D</span> &amp; <span class="id">E</span> &amp; <span class="id">F</span> &amp; <span class="id">G</span> &amp; <span class="id">H</span>).<br/>
&nbsp;&nbsp;<span class="id">edestruct</span> <span class="id"><a href="compcert.common.Memory.html#Mem.valid_access_store">Mem.valid_access_store</a></span> <span class="kwd">as</span> [<span class="id">m</span>' <span class="id">STORE</span>].<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#valid_access_location">valid_access_location</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">PERM</span>: <span class="id"><a href="compcert.common.Memory.html#Mem.range_perm">Mem.range_perm</a></span> <span class="id">m</span>' <span class="id">sp</span> <span class="id">pos</span> (<span class="id">pos</span> + 4 * <span class="id">bound</span>) <span class="id"><a href="compcert.common.Memtype.html#Cur">Cur</a></span> <span class="id"><a href="compcert.common.Memtype.html#Freeable">Freeable</a></span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>. }<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">m</span>'; <span class="tactic">split</span>.<br/>
- <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Mach.html#store_stack">store_stack</a></span>; <span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.add_zero_l">Ptrofs.add_zero_l</a></span>, <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.unsigned_repr">Ptrofs.unsigned_repr</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.max_unsigned">Ptrofs.max_unsigned</a></span>. <span class="tactic">generalize</span> (<span class="id"><a href="compcert.backend.Locations.html#typesize_pos">typesize_pos</a></span> <span class="id">ty</span>). <span class="tactic">omega</span>.<br/>
- <span class="tactic">simpl</span>. <span class="tactic">intuition</span> <span class="tactic">auto</span>.<br/>
+ <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Locations.html#Locmap.set">Locmap.set</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.backend.Locations.html#Loc.eq">Loc.eq</a></span> (<span class="id"><a href="compcert.backend.Locations.html#S">S</a></span> <span class="id">sl</span> <span class="id">ofs</span> <span class="id">ty</span>) (<span class="id"><a href="compcert.backend.Locations.html#S">S</a></span> <span class="id">sl</span> <span class="id">ofs0</span> <span class="id">ty0</span>)); [|<span class="tactic">destruct</span> (<span class="id"><a href="compcert.backend.Locations.html#Loc.diff_dec">Loc.diff_dec</a></span> (<span class="id"><a href="compcert.backend.Locations.html#S">S</a></span> <span class="id">sl</span> <span class="id">ofs</span> <span class="id">ty</span>) (<span class="id"><a href="compcert.backend.Locations.html#S">S</a></span> <span class="id">sl</span> <span class="id">ofs0</span> <span class="id">ty0</span>))].<br/>
* <span class="comment">(*&nbsp;same&nbsp;location&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">e</span>. <span class="tactic">rename</span> <span class="id">ofs0</span> <span class="id">into</span> <span class="id">ofs</span>. <span class="tactic">rename</span> <span class="id">ty0</span> <span class="id">into</span> <span class="id">ty</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="compcert.common.Values.html#Val.load_result">Val.load_result</a></span> (<span class="id"><a href="compcert.common.AST.html#chunk_of_type">chunk_of_type</a></span> <span class="id">ty</span>) <span class="id">v</span>'); <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.load_store_similar_2">Mem.load_store_similar_2</a></span>; <span class="tactic">eauto</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Values.html#Val.load_result_inject">Val.load_result_inject</a></span>; <span class="tactic">auto</span>.<br/>
* <span class="comment">(*&nbsp;different&nbsp;locations&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">H</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">v0</span> &amp; <span class="id">X</span> &amp; <span class="id">Y</span>). <span class="id">exists</span> <span class="id">v0</span>; <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">X</span>; <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.load_store_other">Mem.load_store_other</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">d</span>. <span class="tactic">congruence</span>. <span class="id">right</span>. <span class="tactic">rewrite</span> ! <span class="id"><a href="compcert.backend.Stackingproof.html#size_type_chunk">size_type_chunk</a></span>, ! <span class="id"><a href="compcert.backend.Stackingproof.html#typesize_typesize">typesize_typesize</a></span>. <span class="tactic">omega</span>.<br/>
* <span class="comment">(*&nbsp;overlapping&nbsp;locations&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.Memory.html#Mem.valid_access_load">Mem.valid_access_load</a></span> <span class="id">m</span>' (<span class="id"><a href="compcert.common.AST.html#chunk_of_type">chunk_of_type</a></span> <span class="id">ty0</span>) <span class="id">sp</span> (<span class="id">pos</span> + 4 * <span class="id">ofs0</span>)) <span class="kwd">as</span> [<span class="id">v</span>'' <span class="id">LOAD</span>].<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.valid_access_implies">Mem.valid_access_implies</a></span> <span class="kwd">with</span> <span class="id"><a href="compcert.common.Memtype.html#Writable">Writable</a></span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#valid_access_location">valid_access_location</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v</span>''; <span class="tactic">auto</span>.<br/>
+ <span class="tactic">apply</span> (<span class="id"><a href="compcert.common.Separation.html#m_invar">m_invar</a></span> <span class="id">P</span>) <span class="kwd">with</span> <span class="id">m</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.store_unchanged_on">Mem.store_unchanged_on</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">i</span>; <span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Stackingproof.html#size_type_chunk">size_type_chunk</a></span>, <span class="id"><a href="compcert.backend.Stackingproof.html#typesize_typesize">typesize_typesize</a></span>. <span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">eelim</span> <span class="id">C</span>; <span class="tactic">eauto</span>. <span class="tactic">simpl</span>. <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="initial_locations">initial_locations</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">j</span> <span class="id">sp</span> <span class="id">pos</span> <span class="id">bound</span> <span class="id">P</span> <span class="id">sl</span> <span class="id">ls</span> <span class="id">m</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span> |= <span class="id"><a href="compcert.common.Separation.html#range">range</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#pos">pos</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#pos">pos</a></span> + 4 * <span class="id"><a href="compcert.backend.Stackingproof.html#bound">bound</a></span>) ** <span class="id"><a href="compcert.backend.Stackingproof.html#P">P</a></span> -&gt;<br/>
&nbsp;&nbsp;(8 | <span class="id"><a href="compcert.backend.Stackingproof.html#pos">pos</a></span>) -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">ofs</span> <span class="id">ty</span>, <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> (<span class="id"><a href="compcert.backend.Locations.html#S">S</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sl">sl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span>) = <span class="id"><a href="compcert.common.Values.html#Vundef">Vundef</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span> |= <span class="id"><a href="compcert.backend.Stackingproof.html#contains_locations">contains_locations</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#pos">pos</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#bound">bound</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sl">sl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> ** <span class="id"><a href="compcert.backend.Stackingproof.html#P">P</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3994')">Proof.</div>
<div class="proofscript" id="proof3994">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H</span> <span class="kwd">as</span> (<span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span>). <span class="tactic">destruct</span> <span class="id">A</span> <span class="kwd">as</span> (<span class="id">D</span> &amp; <span class="id">E</span> &amp; <span class="id">F</span>). <span class="tactic">split</span>.<br/>
- <span class="tactic">simpl</span>; <span class="tactic">intuition</span> <span class="tactic">auto</span>. <span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.Memory.html#Mem.valid_access_load">Mem.valid_access_load</a></span> <span class="id">m</span> (<span class="id"><a href="compcert.common.AST.html#chunk_of_type">chunk_of_type</a></span> <span class="id">ty</span>) <span class="id">sp</span> (<span class="id">pos</span> + 4 * <span class="id">ofs</span>)) <span class="kwd">as</span> [<span class="id">v</span> <span class="id">LOAD</span>].<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#valid_access_location">valid_access_location</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v</span>; <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">rewrite</span> <span class="id">H1</span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">split</span>; <span class="tactic">assumption</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="contains_locations_exten">contains_locations_exten</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ls</span> <span class="id">ls</span>' <span class="id">j</span> <span class="id">sp</span> <span class="id">pos</span> <span class="id">bound</span> <span class="id">sl</span>,<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">ofs</span> <span class="id">ty</span>, <span class="id"><a href="compcert.common.Values.html#Val.lessdef">Val.lessdef</a></span> (<span class="id">ls</span>' (<span class="id"><a href="compcert.backend.Locations.html#S">S</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sl">sl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span>)) (<span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> (<span class="id"><a href="compcert.backend.Locations.html#S">S</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sl">sl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span>))) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Separation.html#massert_imp">massert_imp</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#contains_locations">contains_locations</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#pos">pos</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#bound">bound</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sl">sl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.Stackingproof.html#contains_locations">contains_locations</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#pos">pos</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#bound">bound</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sl">sl</a></span> <span class="id">ls</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3995')">Proof.</div>
<div class="proofscript" id="proof3995">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">split</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intuition</span> <span class="tactic">auto</span>. <span class="id">exploit</span> <span class="id">H5</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">v</span> &amp; <span class="id">A</span> &amp; <span class="id">B</span>). <span class="id">exists</span> <span class="id">v</span>; <span class="tactic">split</span>; <span class="tactic">auto</span>. <br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">H</span> <span class="id">ofs</span> <span class="id">ty</span>). <span class="id">inv</span> <span class="id">H</span>. <span class="tactic">congruence</span>. <span class="tactic">auto</span>. <br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="contains_locations_incr">contains_locations_incr</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">j</span> <span class="id">j</span>' <span class="id">sp</span> <span class="id">pos</span> <span class="id">bound</span> <span class="id">sl</span> <span class="id">ls</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Values.html#inject_incr">inject_incr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id">j</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Separation.html#massert_imp">massert_imp</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#contains_locations">contains_locations</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#pos">pos</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#bound">bound</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sl">sl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.Stackingproof.html#contains_locations">contains_locations</a></span> <span class="id">j</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#pos">pos</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#bound">bound</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sl">sl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3996')">Proof.</div>
<div class="proofscript" id="proof3996">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">split</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intuition</span> <span class="tactic">auto</span>. <span class="id">exploit</span> <span class="id">H5</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">v</span> &amp; <span class="id">A</span> &amp; <span class="id">B</span>). <span class="id">exists</span> <span class="id">v</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<div class="doc"><span class="bracket"><span class="id">contains_callee_saves</span> <span class="id">j</span> <span class="id">sp</span> <span class="id">pos</span> <span class="id">rl</span> <span class="id">ls</span></span> is a memory assertion that holds
  if block <span class="bracket"><span class="id">sp</span></span>, starting at offset <span class="bracket"><span class="id">pos</span></span>, contains the values of the
  callee-save registers <span class="bracket"><span class="id">rl</span></span> as given by the location map <span class="bracket"><span class="id">ls</span></span>,
  up to the memory injection <span class="bracket"><span class="id">j</span></span>.  The memory layout of the registers in <span class="bracket"><span class="id">rl</span></span>
  is the same as that implemented by <span class="bracket"><span class="id">save_callee_save_rec</span></span>. </div>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="contains_callee_saves">contains_callee_saves</a></span> (<span class="id">j</span>: <span class="id"><a href="compcert.common.Values.html#meminj">meminj</a></span>) (<span class="id">sp</span>: <span class="id"><a href="compcert.common.Values.html#block">block</a></span>) (<span class="id">pos</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>) (<span class="id">rl</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.x86.Machregs.html#mreg">mreg</a></span>) (<span class="id">ls</span>: <span class="id"><a href="compcert.backend.Linear.html#locset">locset</a></span>) : <span class="id"><a href="compcert.common.Separation.html#massert">massert</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.backend.Stackingproof.html#rl">rl</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; <span class="id"><a href="compcert.common.Separation.html#pure">pure</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span><br/>
&nbsp;&nbsp;| <span class="id">r</span> :: <span class="id">rl</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ty</span> := <span class="id"><a href="compcert.x86.Machregs.html#mreg_type">mreg_type</a></span> <span class="id">r</span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">sz</span> := <span class="id"><a href="compcert.common.AST.html#typesize">AST.typesize</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">pos1</span> := <span class="id"><a href="compcert.lib.Coqlib.html#align">align</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#pos">pos</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sz">sz</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Separation.html#contains">contains</a></span> (<span class="id"><a href="compcert.common.AST.html#chunk_of_type">chunk_of_type</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#pos1">pos1</a></span> (<span class="kwd">fun</span> <span class="id">v</span> =&gt; <span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id">r</span>)) <span class="id"><a href="compcert.backend.Stackingproof.html#v">v</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id"><a href="compcert.backend.Stackingproof.html#contains_callee_saves">contains_callee_saves</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#pos1">pos1</a></span> + <span class="id"><a href="compcert.backend.Stackingproof.html#sz">sz</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#rl">rl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="contains_callee_saves_incr">contains_callee_saves_incr</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">j</span> <span class="id">j</span>' <span class="id">sp</span> <span class="id">ls</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Values.html#inject_incr">inject_incr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id">j</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">rl</span> <span class="id">pos</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Separation.html#massert_imp">massert_imp</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#contains_callee_saves">contains_callee_saves</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#pos">pos</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rl">rl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.Stackingproof.html#contains_callee_saves">contains_callee_saves</a></span> <span class="id">j</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#pos">pos</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rl">rl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3997')">Proof.</div>
<div class="proofscript" id="proof3997">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">rl</span> <span class="kwd">as</span> [ | <span class="id">r1</span> <span class="id">rl</span>]; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
- <span class="tactic">reflexivity</span>.<br/>
- <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Separation.html#sepconj_morph_1">sepconj_morph_1</a></span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Separation.html#contains_imp">contains_imp</a></span>. <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="contains_callee_saves_exten">contains_callee_saves_exten</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">j</span> <span class="id">sp</span> <span class="id">ls</span> <span class="id">ls</span>' <span class="id">rl</span> <span class="id">pos</span>,<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">r</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rl">rl</a></span> -&gt; <span class="id">ls</span>' (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span>) = <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span>)) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Separation.html#massert_eqv">massert_eqv</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#contains_callee_saves">contains_callee_saves</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#pos">pos</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rl">rl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.Stackingproof.html#contains_callee_saves">contains_callee_saves</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#pos">pos</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rl">rl</a></span> <span class="id">ls</span>').<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3998')">Proof.</div>
<div class="proofscript" id="proof3998">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">rl</span> <span class="kwd">as</span> [ | <span class="id">r1</span> <span class="id">rl</span>]; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
- <span class="tactic">reflexivity</span>.<br/>
- <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Separation.html#sepconj_morph_2">sepconj_morph_2</a></span>; <span class="tactic">auto</span>. <span class="tactic">rewrite</span> <span class="id">H</span> <span class="tactic">by</span> <span class="tactic">auto</span>. <span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Separation logic assertions describing the stack frame at <span class="bracket"><span class="id">sp</span></span>.
  It must contain:
  - the values of the <span class="bracket"><span class="kwd">Local</span></span> stack slots of <span class="bracket"><span class="id">ls</span></span>, as per <span class="bracket"><span class="id">contains_locations</span></span>
  - the values of the <span class="bracket"><span class="id">Outgoing</span></span> stack slots of <span class="bracket"><span class="id">ls</span></span>, as per <span class="bracket"><span class="id">contains_locations</span></span>
  - the <span class="bracket"><span class="id">parent</span></span> pointer representing the back link to the caller's frame
  - the <span class="bracket"><span class="id">retaddr</span></span> pointer representing the saved return address
  - the initial values of the used callee-save registers as given by <span class="bracket"><span class="id">ls0</span></span>,
    as per <span class="bracket"><span class="id">contains_callee_saves</span></span>.
In addition, we use a nonseparating conjunction to record the fact that
we have full access rights on the stack frame, except the part that
represents the Linear stack data. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="frame_contents_1">frame_contents_1</a></span> (<span class="id">j</span>: <span class="id"><a href="compcert.common.Values.html#meminj">meminj</a></span>) (<span class="id">sp</span>: <span class="id"><a href="compcert.common.Values.html#block">block</a></span>) (<span class="id">ls</span> <span class="id">ls0</span>: <span class="id"><a href="compcert.backend.Linear.html#locset">locset</a></span>) (<span class="id">parent</span> <span class="id">retaddr</span>: <span class="id"><a href="compcert.common.Values.html#val">val</a></span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#contains_locations">contains_locations</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.fe">fe</a></span>.(<span class="id"><a href="compcert.backend.Bounds.html#fe_ofs_local">fe_ofs_local</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.b">b</a></span>.(<span class="id"><a href="compcert.backend.Bounds.html#bound_local">bound_local</a></span>) <span class="kwd">Local</span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span><br/>
&nbsp;** <span class="id"><a href="compcert.backend.Stackingproof.html#contains_locations">contains_locations</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.x86.Stacklayout.html#fe_ofs_arg">fe_ofs_arg</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.b">b</a></span>.(<span class="id"><a href="compcert.backend.Bounds.html#bound_outgoing">bound_outgoing</a></span>) <span class="id"><a href="compcert.backend.Locations.html#Outgoing">Outgoing</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span><br/>
&nbsp;** <span class="id"><a href="compcert.common.Separation.html#hasvalue">hasvalue</a></span> <span class="id"><a href="compcert.common.AST.html#Mptr">Mptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.fe">fe</a></span>.(<span class="id"><a href="compcert.backend.Bounds.html#fe_ofs_link">fe_ofs_link</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#parent">parent</a></span><br/>
&nbsp;** <span class="id"><a href="compcert.common.Separation.html#hasvalue">hasvalue</a></span> <span class="id"><a href="compcert.common.AST.html#Mptr">Mptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.fe">fe</a></span>.(<span class="id"><a href="compcert.backend.Bounds.html#fe_ofs_retaddr">fe_ofs_retaddr</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#retaddr">retaddr</a></span><br/>
&nbsp;** <span class="id"><a href="compcert.backend.Stackingproof.html#contains_callee_saves">contains_callee_saves</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.fe">fe</a></span>.(<span class="id"><a href="compcert.backend.Bounds.html#fe_ofs_callee_save">fe_ofs_callee_save</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.b">b</a></span>.(<span class="id"><a href="compcert.backend.Bounds.html#used_callee_save">used_callee_save</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ls0">ls0</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="frame_contents">frame_contents</a></span> (<span class="id">j</span>: <span class="id"><a href="compcert.common.Values.html#meminj">meminj</a></span>) (<span class="id">sp</span>: <span class="id"><a href="compcert.common.Values.html#block">block</a></span>) (<span class="id">ls</span> <span class="id">ls0</span>: <span class="id"><a href="compcert.backend.Linear.html#locset">locset</a></span>) (<span class="id">parent</span> <span class="id">retaddr</span>: <span class="id"><a href="compcert.common.Values.html#val">val</a></span>) :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Separation.html#mconj">mconj</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents_1">frame_contents_1</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0">ls0</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#parent">parent</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#retaddr">retaddr</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.common.Separation.html#range">range</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> 0 <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.fe">fe</a></span>.(<span class="id"><a href="compcert.backend.Bounds.html#fe_stack_data">fe_stack_data</a></span>) **<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Separation.html#range">range</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.fe">fe</a></span>.(<span class="id"><a href="compcert.backend.Bounds.html#fe_stack_data">fe_stack_data</a></span>) + <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.b">b</a></span>.(<span class="id"><a href="compcert.backend.Bounds.html#bound_stack_data">bound_stack_data</a></span>)) <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.fe">fe</a></span>.(<span class="id"><a href="compcert.backend.Bounds.html#fe_size">fe_size</a></span>)).<br/>
<br/>
<div class="doc">Accessing components of the frame. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="frame_get_local">frame_get_local</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ofs</span> <span class="id">ty</span> <span class="id">j</span> <span class="id">sp</span> <span class="id">ls</span> <span class="id">ls0</span> <span class="id">parent</span> <span class="id">retaddr</span> <span class="id">m</span> <span class="id">P</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span> |= <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0">ls0</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#parent">parent</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#retaddr">retaddr</a></span> ** <span class="id"><a href="compcert.backend.Stackingproof.html#P">P</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Bounds.html#slot_within_bounds">slot_within_bounds</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.b">b</a></span> <span class="kwd">Local</span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span> -&gt; <span class="id"><a href="compcert.backend.Lineartyping.html#slot_valid">slot_valid</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.f">f</a></span> <span class="kwd">Local</span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Mach.html#load_stack">load_stack</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> (<span class="id"><a href="compcert.backend.Stacking.html#offset_local">offset_local</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.fe">fe</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span>)) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v">v</a></span><br/>
&nbsp;&nbsp;/\ <span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> (<span class="id"><a href="compcert.backend.Locations.html#S">S</a></span> <span class="kwd">Local</span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span>)) <span class="id"><a href="compcert.backend.Stackingproof.html#v">v</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof3999')">Proof.</div>
<div class="proofscript" id="proof3999">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span>, <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents_1">frame_contents_1</a></span>; <span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Lineartyping.html#slot_valid">slot_valid</a></span> <span class="kwd">in</span> <span class="id">H1</span>; <span class="id">InvBooleans</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Separation.html#mconj_proj1">mconj_proj1</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj1">sep_proj1</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj1">sep_proj1</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#get_location">get_location</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="frame_get_outgoing">frame_get_outgoing</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ofs</span> <span class="id">ty</span> <span class="id">j</span> <span class="id">sp</span> <span class="id">ls</span> <span class="id">ls0</span> <span class="id">parent</span> <span class="id">retaddr</span> <span class="id">m</span> <span class="id">P</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span> |= <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0">ls0</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#parent">parent</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#retaddr">retaddr</a></span> ** <span class="id"><a href="compcert.backend.Stackingproof.html#P">P</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Bounds.html#slot_within_bounds">slot_within_bounds</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.b">b</a></span> <span class="id"><a href="compcert.backend.Locations.html#Outgoing">Outgoing</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span> -&gt; <span class="id"><a href="compcert.backend.Lineartyping.html#slot_valid">slot_valid</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.f">f</a></span> <span class="id"><a href="compcert.backend.Locations.html#Outgoing">Outgoing</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Mach.html#load_stack">load_stack</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> (<span class="id"><a href="compcert.backend.Stacking.html#offset_arg">offset_arg</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span>)) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v">v</a></span><br/>
&nbsp;&nbsp;/\ <span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> (<span class="id"><a href="compcert.backend.Locations.html#S">S</a></span> <span class="id"><a href="compcert.backend.Locations.html#Outgoing">Outgoing</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span>)) <span class="id"><a href="compcert.backend.Stackingproof.html#v">v</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4000')">Proof.</div>
<div class="proofscript" id="proof4000">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span>, <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents_1">frame_contents_1</a></span>; <span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Lineartyping.html#slot_valid">slot_valid</a></span> <span class="kwd">in</span> <span class="id">H1</span>; <span class="id">InvBooleans</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Separation.html#mconj_proj1">mconj_proj1</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj1">sep_proj1</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Separation.html#sep_pick2">sep_pick2</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#get_location">get_location</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="frame_get_parent">frame_get_parent</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">j</span> <span class="id">sp</span> <span class="id">ls</span> <span class="id">ls0</span> <span class="id">parent</span> <span class="id">retaddr</span> <span class="id">m</span> <span class="id">P</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span> |= <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0">ls0</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#parent">parent</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#retaddr">retaddr</a></span> ** <span class="id"><a href="compcert.backend.Stackingproof.html#P">P</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Mach.html#load_stack">load_stack</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="compcert.common.AST.html#Tptr">Tptr</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.fe">fe</a></span>.(<span class="id"><a href="compcert.backend.Bounds.html#fe_ofs_link">fe_ofs_link</a></span>)) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#parent">parent</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4001')">Proof.</div>
<div class="proofscript" id="proof4001">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span>, <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents_1">frame_contents_1</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Separation.html#mconj_proj1">mconj_proj1</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj1">sep_proj1</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Separation.html#sep_pick3">sep_pick3</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.common.AST.html#chunk_of_Tptr">chunk_of_Tptr</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#hasvalue_get_stack">hasvalue_get_stack</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="frame_get_retaddr">frame_get_retaddr</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">j</span> <span class="id">sp</span> <span class="id">ls</span> <span class="id">ls0</span> <span class="id">parent</span> <span class="id">retaddr</span> <span class="id">m</span> <span class="id">P</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span> |= <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0">ls0</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#parent">parent</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#retaddr">retaddr</a></span> ** <span class="id"><a href="compcert.backend.Stackingproof.html#P">P</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Mach.html#load_stack">load_stack</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="compcert.common.AST.html#Tptr">Tptr</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.fe">fe</a></span>.(<span class="id"><a href="compcert.backend.Bounds.html#fe_ofs_retaddr">fe_ofs_retaddr</a></span>)) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#retaddr">retaddr</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4002')">Proof.</div>
<div class="proofscript" id="proof4002">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span>, <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents_1">frame_contents_1</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Separation.html#mconj_proj1">mconj_proj1</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj1">sep_proj1</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Separation.html#sep_pick4">sep_pick4</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.common.AST.html#chunk_of_Tptr">chunk_of_Tptr</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#hasvalue_get_stack">hasvalue_get_stack</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Assigning a <span class="bracket"><span class="kwd">Local</span></span> or <span class="bracket"><span class="id">Outgoing</span></span> stack slot. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="frame_set_local">frame_set_local</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ofs</span> <span class="id">ty</span> <span class="id">v</span> <span class="id">v</span>' <span class="id">j</span> <span class="id">sp</span> <span class="id">ls</span> <span class="id">ls0</span> <span class="id">parent</span> <span class="id">retaddr</span> <span class="id">m</span> <span class="id">P</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span> |= <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0">ls0</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#parent">parent</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#retaddr">retaddr</a></span> ** <span class="id"><a href="compcert.backend.Stackingproof.html#P">P</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Bounds.html#slot_within_bounds">slot_within_bounds</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.b">b</a></span> <span class="kwd">Local</span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span> -&gt; <span class="id"><a href="compcert.backend.Lineartyping.html#slot_valid">slot_valid</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.f">f</a></span> <span class="kwd">Local</span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v">v</a></span> <span class="id">v</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">m</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Mach.html#store_stack">store_stack</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> (<span class="id"><a href="compcert.backend.Stacking.html#offset_local">offset_local</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.fe">fe</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span>)) <span class="id">v</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m</span>'<br/>
&nbsp;&nbsp;/\ <span class="id">m</span>' |= <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> (<span class="id"><a href="compcert.backend.Locations.html#Locmap.set">Locmap.set</a></span> (<span class="id"><a href="compcert.backend.Locations.html#S">S</a></span> <span class="kwd">Local</span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#v">v</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ls0">ls0</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#parent">parent</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#retaddr">retaddr</a></span> ** <span class="id"><a href="compcert.backend.Stackingproof.html#P">P</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4003')">Proof.</div>
<div class="proofscript" id="proof4003">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Separation.html#mconj_proj1">mconj_proj1</a></span>; <span class="tactic">eauto</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents_1">frame_contents_1</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> ! <span class="id"><a href="compcert.common.Separation.html#sep_assoc">sep_assoc</a></span>; <span class="tactic">intros</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Lineartyping.html#slot_valid">slot_valid</a></span> <span class="kwd">in</span> <span class="id">H1</span>; <span class="id">InvBooleans</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Stackingproof.html#set_location">set_location</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">m</span>' &amp; <span class="id">A</span> &amp; <span class="id">B</span>).<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">m</span>'; <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">i</span> <span class="id">k</span> <span class="id">p</span>, <span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id">m</span> <span class="id">sp</span> <span class="id"><a href="compcert.backend.Stackingproof.html#i">i</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#k">k</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#p">p</a></span> -&gt; <span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id">m</span>' <span class="id">sp</span> <span class="id"><a href="compcert.backend.Stackingproof.html#i">i</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#k">k</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#p">p</a></span>).<br/>
&nbsp;&nbsp;{  <span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Mach.html#store_stack">store_stack</a></span> <span class="kwd">in</span> <span class="id">A</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">A</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_store_1">Mem.perm_store_1</a></span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Separation.html#frame_mconj">frame_mconj</a></span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents_1">frame_contents_1</a></span>; <span class="tactic">rewrite</span> ! <span class="id"><a href="compcert.common.Separation.html#sep_assoc">sep_assoc</a></span>; <span class="tactic">exact</span> <span class="id">B</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Separation.html#sep_preserved">sep_preserved</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj1">sep_proj1</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Separation.html#mconj_proj2">mconj_proj2</a></span>. <span class="id">eassumption</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Separation.html#range_preserved">range_preserved</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Separation.html#range_preserved">range_preserved</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="frame_set_outgoing">frame_set_outgoing</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ofs</span> <span class="id">ty</span> <span class="id">v</span> <span class="id">v</span>' <span class="id">j</span> <span class="id">sp</span> <span class="id">ls</span> <span class="id">ls0</span> <span class="id">parent</span> <span class="id">retaddr</span> <span class="id">m</span> <span class="id">P</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span> |= <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0">ls0</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#parent">parent</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#retaddr">retaddr</a></span> ** <span class="id"><a href="compcert.backend.Stackingproof.html#P">P</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Bounds.html#slot_within_bounds">slot_within_bounds</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.b">b</a></span> <span class="id"><a href="compcert.backend.Locations.html#Outgoing">Outgoing</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span> -&gt; <span class="id"><a href="compcert.backend.Lineartyping.html#slot_valid">slot_valid</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.f">f</a></span> <span class="id"><a href="compcert.backend.Locations.html#Outgoing">Outgoing</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v">v</a></span> <span class="id">v</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">m</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Mach.html#store_stack">store_stack</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> (<span class="id"><a href="compcert.backend.Stacking.html#offset_arg">offset_arg</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span>)) <span class="id">v</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m</span>'<br/>
&nbsp;&nbsp;/\ <span class="id">m</span>' |= <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> (<span class="id"><a href="compcert.backend.Locations.html#Locmap.set">Locmap.set</a></span> (<span class="id"><a href="compcert.backend.Locations.html#S">S</a></span> <span class="id"><a href="compcert.backend.Locations.html#Outgoing">Outgoing</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#v">v</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ls0">ls0</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#parent">parent</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#retaddr">retaddr</a></span> ** <span class="id"><a href="compcert.backend.Stackingproof.html#P">P</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4004')">Proof.</div>
<div class="proofscript" id="proof4004">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Separation.html#mconj_proj1">mconj_proj1</a></span>; <span class="tactic">eauto</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents_1">frame_contents_1</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> ! <span class="id"><a href="compcert.common.Separation.html#sep_assoc">sep_assoc</a></span>, <span class="id"><a href="compcert.common.Separation.html#sep_swap">sep_swap</a></span>. <span class="tactic">intros</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Lineartyping.html#slot_valid">slot_valid</a></span> <span class="kwd">in</span> <span class="id">H1</span>; <span class="id">InvBooleans</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Stackingproof.html#set_location">set_location</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">m</span>' &amp; <span class="id">A</span> &amp; <span class="id">B</span>).<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">m</span>'; <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">i</span> <span class="id">k</span> <span class="id">p</span>, <span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id">m</span> <span class="id">sp</span> <span class="id"><a href="compcert.backend.Stackingproof.html#i">i</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#k">k</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#p">p</a></span> -&gt; <span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id">m</span>' <span class="id">sp</span> <span class="id"><a href="compcert.backend.Stackingproof.html#i">i</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#k">k</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#p">p</a></span>).<br/>
&nbsp;&nbsp;{  <span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Mach.html#store_stack">store_stack</a></span> <span class="kwd">in</span> <span class="id">A</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">A</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_store_1">Mem.perm_store_1</a></span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Separation.html#frame_mconj">frame_mconj</a></span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents_1">frame_contents_1</a></span>; <span class="tactic">rewrite</span> ! <span class="id"><a href="compcert.common.Separation.html#sep_assoc">sep_assoc</a></span>, <span class="id"><a href="compcert.common.Separation.html#sep_swap">sep_swap</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Separation.html#sep_preserved">sep_preserved</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj1">sep_proj1</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Separation.html#mconj_proj2">mconj_proj2</a></span>. <span class="id">eassumption</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Separation.html#range_preserved">range_preserved</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Separation.html#range_preserved">range_preserved</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Invariance by change of location maps. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="frame_contents_exten">frame_contents_exten</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ls</span> <span class="id">ls0</span> <span class="id">ls</span>' <span class="id">ls0</span>' <span class="id">j</span> <span class="id">sp</span> <span class="id">parent</span> <span class="id">retaddr</span> <span class="id">P</span> <span class="id">m</span>,<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">ofs</span> <span class="id">ty</span>, <span class="id"><a href="compcert.common.Values.html#Val.lessdef">Val.lessdef</a></span> (<span class="id">ls</span>' (<span class="id"><a href="compcert.backend.Locations.html#S">S</a></span> <span class="kwd">Local</span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span>)) (<span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> (<span class="id"><a href="compcert.backend.Locations.html#S">S</a></span> <span class="kwd">Local</span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span>))) -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">ofs</span> <span class="id">ty</span>, <span class="id"><a href="compcert.common.Values.html#Val.lessdef">Val.lessdef</a></span> (<span class="id">ls</span>' (<span class="id"><a href="compcert.backend.Locations.html#S">S</a></span> <span class="id"><a href="compcert.backend.Locations.html#Outgoing">Outgoing</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span>)) (<span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> (<span class="id"><a href="compcert.backend.Locations.html#S">S</a></span> <span class="id"><a href="compcert.backend.Locations.html#Outgoing">Outgoing</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span>))) -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">r</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.b">b</a></span>.(<span class="id"><a href="compcert.backend.Bounds.html#used_callee_save">used_callee_save</a></span>) -&gt; <span class="id">ls0</span>' (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span>) = <span class="id"><a href="compcert.backend.Stackingproof.html#ls0">ls0</a></span> (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span>)) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span> |= <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0">ls0</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#parent">parent</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#retaddr">retaddr</a></span> ** <span class="id"><a href="compcert.backend.Stackingproof.html#P">P</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span> |= <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id">ls</span>' <span class="id">ls0</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#parent">parent</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#retaddr">retaddr</a></span> ** <span class="id"><a href="compcert.backend.Stackingproof.html#P">P</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4005')">Proof.</div>
<div class="proofscript" id="proof4005">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span>, <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents_1">frame_contents_1</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- ! (<span class="id"><a href="compcert.backend.Stackingproof.html#contains_locations_exten">contains_locations_exten</a></span> <span class="id">ls</span> <span class="id">ls</span>') <span class="tactic">by</span> <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">erewrite</span>  &lt;- <span class="id"><a href="compcert.backend.Stackingproof.html#contains_callee_saves_exten">contains_callee_saves_exten</a></span> <span class="tactic">by</span> <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assumption</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Invariance by assignment to registers. </div>
<br/>
<span class="kwd">Corollary</span> <span class="id"><a name="frame_set_reg">frame_set_reg</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span> <span class="id">v</span> <span class="id">j</span> <span class="id">sp</span> <span class="id">ls</span> <span class="id">ls0</span> <span class="id">parent</span> <span class="id">retaddr</span> <span class="id">m</span> <span class="id">P</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span> |= <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0">ls0</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#parent">parent</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#retaddr">retaddr</a></span> ** <span class="id"><a href="compcert.backend.Stackingproof.html#P">P</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span> |= <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> (<span class="id"><a href="compcert.backend.Locations.html#Locmap.set">Locmap.set</a></span> (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#v">v</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ls0">ls0</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#parent">parent</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#retaddr">retaddr</a></span> ** <span class="id"><a href="compcert.backend.Stackingproof.html#P">P</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4006')">Proof.</div>
<div class="proofscript" id="proof4006">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents_exten">frame_contents_exten</a></span> <span class="kwd">with</span> <span class="id">ls</span> <span class="id">ls0</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Corollary</span> <span class="id"><a name="frame_undef_regs">frame_undef_regs</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">j</span> <span class="id">sp</span> <span class="id">ls</span> <span class="id">ls0</span> <span class="id">parent</span> <span class="id">retaddr</span> <span class="id">m</span> <span class="id">P</span> <span class="id">rl</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span> |= <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0">ls0</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#parent">parent</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#retaddr">retaddr</a></span> ** <span class="id"><a href="compcert.backend.Stackingproof.html#P">P</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span> |= <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> (<span class="id"><a href="compcert.backend.LTL.html#undef_regs">LTL.undef_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rl">rl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ls0">ls0</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#parent">parent</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#retaddr">retaddr</a></span> ** <span class="id"><a href="compcert.backend.Stackingproof.html#P">P</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4007')">Proof.</div>
<div class="proofscript" id="proof4007">
<span class="kwd">Local</span> <span class="id">Opaque</span> <span class="id"><a href="compcert.common.Separation.html#sepconj">sepconj</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">rl</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
- <span class="tactic">auto</span>.<br/>
- <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_set_reg">frame_set_reg</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Corollary</span> <span class="id"><a name="frame_set_regpair">frame_set_regpair</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">j</span> <span class="id">sp</span> <span class="id">ls0</span> <span class="id">parent</span> <span class="id">retaddr</span> <span class="id">m</span> <span class="id">P</span> <span class="id">p</span> <span class="id">v</span> <span class="id">ls</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span> |= <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0">ls0</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#parent">parent</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#retaddr">retaddr</a></span> ** <span class="id"><a href="compcert.backend.Stackingproof.html#P">P</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span> |= <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> (<span class="id"><a href="compcert.backend.Locations.html#Locmap.setpair">Locmap.setpair</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#p">p</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v">v</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ls0">ls0</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#parent">parent</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#retaddr">retaddr</a></span> ** <span class="id"><a href="compcert.backend.Stackingproof.html#P">P</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4008')">Proof.</div>
<div class="proofscript" id="proof4008">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">p</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_set_reg">frame_set_reg</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_set_reg">frame_set_reg</a></span>; <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_set_reg">frame_set_reg</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Corollary</span> <span class="id"><a name="frame_set_res">frame_set_res</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">j</span> <span class="id">sp</span> <span class="id">ls0</span> <span class="id">parent</span> <span class="id">retaddr</span> <span class="id">m</span> <span class="id">P</span> <span class="id">res</span> <span class="id">v</span> <span class="id">ls</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span> |= <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0">ls0</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#parent">parent</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#retaddr">retaddr</a></span> ** <span class="id"><a href="compcert.backend.Stackingproof.html#P">P</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span> |= <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> (<span class="id"><a href="compcert.backend.Locations.html#Locmap.setres">Locmap.setres</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#res">res</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v">v</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ls0">ls0</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#parent">parent</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#retaddr">retaddr</a></span> ** <span class="id"><a href="compcert.backend.Stackingproof.html#P">P</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4009')">Proof.</div>
<div class="proofscript" id="proof4009">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">res</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
- <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_set_reg">frame_set_reg</a></span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">auto</span>.<br/>
- <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Invariance by change of memory injection. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="frame_contents_incr">frame_contents_incr</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">j</span> <span class="id">sp</span> <span class="id">ls</span> <span class="id">ls0</span> <span class="id">parent</span> <span class="id">retaddr</span> <span class="id">m</span> <span class="id">P</span> <span class="id">j</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span> |= <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0">ls0</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#parent">parent</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#retaddr">retaddr</a></span> ** <span class="id"><a href="compcert.backend.Stackingproof.html#P">P</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Values.html#inject_incr">inject_incr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id">j</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span> |= <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span> <span class="id">j</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0">ls0</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#parent">parent</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#retaddr">retaddr</a></span> ** <span class="id"><a href="compcert.backend.Stackingproof.html#P">P</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4010')">Proof.</div>
<div class="proofscript" id="proof4010">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span>, <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents_1">frame_contents_1</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="compcert.backend.Stackingproof.html#contains_locations_incr">contains_locations_incr</a></span> <span class="id">j</span> <span class="id">j</span>') <span class="tactic">by</span> <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="compcert.backend.Stackingproof.html#contains_locations_incr">contains_locations_incr</a></span> <span class="id">j</span> <span class="id">j</span>') <span class="tactic">by</span> <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">erewrite</span>  &lt;- <span class="id"><a href="compcert.backend.Stackingproof.html#contains_callee_saves_incr">contains_callee_saves_incr</a></span> <span class="tactic">by</span> <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assumption</span>.<br/>
Qed.</div>
<br/>
<h1> Agreement between location sets and Mach states </h1>
<br/>
<div class="doc">Agreement with Mach register states </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="agree_regs">agree_regs</a></span> (<span class="id">j</span>: <span class="id"><a href="compcert.common.Values.html#meminj">meminj</a></span>) (<span class="id">ls</span>: <span class="id"><a href="compcert.backend.Linear.html#locset">locset</a></span>) (<span class="id">rs</span>: <span class="id"><a href="compcert.backend.Mach.html#regset">regset</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span>, <span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span>)) (<span class="id"><a href="compcert.backend.Stackingproof.html#rs">rs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span>).<br/>
<br/>
<div class="doc">Agreement over locations </div>
<br/>
<span class="kwd">Record</span> <span class="id"><a name="agree_locs">agree_locs</a></span> (<span class="id">ls</span> <span class="id">ls0</span>: <span class="id"><a href="compcert.backend.Linear.html#locset">locset</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id"><a name="mk_agree_locs">mk_agree_locs</a></span> {<br/>
<br/>
<div class="doc">Unused registers have the same value as in the caller </div>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="agree_unused_reg">agree_unused_reg</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span>, ~(<span class="id"><a href="compcert.backend.Bounds.html#mreg_within_bounds">mreg_within_bounds</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.b">b</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span>) -&gt; <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span>) = <span class="id"><a href="compcert.backend.Stackingproof.html#ls0">ls0</a></span> (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span>);<br/>
<br/>
<div class="doc">Incoming stack slots have the same value as the
        corresponding Outgoing stack slots in the caller </div>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a name="agree_incoming">agree_incoming</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ofs</span> <span class="id">ty</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="compcert.backend.Locations.html#S">S</a></span> <span class="id"><a href="compcert.backend.Locations.html#Incoming">Incoming</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span>) (<span class="id"><a href="compcert.common.AST.html#regs_of_rpairs">regs_of_rpairs</a></span> (<span class="id"><a href="compcert.backend.Conventions.html#loc_parameters">loc_parameters</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.f">f</a></span>.(<span class="id"><a href="compcert.backend.Linear.html#fn_sig">Linear.fn_sig</a></span>))) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> (<span class="id"><a href="compcert.backend.Locations.html#S">S</a></span> <span class="id"><a href="compcert.backend.Locations.html#Incoming">Incoming</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span>) = <span class="id"><a href="compcert.backend.Stackingproof.html#ls0">ls0</a></span> (<span class="id"><a href="compcert.backend.Locations.html#S">S</a></span> <span class="id"><a href="compcert.backend.Locations.html#Outgoing">Outgoing</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span>)<br/>
}.<br/>
<br/>
<h2> Properties of <span class="bracket"><span class="id">agree_regs</span></span>. </h2>
<br/>
<div class="doc">Values of registers </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_reg">agree_reg</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">j</span> <span class="id">ls</span> <span class="id">rs</span> <span class="id">r</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs">rs</a></span> -&gt; <span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span>)) (<span class="id"><a href="compcert.backend.Stackingproof.html#rs">rs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4011')">Proof.</div>
<div class="proofscript" id="proof4011">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_reglist">agree_reglist</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">j</span> <span class="id">ls</span> <span class="id">rs</span> <span class="id">rl</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs">rs</a></span> -&gt; <span class="id"><a href="compcert.common.Values.html#Val.inject_list">Val.inject_list</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> (<span class="id"><a href="compcert.backend.LTL.html#reglist">reglist</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rl">rl</a></span>) (<span class="id"><a href="compcert.backend.Stackingproof.html#rs">rs</a></span>##<span class="id"><a href="compcert.backend.Stackingproof.html#rl">rl</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4012')">Proof.</div>
<div class="proofscript" id="proof4012">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">rl</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="id">constructor</span>; <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_reg">agree_reg</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">agree_reg</span> <span class="id">agree_reglist</span>: <span class="id">stacking</span>.<br/>
<br/>
<div class="doc">Preservation under assignments of machine registers. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_regs_set_reg">agree_regs_set_reg</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">j</span> <span class="id">ls</span> <span class="id">rs</span> <span class="id">r</span> <span class="id">v</span> <span class="id">v</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs">rs</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v">v</a></span> <span class="id">v</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> (<span class="id"><a href="compcert.backend.Locations.html#Locmap.set">Locmap.set</a></span> (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#v">v</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span>) (<span class="id"><a href="compcert.backend.Mach.html#Regmap.set">Regmap.set</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span> <span class="id">v</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#rs">rs</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4013')">Proof.</div>
<div class="proofscript" id="proof4013">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Mach.html#Regmap.set">Regmap.set</a></span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.backend.Mach.html#RegEq.eq">RegEq.eq</a></span> <span class="id">r0</span> <span class="id">r</span>). <span class="tactic">subst</span> <span class="id">r0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Locations.html#Locmap.gss">Locmap.gss</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Locations.html#Locmap.gso">Locmap.gso</a></span>; <span class="tactic">auto</span>. <span class="tactic">red</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_regs_set_pair">agree_regs_set_pair</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">j</span> <span class="id">p</span> <span class="id">v</span> <span class="id">v</span>' <span class="id">ls</span> <span class="id">rs</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs">rs</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v">v</a></span> <span class="id">v</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> (<span class="id"><a href="compcert.backend.Locations.html#Locmap.setpair">Locmap.setpair</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#p">p</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v">v</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span>) (<span class="id"><a href="compcert.backend.Mach.html#set_pair">set_pair</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#p">p</a></span> <span class="id">v</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#rs">rs</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4014')">Proof.</div>
<div class="proofscript" id="proof4014">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">p</span>; <span class="tactic">simpl</span>.<br/>
- <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs_set_reg">agree_regs_set_reg</a></span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs_set_reg">agree_regs_set_reg</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs_set_reg">agree_regs_set_reg</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Values.html#Val.hiword_inject">Val.hiword_inject</a></span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Values.html#Val.loword_inject">Val.loword_inject</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_regs_set_res">agree_regs_set_res</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">j</span> <span class="id">res</span> <span class="id">v</span> <span class="id">v</span>' <span class="id">ls</span> <span class="id">rs</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs">rs</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v">v</a></span> <span class="id">v</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> (<span class="id"><a href="compcert.backend.Locations.html#Locmap.setres">Locmap.setres</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#res">res</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v">v</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span>) (<span class="id"><a href="compcert.backend.Mach.html#set_res">set_res</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#res">res</a></span> <span class="id">v</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#rs">rs</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4015')">Proof.</div>
<div class="proofscript" id="proof4015">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">res</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
- <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs_set_reg">agree_regs_set_reg</a></span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">auto</span>.<br/>
- <span class="tactic">apply</span> <span class="id">IHres2</span>. <span class="tactic">apply</span> <span class="id">IHres1</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Values.html#Val.hiword_inject">Val.hiword_inject</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Values.html#Val.loword_inject">Val.loword_inject</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_regs_exten">agree_regs_exten</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">j</span> <span class="id">ls</span> <span class="id">rs</span> <span class="id">ls</span>' <span class="id">rs</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs">rs</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">r</span>, <span class="id">ls</span>' (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span>) = <span class="id"><a href="compcert.common.Values.html#Vundef">Vundef</a></span> \/ <span class="id">ls</span>' (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span>) = <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span>) /\ <span class="id">rs</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span> = <span class="id"><a href="compcert.backend.Stackingproof.html#rs">rs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id">ls</span>' <span class="id">rs</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4016')">Proof.</div>
<div class="proofscript" id="proof4016">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">H0</span> <span class="id">r</span>) <span class="kwd">as</span> [<span class="id">A</span> | [<span class="id">A</span> <span class="id">B</span>]].<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">A</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">A</span>; <span class="tactic">rewrite</span> <span class="id">B</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_regs_undef_regs">agree_regs_undef_regs</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">j</span> <span class="id">rl</span> <span class="id">ls</span> <span class="id">rs</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs">rs</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> (<span class="id"><a href="compcert.backend.LTL.html#undef_regs">LTL.undef_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rl">rl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span>) (<span class="id"><a href="compcert.backend.Mach.html#undef_regs">Mach.undef_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rl">rl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs">rs</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4017')">Proof.</div>
<div class="proofscript" id="proof4017">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">rl</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs_set_reg">agree_regs_set_reg</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_regs_undef_caller_save_regs">agree_regs_undef_caller_save_regs</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">j</span> <span class="id">ls</span> <span class="id">rs</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs">rs</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> (<span class="id"><a href="compcert.backend.LTL.html#undef_caller_save_regs">LTL.undef_caller_save_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span>) (<span class="id"><a href="compcert.backend.Mach.html#undef_caller_save_regs">Mach.undef_caller_save_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs">rs</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4018')">Proof.</div>
<div class="proofscript" id="proof4018">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>. <br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.LTL.html#undef_caller_save_regs">LTL.undef_caller_save_regs</a></span>, <span class="id"><a href="compcert.backend.Mach.html#undef_caller_save_regs">Mach.undef_caller_save_regs</a></span>. <br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.x86.Conventions1.html#is_callee_save">is_callee_save</a></span> <span class="id">r</span>); <span class="tactic">auto</span>. <br/>
Qed.</div>
<br/>
<div class="doc">Preservation under assignment of stack slot </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_regs_set_slot">agree_regs_set_slot</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">j</span> <span class="id">ls</span> <span class="id">rs</span> <span class="id">sl</span> <span class="id">ofs</span> <span class="id">ty</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs">rs</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> (<span class="id"><a href="compcert.backend.Locations.html#Locmap.set">Locmap.set</a></span> (<span class="id"><a href="compcert.backend.Locations.html#S">S</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sl">sl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#v">v</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#rs">rs</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4019')">Proof.</div>
<div class="proofscript" id="proof4019">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Locations.html#Locmap.gso">Locmap.gso</a></span>; <span class="tactic">auto</span>. <span class="tactic">red</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Preservation by increasing memory injections </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_regs_inject_incr">agree_regs_inject_incr</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">j</span> <span class="id">ls</span> <span class="id">rs</span> <span class="id">j</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs">rs</a></span> -&gt; <span class="id"><a href="compcert.common.Values.html#inject_incr">inject_incr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id">j</span>' -&gt; <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id">j</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs">rs</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4020')">Proof.</div>
<div class="proofscript" id="proof4020">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">stacking</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Preservation at function entry. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_regs_call_regs">agree_regs_call_regs</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">j</span> <span class="id">ls</span> <span class="id">rs</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs">rs</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> (<span class="id"><a href="compcert.backend.LTL.html#call_regs">call_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#rs">rs</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4021')">Proof.</div>
<div class="proofscript" id="proof4021">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.LTL.html#call_regs">call_regs</a></span>; <span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<h2> Properties of <span class="bracket"><span class="id">agree_locs</span></span> </h2>
<br/>
<div class="doc">Preservation under assignment of machine register. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_locs_set_reg">agree_locs_set_reg</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ls</span> <span class="id">ls0</span> <span class="id">r</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs">agree_locs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0">ls0</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Bounds.html#mreg_within_bounds">mreg_within_bounds</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.b">b</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs">agree_locs</a></span> (<span class="id"><a href="compcert.backend.Locations.html#Locmap.set">Locmap.set</a></span> (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#v">v</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ls0">ls0</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4022')">Proof.</div>
<div class="proofscript" id="proof4022">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>; <span class="id">constructor</span>; <span class="tactic">auto</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Locations.html#Locmap.gso">Locmap.gso</a></span>. <span class="tactic">auto</span>. <span class="tactic">red</span>. <span class="tactic">intuition</span> <span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="caller_save_reg_within_bounds">caller_save_reg_within_bounds</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.x86.Conventions1.html#is_callee_save">is_callee_save</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> -&gt; <span class="id"><a href="compcert.backend.Bounds.html#mreg_within_bounds">mreg_within_bounds</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.b">b</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4023')">Proof.</div>
<div class="proofscript" id="proof4023">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_locs_set_pair">agree_locs_set_pair</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ls0</span> <span class="id">p</span> <span class="id">v</span> <span class="id">ls</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs">agree_locs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0">ls0</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.AST.html#forall_rpair">forall_rpair</a></span> (<span class="kwd">fun</span> <span class="id">r</span> =&gt; <span class="id"><a href="compcert.x86.Conventions1.html#is_callee_save">is_callee_save</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#p">p</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs">agree_locs</a></span> (<span class="id"><a href="compcert.backend.Locations.html#Locmap.setpair">Locmap.setpair</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#p">p</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v">v</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ls0">ls0</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4024')">Proof.</div>
<div class="proofscript" id="proof4024">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">p</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs_set_reg">agree_locs_set_reg</a></span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#caller_save_reg_within_bounds">caller_save_reg_within_bounds</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs_set_reg">agree_locs_set_reg</a></span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs_set_reg">agree_locs_set_reg</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#caller_save_reg_within_bounds">caller_save_reg_within_bounds</a></span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#caller_save_reg_within_bounds">caller_save_reg_within_bounds</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_locs_set_res">agree_locs_set_res</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ls0</span> <span class="id">res</span> <span class="id">v</span> <span class="id">ls</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs">agree_locs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0">ls0</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">r</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span> (<span class="id"><a href="compcert.common.AST.html#params_of_builtin_res">params_of_builtin_res</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#res">res</a></span>) -&gt; <span class="id"><a href="compcert.backend.Bounds.html#mreg_within_bounds">mreg_within_bounds</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.b">b</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs">agree_locs</a></span> (<span class="id"><a href="compcert.backend.Locations.html#Locmap.setres">Locmap.setres</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#res">res</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v">v</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ls0">ls0</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4025')">Proof.</div>
<div class="proofscript" id="proof4025">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">res</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
- <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs_set_reg">agree_locs_set_reg</a></span>; <span class="tactic">eauto</span>.<br/>
- <span class="tactic">auto</span>.<br/>
- <span class="tactic">apply</span> <span class="id">IHres2</span>; <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_or_app">in_or_app</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_locs_undef_regs">agree_locs_undef_regs</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ls0</span> <span class="id">regs</span> <span class="id">ls</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs">agree_locs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0">ls0</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">r</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#regs">regs</a></span> -&gt; <span class="id"><a href="compcert.backend.Bounds.html#mreg_within_bounds">mreg_within_bounds</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.b">b</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs">agree_locs</a></span> (<span class="id"><a href="compcert.backend.LTL.html#undef_regs">LTL.undef_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#regs">regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ls0">ls0</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4026')">Proof.</div>
<div class="proofscript" id="proof4026">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">regs</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs_set_reg">agree_locs_set_reg</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_locs_undef_locs_1">agree_locs_undef_locs_1</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ls0</span> <span class="id">regs</span> <span class="id">ls</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs">agree_locs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0">ls0</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">r</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#regs">regs</a></span> -&gt; <span class="id"><a href="compcert.x86.Conventions1.html#is_callee_save">is_callee_save</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs">agree_locs</a></span> (<span class="id"><a href="compcert.backend.LTL.html#undef_regs">LTL.undef_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#regs">regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ls0">ls0</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4027')">Proof.</div>
<div class="proofscript" id="proof4027">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs_undef_regs">agree_locs_undef_regs</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#caller_save_reg_within_bounds">caller_save_reg_within_bounds</a></span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_locs_undef_locs">agree_locs_undef_locs</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ls0</span> <span class="id">regs</span> <span class="id">ls</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs">agree_locs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0">ls0</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#existsb">existsb</a></span> <span class="id"><a href="compcert.x86.Conventions1.html#is_callee_save">is_callee_save</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#regs">regs</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs">agree_locs</a></span> (<span class="id"><a href="compcert.backend.LTL.html#undef_regs">LTL.undef_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#regs">regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ls0">ls0</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4028')">Proof.</div>
<div class="proofscript" id="proof4028">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs_undef_locs_1">agree_locs_undef_locs_1</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.x86.Conventions1.html#is_callee_save">is_callee_save</a></span> <span class="id">r</span>) <span class="id">eqn</span>:<span class="id">CS</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#existsb">existsb</a></span> <span class="id"><a href="compcert.x86.Conventions1.html#is_callee_save">is_callee_save</a></span> <span class="id">regs</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#existsb_exists">existsb_exists</a></span>. <span class="id">exists</span> <span class="id">r</span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Preservation by assignment to local slot </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_locs_set_slot">agree_locs_set_slot</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ls</span> <span class="id">ls0</span> <span class="id">sl</span> <span class="id">ofs</span> <span class="id">ty</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs">agree_locs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0">ls0</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Lineartyping.html#slot_writable">slot_writable</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sl">sl</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs">agree_locs</a></span> (<span class="id"><a href="compcert.backend.Locations.html#Locmap.set">Locmap.set</a></span> (<span class="id"><a href="compcert.backend.Locations.html#S">S</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sl">sl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#v">v</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ls0">ls0</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4029')">Proof.</div>
<div class="proofscript" id="proof4029">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H</span>; <span class="id">constructor</span>; <span class="tactic">intros</span>.<br/>
- <span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Locations.html#Locmap.gso">Locmap.gso</a></span>; <span class="tactic">auto</span>. <span class="tactic">red</span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Locations.html#Locmap.gso">Locmap.gso</a></span>; <span class="tactic">auto</span>. <span class="tactic">red</span>. <span class="id">left</span>. <span class="tactic">destruct</span> <span class="id">sl</span>; <span class="tactic">discriminate</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Preservation at return points (when <span class="bracket"><span class="id">ls</span></span> is changed but not <span class="bracket"><span class="id">ls0</span></span>). </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_locs_return">agree_locs_return</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ls</span> <span class="id">ls0</span> <span class="id">ls</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs">agree_locs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0">ls0</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Conventions.html#agree_callee_save">agree_callee_save</a></span> <span class="id">ls</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs">agree_locs</a></span> <span class="id">ls</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#ls0">ls0</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4030')">Proof.</div>
<div class="proofscript" id="proof4030">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">red</span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="id">inv</span> <span class="id">H</span>; <span class="id">constructor</span>; <span class="tactic">auto</span>; <span class="tactic">intros</span>.<br/>
- <span class="tactic">rewrite</span> <span class="id">H0</span>; <span class="tactic">auto</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Bounds.html#mreg_within_bounds">mreg_within_bounds</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">tauto</span>.<br/>
- <span class="tactic">rewrite</span> &lt;- <span class="id">agree_incoming0</span> <span class="tactic">by</span> <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id">H0</span>. <span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_callee_save_set_result">agree_callee_save_set_result</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">sg</span> <span class="id">v</span> <span class="id">ls1</span> <span class="id">ls2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Conventions.html#agree_callee_save">agree_callee_save</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls1">ls1</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls2">ls2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Conventions.html#agree_callee_save">agree_callee_save</a></span> (<span class="id"><a href="compcert.backend.Locations.html#Locmap.setpair">Locmap.setpair</a></span> (<span class="id"><a href="compcert.x86.Conventions1.html#loc_result">loc_result</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sg">sg</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#v">v</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls1">ls1</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ls2">ls2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4031')">Proof.</div>
<div class="proofscript" id="proof4031">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Locations.html#Locmap.gpo">Locmap.gpo</a></span>. <span class="tactic">apply</span> <span class="id">H</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">X</span>: <span class="kwd">forall</span> <span class="id">r</span>, <span class="id"><a href="compcert.x86.Conventions1.html#is_callee_save">is_callee_save</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> -&gt; <span class="id"><a href="compcert.backend.Locations.html#Loc.diff">Loc.diff</a></span> <span class="id">l</span> (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span>)).<br/>
&nbsp;&nbsp;{ <span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">l</span>; <span class="tactic">auto</span>. <span class="tactic">simpl</span>; <span class="tactic">congruence</span>. <span class="tactic">simpl</span>. <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="compcert.x86.Conventions1.html#loc_result_caller_save">loc_result_caller_save</a></span> <span class="id">sg</span>). <span class="tactic">destruct</span> (<span class="id"><a href="compcert.x86.Conventions1.html#loc_result">loc_result</a></span> <span class="id">sg</span>); <span class="tactic">simpl</span>; <span class="tactic">intuition</span> <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_callee_save_regs_set_result">agree_callee_save_regs_set_result</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">sg</span> <span class="id">v</span> <span class="id">ls1</span> <span class="id">ls2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Conventions.html#agree_callee_save_regs">agree_callee_save_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls1">ls1</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls2">ls2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Conventions.html#agree_callee_save_regs">agree_callee_save_regs</a></span> (<span class="id"><a href="compcert.backend.Locations.html#Locmap.setpair">Locmap.setpair</a></span> (<span class="id"><a href="compcert.x86.Conventions1.html#loc_result">loc_result</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sg">sg</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#v">v</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls1">ls1</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ls2">ls2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4032')">Proof.</div>
<div class="proofscript" id="proof4032">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Locations.html#Locmap.gpo">Locmap.gpo</a></span>. <span class="tactic">apply</span> <span class="id">H</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="compcert.x86.Conventions1.html#loc_result_caller_save">loc_result_caller_save</a></span> <span class="id">sg</span>). <span class="tactic">destruct</span> (<span class="id"><a href="compcert.x86.Conventions1.html#loc_result">loc_result</a></span> <span class="id">sg</span>); <span class="tactic">simpl</span>; <span class="tactic">intuition</span> <span class="tactic">auto</span>; <span class="id">clarify</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_callee_save_after">agree_callee_save_after</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ls1</span> <span class="id">ls2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Conventions.html#agree_callee_save">agree_callee_save</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls1">ls1</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls2">ls2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Conventions.html#agree_callee_save">agree_callee_save</a></span> (<span class="id"><a href="compcert.backend.LTL.html#undef_caller_save_regs">LTL.undef_caller_save_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls1">ls1</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ls2">ls2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4033')">Proof.</div>
<div class="proofscript" id="proof4033">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.LTL.html#undef_caller_save_regs">LTL.undef_caller_save_regs</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">l</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">H0</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">destruct</span> <span class="id">sl</span>; <span class="tactic">auto</span>. <span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="agree_callee_save_regs_after">agree_callee_save_regs_after</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ls1</span> <span class="id">ls2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Conventions.html#agree_callee_save_regs">agree_callee_save_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls1">ls1</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls2">ls2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Conventions.html#agree_callee_save_regs">agree_callee_save_regs</a></span> (<span class="id"><a href="compcert.backend.LTL.html#undef_caller_save_regs">LTL.undef_caller_save_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls1">ls1</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ls2">ls2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4034')">Proof.</div>
<div class="proofscript" id="proof4034">
 <span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.LTL.html#undef_caller_save_regs">LTL.undef_caller_save_regs</a></span>. <span class="tactic">rewrite</span> <span class="id">H0</span>. <span class="tactic">auto</span>. Qed.</div>
<br/>
<h2> Properties of destroyed registers. </h2>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="no_callee_saves">no_callee_saves</a></span> (<span class="id">l</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.x86.Machregs.html#mreg">mreg</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#existsb">existsb</a></span> <span class="id"><a href="compcert.x86.Conventions1.html#is_callee_save">is_callee_save</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#l">l</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>.<br/>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="destroyed_by_op_caller_save">destroyed_by_op_caller_save</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">op</span>, <span class="id"><a href="compcert.backend.Stackingproof.html#no_callee_saves">no_callee_saves</a></span> (<span class="id"><a href="compcert.x86.Machregs.html#destroyed_by_op">destroyed_by_op</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#op">op</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4035')">Proof.</div>
<div class="proofscript" id="proof4035">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Stackingproof.html#no_callee_saves">no_callee_saves</a></span>; <span class="tactic">destruct</span> <span class="id">op</span>; (<span class="tactic">reflexivity</span> || <span class="tactic">destruct</span> <span class="id">c</span>; <span class="tactic">reflexivity</span>).<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="destroyed_by_load_caller_save">destroyed_by_load_caller_save</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">chunk</span> <span class="id">addr</span>, <span class="id"><a href="compcert.backend.Stackingproof.html#no_callee_saves">no_callee_saves</a></span> (<span class="id"><a href="compcert.x86.Machregs.html#destroyed_by_load">destroyed_by_load</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#chunk">chunk</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#addr">addr</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4036')">Proof.</div>
<div class="proofscript" id="proof4036">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Stackingproof.html#no_callee_saves">no_callee_saves</a></span>; <span class="tactic">destruct</span> <span class="id">chunk</span>; <span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="destroyed_by_store_caller_save">destroyed_by_store_caller_save</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">chunk</span> <span class="id">addr</span>, <span class="id"><a href="compcert.backend.Stackingproof.html#no_callee_saves">no_callee_saves</a></span> (<span class="id"><a href="compcert.x86.Machregs.html#destroyed_by_store">destroyed_by_store</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#chunk">chunk</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#addr">addr</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4037')">Proof.</div>
<div class="proofscript" id="proof4037">
<span class="kwd">Local</span> <span class="id">Transparent</span> <span class="id"><a href="compcert.x86.Machregs.html#destroyed_by_store">destroyed_by_store</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Stackingproof.html#no_callee_saves">no_callee_saves</a></span>, <span class="id"><a href="compcert.x86.Machregs.html#destroyed_by_store">destroyed_by_store</a></span>; <span class="tactic">intros</span>; <span class="tactic">destruct</span> <span class="id">chunk</span>; <span class="tactic">try</span> <span class="tactic">reflexivity</span>; <span class="tactic">destruct</span> <span class="id"><a href="compcert.x86_64.Archi.html#ptr64">Archi.ptr64</a></span>; <span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="destroyed_by_cond_caller_save">destroyed_by_cond_caller_save</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">cond</span>, <span class="id"><a href="compcert.backend.Stackingproof.html#no_callee_saves">no_callee_saves</a></span> (<span class="id"><a href="compcert.x86.Machregs.html#destroyed_by_cond">destroyed_by_cond</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cond">cond</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4038')">Proof.</div>
<div class="proofscript" id="proof4038">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Stackingproof.html#no_callee_saves">no_callee_saves</a></span>; <span class="tactic">destruct</span> <span class="id">cond</span>; <span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="destroyed_by_jumptable_caller_save">destroyed_by_jumptable_caller_save</a></span>:<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#no_callee_saves">no_callee_saves</a></span> <span class="id"><a href="compcert.x86.Machregs.html#destroyed_by_jumptable">destroyed_by_jumptable</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4039')">Proof.</div>
<div class="proofscript" id="proof4039">
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="destroyed_by_setstack_caller_save">destroyed_by_setstack_caller_save</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ty</span>, <span class="id"><a href="compcert.backend.Stackingproof.html#no_callee_saves">no_callee_saves</a></span> (<span class="id"><a href="compcert.x86.Machregs.html#destroyed_by_setstack">destroyed_by_setstack</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4040')">Proof.</div>
<div class="proofscript" id="proof4040">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Stackingproof.html#no_callee_saves">no_callee_saves</a></span>; <span class="tactic">destruct</span> <span class="id">ty</span>; <span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="destroyed_at_function_entry_caller_save">destroyed_at_function_entry_caller_save</a></span>:<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#no_callee_saves">no_callee_saves</a></span> <span class="id"><a href="compcert.x86.Machregs.html#destroyed_at_function_entry">destroyed_at_function_entry</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4041')">Proof.</div>
<div class="proofscript" id="proof4041">
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hint</span> <span class="kwd">Resolve</span> <span class="id">destroyed_by_op_caller_save</span> <span class="id">destroyed_by_load_caller_save</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destroyed_by_store_caller_save</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destroyed_by_cond_caller_save</span> <span class="id">destroyed_by_jumptable_caller_save</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">destroyed_at_function_entry_caller_save</span>: <span class="id">stacking</span>.<br/>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="destroyed_by_setstack_function_entry">destroyed_by_setstack_function_entry</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ty</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#incl">incl</a></span> (<span class="id"><a href="compcert.x86.Machregs.html#destroyed_by_setstack">destroyed_by_setstack</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span>) <span class="id"><a href="compcert.x86.Machregs.html#destroyed_at_function_entry">destroyed_at_function_entry</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4042')">Proof.</div>
<div class="proofscript" id="proof4042">
<span class="kwd">Local</span> <span class="id">Transparent</span> <span class="id"><a href="compcert.x86.Machregs.html#destroyed_by_setstack">destroyed_by_setstack</a></span> <span class="id"><a href="compcert.x86.Machregs.html#destroyed_at_function_entry">destroyed_at_function_entry</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#incl">incl</a></span>; <span class="tactic">destruct</span> <span class="id">ty</span>; <span class="tactic">simpl</span>; <span class="tactic">tauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="transl_destroyed_by_op">transl_destroyed_by_op</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">op</span> <span class="id">e</span>, <span class="id"><a href="compcert.x86.Machregs.html#destroyed_by_op">destroyed_by_op</a></span> (<span class="id"><a href="compcert.backend.Stacking.html#transl_op">transl_op</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#e">e</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#op">op</a></span>) = <span class="id"><a href="compcert.x86.Machregs.html#destroyed_by_op">destroyed_by_op</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#op">op</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4043')">Proof.</div>
<div class="proofscript" id="proof4043">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">destruct</span> <span class="id">op</span>; <span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="transl_destroyed_by_load">transl_destroyed_by_load</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">chunk</span> <span class="id">addr</span> <span class="id">e</span>, <span class="id"><a href="compcert.x86.Machregs.html#destroyed_by_load">destroyed_by_load</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#chunk">chunk</a></span> (<span class="id"><a href="compcert.backend.Stacking.html#transl_addr">transl_addr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#e">e</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#addr">addr</a></span>) = <span class="id"><a href="compcert.x86.Machregs.html#destroyed_by_load">destroyed_by_load</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#chunk">chunk</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#addr">addr</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4044')">Proof.</div>
<div class="proofscript" id="proof4044">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">destruct</span> <span class="id">chunk</span>; <span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="transl_destroyed_by_store">transl_destroyed_by_store</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">chunk</span> <span class="id">addr</span> <span class="id">e</span>, <span class="id"><a href="compcert.x86.Machregs.html#destroyed_by_store">destroyed_by_store</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#chunk">chunk</a></span> (<span class="id"><a href="compcert.backend.Stacking.html#transl_addr">transl_addr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#e">e</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#addr">addr</a></span>) = <span class="id"><a href="compcert.x86.Machregs.html#destroyed_by_store">destroyed_by_store</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#chunk">chunk</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#addr">addr</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4045')">Proof.</div>
<div class="proofscript" id="proof4045">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">destruct</span> <span class="id">chunk</span>; <span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Let</span> <span class="id"><a name="PRESERVATION.CORELEMMA.FRAME_PROPERTIES.step">step</a></span> := <span class="id"><a href="compcert.backend.Mach.html#step">Mach.step</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.return_address_offset">return_address_offset</a></span>.<br/>
<br/>
<h1> Correctness of saving and restoring of callee-save registers </h1>
<br/>
<div class="doc">The following lemmas show the correctness of the register saving
  code generated by <span class="bracket"><span class="id">save_callee_save</span></span>: after this code has executed,
  the register save areas of the current frame do contain the
  values of the callee-save registers used by the function. </div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="PRESERVATION.CORELEMMA.FRAME_PROPERTIES.SAVE_CALLEE_SAVE">SAVE_CALLEE_SAVE</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.CORELEMMA.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.j">j</a></span>: <span class="id"><a href="compcert.common.Values.html#meminj">meminj</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.CORELEMMA.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.cs">cs</a></span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.backend.Mach.html#stackframe">stackframe</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.CORELEMMA.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.fb">fb</a></span>: <span class="id"><a href="compcert.common.Values.html#block">block</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.CORELEMMA.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.sp">sp</a></span>: <span class="id"><a href="compcert.common.Values.html#block">block</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.CORELEMMA.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.ls">ls</a></span>: <span class="id"><a href="compcert.backend.Linear.html#locset">locset</a></span>.<br/>
<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="PRESERVATION.CORELEMMA.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.ls_temp_undef">ls_temp_undef</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ty</span> <span class="id">r</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span> (<span class="id"><a href="compcert.x86.Machregs.html#destroyed_by_setstack">destroyed_by_setstack</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span>) -&gt; <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.ls">ls</a></span> (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span>) = <span class="id"><a href="compcert.common.Values.html#Vundef">Vundef</a></span>.<br/>
<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="PRESERVATION.CORELEMMA.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.wt_ls">wt_ls</a></span>: <span class="kwd">forall</span> <span class="id">r</span>, <span class="id"><a href="compcert.common.Values.html#Val.has_type">Val.has_type</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.ls">ls</a></span> (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span>)) (<span class="id"><a href="compcert.x86.Machregs.html#mreg_type">mreg_type</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="save_callee_save_rec_correct">save_callee_save_rec_correct</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">k</span> <span class="id">l</span> <span class="id">pos</span> <span class="id">rs</span> <span class="id">m</span> <span class="id">P</span> (<span class="id">ext_tgt</span>: <span class="id"><a href="compcert.common.Values.html#block">block</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="kwd">Prop</span>),<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">r</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#l">l</a></span> -&gt; <span class="id"><a href="compcert.x86.Conventions1.html#is_callee_save">is_callee_save</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span> |= <span class="id"><a href="compcert.common.Separation.html#range">range</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.sp">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#pos">pos</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#size_callee_save_area_rec">size_callee_save_area_rec</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#l">l</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#pos">pos</a></span>) ** <span class="id"><a href="compcert.backend.Stackingproof.html#P">P</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.ls">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs">rs</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">b</span> <span class="id">i</span>, <span class="id"><a href="compcert.backend.Stackingproof.html#ext_tgt">ext_tgt</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#b">b</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#i">i</a></span> -&gt; (<span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.succ">Pos.succ</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#b">b</a></span> &lt; <span class="id"><a href="compcert.common.Memory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span>)%<span class="id">positive</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.succ">Pos.succ</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.sp">sp</a></span> = <span class="id"><a href="compcert.common.Memory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">rs</span>', <span class="id">exists</span> <span class="id">m</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Smallstep.html#star">star</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.step">step</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.tse">tse</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.tge">tge</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.Mach.html#State">State</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.cs">cs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.fb">fb</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.sp">sp</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) (<span class="id"><a href="compcert.backend.Stacking.html#save_callee_save_rec">save_callee_save_rec</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#l">l</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#pos">pos</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#k">k</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#rs">rs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Events.html#E0">E0</a></span> (<span class="id"><a href="compcert.backend.Mach.html#State">State</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.cs">cs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.fb">fb</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.sp">sp</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#k">k</a></span> <span class="id">rs</span>' <span class="id">m</span>')<br/>
&nbsp;&nbsp;/\ <span class="id">m</span>' |= <span class="id"><a href="compcert.backend.Stackingproof.html#contains_callee_saves">contains_callee_saves</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.sp">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#pos">pos</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#l">l</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.ls">ls</a></span> ** <span class="id"><a href="compcert.backend.Stackingproof.html#P">P</a></span><br/>
&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">ofs</span> <span class="id">k</span> <span class="id">p</span>, <span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.sp">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#k">k</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#p">p</a></span> -&gt; <span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.sp">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#k">k</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#p">p</a></span>)<br/>
&nbsp;&nbsp;/\ <span class="id"><a href="compcert.common.Memory.html#Mem.unchanged_on">Mem.unchanged_on</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ext_tgt">ext_tgt</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span> <span class="id">m</span>'<br/>
&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">p</span>, <span class="id"><a href="compcert.common.Memory.html#Mem.valid_block">Mem.valid_block</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#b">b</a></span> -&gt; <span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#b">b</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.common.Memtype.html#Max">Max</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#p">p</a></span> -&gt; <span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#b">b</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.common.Memtype.html#Max">Max</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#p">p</a></span>)<br/>
&nbsp;&nbsp;/\ <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.ls">ls</a></span> <span class="id">rs</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4046')">Proof.</div>
<div class="proofscript" id="proof4046">
<span class="kwd">Local</span> <span class="id">Opaque</span> <span class="id"><a href="compcert.x86.Machregs.html#mreg_type">mreg_type</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span> <span class="kwd">as</span> [ | <span class="id">r</span> <span class="id">l</span>]; <span class="tactic">simpl</span>; <span class="tactic">intros</span> <span class="id">until</span> <span class="id">ext_tgt</span>; <span class="tactic">intros</span> <span class="id">CS</span> <span class="id">SEP</span> <span class="id">AG</span> <span class="id">EXT_TGT_BOUND</span> <span class="id">SP_NEXTBLOCK</span>.<br/>
- <span class="id">exists</span> <span class="id">rs</span>, <span class="id">m</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Smallstep.html#star_refl">star_refl</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_pure">sep_pure</a></span>; <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Separation.html#sep_drop">sep_drop</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">auto</span>. <span class="tactic">split</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.unchanged_on_refl">Mem.unchanged_on_refl</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
- <span class="tactic">set</span> (<span class="id">ty</span> := <span class="id"><a href="compcert.x86.Machregs.html#mreg_type">mreg_type</a></span> <span class="id">r</span>) <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">sz</span> := <span class="id"><a href="compcert.common.AST.html#typesize">AST.typesize</a></span> <span class="id">ty</span>) <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">pos1</span> := <span class="id"><a href="compcert.lib.Coqlib.html#align">align</a></span> <span class="id">pos</span> <span class="id">sz</span>) <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">SZPOS</span>: <span class="id">sz</span> &gt; 0) <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="compcert.common.AST.html#typesize_pos">AST.typesize_pos</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">SZREC</span>: <span class="id">pos1</span> + <span class="id">sz</span> &lt;= <span class="id"><a href="compcert.backend.Bounds.html#size_callee_save_area_rec">size_callee_save_area_rec</a></span> <span class="id">l</span> (<span class="id">pos1</span> + <span class="id">sz</span>)) <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Bounds.html#size_callee_save_area_rec_incr">size_callee_save_area_rec_incr</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">POS1</span>: <span class="id">pos</span> &lt;= <span class="id">pos1</span>) <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#align_le">align_le</a></span>; <span class="tactic">auto</span>).<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">AL1</span>: (<span class="id"><a href="compcert.common.Memdata.html#align_chunk">align_chunk</a></span> (<span class="id"><a href="compcert.common.AST.html#chunk_of_type">chunk_of_type</a></span> <span class="id">ty</span>) | <span class="id">pos1</span>)).<br/>
&nbsp;&nbsp;{ <span class="tactic">unfold</span> <span class="id">pos1</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_trans">Z.divide_trans</a></span> <span class="kwd">with</span> <span class="id">sz</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">sz</span>; <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.backend.Stackingproof.html#size_type_chunk">size_type_chunk</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Memdata.html#align_size_chunk_divides">align_size_chunk_divides</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#align_divides">align_divides</a></span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Separation.html#range_drop_left">range_drop_left</a></span> <span class="kwd">with</span> (<span class="id">mid</span> := <span class="id">pos1</span>) <span class="kwd">in</span> <span class="id">SEP</span>; [ | <span class="tactic">omega</span> ].<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Separation.html#range_split">range_split</a></span> <span class="kwd">with</span> (<span class="id">mid</span> := <span class="id">pos1</span> + <span class="id">sz</span>) <span class="kwd">in</span> <span class="id">SEP</span>; [ | <span class="tactic">omega</span> ].<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">sz</span> <span class="tactic">at</span> 1 <span class="kwd">in</span> <span class="id">SEP</span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.backend.Stackingproof.html#size_type_chunk">size_type_chunk</a></span> <span class="kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Separation.html#range_contains">range_contains</a></span> <span class="kwd">in</span> <span class="id">SEP</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="compcert.backend.Stackingproof.html#contains_set_stack">contains_set_stack</a></span> (<span class="kwd">fun</span> <span class="id">v</span>' =&gt; <span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.j">j</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.ls">ls</a></span> (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id">r</span>)) <span class="id">v</span>') (<span class="id">rs</span> <span class="id">r</span>)).<br/>
&nbsp;&nbsp;<span class="id">eexact</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#load_result_inject">load_result_inject</a></span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.wt_ls">wt_ls</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">SEP</span>; <span class="tactic">intros</span> (<span class="id">m1</span> &amp; <span class="id">STORE</span> &amp; <span class="id">SEP</span>).<br/>
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">rs1</span> := <span class="id"><a href="compcert.backend.Mach.html#undef_regs">undef_regs</a></span> (<span class="id"><a href="compcert.x86.Machregs.html#destroyed_by_setstack">destroyed_by_setstack</a></span> <span class="id">ty</span>) <span class="id">rs</span>).<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">AG1</span>: <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.ls">ls</a></span> <span class="id">rs1</span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id">rs1</span>. <span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In_dec">In_dec</a></span> <span class="id"><a href="compcert.x86.Machregs.html#mreg_eq">mreg_eq</a></span> <span class="id">r0</span> (<span class="id"><a href="compcert.x86.Machregs.html#destroyed_by_setstack">destroyed_by_setstack</a></span> <span class="id">ty</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.SAVE_CALLEE_SAVE.ls_temp_undef">ls_temp_undef</a></span> <span class="tactic">by</span> <span class="tactic">eauto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Mach.html#undef_regs_other">undef_regs_other</a></span> <span class="tactic">by</span> <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id">AG</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_swap">sep_swap</a></span> <span class="kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">IHl</span> (<span class="id">pos1</span> + <span class="id">sz</span>) <span class="id">rs1</span> <span class="id">m1</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;{ <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Mach.html#store_stack">store_stack</a></span>, <span class="id"><a href="compcert.common.Memory.html#Mem.storev">Mem.storev</a></span> <span class="kwd">in</span> *. <span class="id">ss</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.common.Memory.html#Mem.nextblock_store">Mem.nextblock_store</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span>. <span class="tactic">rewrite</span> <span class="id">H</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;{ <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Mach.html#store_stack">store_stack</a></span>, <span class="id"><a href="compcert.common.Memory.html#Mem.storev">Mem.storev</a></span> <span class="kwd">in</span> *. <span class="id">ss</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.common.Memory.html#Mem.nextblock_store">Mem.nextblock_store</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span>. <span class="tactic">rewrite</span> <span class="id">H</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">rs2</span> &amp; <span class="id">m2</span> &amp; <span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span> &amp; <span class="id">UNCH</span> &amp; <span class="id">MAX</span> &amp; <span class="id">D</span>).<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">rs2</span>, <span class="id">m2</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#star_left">star_left</a></span>; <span class="tactic">eauto</span>. <span class="id">constructor</span>. <span class="tactic">exact</span> <span class="id">STORE</span>. <span class="tactic">auto</span>. <span class="id">traceEq</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_assoc">sep_assoc</a></span>, <span class="id"><a href="compcert.common.Separation.html#sep_swap">sep_swap</a></span>. <span class="tactic">exact</span> <span class="id">B</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id">C</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Mach.html#store_stack">store_stack</a></span> <span class="kwd">in</span> <span class="id">STORE</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">STORE</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_store_1">Mem.perm_store_1</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. { <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.unchanged_on_trans">Mem.unchanged_on_trans</a></span>; <span class="tactic">eauto</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Mach.html#store_stack">store_stack</a></span>, <span class="id"><a href="compcert.common.Memory.html#Mem.storev">Mem.storev</a></span> <span class="kwd">in</span> *. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.store_unchanged_on">Mem.store_unchanged_on</a></span>; <span class="tactic">eauto</span>. <span class="id">ii</span>. <span class="id">exploit</span> <span class="id">EXT_TGT_BOUND</span>; <span class="tactic">eauto</span>. <span class="id">xomega</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. { <span class="id">ii</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Mach.html#store_stack">store_stack</a></span>, <span class="id"><a href="compcert.common.Memory.html#Mem.storev">Mem.storev</a></span> <span class="kwd">in</span> *. <span class="id">ss</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_store_2">Mem.perm_store_2</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">MAX</span>; <span class="tactic">eauto</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.common.Memory.html#Mem.valid_block">Mem.valid_block</a></span> <span class="kwd">in</span> *. <span class="id">erewrite</span> <span class="id"><a href="compcert.common.Memory.html#Mem.nextblock_store">Mem.nextblock_store</a></span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.SAVE_CALLEE_SAVE">SAVE_CALLEE_SAVE</a></span>.<br/>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="LTL_undef_regs_same">LTL_undef_regs_same</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span> <span class="id">rl</span> <span class="id">ls</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rl">rl</a></span> -&gt; <span class="id"><a href="compcert.backend.LTL.html#undef_regs">LTL.undef_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rl">rl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span>) = <span class="id"><a href="compcert.common.Values.html#Vundef">Vundef</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4047')">Proof.</div>
<div class="proofscript" id="proof4047">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">rl</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>. <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Locations.html#Locmap.set">Locmap.set</a></span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.backend.Locations.html#Loc.eq">Loc.eq</a></span> (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id">a</span>) (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id">r</span>)). <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.backend.Locations.html#Loc.diff_dec">Loc.diff_dec</a></span> (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id">a</span>) (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id">r</span>)); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">IHrl</span>. <span class="tactic">intuition</span> <span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="LTL_undef_regs_others">LTL_undef_regs_others</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span> <span class="id">rl</span> <span class="id">ls</span>, ~<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rl">rl</a></span> -&gt; <span class="id"><a href="compcert.backend.LTL.html#undef_regs">LTL.undef_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rl">rl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span>) = <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4048')">Proof.</div>
<div class="proofscript" id="proof4048">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">rl</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Locations.html#Locmap.gso">Locmap.gso</a></span>. <span class="tactic">apply</span> <span class="id">IHrl</span>. <span class="tactic">intuition</span>. <span class="tactic">red</span>. <span class="tactic">intuition</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="LTL_undef_regs_slot">LTL_undef_regs_slot</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">sl</span> <span class="id">ofs</span> <span class="id">ty</span> <span class="id">rl</span> <span class="id">ls</span>, <span class="id"><a href="compcert.backend.LTL.html#undef_regs">LTL.undef_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rl">rl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> (<span class="id"><a href="compcert.backend.Locations.html#S">S</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sl">sl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span>) = <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> (<span class="id"><a href="compcert.backend.Locations.html#S">S</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sl">sl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4049')">Proof.</div>
<div class="proofscript" id="proof4049">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">rl</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Locations.html#Locmap.gso">Locmap.gso</a></span>. <span class="tactic">apply</span> <span class="id">IHrl</span>. <span class="tactic">red</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="undef_regs_type">undef_regs_type</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ty</span> <span class="id">l</span> <span class="id">rl</span> <span class="id">ls</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Values.html#Val.has_type">Val.has_type</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#l">l</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span> -&gt; <span class="id"><a href="compcert.common.Values.html#Val.has_type">Val.has_type</a></span> (<span class="id"><a href="compcert.backend.LTL.html#undef_regs">LTL.undef_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rl">rl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#l">l</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4050')">Proof.</div>
<div class="proofscript" id="proof4050">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">rl</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
- <span class="tactic">auto</span>.<br/>
- <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Locations.html#Locmap.set">Locmap.set</a></span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.backend.Locations.html#Loc.eq">Loc.eq</a></span> (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id">a</span>) <span class="id">l</span>). <span class="tactic">red</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.backend.Locations.html#Loc.diff_dec">Loc.diff_dec</a></span> (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id">a</span>) <span class="id">l</span>); <span class="tactic">auto</span>. <span class="tactic">red</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="save_callee_save_correct">save_callee_save_correct</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">j</span> <span class="id">ls</span> <span class="id">ls0</span> <span class="id">rs</span> <span class="id">sp</span> <span class="id">cs</span> <span class="id">fb</span> <span class="id">k</span> <span class="id">m</span> <span class="id">P</span> (<span class="id">ext_tgt</span>: <span class="id"><a href="compcert.common.Values.html#block">block</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="kwd">Prop</span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span> |= <span class="id"><a href="compcert.common.Separation.html#range">range</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.fe">fe</a></span>.(<span class="id"><a href="compcert.backend.Bounds.html#fe_ofs_callee_save">fe_ofs_callee_save</a></span>) (<span class="id"><a href="compcert.backend.Bounds.html#size_callee_save_area">size_callee_save_area</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.b">b</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.fe">fe</a></span>.(<span class="id"><a href="compcert.backend.Bounds.html#fe_ofs_callee_save">fe_ofs_callee_save</a></span>)) ** <span class="id"><a href="compcert.backend.Stackingproof.html#P">P</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">r</span>, <span class="id"><a href="compcert.common.Values.html#Val.has_type">Val.has_type</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span>)) (<span class="id"><a href="compcert.x86.Machregs.html#mreg_type">mreg_type</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span>)) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Conventions.html#agree_callee_save">agree_callee_save</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0">ls0</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs">rs</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">b</span> <span class="id">i</span>, <span class="id"><a href="compcert.backend.Stackingproof.html#ext_tgt">ext_tgt</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#b">b</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#i">i</a></span> -&gt; (<span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.succ">Pos.succ</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#b">b</a></span> &lt; <span class="id"><a href="compcert.common.Memory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span>)%<span class="id">positive</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.succ">Pos.succ</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> = <span class="id"><a href="compcert.common.Memory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">ls1</span> := <span class="id"><a href="compcert.backend.LTL.html#undef_regs">LTL.undef_regs</a></span> <span class="id"><a href="compcert.x86.Machregs.html#destroyed_at_function_entry">destroyed_at_function_entry</a></span> (<span class="id"><a href="compcert.backend.LTL.html#call_regs">LTL.call_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span>) <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">rs1</span> := <span class="id"><a href="compcert.backend.Mach.html#undef_regs">undef_regs</a></span> <span class="id"><a href="compcert.x86.Machregs.html#destroyed_at_function_entry">destroyed_at_function_entry</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs">rs</a></span> <span class="kwd">in</span><br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">rs</span>', <span class="id">exists</span> <span class="id">m</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Smallstep.html#star">star</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.step">step</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.tse">tse</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.tge">tge</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.Mach.html#State">State</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs">cs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#fb">fb</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) (<span class="id"><a href="compcert.backend.Stacking.html#save_callee_save">save_callee_save</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.fe">fe</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#k">k</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#rs1">rs1</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Events.html#E0">E0</a></span> (<span class="id"><a href="compcert.backend.Mach.html#State">State</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs">cs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#fb">fb</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#k">k</a></span> <span class="id">rs</span>' <span class="id">m</span>')<br/>
&nbsp;&nbsp;/\ <span class="id">m</span>' |= <span class="id"><a href="compcert.backend.Stackingproof.html#contains_callee_saves">contains_callee_saves</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.fe">fe</a></span>.(<span class="id"><a href="compcert.backend.Bounds.html#fe_ofs_callee_save">fe_ofs_callee_save</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.b">b</a></span>.(<span class="id"><a href="compcert.backend.Bounds.html#used_callee_save">used_callee_save</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ls0">ls0</a></span> ** <span class="id"><a href="compcert.backend.Stackingproof.html#P">P</a></span><br/>
&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">ofs</span> <span class="id">k</span> <span class="id">p</span>, <span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#k">k</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#p">p</a></span> -&gt; <span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#k">k</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#p">p</a></span>)<br/>
&nbsp;&nbsp;/\ <span class="id"><a href="compcert.common.Memory.html#Mem.unchanged_on">Mem.unchanged_on</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ext_tgt">ext_tgt</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span> <span class="id">m</span>'<br/>
&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">p</span>, <span class="id"><a href="compcert.common.Memory.html#Mem.valid_block">Mem.valid_block</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#b">b</a></span> -&gt; <span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#b">b</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.common.Memtype.html#Max">Max</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#p">p</a></span> -&gt; <span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#b">b</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.common.Memtype.html#Max">Max</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#p">p</a></span>)<br/>
&nbsp;&nbsp;/\ <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls1">ls1</a></span> <span class="id">rs</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4051')">Proof.</div>
<div class="proofscript" id="proof4051">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> <span class="id">ext_tgt</span>; <span class="tactic">intros</span> <span class="id">SEP</span> <span class="id">TY</span> <span class="id">AGCS</span> <span class="id">AG</span> <span class="id">EXT_TGT_BOUND</span> <span class="id">SP_NEXTBLOCK</span>; <span class="tactic">intros</span> <span class="id">ls1</span> <span class="id">rs1</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="compcert.backend.Stackingproof.html#save_callee_save_rec_correct">save_callee_save_rec_correct</a></span> <span class="id">j</span> <span class="id">cs</span> <span class="id">fb</span> <span class="id">sp</span> <span class="id">ls1</span>); <span class="tactic">eauto</span>.<br/>
- <span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id">ls1</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#LTL_undef_regs_same">LTL_undef_regs_same</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#destroyed_by_setstack_function_entry">destroyed_by_setstack_function_entry</a></span>; <span class="tactic">eauto</span>.<br/>
- <span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id">ls1</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#undef_regs_type">undef_regs_type</a></span>. <span class="tactic">apply</span> <span class="id">TY</span>.<br/>
- <span class="tactic">exact</span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.b">b</a></span>.(<span class="id"><a href="compcert.backend.Bounds.html#used_callee_save_prop">used_callee_save_prop</a></span>).<br/>
- <span class="id">instantiate</span> (1 := <span class="id">rs1</span>). <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs_undef_regs">agree_regs_undef_regs</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs_call_regs">agree_regs_call_regs</a></span>. <span class="tactic">auto</span>.<br/>
- <span class="tactic">clear</span> <span class="id">SEP</span>. <span class="tactic">intros</span> (<span class="id">rs</span>' &amp; <span class="id">m</span>' &amp; <span class="id">EXEC</span> &amp; <span class="id">SEP</span> &amp; <span class="id">PERMS</span> &amp; <span class="id">UNCH</span> &amp; <span class="id">MAX</span> &amp; <span class="id">AG</span>').<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">rs</span>', <span class="id">m</span>'.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="id">eexact</span> <span class="id">EXEC</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">rewrite</span> (<span class="id"><a href="compcert.backend.Stackingproof.html#contains_callee_saves_exten">contains_callee_saves_exten</a></span> <span class="id">j</span> <span class="id">sp</span> <span class="id">ls0</span> <span class="id">ls1</span>). <span class="tactic">exact</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.b">b</a></span>.(<span class="id"><a href="compcert.backend.Bounds.html#used_callee_save_prop">used_callee_save_prop</a></span>) <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">ls1</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Stackingproof.html#LTL_undef_regs_others">LTL_undef_regs_others</a></span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.LTL.html#call_regs">call_regs</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">AGCS</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#existsb">existsb</a></span> <span class="id"><a href="compcert.x86.Conventions1.html#is_callee_save">is_callee_save</a></span> <span class="id"><a href="compcert.x86.Machregs.html#destroyed_at_function_entry">destroyed_at_function_entry</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span>  (<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#destroyed_at_function_entry_caller_save">destroyed_at_function_entry_caller_save</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#existsb">existsb</a></span> <span class="id"><a href="compcert.x86.Conventions1.html#is_callee_save">is_callee_save</a></span> <span class="id"><a href="compcert.x86.Machregs.html#destroyed_at_function_entry">destroyed_at_function_entry</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#existsb_exists">existsb_exists</a></span>. <span class="id">exists</span> <span class="id">r</span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">exact</span> <span class="id">PERMS</span>. <span class="tactic">split</span>. <span class="tactic">exact</span> <span class="id">UNCH</span>. <span class="tactic">split</span>. <span class="tactic">exact</span> <span class="id">MAX</span>. <span class="tactic">exact</span> <span class="id">AG</span>'.<br/>
Qed.</div>
<br/>
<div class="doc">As a corollary of the previous lemmas, we obtain the following
  correctness theorem for the execution of a function prologue
  (allocation of the frame + saving of the link and return address +
  saving of the used callee-save registers). </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="function_prologue_correct">function_prologue_correct</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">j</span> <span class="id">ls</span> <span class="id">ls0</span> <span class="id">ls1</span> <span class="id">rs</span> <span class="id">rs1</span> <span class="id">m1</span> <span class="id">m1</span>' <span class="id">m2</span> <span class="id">sp</span> <span class="id">parent</span> <span class="id">ra</span> <span class="id">cs</span> <span class="id">fb</span> <span class="id">k</span> <span class="id">P</span> (<span class="id">ext_tgt</span>: <span class="id"><a href="compcert.common.Values.html#block">block</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span> -&gt; <span class="kwd">Prop</span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs">rs</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Conventions.html#agree_callee_save">agree_callee_save</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0">ls0</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Lineartyping.html#agree_outgoing_arguments">agree_outgoing_arguments</a></span> (<span class="id"><a href="compcert.backend.Linear.html#fn_sig">Linear.fn_sig</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.f">f</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0">ls0</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">r</span>, <span class="id"><a href="compcert.common.Values.html#Val.has_type">Val.has_type</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span>)) (<span class="id"><a href="compcert.x86.Machregs.html#mreg_type">mreg_type</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span>)) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#ls1">ls1</a></span> = <span class="id"><a href="compcert.backend.LTL.html#undef_regs">LTL.undef_regs</a></span> <span class="id"><a href="compcert.x86.Machregs.html#destroyed_at_function_entry">destroyed_at_function_entry</a></span> (<span class="id"><a href="compcert.backend.LTL.html#call_regs">LTL.call_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#rs1">rs1</a></span> = <span class="id"><a href="compcert.backend.Mach.html#undef_regs">undef_regs</a></span> <span class="id"><a href="compcert.x86.Machregs.html#destroyed_at_function_entry">destroyed_at_function_entry</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs">rs</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Memory.html#Mem.alloc">Mem.alloc</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m1">m1</a></span> 0 <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.f">f</a></span>.(<span class="id"><a href="compcert.backend.Linear.html#fn_stacksize">Linear.fn_stacksize</a></span>) = (<span class="id"><a href="compcert.backend.Stackingproof.html#m2">m2</a></span>, <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Values.html#Val.has_type">Val.has_type</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#parent">parent</a></span> <span class="id"><a href="compcert.common.AST.html#Tptr">Tptr</a></span> -&gt; <span class="id"><a href="compcert.common.Values.html#Val.has_type">Val.has_type</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ra">ra</a></span> <span class="id"><a href="compcert.common.AST.html#Tptr">Tptr</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">m1</span>' |= <span class="id"><a href="compcert.common.Separation.html#minjection">minjection</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m1">m1</a></span> ** <span class="id"><a href="compcert.common.Separation.html#globalenv_inject">globalenv_inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.ge">ge</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> ** <span class="id"><a href="compcert.backend.Stackingproof.html#P">P</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">b</span> <span class="id">i</span>, <span class="id"><a href="compcert.backend.Stackingproof.html#ext_tgt">ext_tgt</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#b">b</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#i">i</a></span> -&gt; (<span class="id"><a href="compcert.backend.Stackingproof.html#b">b</a></span> &lt; <span class="id"><a href="compcert.common.Memory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">m1</span>')%<span class="id">positive</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">j</span>', <span class="id">exists</span> <span class="id">rs</span>', <span class="id">exists</span> <span class="id">m2</span>', <span class="id">exists</span> <span class="id">sp</span>', <span class="id">exists</span> <span class="id">m3</span>', <span class="id">exists</span> <span class="id">m4</span>', <span class="id">exists</span> <span class="id">m5</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Memory.html#Mem.alloc">Mem.alloc</a></span> <span class="id">m1</span>' 0 <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.tf">tf</a></span>.(<span class="id"><a href="compcert.backend.Mach.html#fn_stacksize">fn_stacksize</a></span>) = (<span class="id">m2</span>', <span class="id">sp</span>')<br/>
&nbsp;&nbsp;/\ <span class="id"><a href="compcert.backend.Mach.html#store_stack">store_stack</a></span> <span class="id">m2</span>' (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">sp</span>' <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="compcert.common.AST.html#Tptr">Tptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.tf">tf</a></span>.(<span class="id"><a href="compcert.backend.Mach.html#fn_link_ofs">fn_link_ofs</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#parent">parent</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m3</span>'<br/>
&nbsp;&nbsp;/\ <span class="id"><a href="compcert.backend.Mach.html#store_stack">store_stack</a></span> <span class="id">m3</span>' (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">sp</span>' <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="compcert.common.AST.html#Tptr">Tptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.tf">tf</a></span>.(<span class="id"><a href="compcert.backend.Mach.html#fn_retaddr_ofs">fn_retaddr_ofs</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ra">ra</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m4</span>'<br/>
&nbsp;&nbsp;/\ <span class="id"><a href="compcert.common.Smallstep.html#star">star</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.step">step</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.tse">tse</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.tge">tge</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.Mach.html#State">State</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs">cs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#fb">fb</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">sp</span>' <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) (<span class="id"><a href="compcert.backend.Stacking.html#save_callee_save">save_callee_save</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.fe">fe</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#k">k</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#rs1">rs1</a></span> <span class="id">m4</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Events.html#E0">E0</a></span> (<span class="id"><a href="compcert.backend.Mach.html#State">State</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs">cs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#fb">fb</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">sp</span>' <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#k">k</a></span> <span class="id">rs</span>' <span class="id">m5</span>')<br/>
&nbsp;&nbsp;/\ <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id">j</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#ls1">ls1</a></span> <span class="id">rs</span>'<br/>
&nbsp;&nbsp;/\ <span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs">agree_locs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls1">ls1</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0">ls0</a></span><br/>
&nbsp;&nbsp;/\ <span class="id">m5</span>' |= <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span> <span class="id">j</span>' <span class="id">sp</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#ls1">ls1</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0">ls0</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#parent">parent</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ra">ra</a></span> ** <span class="id"><a href="compcert.common.Separation.html#minjection">minjection</a></span> <span class="id">j</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#m2">m2</a></span> ** <span class="id"><a href="compcert.common.Separation.html#globalenv_inject">globalenv_inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.ge">ge</a></span> <span class="id">j</span>' ** <span class="id"><a href="compcert.backend.Stackingproof.html#P">P</a></span><br/>
&nbsp;&nbsp;/\ <span class="id">j</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id">sp</span>', <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.fe">fe</a></span>.(<span class="id"><a href="compcert.backend.Bounds.html#fe_stack_data">fe_stack_data</a></span>))<br/>
&nbsp;&nbsp;/\ <span class="id"><a href="compcert.common.Events.html#inject_separated">inject_separated</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id">j</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#m1">m1</a></span> <span class="id">m1</span>'<br/>
&nbsp;&nbsp;/\ <span class="id"><a href="compcert.common.Memory.html#Mem.unchanged_on">Mem.unchanged_on</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ext_tgt">ext_tgt</a></span> <span class="id">m4</span>' <span class="id">m5</span>'<br/>
&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">b</span> <span class="id">ofs</span> <span class="id">p</span>, <span class="id"><a href="compcert.common.Memory.html#Mem.valid_block">Mem.valid_block</a></span> <span class="id">m4</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#b">b</a></span> -&gt; <span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id">m5</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#b">b</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.common.Memtype.html#Max">Max</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#p">p</a></span> -&gt; <span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id">m4</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#b">b</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.common.Memtype.html#Max">Max</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#p">p</a></span>)<br/>
&nbsp;&nbsp;/\ <span class="id"><a href="compcert.common.Values.html#inject_incr">inject_incr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id">j</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4052')">Proof.</div>
<div class="proofscript" id="proof4052">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> <span class="id">ext_tgt</span>; <span class="tactic">intros</span> <span class="id">AGREGS</span> <span class="id">AGCS</span> <span class="id">AGARGS</span> <span class="id">WTREGS</span> <span class="id">LS1</span> <span class="id">RS1</span> <span class="id">ALLOC</span> <span class="id">TYPAR</span> <span class="id">TYRA</span> <span class="id">SEP</span> <span class="id">EXT_TGT_BOUND</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Stackingproof.html#unfold_transf_function">unfold_transf_function</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Mach.html#fn_stacksize">fn_stacksize</a></span>, <span class="id"><a href="compcert.backend.Mach.html#fn_link_ofs">fn_link_ofs</a></span>, <span class="id"><a href="compcert.backend.Mach.html#fn_retaddr_ofs">fn_retaddr_ofs</a></span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Stack&nbsp;layout&nbsp;info&nbsp;*)</span><br/>
<span class="kwd">Local</span> <span class="id">Opaque</span> <span class="id"><a href="compcert.backend.Stackingproof.html#b">b</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#fe">fe</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="compcert.x86.Stacklayout.html#frame_env_range">frame_env_range</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.b">b</a></span>) (<span class="id"><a href="compcert.x86.Stacklayout.html#frame_env_aligned">frame_env_aligned</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.b">b</a></span>). <span class="tactic">replace</span> (<span class="id"><a href="compcert.x86.Stacklayout.html#make_env">make_env</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.b">b</a></span>) <span class="kwd">with</span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.fe">fe</a></span> <span class="tactic">by</span> <span class="tactic">auto</span>. <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">LAYOUT1</span> <span class="id">LAYOUT2</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Allocation&nbsp;step&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.Memory.html#Mem.alloc">Mem.alloc</a></span> <span class="id">m1</span>' 0 (<span class="id"><a href="compcert.backend.Bounds.html#fe_size">fe_size</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.fe">fe</a></span>)) <span class="kwd">as</span> [<span class="id">m2</span>' <span class="id">sp</span>'] <span class="id">eqn</span>:<span class="id">ALLOC</span>'.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Separation.html#alloc_parallel_rule_2">alloc_parallel_rule_2</a></span>.<br/>
&nbsp;&nbsp;<span class="id">eexact</span> <span class="id">SEP</span>. <span class="id">eexact</span> <span class="id">ALLOC</span>. <span class="id">eexact</span> <span class="id">ALLOC</span>'.<br/>
&nbsp;&nbsp;<span class="id">instantiate</span> (1 := <span class="id"><a href="compcert.backend.Bounds.html#fe_stack_data">fe_stack_data</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.fe">fe</a></span>). <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id">instantiate</span> (1 := <span class="id"><a href="compcert.backend.Bounds.html#fe_stack_data">fe_stack_data</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.fe">fe</a></span> + <span class="id"><a href="compcert.backend.Bounds.html#bound_stack_data">bound_stack_data</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.b">b</a></span>). <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.max_comm">Z.max_comm</a></span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id"><a href="compcert.backend.Bounds.html#bound_stack_data_pos">bound_stack_data_pos</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.b">b</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#size_no_overflow">size_no_overflow</a></span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">SEP</span>. <span class="tactic">intros</span> (<span class="id">j</span>' &amp; <span class="id">SEP</span> &amp; <span class="id">INCR</span> &amp; <span class="id">SAME</span> &amp; <span class="id">INJ_SEP</span>).<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Remember&nbsp;the&nbsp;freeable&nbsp;permissions&nbsp;using&nbsp;a&nbsp;mconj&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">SEPCONJ</span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">m2</span>' |= <span class="id"><a href="compcert.common.Separation.html#mconj">mconj</a></span> (<span class="id"><a href="compcert.common.Separation.html#range">range</a></span> <span class="id">sp</span>' 0 (<span class="id"><a href="compcert.backend.Bounds.html#fe_stack_data">fe_stack_data</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.fe">fe</a></span>) ** <span class="id"><a href="compcert.common.Separation.html#range">range</a></span> <span class="id">sp</span>' (<span class="id"><a href="compcert.backend.Bounds.html#fe_stack_data">fe_stack_data</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.fe">fe</a></span> + <span class="id"><a href="compcert.backend.Bounds.html#bound_stack_data">bound_stack_data</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.b">b</a></span>) (<span class="id"><a href="compcert.backend.Bounds.html#fe_size">fe_size</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.fe">fe</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.common.Separation.html#range">range</a></span> <span class="id">sp</span>' 0 (<span class="id"><a href="compcert.backend.Bounds.html#fe_stack_data">fe_stack_data</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.fe">fe</a></span>) ** <span class="id"><a href="compcert.common.Separation.html#range">range</a></span> <span class="id">sp</span>' (<span class="id"><a href="compcert.backend.Bounds.html#fe_stack_data">fe_stack_data</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.fe">fe</a></span> + <span class="id"><a href="compcert.backend.Bounds.html#bound_stack_data">bound_stack_data</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.b">b</a></span>) (<span class="id"><a href="compcert.backend.Bounds.html#fe_size">fe_size</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.fe">fe</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id"><a href="compcert.common.Separation.html#minjection">minjection</a></span> <span class="id">j</span>' <span class="id">m2</span> ** <span class="id"><a href="compcert.common.Separation.html#globalenv_inject">globalenv_inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.ge">ge</a></span> <span class="id">j</span>' ** <span class="id">P</span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Separation.html#mconj_intro">mconj_intro</a></span>; <span class="tactic">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_assoc">sep_assoc</a></span>; <span class="tactic">assumption</span>. }<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Dividing&nbsp;up&nbsp;the&nbsp;frame&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="compcert.x86.Stacklayout.html#frame_env_separated">frame_env_separated</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.b">b</a></span>) <span class="kwd">in</span> <span class="id">SEP</span>. <span class="tactic">replace</span> (<span class="id"><a href="compcert.x86.Stacklayout.html#make_env">make_env</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.b">b</a></span>) <span class="kwd">with</span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.fe">fe</a></span> <span class="kwd">in</span> <span class="id">SEP</span> <span class="tactic">by</span> <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Store&nbsp;of&nbsp;parent&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_swap3">sep_swap3</a></span> <span class="kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="compcert.common.Separation.html#range_contains">range_contains</a></span> <span class="id"><a href="compcert.common.AST.html#Mptr">Mptr</a></span>) <span class="kwd">in</span> <span class="id">SEP</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="compcert.backend.Stackingproof.html#contains_set_stack">contains_set_stack</a></span> (<span class="kwd">fun</span> <span class="id">v</span>' =&gt; <span class="id">v</span>' = <span class="id">parent</span>) <span class="id">parent</span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span>) <span class="id">m2</span>' <span class="id"><a href="compcert.common.AST.html#Tptr">Tptr</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.common.AST.html#chunk_of_Tptr">chunk_of_Tptr</a></span>; <span class="id">eexact</span> <span class="id">SEP</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Values.html#Val.load_result_same">Val.load_result_same</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">SEP</span>; <span class="tactic">intros</span> (<span class="id">m3</span>' &amp; <span class="id">STORE_PARENT</span> &amp; <span class="id">SEP</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_swap3">sep_swap3</a></span> <span class="kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Store&nbsp;of&nbsp;return&nbsp;address&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_swap4">sep_swap4</a></span> <span class="kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="id"><a href="compcert.common.Separation.html#range_contains">range_contains</a></span> <span class="id"><a href="compcert.common.AST.html#Mptr">Mptr</a></span>) <span class="kwd">in</span> <span class="id">SEP</span>; [|<span class="tactic">tauto</span>].<br/>
&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="compcert.backend.Stackingproof.html#contains_set_stack">contains_set_stack</a></span> (<span class="kwd">fun</span> <span class="id">v</span>' =&gt; <span class="id">v</span>' = <span class="id">ra</span>) <span class="id">ra</span> (<span class="kwd">fun</span> <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span>) <span class="id">m3</span>' <span class="id"><a href="compcert.common.AST.html#Tptr">Tptr</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.common.AST.html#chunk_of_Tptr">chunk_of_Tptr</a></span>; <span class="id">eexact</span> <span class="id">SEP</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Values.html#Val.load_result_same">Val.load_result_same</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">SEP</span>; <span class="tactic">intros</span> (<span class="id">m4</span>' &amp; <span class="id">STORE_RETADDR</span> &amp; <span class="id">SEP</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_swap4">sep_swap4</a></span> <span class="kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Saving&nbsp;callee-save&nbsp;registers&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_swap5">sep_swap5</a></span> <span class="kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">TT</span>:<span class="id"><a href="compcert.common.Memory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">m4</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.succ">Pos.succ</a></span> (<span class="id"><a href="compcert.common.Memory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">m1</span>')).<br/>
&nbsp;&nbsp;{ <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Mach.html#store_stack">store_stack</a></span>, <span class="id"><a href="compcert.common.Memory.html#Mem.storev">Mem.storev</a></span> <span class="kwd">in</span> *. <span class="id">ss</span>. <span class="id">erewrite</span> <span class="id"><a href="compcert.common.Memory.html#Mem.nextblock_store">Mem.nextblock_store</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="compcert.common.Memory.html#Mem.nextblock_store">Mem.nextblock_store</a></span>; <span class="tactic">eauto</span>. <span class="id">erewrite</span> <span class="id"><a href="compcert.common.Memory.html#Mem.nextblock_alloc">Mem.nextblock_alloc</a></span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="compcert.backend.Stackingproof.html#save_callee_save_correct">save_callee_save_correct</a></span> <span class="id">j</span>' <span class="id">ls</span> <span class="id">ls0</span> <span class="id">rs</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs_inject_incr">agree_regs_inject_incr</a></span> <span class="kwd">with</span> <span class="id">j</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;{ <span class="tactic">rewrite</span> <span class="id">TT</span>. <span class="id">ii</span>. <span class="id">exploit</span> <span class="id">EXT_TGT_BOUND</span>; <span class="tactic">eauto</span>. <span class="id">xomega</span>. }<br/>
&nbsp;&nbsp;{ <span class="tactic">rewrite</span> <span class="id">TT</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.common.Memory.html#Mem.alloc_result">Mem.alloc_result</a></span>; <span class="tactic">eauto</span>. <span class="id">ii</span>. <span class="tactic">congruence</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="compcert.backend.LTL.html#undef_regs">LTL.undef_regs</a></span> <span class="id"><a href="compcert.x86.Machregs.html#destroyed_at_function_entry">destroyed_at_function_entry</a></span> (<span class="id"><a href="compcert.backend.LTL.html#call_regs">call_regs</a></span> <span class="id">ls</span>)) <span class="kwd">with</span> <span class="id">ls1</span> <span class="tactic">by</span> <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="compcert.backend.Mach.html#undef_regs">undef_regs</a></span> <span class="id"><a href="compcert.x86.Machregs.html#destroyed_at_function_entry">destroyed_at_function_entry</a></span> <span class="id">rs</span>) <span class="kwd">with</span> <span class="id">rs1</span> <span class="tactic">by</span> <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">SEP</span>; <span class="tactic">intros</span> (<span class="id">rs2</span> &amp; <span class="id">m5</span>' &amp; <span class="id">SAVE_CS</span> &amp; <span class="id">SEP</span> &amp; <span class="id">PERMS</span> &amp; <span class="id">UNCH</span> &amp; <span class="id">MAX</span> &amp; <span class="id">AGREGS</span>').<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_swap5">sep_swap5</a></span> <span class="kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Materializing&nbsp;the&nbsp;Local&nbsp;and&nbsp;Outgoing&nbsp;locations&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="compcert.backend.Stackingproof.html#initial_locations">initial_locations</a></span> <span class="id">j</span>'). <span class="id">eexact</span> <span class="id">SEP</span>. <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;<span class="id">instantiate</span> (1 := <span class="kwd">Local</span>). <span class="id">instantiate</span> (1 := <span class="id">ls1</span>).<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">rewrite</span> <span class="id">LS1</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Stackingproof.html#LTL_undef_regs_slot">LTL_undef_regs_slot</a></span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">SEP</span>; <span class="tactic">intros</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_swap">sep_swap</a></span> <span class="kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="compcert.backend.Stackingproof.html#initial_locations">initial_locations</a></span> <span class="id">j</span>'). <span class="id">eexact</span> <span class="id">SEP</span>. <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;<span class="id">instantiate</span> (1 := <span class="id"><a href="compcert.backend.Locations.html#Outgoing">Outgoing</a></span>). <span class="id">instantiate</span> (1 := <span class="id">ls1</span>).<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">rewrite</span> <span class="id">LS1</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Stackingproof.html#LTL_undef_regs_slot">LTL_undef_regs_slot</a></span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">SEP</span>; <span class="tactic">intros</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_swap">sep_swap</a></span> <span class="kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Now&nbsp;we&nbsp;frame&nbsp;this&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">SEPFINAL</span>: <span class="id">m5</span>' |= <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span> <span class="id">j</span>' <span class="id">sp</span>' <span class="id">ls1</span> <span class="id">ls0</span> <span class="id">parent</span> <span class="id">ra</span> ** <span class="id"><a href="compcert.common.Separation.html#minjection">minjection</a></span> <span class="id">j</span>' <span class="id">m2</span> ** <span class="id"><a href="compcert.common.Separation.html#globalenv_inject">globalenv_inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.ge">ge</a></span> <span class="id">j</span>' ** <span class="id">P</span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Separation.html#frame_mconj">frame_mconj</a></span>. <span class="id">eexact</span> <span class="id">SEPCONJ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.common.AST.html#chunk_of_Tptr">chunk_of_Tptr</a></span> <span class="kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents_1">frame_contents_1</a></span>; <span class="tactic">rewrite</span> ! <span class="id"><a href="compcert.common.Separation.html#sep_assoc">sep_assoc</a></span>. <span class="tactic">exact</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="kwd">forall</span> <span class="id">ofs</span> <span class="id">k</span> <span class="id">p</span>, <span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id">m2</span>' <span class="id">sp</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#k">k</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#p">p</a></span> -&gt; <span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> <span class="id">m5</span>' <span class="id">sp</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#k">k</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#p">p</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id">PERMS</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Mach.html#store_stack">store_stack</a></span> <span class="kwd">in</span> <span class="id">STORE_PARENT</span>, <span class="id">STORE_RETADDR</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">STORE_PARENT</span>, <span class="id">STORE_RETADDR</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_store_1">Mem.perm_store_1</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Separation.html#sep_preserved">sep_preserved</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj1">sep_proj1</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Separation.html#mconj_proj2">mconj_proj2</a></span>. <span class="id">eexact</span> <span class="id">SEPCONJ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Separation.html#range_preserved">range_preserved</a></span> <span class="kwd">with</span> <span class="id">m2</span>'; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Separation.html#range_preserved">range_preserved</a></span> <span class="kwd">with</span> <span class="id">m2</span>'; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">SEP</span> <span class="id">SEPCONJ</span>.<br/>
<span class="comment">(*&nbsp;Conclusions&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">j</span>', <span class="id">rs2</span>, <span class="id">m2</span>', <span class="id">sp</span>', <span class="id">m3</span>', <span class="id">m4</span>', <span class="id">m5</span>'.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">exact</span> <span class="id">STORE_PARENT</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">exact</span> <span class="id">STORE_RETADDR</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="id">eexact</span> <span class="id">SAVE_CS</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">exact</span> <span class="id">AGREGS</span>'.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">rewrite</span> <span class="id">LS1</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs_undef_locs">agree_locs_undef_locs</a></span>; [|<span class="tactic">reflexivity</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.LTL.html#call_regs">call_regs</a></span>. <span class="tactic">apply</span> <span class="id">AGCS</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Bounds.html#mreg_within_bounds">mreg_within_bounds</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.LTL.html#call_regs">call_regs</a></span>. <span class="tactic">apply</span> <span class="id">AGARGS</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Conventions.html#incoming_slot_in_parameters">incoming_slot_in_parameters</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">exact</span> <span class="id">SEPFINAL</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">exact</span> <span class="id">SAME</span>. <span class="tactic">split</span>. <span class="tactic">exact</span> <span class="id">INJ_SEP</span>. <span class="tactic">split</span>. <span class="tactic">exact</span> <span class="id">UNCH</span>. <span class="tactic">split</span>. <span class="tactic">exact</span> <span class="id">MAX</span>. <span class="tactic">exact</span> <span class="id">INCR</span>.<br/>
Qed.</div>
<br/>
<div class="doc">The following lemmas show the correctness of the register reloading
  code generated by <span class="bracket"><span class="id">reload_callee_save</span></span>: after this code has executed,
  all callee-save registers contain the same values they had at
  function entry. </div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="PRESERVATION.CORELEMMA.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE">RESTORE_CALLEE_SAVE</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.CORELEMMA.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.j">j</a></span>: <span class="id"><a href="compcert.common.Values.html#meminj">meminj</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.CORELEMMA.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.cs">cs</a></span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.backend.Mach.html#stackframe">stackframe</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.CORELEMMA.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.fb">fb</a></span>: <span class="id"><a href="compcert.common.Values.html#block">block</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.CORELEMMA.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.sp">sp</a></span>: <span class="id"><a href="compcert.common.Values.html#block">block</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.CORELEMMA.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.ls0">ls0</a></span>: <span class="id"><a href="compcert.backend.Linear.html#locset">locset</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.CORELEMMA.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.m">m</a></span>: <span class="id"><a href="compcert.common.Memory.html#mem">mem</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="agree_unused">agree_unused</a></span> (<span class="id">ls0</span>: <span class="id"><a href="compcert.backend.Linear.html#locset">locset</a></span>) (<span class="id">rs</span>: <span class="id"><a href="compcert.backend.Mach.html#regset">regset</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">r</span>, ~(<span class="id"><a href="compcert.backend.Bounds.html#mreg_within_bounds">mreg_within_bounds</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.b">b</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span>) -&gt; <span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.j">j</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#ls0">ls0</a></span> (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span>)) (<span class="id"><a href="compcert.backend.Stackingproof.html#rs">rs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="restore_callee_save_rec_correct">restore_callee_save_rec_correct</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span> <span class="id">ofs</span> <span class="id">rs</span> <span class="id">k</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.m">m</a></span> |= <span class="id"><a href="compcert.backend.Stackingproof.html#contains_callee_saves">contains_callee_saves</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.sp">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#l">l</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.ls0">ls0</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_unused">agree_unused</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.ls0">ls0</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs">rs</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">r</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#l">l</a></span> -&gt; <span class="id"><a href="compcert.backend.Bounds.html#mreg_within_bounds">mreg_within_bounds</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.b">b</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">rs</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Smallstep.html#star">star</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.step">step</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.tse">tse</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.tge">tge</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.Mach.html#State">State</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.cs">cs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.fb">fb</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.sp">sp</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) (<span class="id"><a href="compcert.backend.Stacking.html#restore_callee_save_rec">restore_callee_save_rec</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#l">l</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#k">k</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#rs">rs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.m">m</a></span>)<br/>
&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Events.html#E0">E0</a></span> (<span class="id"><a href="compcert.backend.Mach.html#State">State</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.cs">cs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.fb">fb</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.sp">sp</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#k">k</a></span> <span class="id">rs</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.m">m</a></span>)<br/>
&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">r</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#l">l</a></span> -&gt; <span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.j">j</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.ls0">ls0</a></span> (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span>)) (<span class="id">rs</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span>))<br/>
&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">r</span>, ~(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#l">l</a></span>) -&gt; <span class="id">rs</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span> = <span class="id"><a href="compcert.backend.Stackingproof.html#rs">rs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span>)<br/>
&nbsp;&nbsp;/\ <span class="id"><a href="compcert.backend.Stackingproof.html#agree_unused">agree_unused</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE.ls0">ls0</a></span> <span class="id">rs</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4053')">Proof.</div>
<div class="proofscript" id="proof4053">
<span class="kwd">Local</span> <span class="id">Opaque</span> <span class="id"><a href="compcert.x86.Machregs.html#mreg_type">mreg_type</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span> <span class="kwd">as</span> [ | <span class="id">r</span> <span class="id">l</span>]; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
- <span class="comment">(*&nbsp;base&nbsp;case&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">rs</span>. <span class="tactic">intuition</span> <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Smallstep.html#star_refl">star_refl</a></span>.<br/>
- <span class="comment">(*&nbsp;inductive&nbsp;case&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">ty</span> := <span class="id"><a href="compcert.x86.Machregs.html#mreg_type">mreg_type</a></span> <span class="id">r</span>) <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">sz</span> := <span class="id"><a href="compcert.common.AST.html#typesize">AST.typesize</a></span> <span class="id">ty</span>) <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">ofs1</span> := <span class="id"><a href="compcert.lib.Coqlib.html#align">align</a></span> <span class="id">ofs</span> <span class="id">sz</span>).<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">SZPOS</span>: <span class="id">sz</span> &gt; 0) <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="compcert.common.AST.html#typesize_pos">AST.typesize_pos</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">OFSLE</span>: <span class="id">ofs</span> &lt;= <span class="id">ofs1</span>) <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#align_le">align_le</a></span>; <span class="tactic">auto</span>).<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">BOUND</span>: <span class="id"><a href="compcert.backend.Bounds.html#mreg_within_bounds">mreg_within_bounds</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.b">b</a></span> <span class="id">r</span>) <span class="tactic">by</span> <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Stackingproof.html#contains_get_stack">contains_get_stack</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj1">sep_proj1</a></span>; <span class="id">eassumption</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">v</span> &amp; <span class="id">LOAD</span> &amp; <span class="id">SPEC</span>).<br/>
&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id">IHl</span> (<span class="id">ofs1</span> + <span class="id">sz</span>) (<span class="id">rs</span>#<span class="id">r</span> &lt;- <span class="id">v</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj2">sep_proj2</a></span>; <span class="id">eassumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Mach.html#Regmap.gso">Regmap.gso</a></span>. <span class="tactic">auto</span>. <span class="tactic">intuition</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">rs</span>' &amp; <span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span> &amp; <span class="id">D</span>).<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">rs</span>'.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#star_step">star_step</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="tactic">exact</span> <span class="id">LOAD</span>. <span class="id">traceEq</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In_dec">In_dec</a></span> <span class="id"><a href="compcert.x86.Machregs.html#mreg_eq">mreg_eq</a></span> <span class="id">r0</span> <span class="id">l</span>). <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">r</span> = <span class="id">r0</span>) <span class="tactic">by</span> <span class="tactic">tauto</span>. <span class="tactic">subst</span> <span class="id">r0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">C</span> <span class="tactic">by</span> <span class="tactic">auto</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Mach.html#Regmap.gss">Regmap.gss</a></span>. <span class="tactic">exact</span> <span class="id">SPEC</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">C</span> <span class="tactic">by</span> <span class="tactic">tauto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Mach.html#Regmap.gso">Regmap.gso</a></span>. <span class="tactic">intuition</span> <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">exact</span> <span class="id">D</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.RESTORE_CALLEE_SAVE">RESTORE_CALLEE_SAVE</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="restore_callee_save_correct">restore_callee_save_correct</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">j</span> <span class="id">sp</span> <span class="id">ls</span> <span class="id">ls0</span> <span class="id">pa</span> <span class="id">ra</span> <span class="id">P</span> <span class="id">rs</span> <span class="id">k</span> <span class="id">cs</span> <span class="id">fb</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span> |= <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0">ls0</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#pa">pa</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ra">ra</a></span> ** <span class="id"><a href="compcert.backend.Stackingproof.html#P">P</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_unused">agree_unused</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0">ls0</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs">rs</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">rs</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Smallstep.html#star">star</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.step">step</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.tse">tse</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.tge">tge</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.Mach.html#State">State</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs">cs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#fb">fb</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) (<span class="id"><a href="compcert.backend.Stacking.html#restore_callee_save">restore_callee_save</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.fe">fe</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#k">k</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#rs">rs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Events.html#E0">E0</a></span> (<span class="id"><a href="compcert.backend.Mach.html#State">State</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs">cs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#fb">fb</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#k">k</a></span> <span class="id">rs</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span>)<br/>
&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">r</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.x86.Conventions1.html#is_callee_save">is_callee_save</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> -&gt; <span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#ls0">ls0</a></span> (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span>)) (<span class="id">rs</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span>))<br/>
&nbsp;&nbsp;/\ (<span class="kwd">forall</span> <span class="id">r</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.x86.Conventions1.html#is_callee_save">is_callee_save</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span> -&gt; <span class="id">rs</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span> = <span class="id"><a href="compcert.backend.Stackingproof.html#rs">rs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4054')">Proof.</div>
<div class="proofscript" id="proof4054">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span>, <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents_1">frame_contents_1</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Separation.html#mconj_proj1">mconj_proj1</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">rewrite</span> ! <span class="id"><a href="compcert.common.Separation.html#sep_assoc">sep_assoc</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Separation.html#sep_pick5">sep_pick5</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Stackingproof.html#restore_callee_save_rec_correct">restore_callee_save_rec_correct</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Bounds.html#mreg_within_bounds">mreg_within_bounds</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">rs</span>' &amp; <span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span> &amp; <span class="id">D</span>).<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">rs</span>'.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="id">eexact</span> <span class="id">A</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In_dec">In_dec</a></span> <span class="id"><a href="compcert.x86.Machregs.html#mreg_eq">mreg_eq</a></span> <span class="id">r</span> (<span class="id"><a href="compcert.backend.Bounds.html#used_callee_save">used_callee_save</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.b">b</a></span>)).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">B</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">C</span> <span class="tactic">by</span> <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id">H0</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Bounds.html#mreg_within_bounds">mreg_within_bounds</a></span>; <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">C</span>. <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">apply</span> (<span class="id"><a href="compcert.backend.Bounds.html#used_callee_save_prop">used_callee_save_prop</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.b">b</a></span>) <span class="kwd">in</span> <span class="id">H2</span>. <span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<div class="doc">As a corollary, we obtain the following correctness result for
  the execution of a function epilogue (reloading of used callee-save
  registers + reloading of the link and return address + freeing
  of the frame). </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="function_epilogue_correct">function_epilogue_correct</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span>' <span class="id">j</span> <span class="id">sp</span>' <span class="id">ls</span> <span class="id">ls0</span> <span class="id">pa</span> <span class="id">ra</span> <span class="id">P</span> <span class="id">m</span> <span class="id">rs</span> <span class="id">sp</span> <span class="id">m1</span> <span class="id">k</span> <span class="id">cs</span> <span class="id">fb</span>,<br/>
&nbsp;&nbsp;<span class="id">m</span>' |= <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id">sp</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0">ls0</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#pa">pa</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ra">ra</a></span> ** <span class="id"><a href="compcert.common.Separation.html#minjection">minjection</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span> ** <span class="id"><a href="compcert.backend.Stackingproof.html#P">P</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs">rs</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs">agree_locs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0">ls0</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id">sp</span>', <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.fe">fe</a></span>.(<span class="id"><a href="compcert.backend.Bounds.html#fe_stack_data">fe_stack_data</a></span>)) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Memory.html#Mem.free">Mem.free</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> 0 <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.f">f</a></span>.(<span class="id"><a href="compcert.backend.Linear.html#fn_stacksize">Linear.fn_stacksize</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m1">m1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">rs1</span>, <span class="id">exists</span> <span class="id">m1</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Mach.html#load_stack">load_stack</a></span> <span class="id">m</span>' (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">sp</span>' <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="compcert.common.AST.html#Tptr">Tptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.tf">tf</a></span>.(<span class="id"><a href="compcert.backend.Mach.html#fn_link_ofs">fn_link_ofs</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#pa">pa</a></span><br/>
&nbsp;&nbsp;/\ <span class="id"><a href="compcert.backend.Mach.html#load_stack">load_stack</a></span> <span class="id">m</span>' (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">sp</span>' <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="compcert.common.AST.html#Tptr">Tptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.tf">tf</a></span>.(<span class="id"><a href="compcert.backend.Mach.html#fn_retaddr_ofs">fn_retaddr_ofs</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ra">ra</a></span><br/>
&nbsp;&nbsp;/\ <span class="id"><a href="compcert.common.Memory.html#Mem.free">Mem.free</a></span> <span class="id">m</span>' <span class="id">sp</span>' 0 <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.tf">tf</a></span>.(<span class="id"><a href="compcert.backend.Mach.html#fn_stacksize">fn_stacksize</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m1</span>'<br/>
&nbsp;&nbsp;/\ <span class="id"><a href="compcert.common.Smallstep.html#star">star</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.step">step</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.tse">tse</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.tge">tge</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.Mach.html#State">State</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs">cs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#fb">fb</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">sp</span>' <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) (<span class="id"><a href="compcert.backend.Stacking.html#restore_callee_save">restore_callee_save</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES.fe">fe</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#k">k</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#rs">rs</a></span> <span class="id">m</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Events.html#E0">E0</a></span> (<span class="id"><a href="compcert.backend.Mach.html#State">State</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs">cs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#fb">fb</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">sp</span>' <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#k">k</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs1">rs1</a></span> <span class="id">m</span>')<br/>
&nbsp;&nbsp;/\ <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> (<span class="id"><a href="compcert.backend.LTL.html#return_regs">return_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0">ls0</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#rs1">rs1</a></span><br/>
&nbsp;&nbsp;/\ <span class="id"><a href="compcert.backend.Conventions.html#agree_callee_save">agree_callee_save</a></span> (<span class="id"><a href="compcert.backend.LTL.html#return_regs">return_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls0">ls0</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ls0">ls0</a></span><br/>
&nbsp;&nbsp;/\ <span class="id">m1</span>' |= <span class="id"><a href="compcert.common.Separation.html#minjection">minjection</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m1">m1</a></span> ** <span class="id"><a href="compcert.backend.Stackingproof.html#P">P</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4055')">Proof.</div>
<div class="proofscript" id="proof4055">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> <span class="id">fb</span>; <span class="tactic">intros</span> <span class="id">SEP</span> <span class="id">AGR</span> <span class="id">AGL</span> <span class="id">INJ</span> <span class="id">FREE</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Can&nbsp;free&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Separation.html#free_parallel_rule">free_parallel_rule</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.common.Separation.html#sep_assoc">sep_assoc</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Separation.html#mconj_proj2">mconj_proj2</a></span>. <span class="id">eexact</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexact</span> <span class="id">FREE</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexact</span> <span class="id">INJ</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.max_comm">Z.max_comm</a></span>; <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">m1</span>' &amp; <span class="id">FREE</span>' &amp; <span class="id">SEP</span>').<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Reloading&nbsp;the&nbsp;callee-save&nbsp;registers&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Stackingproof.html#restore_callee_save_correct">restore_callee_save_correct</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">eexact</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">instantiate</span> (1 := <span class="id">rs</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">AGL</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">agree_unused_reg0</span> <span class="tactic">by</span> <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id">AGR</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">rs</span>' &amp; <span class="id">LOAD_CS</span> &amp; <span class="id">CS</span> &amp; <span class="id">NCS</span>).<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Reloading&nbsp;the&nbsp;back&nbsp;link&nbsp;and&nbsp;return&nbsp;address&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span> <span class="kwd">in</span> <span class="id">SEP</span>; <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Separation.html#mconj_proj1">mconj_proj1</a></span> <span class="kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents_1">frame_contents_1</a></span> <span class="kwd">in</span> <span class="id">SEP</span>; <span class="tactic">rewrite</span> ! <span class="id"><a href="compcert.common.Separation.html#sep_assoc">sep_assoc</a></span> <span class="kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="compcert.backend.Stackingproof.html#hasvalue_get_stack">hasvalue_get_stack</a></span> <span class="id"><a href="compcert.common.AST.html#Tptr">Tptr</a></span>). <span class="tactic">rewrite</span> <span class="id"><a href="compcert.common.AST.html#chunk_of_Tptr">chunk_of_Tptr</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Separation.html#sep_pick3">sep_pick3</a></span>; <span class="id">eexact</span> <span class="id">SEP</span>. <span class="tactic">intros</span> <span class="id">LOAD_LINK</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="compcert.backend.Stackingproof.html#hasvalue_get_stack">hasvalue_get_stack</a></span> <span class="id"><a href="compcert.common.AST.html#Tptr">Tptr</a></span>). <span class="tactic">rewrite</span> <span class="id"><a href="compcert.common.AST.html#chunk_of_Tptr">chunk_of_Tptr</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Separation.html#sep_pick4">sep_pick4</a></span>; <span class="id">eexact</span> <span class="id">SEP</span>. <span class="tactic">intros</span> <span class="id">LOAD_RETADDR</span>.<br/>
&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Conclusions&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Stackingproof.html#unfold_transf_function">unfold_transf_function</a></span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">rs</span>', <span class="id">m1</span>'.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="id">eassumption</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">red</span>; <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.LTL.html#return_regs">return_regs</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.x86.Conventions1.html#is_callee_save">is_callee_save</a></span> <span class="id">r</span>) <span class="id">eqn</span>:<span class="id">C</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">CS</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">NCS</span> <span class="tactic">by</span> <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id">AGR</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">red</span>; <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.LTL.html#return_regs">return_regs</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">l</span>. <span class="tactic">rewrite</span> <span class="id">H</span>; <span class="tactic">auto</span>. <span class="tactic">destruct</span> <span class="id">sl</span>; <span class="tactic">auto</span>; <span class="id">contradiction</span>. <br/>
&nbsp;&nbsp;<span class="tactic">assumption</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.FRAME_PROPERTIES">FRAME_PROPERTIES</a></span>.<br/>
<br/>
<h1> Call stack invariants </h1>
<br/>
<div class="doc">This is the memory assertion that captures the contents of the stack frames
  mentioned in the call stacks. </div>
<span class="kwd">Definition</span> <span class="id"><a name="dummy_frame_contents">dummy_frame_contents</a></span> (<span class="id">j</span>: <span class="id"><a href="compcert.common.Values.html#meminj">meminj</a></span>) (<span class="id">ls</span>: <span class="id"><a href="compcert.backend.Linear.html#locset">locset</a></span>) (<span class="id">sg</span>: <span class="id"><a href="compcert.common.AST.html#signature">signature</a></span>) (<span class="id">sp</span>: <span class="id"><a href="compcert.common.Values.html#block">block</a></span>) (<span class="id">spofs</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>): <span class="id"><a href="compcert.common.Separation.html#massert">massert</a></span> :=<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.Stackingproof.html#contains_locations">contains_locations</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#spofs">spofs</a></span> (<span class="id"><a href="compcert.x86.Conventions1.html#size_arguments">size_arguments</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sg">sg</a></span>) <span class="id"><a href="compcert.backend.Locations.html#Outgoing">Outgoing</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="dummy_frame_contents_incr">dummy_frame_contents_incr</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">j</span> <span class="id">ls</span> <span class="id">sg</span> <span class="id">sp</span> <span class="id">spofs</span> <span class="id">j</span>' <span class="id">m</span> <span class="id">P</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">DUMMY</span>: <span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span> |= <span class="id"><a href="compcert.backend.Stackingproof.html#dummy_frame_contents">dummy_frame_contents</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sg">sg</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#spofs">spofs</a></span> ** <span class="id"><a href="compcert.backend.Stackingproof.html#P">P</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">INCR</span>: <span class="id"><a href="compcert.common.Values.html#inject_incr">inject_incr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id">j</span>'):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;<span class="id">DUMMY</span>: <span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span> |= <span class="id"><a href="compcert.backend.Stackingproof.html#dummy_frame_contents">dummy_frame_contents</a></span> <span class="id">j</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sg">sg</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#spofs">spofs</a></span> ** <span class="id"><a href="compcert.backend.Stackingproof.html#P">P</a></span>&gt;&gt;.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4056')">Proof.</div>
<div class="proofscript" id="proof4056">
&nbsp;&nbsp;<span class="tactic">red</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Stackingproof.html#dummy_frame_contents">dummy_frame_contents</a></span>. <span class="tactic">rewrite</span> &lt;- (<span class="id"><a href="compcert.backend.Stackingproof.html#contains_locations_incr">contains_locations_incr</a></span> <span class="id">j</span> <span class="id">j</span>') <span class="tactic">by</span> <span class="tactic">auto</span>. <span class="tactic">assumption</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="stack_contents_noargs">stack_contents_noargs</a></span> (<span class="id">j</span>: <span class="id"><a href="compcert.common.Values.html#meminj">meminj</a></span>) (<span class="id">cs</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.backend.Linear.html#stackframe">Linear.stackframe</a></span>) (<span class="id">cs</span>': <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.backend.Mach.html#stackframe">Mach.stackframe</a></span>) : <span class="id"><a href="compcert.common.Separation.html#massert">massert</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs">cs</a></span>, <span class="id">cs</span>' <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; <span class="id"><a href="compcert.common.Separation.html#pure">pure</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.Linear.html#Stackframe">Linear.Stackframe</a></span> <span class="id">f</span> <span class="id">_</span> <span class="id">ls</span> <span class="id">c</span> :: <span class="id">cs</span>, <span class="id"><a href="compcert.backend.Mach.html#Stackframe">Mach.Stackframe</a></span> <span class="id">fb</span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">sp</span>' <span class="id">_</span>) <span class="id">ra</span> <span class="id">c</span>' :: <span class="id">cs</span>' =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span> <span class="id">f</span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id">sp</span>' <span class="id">ls</span> (<span class="id"><a href="compcert.backend.Linear.html#parent_locset">parent_locset</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs">cs</a></span>) (<span class="id"><a href="compcert.backend.Mach.html#parent_sp">parent_sp</a></span> <span class="id">cs</span>') (<span class="id"><a href="compcert.backend.Mach.html#parent_ra">parent_ra</a></span> <span class="id">cs</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id"><a href="compcert.backend.Stackingproof.html#stack_contents_noargs">stack_contents_noargs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs">cs</a></span> <span class="id">cs</span>'<br/>
&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="compcert.common.Separation.html#pure">pure</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="stack_contents_args">stack_contents_args</a></span> (<span class="id">j</span>: <span class="id"><a href="compcert.common.Values.html#meminj">meminj</a></span>) (<span class="id">cs</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.backend.Linear.html#stackframe">Linear.stackframe</a></span>) (<span class="id">cs</span>': <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.backend.Mach.html#stackframe">Mach.stackframe</a></span>) : <span class="id"><a href="compcert.common.Separation.html#massert">massert</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs">cs</a></span>, <span class="id">cs</span>' <span class="kwd">with</span><br/>
&nbsp;&nbsp;| [<span class="id"><a href="compcert.backend.Linear.html#Stackframe">Linear.Stackframe</a></span> <span class="id">f</span> <span class="id">_</span> <span class="id">ls</span> <span class="id">_</span>], [<span class="id"><a href="compcert.backend.Mach.html#Stackframe">Mach.Stackframe</a></span> <span class="id">fb</span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">sp</span>' <span class="id">spofs</span>) <span class="id">ra</span> <span class="id">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#dummy_frame_contents">dummy_frame_contents</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id">ls</span> <span class="id">f</span>.(<span class="id"><a href="compcert.backend.Linear.html#fn_sig">Linear.fn_sig</a></span>) <span class="id">sp</span>' <span class="id">spofs</span>.(<span class="id"><a href="compcert.lib.Integers.html#Ptrofs.unsigned">Ptrofs.unsigned</a></span>)<br/>
&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.Linear.html#Stackframe">Linear.Stackframe</a></span> <span class="id">f</span> <span class="id">_</span> <span class="id">ls</span> <span class="id">c</span> :: <span class="id">cs</span>, <span class="id"><a href="compcert.backend.Mach.html#Stackframe">Mach.Stackframe</a></span> <span class="id">fb</span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">sp</span>' <span class="id">_</span>) <span class="id">ra</span> <span class="id">c</span>' :: <span class="id">cs</span>' =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span> <span class="id">f</span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id">sp</span>' <span class="id">ls</span> (<span class="id"><a href="compcert.backend.Linear.html#parent_locset">parent_locset</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs">cs</a></span>) (<span class="id"><a href="compcert.backend.Mach.html#parent_sp">parent_sp</a></span> <span class="id">cs</span>') (<span class="id"><a href="compcert.backend.Mach.html#parent_ra">parent_ra</a></span> <span class="id">cs</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id"><a href="compcert.backend.Stackingproof.html#stack_contents_args">stack_contents_args</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs">cs</a></span> <span class="id">cs</span>'<br/>
&nbsp;&nbsp;| <span class="id">_</span>, <span class="id">_</span> =&gt; <span class="id"><a href="compcert.common.Separation.html#pure">pure</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Notation</span> "'<span class="id">stack_contents</span>'" := (<span class="kwd">if</span> <span class="id"><a href="compcert.backend.Conventions.html#main_args">main_args</a></span> <span class="kwd">then</span> <span class="id"><a href="compcert.backend.Stackingproof.html#stack_contents_args">stack_contents_args</a></span> <span class="kwd">else</span> <span class="id"><a href="compcert.backend.Stackingproof.html#stack_contents_noargs">stack_contents_noargs</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">only</span> <span class="id">parsing</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="stack_contents_nil_left_false">stack_contents_nil_left_false</a></span>: <span class="kwd">forall</span> <span class="id">j</span> <span class="id">cs</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#stack_contents_args">stack_contents_args</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> [] <span class="id">cs</span>' = <span class="id"><a href="compcert.common.Separation.html#pure">pure</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4057')">Proof.</div>
<div class="proofscript" id="proof4057">
 <span class="id">ss</span>; <span class="id">des_ifs</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="stack_contents_nil_right_false">stack_contents_nil_right_false</a></span>: <span class="kwd">forall</span> <span class="id">j</span> <span class="id">cs</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#stack_contents_args">stack_contents_args</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs">cs</a></span> [] = <span class="id"><a href="compcert.common.Separation.html#pure">pure</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4058')">Proof.</div>
<div class="proofscript" id="proof4058">
 <span class="tactic">destruct</span> <span class="id">cs</span>; <span class="id">ss</span>; <span class="id">des_ifs</span>; <span class="id">ss</span>; <span class="id">des_ifs</span>. Qed.</div>
<br/>
<div class="doc"><span class="bracket"><span class="id">match_stacks</span></span> captures additional properties (not related to memory)
  of the Linear and Mach call stacks. </div>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="match_stacks">match_stacks</a></span> (<span class="id">j</span>: <span class="id"><a href="compcert.common.Values.html#meminj">meminj</a></span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.backend.Linear.html#stackframe">Linear.stackframe</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.backend.Mach.html#stackframe">stackframe</a></span> -&gt; <span class="id"><a href="compcert.common.AST.html#signature">signature</a></span> -&gt; <span class="id">SimMemInj.t</span>' -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="match_stacks_empty">match_stacks_empty</a></span>: <span class="kwd">forall</span> <span class="id">sg</span> <span class="id">sm0</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">MAINARGS</span>: <span class="id"><a href="compcert.backend.Conventions.html#main_args">main_args</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false">false</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">SYMBINJ</span>: <span class="id"><a href="compcert.common.Events.html#symbols_inject">symbols_inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.se">se</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.tse">tse</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Conventions.html#tailcall_possible">tailcall_possible</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sg">sg</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sg">sg</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sm0">sm0</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="match_stacks_dummy">match_stacks_dummy</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">MAINARGS</span>: <span class="id"><a href="compcert.backend.Conventions.html#main_args">main_args</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SYMBINJ</span>: <span class="id"><a href="compcert.common.Events.html#symbols_inject">symbols_inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.se">se</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.tse">tse</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sg_init</span> <span class="id">sp</span> <span class="id">ls_init</span> <span class="id">sg</span> <span class="id">ra</span> <span class="id">sm0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">RAPTR</span>: <span class="id"><a href="compcert.common.Values.html#Val.has_type">Val.has_type</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ra">ra</a></span> <span class="id"><a href="compcert.common.AST.html#Tptr">Tptr</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ARGS</span>: <span class="kwd">forall</span> <span class="id">ofs</span> <span class="id">ty</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">LOC</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="compcert.backend.Locations.html#S">S</a></span> <span class="id"><a href="compcert.backend.Locations.html#Outgoing">Outgoing</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span>) (<span class="id"><a href="compcert.common.AST.html#regs_of_rpairs">regs_of_rpairs</a></span> (<span class="id"><a href="compcert.x86.Conventions1.html#loc_arguments">loc_arguments</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sg_init">sg_init</a></span>))),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;<span class="id">BOUND</span>: <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> + <span class="id"><a href="compcert.backend.Locations.html#typesize">typesize</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span> &lt;= <span class="id"><a href="compcert.x86.Conventions1.html#size_arguments">size_arguments</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sg_init">sg_init</a></span>&gt;&gt;)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">LE</span>: <span class="id"><a href="compcert.backend.Stackingproof.html#sg">sg</a></span> = <span class="id"><a href="compcert.backend.Stackingproof.html#sg_init">sg_init</a></span> \/ <span class="id"><a href="compcert.backend.Conventions.html#tailcall_possible">tailcall_possible</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sg">sg</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SPVALID</span>: <span class="id"><a href="compcert.backend.Stackingproof.html#sm0">sm0</a></span>.(<span class="id"><a href="compcert.common.SimMemInj.html#tgt">SimMemInj.tgt</a></span>).(<span class="id"><a href="compcert.common.Memory.html#Mem.valid_block">Mem.valid_block</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sm0">sm0</a></span>.(<span class="id"><a href="compcert.common.SimMemInj.html#tgt_parent_nb">SimMemInj.tgt_parent_nb</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">i</span>, ~ <span class="id"><a href="compcert.backend.Stackingproof.html#sm0">sm0</a></span>.(<span class="id"><a href="compcert.common.SimMemInj.html#tgt_external">SimMemInj.tgt_external</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#i">i</a></span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> [<span class="id"><a href="compcert.backend.Linear.html#dummy_stack">Linear.dummy_stack</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sg_init">sg_init</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls_init">ls_init</a></span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id"><a href="compcert.backend.Mach.html#dummy_stack">Mach.dummy_stack</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ra">ra</a></span>] <span class="id"><a href="compcert.backend.Stackingproof.html#sg">sg</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sm0">sm0</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="match_stacks_cons">match_stacks_cons</a></span>: <span class="kwd">forall</span> <span class="id">f</span> <span class="id">sp</span> <span class="id">ls</span> <span class="id">c</span> <span class="id">cs</span> <span class="id">fb</span> <span class="id">sp</span>' <span class="id">ra</span> <span class="id">c</span>' <span class="id">cs</span>' <span class="id">sg</span> <span class="id">trf</span> <span class="id">sm0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SPVALID</span>: <span class="id"><a href="compcert.backend.Stackingproof.html#sm0">sm0</a></span>.(<span class="id"><a href="compcert.common.SimMemInj.html#tgt">SimMemInj.tgt</a></span>).(<span class="id"><a href="compcert.common.Memory.html#Mem.valid_block">Mem.valid_block</a></span>) <span class="id">sp</span>' /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sm0">sm0</a></span>.(<span class="id"><a href="compcert.common.SimMemInj.html#tgt_parent_nb">SimMemInj.tgt_parent_nb</a></span>) <span class="id">sp</span>' /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">i</span>, ~ <span class="id"><a href="compcert.backend.Stackingproof.html#sm0">sm0</a></span>.(<span class="id"><a href="compcert.common.SimMemInj.html#tgt_external">SimMemInj.tgt_external</a></span>) <span class="id">sp</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#i">i</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">PRIV</span>: <span class="kwd">forall</span> <span class="id">i</span>, 0 &lt;= <span class="id"><a href="compcert.backend.Stackingproof.html#i">i</a></span> &lt; (<span class="id"><a href="compcert.backend.Bounds.html#fe_stack_data">fe_stack_data</a></span> (<span class="id"><a href="compcert.x86.Stacklayout.html#make_env">make_env</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#function_bounds">function_bounds</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f">f</a></span>))) \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Bounds.html#fe_stack_data">fe_stack_data</a></span> (<span class="id"><a href="compcert.x86.Stacklayout.html#make_env">make_env</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#function_bounds">function_bounds</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f">f</a></span>)) + <span class="id"><a href="compcert.backend.Linear.html#fn_stacksize">Linear.fn_stacksize</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f">f</a></span> &lt;= <span class="id"><a href="compcert.backend.Stackingproof.html#i">i</a></span> &lt; <span class="id"><a href="compcert.backend.Bounds.html#fe_size">fe_size</a></span> (<span class="id"><a href="compcert.x86.Stacklayout.html#make_env">make_env</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#function_bounds">function_bounds</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f">f</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt; <span class="id"><a href="compcert.backend.Stackingproof.html#sm0">sm0</a></span>.(<span class="id"><a href="compcert.common.SimMemInj.html#tgt_private">SimMemInj.tgt_private</a></span>) <span class="id">sp</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#i">i</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">TAIL</span>: <span class="id"><a href="compcert.lib.Coqlib.html#is_tail">is_tail</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#c">c</a></span> (<span class="id"><a href="compcert.backend.Linear.html#fn_code">Linear.fn_code</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f">f</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FINDF</span>: <span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_funct_ptr">Genv.find_funct_ptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.tge">tge</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#fb">fb</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="compcert.common.AST.html#Internal">Internal</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#trf">trf</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">TRF</span>: <span class="id"><a href="compcert.backend.Stacking.html#transf_function">transf_function</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f">f</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#trf">trf</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">TRC</span>: <span class="id"><a href="compcert.backend.Stacking.html#transl_code">transl_code</a></span> (<span class="id"><a href="compcert.x86.Stacklayout.html#make_env">make_env</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#function_bounds">function_bounds</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f">f</a></span>)) <span class="id"><a href="compcert.backend.Stackingproof.html#c">c</a></span> = <span class="id">c</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">INJ</span>: <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id">sp</span>', (<span class="id"><a href="compcert.backend.Bounds.html#fe_stack_data">fe_stack_data</a></span> (<span class="id"><a href="compcert.x86.Stacklayout.html#make_env">make_env</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#function_bounds">function_bounds</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f">f</a></span>)))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">TY_RA</span>: <span class="id"><a href="compcert.common.Values.html#Val.has_type">Val.has_type</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ra">ra</a></span> <span class="id"><a href="compcert.common.AST.html#Tptr">Tptr</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">AGL</span>: <span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs">agree_locs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f">f</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> (<span class="id"><a href="compcert.backend.Linear.html#parent_locset">parent_locset</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs">cs</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">ARGS</span>: <span class="kwd">forall</span> <span class="id">ofs</span> <span class="id">ty</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="compcert.backend.Locations.html#S">S</a></span> <span class="id"><a href="compcert.backend.Locations.html#Outgoing">Outgoing</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span>) (<span class="id"><a href="compcert.common.AST.html#regs_of_rpairs">regs_of_rpairs</a></span> (<span class="id"><a href="compcert.x86.Conventions1.html#loc_arguments">loc_arguments</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sg">sg</a></span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Bounds.html#slot_within_bounds">slot_within_bounds</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#function_bounds">function_bounds</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f">f</a></span>) <span class="id"><a href="compcert.backend.Locations.html#Outgoing">Outgoing</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">STK</span>: <span class="id"><a href="compcert.backend.Stackingproof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs">cs</a></span> <span class="id">cs</span>' (<span class="id"><a href="compcert.backend.Linear.html#fn_sig">Linear.fn_sig</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f">f</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#sm0">sm0</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SZARG</span>: <span class="id"><a href="compcert.x86.Conventions1.html#size_arguments">size_arguments</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sg">sg</a></span> &lt;= <span class="id"><a href="compcert.backend.Bounds.html#bound_outgoing">bound_outgoing</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#function_bounds">function_bounds</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f">f</a></span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.Linear.html#Stackframe">Linear.Stackframe</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f">f</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#c">c</a></span> :: <span class="id"><a href="compcert.backend.Stackingproof.html#cs">cs</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.Mach.html#Stackframe">Stackframe</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#fb">fb</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">sp</span>' <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#ra">ra</a></span> <span class="id">c</span>' :: <span class="id">cs</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#sg">sg</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sm0">sm0</a></span>.<br/>
<br/>
<div class="doc">Invariance with respect to change of memory injection. </div>
<br/>
<span class="kwd">Ltac</span> <span class="id">sep_simpl_tac</span> :=<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.lib.sflib.html#NW">NW</a></span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;<span class="tactic">repeat</span> (<span class="tactic">try</span> <span class="tactic">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_assoc">sep_assoc</a></span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="tactic">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_pure">sep_pure</a></span> <span class="kwd">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Stackingproof.html#stack_contents_nil_left_false">stack_contents_nil_left_false</a></span> <span class="kwd">in</span> *; <span class="tactic">try</span> <span class="tactic">assumption</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Stackingproof.html#stack_contents_nil_right_false">stack_contents_nil_right_false</a></span> <span class="kwd">in</span> *; <span class="tactic">try</span> <span class="tactic">assumption</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> <span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span>: <span class="id">_</span> |= <span class="id"><a href="compcert.common.Separation.html#pure">pure</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span> |- <span class="id">_</span>] =&gt; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>; <span class="id">inv</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span>: <span class="id">_</span> |= <span class="id">_</span> ** <span class="id"><a href="compcert.common.Separation.html#pure">pure</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span> |- <span class="id">_</span>] =&gt; <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj2">sep_proj2</a></span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id">H</span>: <span class="id">_</span> |= <span class="id">_</span> ** <span class="id"><a href="compcert.common.Separation.html#pure">pure</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span> ** <span class="id">_</span> |- <span class="id">_</span>] =&gt; <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Separation.html#sep_pick2">sep_pick2</a></span> <span class="kwd">in</span> <span class="id">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">idtac</span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="stack_contents_change_meminj">stack_contents_change_meminj</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">j</span> <span class="id">j</span>', <span class="id"><a href="compcert.common.Values.html#inject_incr">inject_incr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id">j</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">cs</span> <span class="id">cs</span>' <span class="id">P</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span> |= <span class="id">stack_contents</span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs">cs</a></span> <span class="id">cs</span>' ** <span class="id"><a href="compcert.backend.Stackingproof.html#P">P</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span> |= <span class="id">stack_contents</span> <span class="id">j</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#cs">cs</a></span> <span class="id">cs</span>' ** <span class="id"><a href="compcert.backend.Stackingproof.html#P">P</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4059')">Proof.</div>
<div class="proofscript" id="proof4059">
<span class="kwd">Local</span> <span class="id">Opaque</span> <span class="id"><a href="compcert.common.Separation.html#sepconj">sepconj</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="compcert.backend.Conventions.html#main_args">main_args</a></span> <span class="id">eqn</span>:<span class="id">MAINARGS</span>; <span class="id">cycle</span> 1.<br/>
- <span class="tactic">induction</span> <span class="id">cs</span> <span class="kwd">as</span> [ | [] <span class="id">cs</span>]; <span class="tactic">destruct</span> <span class="id">cs</span>' <span class="kwd">as</span> [ | [] <span class="id">cs</span>']; <span class="tactic">simpl</span>; <span class="tactic">intros</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">sp0</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_assoc">sep_assoc</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents_incr">frame_contents_incr</a></span> <span class="kwd">with</span> (<span class="id">j</span> := <span class="id">j</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_swap">sep_swap</a></span>. <span class="tactic">apply</span> <span class="id">IHcs</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_swap">sep_swap</a></span>. <span class="tactic">assumption</span>.<br/>
- <span class="tactic">induction</span> <span class="id">cs</span> <span class="kwd">as</span> [ | [] <span class="id">cs</span>]; <span class="tactic">destruct</span> <span class="id">cs</span>' <span class="kwd">as</span> [ | [] <span class="id">cs</span>']; <span class="tactic">simpl</span>; <span class="tactic">intros</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">sp0</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">cs</span>, <span class="id">cs</span>'; <span class="id">sep_simpl_tac</span>; <span class="id">des</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#dummy_frame_contents_incr">dummy_frame_contents_incr</a></span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents_incr">frame_contents_incr</a></span> <span class="kwd">with</span> (<span class="id">j</span> := <span class="id">j</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_swap">sep_swap</a></span>. <span class="tactic">apply</span> <span class="id">IHcs</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_swap">sep_swap</a></span>. <span class="tactic">assumption</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="spvalid_le">spvalid_le</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sm0</span> <span class="id">sm1</span> <span class="id">sp</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SPVALID</span>: <span class="id"><a href="compcert.backend.Stackingproof.html#sm0">sm0</a></span>.(<span class="id"><a href="compcert.common.SimMemInj.html#tgt">SimMemInj.tgt</a></span>).(<span class="id"><a href="compcert.common.Memory.html#Mem.valid_block">Mem.valid_block</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sm0">sm0</a></span>.(<span class="id"><a href="compcert.common.SimMemInj.html#tgt_parent_nb">SimMemInj.tgt_parent_nb</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">i</span>, ~ <span class="id"><a href="compcert.backend.Stackingproof.html#sm0">sm0</a></span>.(<span class="id"><a href="compcert.common.SimMemInj.html#tgt_external">SimMemInj.tgt_external</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#i">i</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">LE</span>: <span class="id">SimMemInj.le</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#sm0">sm0</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sm1">sm1</a></span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;<span class="id">SPVALID</span>: <span class="id"><a href="compcert.backend.Stackingproof.html#sm1">sm1</a></span>.(<span class="id"><a href="compcert.common.SimMemInj.html#tgt">SimMemInj.tgt</a></span>).(<span class="id"><a href="compcert.common.Memory.html#Mem.valid_block">Mem.valid_block</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sm1">sm1</a></span>.(<span class="id"><a href="compcert.common.SimMemInj.html#tgt_parent_nb">SimMemInj.tgt_parent_nb</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">i</span>, ~ <span class="id"><a href="compcert.backend.Stackingproof.html#sm1">sm1</a></span>.(<span class="id"><a href="compcert.common.SimMemInj.html#tgt_external">SimMemInj.tgt_external</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#i">i</a></span>&gt;&gt;.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4060')">Proof.</div>
<div class="proofscript" id="proof4060">
&nbsp;&nbsp;<span class="id">des</span>. <span class="id">inv</span> <span class="id">LE</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">TGTPARENTEQ</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">TGTPARENTEQNB</span>. <span class="id">esplits</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.valid_block_unchanged_on">Mem.valid_block_unchanged_on</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="match_stacks_symbols_inject">match_stacks_symbols_inject</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">j</span> <span class="id">cs</span> <span class="id">cs</span>' <span class="id">sg</span> <span class="id">sm0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">MCS</span>: <span class="id"><a href="compcert.backend.Stackingproof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs">cs</a></span> <span class="id">cs</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#sg">sg</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sm0">sm0</a></span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;<span class="id">SYMBINJ</span>: <span class="id"><a href="compcert.common.Events.html#symbols_inject">symbols_inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.se">se</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.tse">tse</a></span>&gt;&gt;.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4061')">Proof.</div>
<div class="proofscript" id="proof4061">
 <span class="tactic">induction</span> <span class="id">MCS</span>; <span class="tactic">auto</span>. Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="match_stacks_change_meminj">match_stacks_change_meminj</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">j</span> <span class="id">j</span>', <span class="id"><a href="compcert.common.Values.html#inject_incr">inject_incr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id">j</span>'  -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">SAMESRC</span>: <span class="kwd">forall</span> <span class="id">b1</span> <span class="id">b2</span> <span class="id">delta</span>, <span class="id">j</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#b1">b1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="compcert.backend.Stackingproof.html#b2">b2</a></span>, <span class="id"><a href="compcert.backend.Stackingproof.html#delta">delta</a></span>) -&gt; <span class="id"><a href="compcert.lib.Coqlib.html#Plt">Plt</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#b1">b1</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.se">se</a></span>.(<span class="id"><a href="compcert.common.Globalenvs.html#Senv.nextblock">Senv.nextblock</a></span>) -&gt; <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#b1">b1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="compcert.backend.Stackingproof.html#b2">b2</a></span>, <span class="id"><a href="compcert.backend.Stackingproof.html#delta">delta</a></span>)),<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">SAMETGT</span>: <span class="kwd">forall</span> <span class="id">b1</span> <span class="id">b2</span> <span class="id">delta</span>, <span class="id">j</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#b1">b1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="compcert.backend.Stackingproof.html#b2">b2</a></span>, <span class="id"><a href="compcert.backend.Stackingproof.html#delta">delta</a></span>) -&gt; <span class="id"><a href="compcert.lib.Coqlib.html#Plt">Plt</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#b2">b2</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.tse">tse</a></span>.(<span class="id"><a href="compcert.common.Globalenvs.html#Senv.nextblock">Senv.nextblock</a></span>) -&gt; <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#b1">b1</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="compcert.backend.Stackingproof.html#b2">b2</a></span>, <span class="id"><a href="compcert.backend.Stackingproof.html#delta">delta</a></span>)),<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">cs</span> <span class="id">cs</span>' <span class="id">sg</span> <span class="id">sm0</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs">cs</a></span> <span class="id">cs</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#sg">sg</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sm0">sm0</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#match_stacks">match_stacks</a></span> <span class="id">j</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#cs">cs</a></span> <span class="id">cs</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#sg">sg</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sm0">sm0</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4062')">Proof.</div>
<div class="proofscript" id="proof4062">
&nbsp;&nbsp;<span class="tactic">induction</span> 4; <span class="tactic">intros</span>.<br/>
- <span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Events.html#symbols_inject_incr">symbols_inject_incr</a></span>; <span class="tactic">eauto</span>.<br/>
- <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Events.html#symbols_inject_incr">symbols_inject_incr</a></span>; <span class="tactic">eauto</span>.<br/>
- <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="match_stacks_le">match_stacks_le</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">j</span> <span class="id">cs</span> <span class="id">cs</span>' <span class="id">sg</span> <span class="id">sm0</span> <span class="id">sm1</span><br/>
&nbsp;&nbsp;(<span class="id">LE</span>: <span class="id">SimMemInj.le</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#sm0">sm0</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sm1">sm1</a></span>)<br/>
&nbsp;&nbsp;(<span class="id">INJ</span>: <span class="kwd">forall</span> <span class="id">b</span> <span class="id">b2</span> <span class="id">delta</span>, <span class="id"><a href="compcert.common.Memory.html#Mem.valid_block">Mem.valid_block</a></span> (<span class="id"><a href="compcert.common.SimMemInj.html#tgt">SimMemInj.tgt</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sm0">sm0</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#b2">b2</a></span> -&gt; <span class="id"><a href="compcert.common.SimMemInj.html#inj">SimMemInj.inj</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sm1">sm1</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#b">b</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#b2">b2</a></span>, <span class="id"><a href="compcert.backend.Stackingproof.html#delta">delta</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt; <span class="id"><a href="compcert.common.SimMemInj.html#inj">SimMemInj.inj</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sm0">sm0</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#b">b</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#b2">b2</a></span>, <span class="id"><a href="compcert.backend.Stackingproof.html#delta">delta</a></span>))<br/>
&nbsp;&nbsp;(<span class="id">PERM</span>: <span class="kwd">forall</span> <span class="id">b</span> <span class="id">b2</span> <span class="id">delta</span> <span class="id">i</span>, <span class="id"><a href="compcert.common.Memory.html#Mem.valid_block">Mem.valid_block</a></span> (<span class="id"><a href="compcert.common.SimMemInj.html#tgt">SimMemInj.tgt</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sm0">sm0</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#b2">b2</a></span> -&gt; <span class="id"><a href="compcert.common.SimMemInj.html#inj">SimMemInj.inj</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sm1">sm1</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#b">b</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#b2">b2</a></span>, <span class="id"><a href="compcert.backend.Stackingproof.html#delta">delta</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt; <span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> (<span class="id"><a href="compcert.common.SimMemInj.html#src">SimMemInj.src</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sm1">sm1</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#b">b</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#i">i</a></span> <span class="id"><a href="compcert.common.Memtype.html#Max">Max</a></span> <span class="id"><a href="compcert.common.Memtype.html#Nonempty">Nonempty</a></span> -&gt; <span class="id"><a href="compcert.common.Memory.html#Mem.perm">Mem.perm</a></span> (<span class="id"><a href="compcert.common.SimMemInj.html#src">SimMemInj.src</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sm0">sm0</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#b">b</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#i">i</a></span> <span class="id"><a href="compcert.common.Memtype.html#Max">Max</a></span> <span class="id"><a href="compcert.common.Memtype.html#Nonempty">Nonempty</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs">cs</a></span> <span class="id">cs</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#sg">sg</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sm0">sm0</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs">cs</a></span> <span class="id">cs</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#sg">sg</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sm1">sm1</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4063')">Proof.</div>
<div class="proofscript" id="proof4063">
&nbsp;&nbsp;<span class="tactic">induction</span> 4; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;{ <span class="id">econs</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;{ <span class="id">econs</span>; <span class="tactic">eauto</span>. <span class="id">inv</span> <span class="id">LE</span>. <span class="id">des_safe</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id">TGTPARENTEQ</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">TGTPARENTEQNB</span>. <span class="id">esplits</span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.valid_block_unchanged_on">Mem.valid_block_unchanged_on</a></span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">PRIVEQ</span>: <span class="id"><a href="compcert.common.SimMemInj.html#tgt_private">SimMemInj.tgt_private</a></span> <span class="id">sm0</span> <span class="id">sp</span>' &lt;1= <span class="id"><a href="compcert.common.SimMemInj.html#tgt_private">SimMemInj.tgt_private</a></span> <span class="id">sm1</span> <span class="id">sp</span>').<br/>
&nbsp;&nbsp;{ <span class="tactic">clear</span> - <span class="id">PERM</span> <span class="id">INJ</span> <span class="id">LE</span>. <span class="id">ii</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.common.SimMemInj.html#tgt_private">SimMemInj.tgt_private</a></span>, <span class="id"><a href="compcert.common.Events.html#loc_out_of_reach">loc_out_of_reach</a></span> <span class="kwd">in</span> *. <span class="id">ss</span>. <span class="id">desH</span> <span class="id">PR</span>. <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">ii</span>. <span class="tactic">eapply</span> <span class="id">PR</span>. <span class="id">erewrite</span> <span class="id">INJ</span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id">PERM</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.valid_block_unchanged_on">Mem.valid_block_unchanged_on</a></span>; <span class="tactic">eauto</span>. <span class="id">inv</span> <span class="id">LE</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id">econs</span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#spvalid_le">spvalid_le</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Invariance with respect to change of signature. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="match_stacks_change_sig">match_stacks_change_sig</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">sg1</span> <span class="id">j</span> <span class="id">cs</span> <span class="id">cs</span>' <span class="id">sg</span> <span class="id">sm0</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs">cs</a></span> <span class="id">cs</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#sg">sg</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sm0">sm0</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Conventions.html#tailcall_possible">tailcall_possible</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sg1">sg1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs">cs</a></span> <span class="id">cs</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#sg1">sg1</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sm0">sm0</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4064')">Proof.</div>
<div class="proofscript" id="proof4064">
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">intros</span>; <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">elim</span> (<span class="id">H0</span> <span class="id">_</span> <span class="id">H1</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Conventions.html#tailcall_size">tailcall_size</a></span>; <span class="tactic">try</span> <span class="tactic">assumption</span>; <span class="tactic">try</span> <span class="id">xomega</span>. <span class="id">hexploit</span> (<span class="id"><a href="compcert.x86.Conventions1.html#size_arguments_above">size_arguments_above</a></span> <span class="id">sg</span>); <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">xomega</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Typing properties of <span class="bracket"><span class="id">match_stacks</span></span>. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="match_stacks_type_sp">match_stacks_type_sp</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">j</span> <span class="id">cs</span> <span class="id">cs</span>' <span class="id">sg</span> <span class="id">sm0</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs">cs</a></span> <span class="id">cs</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#sg">sg</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sm0">sm0</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Values.html#Val.has_type">Val.has_type</a></span> (<span class="id"><a href="compcert.backend.Mach.html#parent_sp">parent_sp</a></span> <span class="id">cs</span>') <span class="id"><a href="compcert.common.AST.html#Tptr">Tptr</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4065')">Proof.</div>
<div class="proofscript" id="proof4065">
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Mach.html#parent_sp">parent_sp</a></span>; <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Values.html#Val.Vptr_has_type">Val.Vptr_has_type</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="match_stacks_type_retaddr">match_stacks_type_retaddr</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">j</span> <span class="id">cs</span> <span class="id">cs</span>' <span class="id">sg</span> <span class="id">sm0</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs">cs</a></span> <span class="id">cs</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#sg">sg</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sm0">sm0</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Values.html#Val.has_type">Val.has_type</a></span> (<span class="id"><a href="compcert.backend.Mach.html#parent_ra">parent_ra</a></span> <span class="id">cs</span>') <span class="id"><a href="compcert.common.AST.html#Tptr">Tptr</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4066')">Proof.</div>
<div class="proofscript" id="proof4066">
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Mach.html#parent_ra">parent_ra</a></span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Values.html#Val.Vnullptr_has_type">Val.Vnullptr_has_type</a></span>.<br/>
Qed.</div>
<br/>
<h1> Syntactic properties of the translation </h1>
<br/>
<div class="doc">Preservation of code labels through the translation. </div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="PRESERVATION.CORELEMMA.LABELS">LABELS</a></span>.<br/>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="find_label_save_callee_save">find_label_save_callee_save</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">lbl</span> <span class="id">l</span> <span class="id">ofs</span> <span class="id">k</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Mach.html#find_label">Mach.find_label</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#lbl">lbl</a></span> (<span class="id"><a href="compcert.backend.Stacking.html#save_callee_save_rec">save_callee_save_rec</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#l">l</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#k">k</a></span>) = <span class="id"><a href="compcert.backend.Mach.html#find_label">Mach.find_label</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#lbl">lbl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#k">k</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4067')">Proof.</div>
<div class="proofscript" id="proof4067">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="find_label_restore_callee_save">find_label_restore_callee_save</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">lbl</span> <span class="id">l</span> <span class="id">ofs</span> <span class="id">k</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Mach.html#find_label">Mach.find_label</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#lbl">lbl</a></span> (<span class="id"><a href="compcert.backend.Stacking.html#restore_callee_save_rec">restore_callee_save_rec</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#l">l</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#k">k</a></span>) = <span class="id"><a href="compcert.backend.Mach.html#find_label">Mach.find_label</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#lbl">lbl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#k">k</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4068')">Proof.</div>
<div class="proofscript" id="proof4068">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="transl_code_eq">transl_code_eq</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">fe</span> <span class="id">i</span> <span class="id">c</span>, <span class="id"><a href="compcert.backend.Stacking.html#transl_code">transl_code</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#fe">fe</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#i">i</a></span> :: <span class="id"><a href="compcert.backend.Stackingproof.html#c">c</a></span>) = <span class="id"><a href="compcert.backend.Stacking.html#transl_instr">transl_instr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#fe">fe</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#i">i</a></span> (<span class="id"><a href="compcert.backend.Stacking.html#transl_code">transl_code</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#fe">fe</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#c">c</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4069')">Proof.</div>
<div class="proofscript" id="proof4069">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Stacking.html#transl_code">transl_code</a></span>; <span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#list_fold_right_eq">list_fold_right_eq</a></span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="find_label_transl_code">find_label_transl_code</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">fe</span> <span class="id">lbl</span> <span class="id">c</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Mach.html#find_label">Mach.find_label</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#lbl">lbl</a></span> (<span class="id"><a href="compcert.backend.Stacking.html#transl_code">transl_code</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#fe">fe</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#c">c</a></span>) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#option_map">option_map</a></span> (<span class="id"><a href="compcert.backend.Stacking.html#transl_code">transl_code</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#fe">fe</a></span>) (<span class="id"><a href="compcert.backend.Linear.html#find_label">Linear.find_label</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#lbl">lbl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#c">c</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4070')">Proof.</div>
<div class="proofscript" id="proof4070">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">c</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
- <span class="tactic">auto</span>.<br/>
- <span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Stackingproof.html#transl_code_eq">transl_code_eq</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">a</span>; <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Stacking.html#transl_instr">transl_instr</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">s</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">s</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Stacking.html#restore_callee_save">restore_callee_save</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Stackingproof.html#find_label_restore_callee_save">find_label_restore_callee_save</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#peq">peq</a></span> <span class="id">lbl</span> <span class="id">l</span>). <span class="tactic">reflexivity</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Stacking.html#restore_callee_save">restore_callee_save</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Stackingproof.html#find_label_restore_callee_save">find_label_restore_callee_save</a></span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="transl_find_label">transl_find_label</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">tf</span> <span class="id">lbl</span> <span class="id">c</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stacking.html#transf_function">transf_function</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f">f</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#tf">tf</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Linear.html#find_label">Linear.find_label</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#lbl">lbl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f">f</a></span>.(<span class="id"><a href="compcert.backend.Linear.html#fn_code">Linear.fn_code</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#c">c</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Mach.html#find_label">Mach.find_label</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#lbl">lbl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#tf">tf</a></span>.(<span class="id"><a href="compcert.backend.Mach.html#fn_code">Mach.fn_code</a></span>) =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="compcert.backend.Stacking.html#transl_code">transl_code</a></span> (<span class="id"><a href="compcert.x86.Stacklayout.html#make_env">make_env</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#function_bounds">function_bounds</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f">f</a></span>)) <span class="id"><a href="compcert.backend.Stackingproof.html#c">c</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4071')">Proof.</div>
<div class="proofscript" id="proof4071">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> (<span class="id"><a href="compcert.backend.Stackingproof.html#unfold_transf_function">unfold_transf_function</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">H</span>).  <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Stacking.html#transl_body">transl_body</a></span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Stacking.html#save_callee_save">save_callee_save</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Stackingproof.html#find_label_save_callee_save">find_label_save_callee_save</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Stackingproof.html#find_label_transl_code">find_label_transl_code</a></span>. <span class="tactic">rewrite</span> <span class="id">H0</span>. <span class="tactic">reflexivity</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.LABELS">LABELS</a></span>.<br/>
<br/>
<div class="doc">Code tail property for Linear executions. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="find_label_tail">find_label_tail</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">lbl</span> <span class="id">c</span> <span class="id">c</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Linear.html#find_label">Linear.find_label</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#lbl">lbl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#c">c</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">c</span>' -&gt; <span class="id"><a href="compcert.lib.Coqlib.html#is_tail">is_tail</a></span> <span class="id">c</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#c">c</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4072')">Proof.</div>
<div class="proofscript" id="proof4072">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">c</span>; <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">c</span>'. <span class="tactic">case</span> (<span class="id"><a href="compcert.backend.Linear.html#is_label">Linear.is_label</a></span> <span class="id">lbl</span> <span class="id">a</span>); <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">injection</span> <span class="id">H</span>; <span class="tactic">intro</span>; <span class="tactic">subst</span> <span class="id">c</span>'. <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">coqlib</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">coqlib</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Code tail property for translations </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="is_tail_save_callee_save">is_tail_save_callee_save</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span> <span class="id">ofs</span> <span class="id">k</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#is_tail">is_tail</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#k">k</a></span> (<span class="id"><a href="compcert.backend.Stacking.html#save_callee_save_rec">save_callee_save_rec</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#l">l</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#k">k</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4073')">Proof.</div>
<div class="proofscript" id="proof4073">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">intros</span>; <span class="tactic">simpl</span>. <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">coqlib</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="is_tail_restore_callee_save">is_tail_restore_callee_save</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span> <span class="id">ofs</span> <span class="id">k</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#is_tail">is_tail</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#k">k</a></span> (<span class="id"><a href="compcert.backend.Stacking.html#restore_callee_save_rec">restore_callee_save_rec</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#l">l</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#k">k</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4074')">Proof.</div>
<div class="proofscript" id="proof4074">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">intros</span>; <span class="tactic">simpl</span>. <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">coqlib</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="is_tail_transl_instr">is_tail_transl_instr</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">fe</span> <span class="id">i</span> <span class="id">k</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#is_tail">is_tail</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#k">k</a></span> (<span class="id"><a href="compcert.backend.Stacking.html#transl_instr">transl_instr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#fe">fe</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#i">i</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#k">k</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4075')">Proof.</div>
<div class="proofscript" id="proof4075">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">i</span>; <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Stacking.html#transl_instr">transl_instr</a></span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">coqlib</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">s</span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">coqlib</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">s</span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">coqlib</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Stacking.html#restore_callee_save">restore_callee_save</a></span>.  <span class="tactic">eapply</span> <span class="id"><a href="compcert.lib.Coqlib.html#is_tail_trans">is_tail_trans</a></span>. 2: <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#is_tail_restore_callee_save">is_tail_restore_callee_save</a></span>. <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">coqlib</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Stacking.html#restore_callee_save">restore_callee_save</a></span>.  <span class="tactic">eapply</span> <span class="id"><a href="compcert.lib.Coqlib.html#is_tail_trans">is_tail_trans</a></span>. 2: <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#is_tail_restore_callee_save">is_tail_restore_callee_save</a></span>. <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">coqlib</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="is_tail_transl_code">is_tail_transl_code</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">fe</span> <span class="id">c1</span> <span class="id">c2</span>, <span class="id"><a href="compcert.lib.Coqlib.html#is_tail">is_tail</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#c1">c1</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#c2">c2</a></span> -&gt; <span class="id"><a href="compcert.lib.Coqlib.html#is_tail">is_tail</a></span> (<span class="id"><a href="compcert.backend.Stacking.html#transl_code">transl_code</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#fe">fe</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#c1">c1</a></span>) (<span class="id"><a href="compcert.backend.Stacking.html#transl_code">transl_code</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#fe">fe</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#c2">c2</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4076')">Proof.</div>
<div class="proofscript" id="proof4076">
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">simpl</span>. <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">coqlib</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Stackingproof.html#transl_code_eq">transl_code_eq</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.lib.Coqlib.html#is_tail_trans">is_tail_trans</a></span>. <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#is_tail_transl_instr">is_tail_transl_instr</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="is_tail_transf_function">is_tail_transf_function</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">tf</span> <span class="id">c</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stacking.html#transf_function">transf_function</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f">f</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#tf">tf</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#is_tail">is_tail</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#c">c</a></span> (<span class="id"><a href="compcert.backend.Linear.html#fn_code">Linear.fn_code</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f">f</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#is_tail">is_tail</a></span> (<span class="id"><a href="compcert.backend.Stacking.html#transl_code">transl_code</a></span> (<span class="id"><a href="compcert.x86.Stacklayout.html#make_env">make_env</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#function_bounds">function_bounds</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f">f</a></span>)) <span class="id"><a href="compcert.backend.Stackingproof.html#c">c</a></span>) (<span class="id"><a href="compcert.backend.Mach.html#fn_code">fn_code</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#tf">tf</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4077')">Proof.</div>
<div class="proofscript" id="proof4077">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> (<span class="id"><a href="compcert.backend.Stackingproof.html#unfold_transf_function">unfold_transf_function</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">H</span>). <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Stacking.html#transl_body">transl_body</a></span>, <span class="id"><a href="compcert.backend.Stacking.html#save_callee_save">save_callee_save</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.lib.Coqlib.html#is_tail_trans">is_tail_trans</a></span>. 2: <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#is_tail_save_callee_save">is_tail_save_callee_save</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#is_tail_transl_code">is_tail_transl_code</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<h1> Semantic preservation </h1>
<br/>
<div class="doc">Preservation / translation of global symbols and functions. </div>
<br/>
<span class="kwd">Hypothesis</span> (<span class="id"><a name="PRESERVATION.CORELEMMA.MATCH_GENV">MATCH_GENV</a></span>: <span class="id"><a href="compcert.common.Globalenvs.html#Genv.match_genvs">Genv.match_genvs</a></span> (<span class="id"><a href="compcert.common.Linking.html#match_globdef">match_globdef</a></span> (<span class="kwd">fun</span> <span class="id">_</span> <span class="id">f</span> <span class="id">tf</span> =&gt; <span class="id"><a href="compcert.backend.Stacking.html#transf_fundef">transf_fundef</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f">f</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#tf">tf</a></span>) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.prog">prog</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.ge">ge</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.tge">tge</a></span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="symbols_preserved">symbols_preserved</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">s</span>: <span class="id"><a href="compcert.common.AST.html#ident">ident</a></span>), <span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_symbol">Genv.find_symbol</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.tge">tge</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#s">s</a></span> = <span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_symbol">Genv.find_symbol</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.ge">ge</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#s">s</a></span>.<br/>
<span class="kwd">Proof</span> (<span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_symbol_match_genv">Genv.find_symbol_match_genv</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.MATCH_GENV">MATCH_GENV</a></span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="senv_preserved">senv_preserved</a></span>:<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Globalenvs.html#Senv.equiv">Senv.equiv</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.ge">ge</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.tge">tge</a></span>.<br/>
<span class="kwd">Proof</span> (<span class="id"><a href="compcert.common.Globalenvs.html#Genv.senv_match_genv">Genv.senv_match_genv</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.MATCH_GENV">MATCH_GENV</a></span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="functions_translated">functions_translated</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">v</span> <span class="id">f</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_funct">Genv.find_funct</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.ge">ge</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v">v</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f">f</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">tf</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_funct">Genv.find_funct</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.tge">tge</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v">v</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#tf">tf</a></span> /\ <span class="id"><a href="compcert.backend.Stacking.html#transf_fundef">transf_fundef</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f">f</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#tf">tf</a></span>.<br/>
<span class="kwd">Proof</span> (<span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_funct_transf_partial_genv">Genv.find_funct_transf_partial_genv</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.MATCH_GENV">MATCH_GENV</a></span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="function_ptr_translated">function_ptr_translated</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">b</span> <span class="id">f</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_funct_ptr">Genv.find_funct_ptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.ge">ge</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#b">b</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f">f</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">tf</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_funct_ptr">Genv.find_funct_ptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.tge">tge</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#b">b</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#tf">tf</a></span> /\ <span class="id"><a href="compcert.backend.Stacking.html#transf_fundef">transf_fundef</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f">f</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#tf">tf</a></span>.<br/>
<span class="kwd">Proof</span> (<span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_funct_ptr_transf_partial_genv">Genv.find_funct_ptr_transf_partial_genv</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.MATCH_GENV">MATCH_GENV</a></span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="sig_preserved">sig_preserved</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">tf</span>, <span class="id"><a href="compcert.backend.Stacking.html#transf_fundef">transf_fundef</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f">f</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#tf">tf</a></span> -&gt; <span class="id"><a href="compcert.backend.Mach.html#funsig">Mach.funsig</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#tf">tf</a></span> = <span class="id"><a href="compcert.backend.Linear.html#funsig">Linear.funsig</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f">f</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4078')">Proof.</div>
<div class="proofscript" id="proof4078">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> <span class="id">tf</span>; <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Stacking.html#transf_fundef">transf_fundef</a></span>, <span class="id"><a href="compcert.common.AST.html#transf_partial_fundef">transf_partial_fundef</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">f</span>; <span class="tactic">intros</span>; <span class="id">monadInv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="compcert.backend.Stackingproof.html#unfold_transf_function">unfold_transf_function</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">EQ</span>). <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="find_function_ptr_translated">find_function_ptr_translated</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">j</span> <span class="id">ls</span> <span class="id">rs</span> <span class="id">m</span> <span class="id">ros</span> <span class="id">fptr</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs">rs</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span> |= <span class="id"><a href="compcert.common.Separation.html#globalenv_inject">globalenv_inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.ge">ge</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Linear.html#find_function_ptr">Linear.find_function_ptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.ge">ge</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ros">ros</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> = <span class="id"><a href="compcert.backend.Stackingproof.html#fptr">fptr</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">tfptr</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;<span class="id">TFPTR</span>: <span class="id"><a href="compcert.backend.Mach.html#find_function_ptr">find_function_ptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.tge">tge</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ros">ros</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs">rs</a></span> = <span class="id"><a href="compcert.backend.Stackingproof.html#tfptr">tfptr</a></span>&gt;&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ &lt;&lt;<span class="id">FPTR</span>: <span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#fptr">fptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#tfptr">tfptr</a></span>&gt;&gt;.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4079')">Proof.</div>
<div class="proofscript" id="proof4079">
&nbsp;&nbsp;<span class="id">ii</span>. <span class="id">inv</span> <span class="id">H0</span>; <span class="id">des</span>. <span class="tactic">destruct</span> <span class="id">ros</span>; <span class="id">ss</span>; <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;- <span class="id">esplits</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id">erewrite</span> <span class="id"><a href="compcert.backend.Stackingproof.html#symbols_preserved">symbols_preserved</a></span>. <span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">esplits</span>; <span class="tactic">eauto</span>. <span class="id">inv</span> <span class="id">H0</span>. <span class="id">exploit</span> <span class="id">SYMBOLS</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">esplits</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Preservation of the arguments to an external call. </div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="PRESERVATION.CORELEMMA.EXTERNAL_ARGUMENTS">EXTERNAL_ARGUMENTS</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.CORELEMMA.EXTERNAL_ARGUMENTS.j">j</a></span>: <span class="id"><a href="compcert.common.Values.html#meminj">meminj</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.CORELEMMA.EXTERNAL_ARGUMENTS.cs">cs</a></span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.backend.Linear.html#stackframe">Linear.stackframe</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id">cs</span>': <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.backend.Mach.html#stackframe">stackframe</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.CORELEMMA.EXTERNAL_ARGUMENTS.sg">sg</a></span>: <span class="id"><a href="compcert.common.AST.html#signature">signature</a></span>.<br/>
<span class="kwd">Variables</span> <span class="id"><a name="PRESERVATION.CORELEMMA.EXTERNAL_ARGUMENTS.bound">bound</a></span> <span class="id">bound</span>': <span class="id"><a href="compcert.common.Values.html#block">block</a></span>.<br/>
<span class="kwd">Variables</span> <span class="id"><a name="PRESERVATION.CORELEMMA.EXTERNAL_ARGUMENTS.sm0">sm0</a></span>: <span class="id">SimMemInj.t</span>'.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="PRESERVATION.CORELEMMA.EXTERNAL_ARGUMENTS.MS">MS</a></span>: <span class="id"><a href="compcert.backend.Stackingproof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.EXTERNAL_ARGUMENTS.j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.EXTERNAL_ARGUMENTS.cs">cs</a></span> <span class="id">cs</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.EXTERNAL_ARGUMENTS.sg">sg</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.EXTERNAL_ARGUMENTS.sm0">sm0</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.CORELEMMA.EXTERNAL_ARGUMENTS.ls">ls</a></span>: <span class="id"><a href="compcert.backend.Linear.html#locset">locset</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.CORELEMMA.EXTERNAL_ARGUMENTS.rs">rs</a></span>: <span class="id"><a href="compcert.backend.Mach.html#regset">regset</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="PRESERVATION.CORELEMMA.EXTERNAL_ARGUMENTS.AGR">AGR</a></span>: <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.EXTERNAL_ARGUMENTS.j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.EXTERNAL_ARGUMENTS.ls">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.EXTERNAL_ARGUMENTS.rs">rs</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="PRESERVATION.CORELEMMA.EXTERNAL_ARGUMENTS.AGCS">AGCS</a></span>: <span class="id"><a href="compcert.backend.Conventions.html#agree_callee_save">agree_callee_save</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.EXTERNAL_ARGUMENTS.ls">ls</a></span> (<span class="id"><a href="compcert.backend.Linear.html#parent_locset">parent_locset</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.EXTERNAL_ARGUMENTS.cs">cs</a></span>).<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="PRESERVATION.CORELEMMA.EXTERNAL_ARGUMENTS.AGARGS">AGARGS</a></span>: <span class="id"><a href="compcert.backend.Lineartyping.html#agree_outgoing_arguments">agree_outgoing_arguments</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.EXTERNAL_ARGUMENTS.sg">sg</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.EXTERNAL_ARGUMENTS.ls">ls</a></span> (<span class="id"><a href="compcert.backend.Linear.html#parent_locset">parent_locset</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.EXTERNAL_ARGUMENTS.cs">cs</a></span>).<br/>
<span class="kwd">Variable</span> <span class="id">m</span>': <span class="id"><a href="compcert.common.Memory.html#mem">mem</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="PRESERVATION.CORELEMMA.EXTERNAL_ARGUMENTS.SEP">SEP</a></span>: <span class="id">m</span>' |= <span class="id">stack_contents</span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.EXTERNAL_ARGUMENTS.j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.EXTERNAL_ARGUMENTS.cs">cs</a></span> <span class="id">cs</span>'.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="transl_external_argument">transl_external_argument</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#l">l</a></span> (<span class="id"><a href="compcert.common.AST.html#regs_of_rpairs">regs_of_rpairs</a></span> (<span class="id"><a href="compcert.x86.Conventions1.html#loc_arguments">loc_arguments</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.EXTERNAL_ARGUMENTS.sg">sg</a></span>)) -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v</span>, <span class="id"><a href="compcert.backend.Mach.html#extcall_arg">extcall_arg</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.EXTERNAL_ARGUMENTS.rs">rs</a></span> <span class="id">m</span>' (<span class="id"><a href="compcert.backend.Mach.html#parent_sp">parent_sp</a></span> <span class="id">cs</span>') <span class="id"><a href="compcert.backend.Stackingproof.html#l">l</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v">v</a></span> /\ <span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.EXTERNAL_ARGUMENTS.j">j</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.EXTERNAL_ARGUMENTS.ls">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#l">l</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#v">v</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4080')">Proof.</div>
<div class="proofscript" id="proof4080">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="compcert.x86.Conventions1.html#loc_argument_acceptable">loc_argument_acceptable</a></span> <span class="id">l</span>) <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Conventions.html#loc_arguments_acceptable_2">loc_arguments_acceptable_2</a></span> <span class="kwd">with</span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.EXTERNAL_ARGUMENTS.sg">sg</a></span>; <span class="tactic">auto</span>).<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">l</span>; <span class="tactic">red</span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
- <span class="id">exists</span> (<span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.EXTERNAL_ARGUMENTS.rs">rs</a></span> <span class="id">r</span>); <span class="tactic">split</span>. <span class="id">constructor</span>. <span class="tactic">auto</span>.<br/>
- <span class="tactic">destruct</span> <span class="id">sl</span>; <span class="tactic">try</span> <span class="id">contradiction</span>.<br/>
<span class="kwd">Local</span> <span class="id">Opaque</span> <span class="id"><a href="compcert.backend.Stackingproof.html#contains_locations">contains_locations</a></span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.EXTERNAL_ARGUMENTS.MS">MS</a></span>.<br/>
+ <span class="tactic">elim</span> (<span class="id">H1</span> <span class="id">_</span> <span class="id">H</span>).<br/>
+ <span class="id">ss</span>. <span class="tactic">rewrite</span> <span class="id">MAINARGS</span> <span class="kwd">in</span> *. <span class="id">des</span>; <span class="id">cycle</span> 1.<br/>
&nbsp;&nbsp;{ <span class="id">hnf</span> <span class="kwd">in</span> <span class="id">LE</span>. <span class="id">exploit</span> <span class="id">LE</span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">des</span>. <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;<span class="id">clarify</span>. <span class="id">clear_tac</span>. <span class="id">ss</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Stackingproof.html#dummy_frame_contents">dummy_frame_contents</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">hexploit</span> <span class="id"><a href="compcert.x86.Conventions1.html#loc_arguments_bounded">loc_arguments_bounded</a></span>; <span class="tactic">eauto</span>. <span class="id">i</span>.<br/>
&nbsp;&nbsp;<span class="id">specialize</span> (<span class="id">ARGS</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H</span>). <span class="id">des</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Stackingproof.html#get_location">get_location</a></span>; <span class="tactic">eauto</span>; <span class="tactic">try</span> <span class="id">xomega</span>. <span class="id">i</span>; <span class="id">des</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.Ptrofs_add_repr">Ptrofs.Ptrofs_add_repr</a></span>, <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.repr_unsigned">Ptrofs.repr_unsigned</a></span>, &lt;- <span class="id"><a href="compcert.backend.Stackingproof.html#load_stack_transf_ofs">load_stack_transf_ofs</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">esplits</span>; <span class="tactic">eauto</span>. { <span class="id">econs</span>; <span class="tactic">eauto</span>. } <span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.EXTERNAL_ARGUMENTS.AGARGS">AGARGS</a></span>; <span class="id">ss</span>.<br/>
+ <span class="tactic">assert</span> (<span class="id"><a href="compcert.backend.Lineartyping.html#slot_valid">slot_valid</a></span> <span class="id">f</span> <span class="id"><a href="compcert.backend.Locations.html#Outgoing">Outgoing</a></span> <span class="id">pos</span> <span class="id">ty</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">destruct</span> <span class="id">H0</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Lineartyping.html#slot_valid">slot_valid</a></span>, <span class="id"><a href="compcert.lib.Coqlib.html#proj_sumbool">proj_sumbool</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#zle_true">zle_true</a></span> <span class="tactic">by</span> <span class="tactic">omega</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#pred_dec_true">pred_dec_true</a></span> <span class="tactic">by</span> <span class="tactic">auto</span>. <span class="tactic">reflexivity</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="compcert.backend.Bounds.html#slot_within_bounds">slot_within_bounds</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#function_bounds">function_bounds</a></span> <span class="id">f</span>) <span class="id"><a href="compcert.backend.Locations.html#Outgoing">Outgoing</a></span> <span class="id">pos</span> <span class="id">ty</span>) <span class="tactic">by</span> <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">exists</span> <span class="id">v</span>, &lt;&lt;<span class="id">A</span>: <span class="id"><a href="compcert.backend.Mach.html#load_stack">load_stack</a></span> <span class="id">m</span>' (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">sp</span>' <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id">ty</span> (<span class="id"><a href="compcert.lib.Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> (<span class="id"><a href="compcert.backend.Stacking.html#offset_arg">offset_arg</a></span> <span class="id">pos</span>)) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v">v</a></span>&gt;&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ &lt;&lt;<span class="id">B</span>: <span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.EXTERNAL_ARGUMENTS.j">j</a></span> (<span class="id">ls0</span> (<span class="id"><a href="compcert.backend.Locations.html#S">S</a></span> <span class="id"><a href="compcert.backend.Locations.html#Outgoing">Outgoing</a></span> <span class="id">pos</span> <span class="id">ty</span>)) <span class="id"><a href="compcert.backend.Stackingproof.html#v">v</a></span>&gt;&gt;).<br/>
&nbsp;&nbsp;{ <span class="tactic">destruct</span> <span class="id"><a href="compcert.backend.Conventions.html#main_args">main_args</a></span> <span class="id">eqn</span>:<span class="id">MAINARGS</span>; <span class="id">cycle</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">SEP</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_get_outgoing">frame_get_outgoing</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">SEP</span>. <span class="id">des_ifs</span>; <span class="id">sep_simpl_tac</span>. { <span class="id">inv</span> <span class="id">STK</span>. <span class="id">clarify</span>. } <span class="id">exploit</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_get_outgoing">frame_get_outgoing</a></span>; <span class="tactic">eauto</span>. } <span class="id">des</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>. <span class="tactic">exact</span> <span class="id">A</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.EXTERNAL_ARGUMENTS.AGARGS">AGARGS</a></span> <span class="tactic">by</span> <span class="tactic">auto</span>. <span class="tactic">exact</span> <span class="id">B</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="transl_external_argument_2">transl_external_argument_2</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#p">p</a></span> (<span class="id"><a href="compcert.x86.Conventions1.html#loc_arguments">loc_arguments</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.EXTERNAL_ARGUMENTS.sg">sg</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v</span>, <span class="id"><a href="compcert.backend.Mach.html#extcall_arg_pair">extcall_arg_pair</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.EXTERNAL_ARGUMENTS.rs">rs</a></span> <span class="id">m</span>' (<span class="id"><a href="compcert.backend.Mach.html#parent_sp">parent_sp</a></span> <span class="id">cs</span>') <span class="id"><a href="compcert.backend.Stackingproof.html#p">p</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v">v</a></span> /\ <span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.EXTERNAL_ARGUMENTS.j">j</a></span> (<span class="id"><a href="compcert.backend.Locations.html#Locmap.getpair">Locmap.getpair</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#p">p</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.EXTERNAL_ARGUMENTS.ls">ls</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#v">v</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4081')">Proof.</div>
<div class="proofscript" id="proof4081">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">p</span> <span class="kwd">as</span> [<span class="id">l</span> | <span class="id">l1</span> <span class="id">l2</span>].<br/>
- <span class="tactic">destruct</span> (<span class="id"><a href="compcert.backend.Stackingproof.html#transl_external_argument">transl_external_argument</a></span> <span class="id">l</span>) <span class="kwd">as</span> (<span class="id">v</span> &amp; <span class="id">A</span> &amp; <span class="id">B</span>). <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.AST.html#in_regs_of_rpairs">in_regs_of_rpairs</a></span>; <span class="tactic">eauto</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v</span>; <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">destruct</span> (<span class="id"><a href="compcert.backend.Stackingproof.html#transl_external_argument">transl_external_argument</a></span> <span class="id">l1</span>) <span class="kwd">as</span> (<span class="id">v1</span> &amp; <span class="id">A1</span> &amp; <span class="id">B1</span>). <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.AST.html#in_regs_of_rpairs">in_regs_of_rpairs</a></span>; <span class="tactic">eauto</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.backend.Stackingproof.html#transl_external_argument">transl_external_argument</a></span> <span class="id">l2</span>) <span class="kwd">as</span> (<span class="id">v2</span> &amp; <span class="id">A2</span> &amp; <span class="id">B2</span>). <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.AST.html#in_regs_of_rpairs">in_regs_of_rpairs</a></span>; <span class="tactic">eauto</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="compcert.common.Values.html#Val.longofwords">Val.longofwords</a></span> <span class="id">v1</span> <span class="id">v2</span>); <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Values.html#Val.longofwords_inject">Val.longofwords_inject</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="transl_external_arguments_rec">transl_external_arguments_rec</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">locs</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#incl">incl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#locs">locs</a></span> (<span class="id"><a href="compcert.x86.Conventions1.html#loc_arguments">loc_arguments</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.EXTERNAL_ARGUMENTS.sg">sg</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">vl</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#list_forall2">list_forall2</a></span> (<span class="id"><a href="compcert.backend.Mach.html#extcall_arg_pair">extcall_arg_pair</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.EXTERNAL_ARGUMENTS.rs">rs</a></span> <span class="id">m</span>' (<span class="id"><a href="compcert.backend.Mach.html#parent_sp">parent_sp</a></span> <span class="id">cs</span>')) <span class="id"><a href="compcert.backend.Stackingproof.html#locs">locs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#vl">vl</a></span><br/>
&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="compcert.common.Values.html#Val.inject_list">Val.inject_list</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.EXTERNAL_ARGUMENTS.j">j</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">p</span> =&gt; <span class="id"><a href="compcert.backend.Locations.html#Locmap.getpair">Locmap.getpair</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#p">p</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.EXTERNAL_ARGUMENTS.ls">ls</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#locs">locs</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#vl">vl</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4082')">Proof.</div>
<div class="proofscript" id="proof4082">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">locs</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id"><a href="compcert.common.Values.html#val">val</a></span>); <span class="tactic">split</span>. <span class="id">constructor</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Stackingproof.html#transl_external_argument_2">transl_external_argument_2</a></span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">coqlib</span>. <span class="tactic">intros</span> [<span class="id">v</span> [<span class="id">A</span> <span class="id">B</span>]].<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">IHlocs</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">coqlib</span>. <span class="tactic">intros</span> [<span class="id">vl</span> [<span class="id">C</span> <span class="id">D</span>]].<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id">v</span> :: <span class="id">vl</span>); <span class="tactic">split</span>; <span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="transl_external_arguments">transl_external_arguments</a></span>:<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">vl</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Mach.html#extcall_arguments">extcall_arguments</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.EXTERNAL_ARGUMENTS.rs">rs</a></span> <span class="id">m</span>' (<span class="id"><a href="compcert.backend.Mach.html#parent_sp">parent_sp</a></span> <span class="id">cs</span>') <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.EXTERNAL_ARGUMENTS.sg">sg</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#vl">vl</a></span><br/>
&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="compcert.common.Values.html#Val.inject_list">Val.inject_list</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.EXTERNAL_ARGUMENTS.j">j</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="kwd">fun</span> <span class="id">p</span> =&gt; <span class="id"><a href="compcert.backend.Locations.html#Locmap.getpair">Locmap.getpair</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#p">p</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.EXTERNAL_ARGUMENTS.ls">ls</a></span>) (<span class="id"><a href="compcert.x86.Conventions1.html#loc_arguments">loc_arguments</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.EXTERNAL_ARGUMENTS.sg">sg</a></span>)) <span class="id"><a href="compcert.backend.Stackingproof.html#vl">vl</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4083')">Proof.</div>
<div class="proofscript" id="proof4083">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Mach.html#extcall_arguments">extcall_arguments</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#transl_external_arguments_rec">transl_external_arguments_rec</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">coqlib</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.EXTERNAL_ARGUMENTS">EXTERNAL_ARGUMENTS</a></span>.<br/>
<br/>
<div class="doc">Preservation of the arguments to a builtin. </div>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="PRESERVATION.CORELEMMA.BUILTIN_ARGUMENTS">BUILTIN_ARGUMENTS</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.CORELEMMA.BUILTIN_ARGUMENTS.f">f</a></span>: <span class="id"><a href="compcert.backend.Linear.html#function">Linear.function</a></span>.<br/>
<span class="kwd">Let</span> <span class="id"><a name="PRESERVATION.CORELEMMA.BUILTIN_ARGUMENTS.b">b</a></span> := <span class="id"><a href="compcert.backend.Bounds.html#function_bounds">function_bounds</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.BUILTIN_ARGUMENTS.f">f</a></span>.<br/>
<span class="kwd">Let</span> <span class="id"><a name="PRESERVATION.CORELEMMA.BUILTIN_ARGUMENTS.fe">fe</a></span> := <span class="id"><a href="compcert.x86.Stacklayout.html#make_env">make_env</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.BUILTIN_ARGUMENTS.b">b</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.CORELEMMA.BUILTIN_ARGUMENTS.tf">tf</a></span>: <span class="id"><a href="compcert.backend.Mach.html#function">Mach.function</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="PRESERVATION.CORELEMMA.BUILTIN_ARGUMENTS.TRANSF_F">TRANSF_F</a></span>: <span class="id"><a href="compcert.backend.Stacking.html#transf_function">transf_function</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.BUILTIN_ARGUMENTS.f">f</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.BUILTIN_ARGUMENTS.tf">tf</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.CORELEMMA.BUILTIN_ARGUMENTS.j">j</a></span>: <span class="id"><a href="compcert.common.Values.html#meminj">meminj</a></span>.<br/>
<span class="kwd">Variables</span> <span class="id"><a name="PRESERVATION.CORELEMMA.BUILTIN_ARGUMENTS.m">m</a></span> <span class="id">m</span>': <span class="id"><a href="compcert.common.Memory.html#mem">mem</a></span>.<br/>
<span class="kwd">Variables</span> <span class="id"><a name="PRESERVATION.CORELEMMA.BUILTIN_ARGUMENTS.ls">ls</a></span> <span class="id"><a name="PRESERVATION.CORELEMMA.BUILTIN_ARGUMENTS.ls0">ls0</a></span>: <span class="id"><a href="compcert.backend.Linear.html#locset">locset</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="PRESERVATION.CORELEMMA.BUILTIN_ARGUMENTS.rs">rs</a></span>: <span class="id"><a href="compcert.backend.Mach.html#regset">regset</a></span>.<br/>
<span class="kwd">Variables</span> <span class="id"><a name="PRESERVATION.CORELEMMA.BUILTIN_ARGUMENTS.sp">sp</a></span> <span class="id">sp</span>': <span class="id"><a href="compcert.common.Values.html#block">block</a></span>.<br/>
<span class="kwd">Variables</span> <span class="id"><a name="PRESERVATION.CORELEMMA.BUILTIN_ARGUMENTS.parent">parent</a></span> <span class="id"><a name="PRESERVATION.CORELEMMA.BUILTIN_ARGUMENTS.retaddr">retaddr</a></span>: <span class="id"><a href="compcert.common.Values.html#val">val</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="PRESERVATION.CORELEMMA.BUILTIN_ARGUMENTS.INJ">INJ</a></span>: <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.BUILTIN_ARGUMENTS.j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.BUILTIN_ARGUMENTS.sp">sp</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id">sp</span>', <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.BUILTIN_ARGUMENTS.fe">fe</a></span>.(<span class="id"><a href="compcert.backend.Bounds.html#fe_stack_data">fe_stack_data</a></span>)).<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="PRESERVATION.CORELEMMA.BUILTIN_ARGUMENTS.AGR">AGR</a></span>: <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.BUILTIN_ARGUMENTS.j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.BUILTIN_ARGUMENTS.ls">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.BUILTIN_ARGUMENTS.rs">rs</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="PRESERVATION.CORELEMMA.BUILTIN_ARGUMENTS.SEP">SEP</a></span>: <span class="id">m</span>' |= <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.BUILTIN_ARGUMENTS.f">f</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.BUILTIN_ARGUMENTS.j">j</a></span> <span class="id">sp</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.BUILTIN_ARGUMENTS.ls">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.BUILTIN_ARGUMENTS.ls0">ls0</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.BUILTIN_ARGUMENTS.parent">parent</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.BUILTIN_ARGUMENTS.retaddr">retaddr</a></span> ** <span class="id"><a href="compcert.common.Separation.html#minjection">minjection</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.BUILTIN_ARGUMENTS.j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.BUILTIN_ARGUMENTS.m">m</a></span> ** <span class="id"><a href="compcert.common.Separation.html#globalenv_inject">globalenv_inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.ge">ge</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.BUILTIN_ARGUMENTS.j">j</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="transl_builtin_arg_correct">transl_builtin_arg_correct</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">a</span> <span class="id">v</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Events.html#eval_builtin_arg">eval_builtin_arg</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.ge">ge</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.BUILTIN_ARGUMENTS.ls">ls</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.BUILTIN_ARGUMENTS.sp">sp</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.BUILTIN_ARGUMENTS.m">m</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#a">a</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v">v</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">l</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#l">l</a></span> (<span class="id"><a href="compcert.common.AST.html#params_of_builtin_arg">params_of_builtin_arg</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#a">a</a></span>) -&gt; <span class="id"><a href="compcert.backend.Lineartyping.html#loc_valid">loc_valid</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.BUILTIN_ARGUMENTS.f">f</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#l">l</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>) -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">sl</span> <span class="id">ofs</span> <span class="id">ty</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="compcert.backend.Locations.html#S">S</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sl">sl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span>) (<span class="id"><a href="compcert.common.AST.html#params_of_builtin_arg">params_of_builtin_arg</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#a">a</a></span>) -&gt; <span class="id"><a href="compcert.backend.Bounds.html#slot_within_bounds">slot_within_bounds</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.BUILTIN_ARGUMENTS.b">b</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sl">sl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Events.html#eval_builtin_arg">eval_builtin_arg</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.ge">ge</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.BUILTIN_ARGUMENTS.rs">rs</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">sp</span>' <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id">m</span>' (<span class="id"><a href="compcert.backend.Stacking.html#transl_builtin_arg">transl_builtin_arg</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.BUILTIN_ARGUMENTS.fe">fe</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#a">a</a></span>) <span class="id">v</span>'<br/>
&nbsp;&nbsp;/\ <span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.BUILTIN_ARGUMENTS.j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v">v</a></span> <span class="id">v</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4084')">Proof.</div>
<div class="proofscript" id="proof4084">
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">SYMB</span>: <span class="kwd">forall</span> <span class="id">id</span> <span class="id">ofs</span>, <span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.BUILTIN_ARGUMENTS.j">j</a></span> (<span class="id"><a href="compcert.common.Globalenvs.html#Senv.symbol_address">Senv.symbol_address</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.ge">ge</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#id">id</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span>) (<span class="id"><a href="compcert.common.Globalenvs.html#Senv.symbol_address">Senv.symbol_address</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.ge">ge</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#id">id</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span>)).<br/>
&nbsp;&nbsp;{ <span class="tactic">assert</span> (<span class="id">G</span>: <span class="id"><a href="compcert.common.Events.html#meminj_preserves_globals">meminj_preserves_globals</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.ge">ge</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.BUILTIN_ARGUMENTS.j">j</a></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Separation.html#globalenv_inject_preserves_globals">globalenv_inject_preserves_globals</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj2">sep_proj2</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj2">sep_proj2</a></span>. <span class="id">eexact</span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.BUILTIN_ARGUMENTS.SEP">SEP</a></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">unfold</span> <span class="id"><a href="compcert.common.Globalenvs.html#Senv.symbol_address">Senv.symbol_address</a></span>; <span class="tactic">simpl</span>; <span class="tactic">unfold</span> <span class="id"><a href="compcert.common.Globalenvs.html#Genv.symbol_address">Genv.symbol_address</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_symbol">Genv.find_symbol</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.ge">ge</a></span> <span class="id">id</span>) <span class="id">eqn</span>:<span class="id">FS</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">G</span>. <span class="id">econstructor</span>. <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.add_zero">Ptrofs.add_zero</a></span>; <span class="tactic">auto</span>. }<br/>
<span class="kwd">Local</span> <span class="id">Opaque</span> <span class="id"><a href="compcert.backend.Stackingproof.html#fe">fe</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">simpl</span>; <span class="tactic">intros</span> <span class="id">VALID</span> <span class="id">BOUNDS</span>.<br/>
- <span class="tactic">assert</span> (<span class="id"><a href="compcert.backend.Lineartyping.html#loc_valid">loc_valid</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.BUILTIN_ARGUMENTS.f">f</a></span> <span class="id">x</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>) <span class="tactic">by</span> <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">x</span> <span class="kwd">as</span> [<span class="id">r</span> | [] <span class="id">ofs</span> <span class="id">ty</span>]; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;+ <span class="id">exists</span> (<span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.BUILTIN_ARGUMENTS.rs">rs</a></span> <span class="id">r</span>); <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">barg</span>.<br/>
&nbsp;&nbsp;+ <span class="id">exploit</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_get_local">frame_get_local</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">v</span> &amp; <span class="id">A</span> &amp; <span class="id">B</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v</span>; <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
- <span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">barg</span>.<br/>
- <span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">barg</span>.<br/>
- <span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">barg</span>.<br/>
- <span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">barg</span>.<br/>
- <span class="tactic">set</span> (<span class="id">ofs</span>' := <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.add">Ptrofs.add</a></span> <span class="id">ofs</span> (<span class="id"><a href="compcert.lib.Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#fe_stack_data">fe_stack_data</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.BUILTIN_ARGUMENTS.fe">fe</a></span>))).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj2">sep_proj2</a></span> <span class="kwd">in</span> <span class="id">SEP</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj1">sep_proj1</a></span> <span class="kwd">in</span> <span class="id">SEP</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.common.Separation.html#loadv_parallel_rule">loadv_parallel_rule</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">instantiate</span> (1 := <span class="id"><a href="compcert.common.Values.html#Val.offset_ptr">Val.offset_ptr</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">sp</span>' <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id">ofs</span>').<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">rewrite</span> ! <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.add_zero_l">Ptrofs.add_zero_l</a></span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">v</span>' &amp; <span class="id">A</span> &amp; <span class="id">B</span>). <span class="id">exists</span> <span class="id">v</span>'; <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
- <span class="id">econstructor</span>; <span class="tactic">split</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">barg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.common.Values.html#Val.offset_ptr">Val.offset_ptr</a></span>. <span class="tactic">rewrite</span> ! <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.add_zero_l">Ptrofs.add_zero_l</a></span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
- <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj2">sep_proj2</a></span> <span class="kwd">in</span> <span class="id">SEP</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj1">sep_proj1</a></span> <span class="kwd">in</span> <span class="id">SEP</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.common.Separation.html#loadv_parallel_rule">loadv_parallel_rule</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">v</span>' &amp; <span class="id">A</span> &amp; <span class="id">B</span>). <span class="id">exists</span> <span class="id">v</span>'; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">barg</span>.<br/>
- <span class="id">econstructor</span>; <span class="tactic">split</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">barg</span>.<br/>
- <span class="tactic">destruct</span> <span class="id">IHeval_builtin_arg1</span> <span class="kwd">as</span> (<span class="id">v1</span> &amp; <span class="id">A1</span> &amp; <span class="id">B1</span>); <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_or_app">in_or_app</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">IHeval_builtin_arg2</span> <span class="kwd">as</span> (<span class="id">v2</span> &amp; <span class="id">A2</span> &amp; <span class="id">B2</span>); <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_or_app">in_or_app</a></span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="compcert.common.Values.html#Val.longofwords">Val.longofwords</a></span> <span class="id">v1</span> <span class="id">v2</span>); <span class="tactic">split</span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">barg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Values.html#Val.longofwords_inject">Val.longofwords_inject</a></span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">destruct</span> <span class="id">IHeval_builtin_arg1</span> <span class="kwd">as</span> (<span class="id">v1</span>' &amp; <span class="id">A1</span> &amp; <span class="id">B1</span>); <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_or_app">in_or_app</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">IHeval_builtin_arg2</span> <span class="kwd">as</span> (<span class="id">v2</span>' &amp; <span class="id">A2</span> &amp; <span class="id">B2</span>); <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_or_app">in_or_app</a></span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>. <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">barg</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id"><a href="compcert.x86_64.Archi.html#ptr64">Archi.ptr64</a></span>; <span class="tactic">auto</span> <span class="kwd">using</span> <span class="id"><a href="compcert.common.Values.html#Val.add_inject">Val.add_inject</a></span>, <span class="id"><a href="compcert.common.Values.html#Val.addl_inject">Val.addl_inject</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="transl_builtin_args_correct">transl_builtin_args_correct</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">al</span> <span class="id">vl</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Events.html#eval_builtin_args">eval_builtin_args</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.ge">ge</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.BUILTIN_ARGUMENTS.ls">ls</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.BUILTIN_ARGUMENTS.sp">sp</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.BUILTIN_ARGUMENTS.m">m</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#al">al</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#vl">vl</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">l</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#l">l</a></span> (<span class="id"><a href="compcert.common.AST.html#params_of_builtin_args">params_of_builtin_args</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#al">al</a></span>) -&gt; <span class="id"><a href="compcert.backend.Lineartyping.html#loc_valid">loc_valid</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.BUILTIN_ARGUMENTS.f">f</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#l">l</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>) -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">sl</span> <span class="id">ofs</span> <span class="id">ty</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="compcert.backend.Locations.html#S">S</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sl">sl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span>) (<span class="id"><a href="compcert.common.AST.html#params_of_builtin_args">params_of_builtin_args</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#al">al</a></span>) -&gt; <span class="id"><a href="compcert.backend.Bounds.html#slot_within_bounds">slot_within_bounds</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.BUILTIN_ARGUMENTS.b">b</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sl">sl</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ty">ty</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">vl</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Events.html#eval_builtin_args">eval_builtin_args</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.ge">ge</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.BUILTIN_ARGUMENTS.rs">rs</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">sp</span>' <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id">m</span>' (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="id"><a href="compcert.backend.Stacking.html#transl_builtin_arg">transl_builtin_arg</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.BUILTIN_ARGUMENTS.fe">fe</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#al">al</a></span>) <span class="id">vl</span>'<br/>
&nbsp;&nbsp;/\ <span class="id"><a href="compcert.common.Values.html#Val.inject_list">Val.inject_list</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.BUILTIN_ARGUMENTS.j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#vl">vl</a></span> <span class="id">vl</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4085')">Proof.</div>
<div class="proofscript" id="proof4085">
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">simpl</span>; <span class="tactic">intros</span> <span class="id">VALID</span> <span class="id">BOUNDS</span>.<br/>
- <span class="id">exists</span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> <span class="id"><a href="compcert.common.Values.html#val">val</a></span>); <span class="tactic">split</span>; <span class="id">constructor</span>.<br/>
- <span class="id">exploit</span> <span class="id"><a href="compcert.backend.Stackingproof.html#transl_builtin_arg_correct">transl_builtin_arg_correct</a></span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_or_app">in_or_app</a></span>. <span class="tactic">intros</span> (<span class="id">v1</span>' &amp; <span class="id">A</span> &amp; <span class="id">B</span>).<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">IHlist_forall2</span>; <span class="tactic">eauto</span> <span class="kwd">using</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_or_app">in_or_app</a></span>. <span class="tactic">intros</span> (<span class="id">vl</span>' &amp; <span class="id">C</span> &amp; <span class="id">D</span>).<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id">v1</span>'::<span class="id">vl</span>'); <span class="tactic">split</span>; <span class="id">constructor</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.BUILTIN_ARGUMENTS">BUILTIN_ARGUMENTS</a></span>.<br/>
<br/>
<div class="doc">The proof of semantic preservation relies on simulation diagrams
  of the following form:
<pre>
           st1 --------------- st2
            |                   |
           t|                  +|t
            |                   |
            v                   v
           st1'--------------- st2'</pre>
  Matching between source and target states is defined by <span class="bracket"><span class="id">match_states</span></span>
  below.  It implies:
<ul>
<li>
 Satisfaction of the separation logic assertions that describe the contents
  of memory.  This is a separating conjunction of facts about:
<ul>
<li>
 the current stack frame
</li>
<li>
 the frames in the call stack
</li>
<li>
 the injection from the Linear memory state into the Mach memory state
</li>
<li>
 the preservation of the global environment.
</li>
</ul>
 Agreement between, on the Linear side, the location sets <span class="bracket"><span class="id">ls</span></span>
  and <span class="bracket"><span class="id">parent_locset</span> <span class="id">s</span></span> of the current function and its caller,
  and on the Mach side the register set <span class="bracket"><span class="id">rs</span></span>.
</li>
<li>
 The Linear code <span class="bracket"><span class="id">c</span></span> is a suffix of the code of the
  function <span class="bracket"><span class="id">f</span></span> being executed.
</li>
<li>
 Well-typedness of <span class="bracket"><span class="id">f</span></span>.
</li>
</ul>
</div>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="match_states">match_states</a></span>: <span class="id"><a href="compcert.backend.Linear.html#state">Linear.state</a></span> -&gt; <span class="id"><a href="compcert.backend.Mach.html#state">Mach.state</a></span> -&gt; <span class="id">SimMemInj.t</span>' -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="match_states_dummy">match_states_dummy</a></span>: <span class="kwd">forall</span> <span class="id">f</span> <span class="id">ls</span> <span class="id">m</span> <span class="id">fb</span> <span class="id">tsp</span> <span class="id">tc</span> <span class="id">rs</span> <span class="id">m</span>' <span class="id">j</span> <span class="id">sm0</span> (<span class="id">MCOMPAT</span>: <span class="id"><a href="compcert.common.SimMemInj.html#mcompat">SimMemInj.mcompat</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sm0">sm0</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span>) (<span class="id">MWF</span>: <span class="id">SimMemInj.wf</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#sm0">sm0</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#match_states">match_states</a></span> (<span class="id"><a href="compcert.backend.Linear.html#State">Linear.State</a></span> [] <span class="id"><a href="compcert.backend.Stackingproof.html#f">f</a></span> <span class="id"><a href="compcert.common.Values.html#Vundef">Vundef</a></span> [] <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span>) (<span class="id"><a href="compcert.backend.Mach.html#State">Mach.State</a></span> [] <span class="id"><a href="compcert.backend.Stackingproof.html#fb">fb</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#tsp">tsp</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#tc">tc</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs">rs</a></span> <span class="id">m</span>') <span class="id"><a href="compcert.backend.Stackingproof.html#sm0">sm0</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="match_states_intro">match_states_intro</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">cs</span> <span class="id">f</span> <span class="id">sp</span> <span class="id">c</span> <span class="id">ls</span> <span class="id">m</span> <span class="id">cs</span>' <span class="id">fb</span> <span class="id">sp</span>' <span class="id">rs</span> <span class="id">m</span>' <span class="id">j</span> <span class="id">tf</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sm0</span> (<span class="id">MCOMPAT</span>: <span class="id"><a href="compcert.common.SimMemInj.html#mcompat">SimMemInj.mcompat</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sm0">sm0</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SPVALID</span>: <span class="id"><a href="compcert.backend.Stackingproof.html#sm0">sm0</a></span>.(<span class="id"><a href="compcert.common.SimMemInj.html#tgt">SimMemInj.tgt</a></span>).(<span class="id"><a href="compcert.common.Memory.html#Mem.valid_block">Mem.valid_block</a></span>) <span class="id">sp</span>' /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sm0">sm0</a></span>.(<span class="id"><a href="compcert.common.SimMemInj.html#tgt_parent_nb">SimMemInj.tgt_parent_nb</a></span>) <span class="id">sp</span>' /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">i</span>, ~ <span class="id"><a href="compcert.backend.Stackingproof.html#sm0">sm0</a></span>.(<span class="id"><a href="compcert.common.SimMemInj.html#tgt_external">SimMemInj.tgt_external</a></span>) <span class="id">sp</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#i">i</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">MWF</span>: <span class="id">SimMemInj.wf</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#sm0">sm0</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">PRIV</span>: <span class="kwd">forall</span> <span class="id">i</span>, 0 &lt;= <span class="id"><a href="compcert.backend.Stackingproof.html#i">i</a></span> &lt; <span class="id"><a href="compcert.backend.Bounds.html#fe_stack_data">fe_stack_data</a></span> (<span class="id"><a href="compcert.x86.Stacklayout.html#make_env">make_env</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#function_bounds">function_bounds</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f">f</a></span>)) \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Bounds.html#fe_stack_data">fe_stack_data</a></span> (<span class="id"><a href="compcert.x86.Stacklayout.html#make_env">make_env</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#function_bounds">function_bounds</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f">f</a></span>)) + <span class="id"><a href="compcert.backend.Linear.html#fn_stacksize">Linear.fn_stacksize</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f">f</a></span> &lt;= <span class="id"><a href="compcert.backend.Stackingproof.html#i">i</a></span> &lt; <span class="id"><a href="compcert.backend.Bounds.html#fe_size">fe_size</a></span> (<span class="id"><a href="compcert.x86.Stacklayout.html#make_env">make_env</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#function_bounds">function_bounds</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f">f</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt; <span class="id"><a href="compcert.backend.Stackingproof.html#sm0">sm0</a></span>.(<span class="id"><a href="compcert.common.SimMemInj.html#tgt_private">SimMemInj.tgt_private</a></span>) <span class="id">sp</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#i">i</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">STACKS</span>: <span class="id"><a href="compcert.backend.Stackingproof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs">cs</a></span> <span class="id">cs</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#f">f</a></span>.(<span class="id"><a href="compcert.backend.Linear.html#fn_sig">Linear.fn_sig</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#sm0">sm0</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">TRANSL</span>: <span class="id"><a href="compcert.backend.Stacking.html#transf_function">transf_function</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f">f</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#tf">tf</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FIND</span>: <span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_funct_ptr">Genv.find_funct_ptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.tge">tge</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#fb">fb</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="compcert.common.AST.html#Internal">Internal</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#tf">tf</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">AGREGS</span>: <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs">rs</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">AGLOCS</span>: <span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs">agree_locs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f">f</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> (<span class="id"><a href="compcert.backend.Linear.html#parent_locset">parent_locset</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs">cs</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">INJSP</span>: <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id">sp</span>', <span class="id"><a href="compcert.backend.Bounds.html#fe_stack_data">fe_stack_data</a></span> (<span class="id"><a href="compcert.x86.Stacklayout.html#make_env">make_env</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#function_bounds">function_bounds</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f">f</a></span>))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">TAIL</span>: <span class="id"><a href="compcert.lib.Coqlib.html#is_tail">is_tail</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#c">c</a></span> (<span class="id"><a href="compcert.backend.Linear.html#fn_code">Linear.fn_code</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f">f</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SEP</span>: <span class="id">m</span>' |= <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f">f</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id">sp</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> (<span class="id"><a href="compcert.backend.Linear.html#parent_locset">parent_locset</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs">cs</a></span>) (<span class="id"><a href="compcert.backend.Mach.html#parent_sp">parent_sp</a></span> <span class="id">cs</span>') (<span class="id"><a href="compcert.backend.Mach.html#parent_ra">parent_ra</a></span> <span class="id">cs</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id">stack_contents</span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs">cs</a></span> <span class="id">cs</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id"><a href="compcert.common.Separation.html#minjection">minjection</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id"><a href="compcert.common.Separation.html#globalenv_inject">globalenv_inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.ge">ge</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#match_states">match_states</a></span> (<span class="id"><a href="compcert.backend.Linear.html#State">Linear.State</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs">cs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f">f</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sp">sp</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#c">c</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.Mach.html#State">Mach.State</a></span> <span class="id">cs</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#fb">fb</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">sp</span>' <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) (<span class="id"><a href="compcert.backend.Stacking.html#transl_code">transl_code</a></span> (<span class="id"><a href="compcert.x86.Stacklayout.html#make_env">make_env</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#function_bounds">function_bounds</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f">f</a></span>)) <span class="id"><a href="compcert.backend.Stackingproof.html#c">c</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#rs">rs</a></span> <span class="id">m</span>') <span class="id"><a href="compcert.backend.Stackingproof.html#sm0">sm0</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="match_states_call">match_states_call</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">cs</span> <span class="id">fptr</span> <span class="id">sg</span> <span class="id">ls</span> <span class="id">m</span> <span class="id">cs</span>' <span class="id">tfptr</span> <span class="id">rs</span> <span class="id">m</span>' <span class="id">j</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sm0</span> (<span class="id">MCOMPAT</span>: <span class="id"><a href="compcert.common.SimMemInj.html#mcompat">SimMemInj.mcompat</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sm0">sm0</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">MWF</span>: <span class="id">SimMemInj.wf</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#sm0">sm0</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">STACKS</span>: <span class="id"><a href="compcert.backend.Stackingproof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs">cs</a></span> <span class="id">cs</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#sg">sg</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sm0">sm0</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">AGREGS</span>: <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs">rs</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">AGCSREGS</span>: <span class="id"><a href="compcert.backend.Conventions.html#agree_callee_save_regs">agree_callee_save_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> (<span class="id"><a href="compcert.backend.Linear.html#parent_locset">parent_locset</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs">cs</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">FPTR</span>: <span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#fptr">fptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#tfptr">tfptr</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SEP</span>: <span class="id">m</span>' |= <span class="id">stack_contents</span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs">cs</a></span> <span class="id">cs</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id"><a href="compcert.common.Separation.html#minjection">minjection</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id"><a href="compcert.common.Separation.html#globalenv_inject">globalenv_inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.ge">ge</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#match_states">match_states</a></span> (<span class="id"><a href="compcert.backend.Linear.html#Callstate">Linear.Callstate</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs">cs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#fptr">fptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sg">sg</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.Mach.html#Callstate">Mach.Callstate</a></span> <span class="id">cs</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#tfptr">tfptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs">rs</a></span> <span class="id">m</span>') <span class="id"><a href="compcert.backend.Stackingproof.html#sm0">sm0</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="match_states_return">match_states_return</a></span>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">cs</span> <span class="id">ls</span> <span class="id">m</span> <span class="id">cs</span>' <span class="id">rs</span> <span class="id">m</span>' <span class="id">j</span> <span class="id">sg</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sm0</span> (<span class="id">MCOMPAT</span>: <span class="id"><a href="compcert.common.SimMemInj.html#mcompat">SimMemInj.mcompat</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sm0">sm0</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span> <span class="id">m</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">MWF</span>: <span class="id">SimMemInj.wf</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#sm0">sm0</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">STACKS</span>: <span class="id"><a href="compcert.backend.Stackingproof.html#match_stacks">match_stacks</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs">cs</a></span> <span class="id">cs</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#sg">sg</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sm0">sm0</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">AGREGS</span>: <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs">agree_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#rs">rs</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">AGCSREGS</span>: <span class="id"><a href="compcert.backend.Conventions.html#agree_callee_save_regs">agree_callee_save_regs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> (<span class="id"><a href="compcert.backend.Linear.html#parent_locset">parent_locset</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs">cs</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">SEP</span>: <span class="id">m</span>' |= <span class="id">stack_contents</span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs">cs</a></span> <span class="id">cs</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id"><a href="compcert.common.Separation.html#minjection">minjection</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id"><a href="compcert.common.Separation.html#globalenv_inject">globalenv_inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.ge">ge</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#j">j</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Stackingproof.html#match_states">match_states</a></span> (<span class="id"><a href="compcert.backend.Linear.html#Returnstate">Linear.Returnstate</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#cs">cs</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ls">ls</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#m">m</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.Mach.html#Returnstate">Mach.Returnstate</a></span> <span class="id">cs</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#rs">rs</a></span> <span class="id">m</span>') <span class="id"><a href="compcert.backend.Stackingproof.html#sm0">sm0</a></span>.<br/>
<br/>
<span class="kwd">Local</span> <span class="id">Opaque</span> <span class="id"><a href="compcert.backend.Bounds.html#fe_stack_data">fe_stack_data</a></span> <span class="id"><a href="compcert.backend.Bounds.html#fe_size">fe_size</a></span>.<br/>
<br/>
<span class="kwd">Let</span> <span class="id"><a name="PRESERVATION.CORELEMMA.step">step</a></span> := <span class="id"><a href="compcert.backend.Mach.html#step">Mach.step</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.return_address_offset">return_address_offset</a></span>.<br/>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="transf_step_correct">transf_step_correct</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">s1</span> <span class="id">t</span> <span class="id">s2</span>, <span class="id"><a href="compcert.backend.Linear.html#step">Linear.step</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.se">se</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.ge">ge</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#s1">s1</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#t">t</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#s2">s2</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">WTS</span>: <span class="id"><a href="compcert.backend.Lineartyping.html#wt_state">wt_state</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#s1">s1</a></span>) <span class="id">s1</span>' <span class="id">sm0</span> (<span class="id">MS</span>: <span class="id"><a href="compcert.backend.Stackingproof.html#match_states">match_states</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#s1">s1</a></span> <span class="id">s1</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#sm0">sm0</a></span>),<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">s2</span>', <span class="id"><a href="compcert.common.Smallstep.html#plus">plus</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.step">step</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.tse">tse</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.tge">tge</a></span> <span class="id">s1</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#t">t</a></span> <span class="id">s2</span>' /\ (<span class="id">exists</span> <span class="id">sm1</span>, <span class="id"><a href="compcert.backend.Stackingproof.html#match_states">match_states</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#s2">s2</a></span> <span class="id">s2</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#sm1">sm1</a></span> /\ &lt;&lt;<span class="id">MLE</span>: <span class="id">SimMemInj.le</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#sm0">sm0</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sm1">sm1</a></span>&gt;&gt;).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4086')">Proof.</div>
<div class="proofscript" id="proof4086">
&nbsp;&nbsp;<span class="tactic">induction</span> 1; <span class="tactic">intros</span>;<br/>
&nbsp;&nbsp;<span class="tactic">try</span> <span class="id">inv</span> <span class="id">MS</span>;<br/>
&nbsp;&nbsp;<span class="tactic">try</span> <span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Stackingproof.html#transl_code_eq">transl_code_eq</a></span>;<br/>
&nbsp;&nbsp;<span class="tactic">try</span> (<span class="tactic">generalize</span> (<span class="id"><a href="compcert.backend.Bounds.html#function_is_within_bounds">function_is_within_bounds</a></span> <span class="id">f</span> <span class="id">_</span> (<span class="id"><a href="compcert.lib.Coqlib.html#is_tail_in">is_tail_in</a></span> <span class="id">TAIL</span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">BOUND</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">BOUND</span>);<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Stacking.html#transl_instr">transl_instr</a></span>.<br/>
<br/>
- <span class="comment">(*&nbsp;Lgetstack&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">BOUND</span> <span class="kwd">as</span> [<span class="id">BOUND1</span> <span class="id">BOUND2</span>].<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Lineartyping.html#wt_state_getstack">wt_state_getstack</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> <span class="id">SV</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.LTL.html#destroyed_by_getstack">destroyed_by_getstack</a></span>; <span class="tactic">destruct</span> <span class="id">sl</span>.<br/>
+ <span class="comment">(*&nbsp;Lgetstack,&nbsp;local&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_get_local">frame_get_local</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">v</span> &amp; <span class="id">A</span> &amp; <span class="id">B</span>).<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Mach.html#exec_Mgetstack">exec_Mgetstack</a></span>. <span class="tactic">exact</span> <span class="id">A</span>.<br/>
&nbsp;&nbsp;<span class="id">SimMemInj.spl</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">coqlib</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs_set_reg">agree_regs_set_reg</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs_set_reg">agree_locs_set_reg</a></span>; <span class="tactic">auto</span>.<br/>
+ <span class="comment">(*&nbsp;Lgetstack,&nbsp;incoming&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Lineartyping.html#slot_valid">slot_valid</a></span> <span class="kwd">in</span> <span class="id">SV</span>. <span class="id">InvBooleans</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Conventions.html#incoming_slot_in_parameters">incoming_slot_in_parameters</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> <span class="id">IN_ARGS</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">STACKS</span>; <span class="tactic">clear</span> <span class="id">STACKS</span>.<br/>
&nbsp;&nbsp;<span class="tactic">elim</span> (<span class="id">H1</span> <span class="id">_</span> <span class="id">IN_ARGS</span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">rewrite</span> <span class="id">MAINARGS</span> <span class="kwd">in</span> *. <span class="tactic">subst</span> <span class="id">s</span> <span class="id">cs</span>'. <span class="id">exploit</span> (<span class="id"><a href="compcert.backend.Stackingproof.html#slot_outgoing_argument_valid">slot_outgoing_argument_valid</a></span> <span class="id">f</span>); <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">VALID</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">Local</span> <span class="id">Opaque</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.mul">Z.mul</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.add">Z.add</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.div">Z.div</a></span> <span class="id"><a href="compcert.x86.Stacklayout.html#make_env">make_env</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Lineartyping.html#slot_valid">slot_valid</a></span> <span class="kwd">in</span> *. <span class="id">simpl_bool</span>. <span class="id">des</span>; <span class="id">cycle</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">hnf</span> <span class="kwd">in</span> <span class="id">LE</span>. <span class="id">exploit</span> <span class="id">LE</span>; <span class="tactic">eauto</span>. <span class="id">ss</span>. } <span class="id">clarify</span>. <span class="id">des_sumbool</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">des_ifs</span>; <span class="id">cycle</span> 1.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exploit</span> <span class="id"><a href="compcert.backend.Stackingproof.html#get_location">get_location</a></span>; <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Separation.html#sep_pick2">sep_pick2</a></span> <span class="kwd">in</span> <span class="id">SEP</span>. <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id">ARGS</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">v</span> &amp; <span class="id">A</span> &amp; <span class="id">B</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.Ptrofs_add_repr">Ptrofs.Ptrofs_add_repr</a></span>, <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.repr_unsigned">Ptrofs.repr_unsigned</a></span>, &lt;- <span class="id"><a href="compcert.backend.Stackingproof.html#load_stack_transf_ofs">load_stack_transf_ofs</a></span> <span class="kwd">in</span> *. <span class="id">esplits</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Mach.html#exec_Mgetparam">exec_Mgetparam</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">rewrite</span> (<span class="id"><a href="compcert.backend.Stackingproof.html#unfold_transf_function">unfold_transf_function</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">TRANSL</span>). <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Mach.html#fn_link_ofs">fn_link_ofs</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_get_parent">frame_get_parent</a></span>. <span class="id">eexact</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">coqlib</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs_set_reg">agree_regs_set_reg</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs_set_reg">agree_regs_set_reg</a></span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="id">erewrite</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_incoming">agree_incoming</a></span> <span class="tactic">by</span> <span class="tactic">eauto</span>. <span class="tactic">exact</span> <span class="id">B</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs_set_reg">agree_locs_set_reg</a></span>; <span class="tactic">auto</span>. <span class="id">ss</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs_set_reg">agree_locs_set_reg</a></span>; <span class="tactic">eauto</span>. <span class="id">ss</span>. <span class="tactic">rewrite</span> <span class="id">MAINARGS</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">s</span> <span class="id">cs</span>'.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">exists</span> <span class="id">P</span>, <span class="id">m</span>' |= <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span> <span class="id">f0</span> <span class="id">j</span> <span class="id">sp</span>'0 <span class="id">ls</span> (<span class="id"><a href="compcert.backend.Linear.html#parent_locset">parent_locset</a></span> <span class="id">cs</span>) (<span class="id"><a href="compcert.backend.Mach.html#parent_sp">parent_sp</a></span> <span class="id">cs</span>'0) (<span class="id"><a href="compcert.backend.Mach.html#parent_ra">parent_ra</a></span> <span class="id">cs</span>'0) ** <span class="id"><a href="compcert.backend.Stackingproof.html#P">P</a></span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">destruct</span> <span class="id"><a href="compcert.backend.Conventions.html#main_args">main_args</a></span> <span class="id">eqn</span>:<span class="id">MAINARGS</span>; <span class="id">eexists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj2">sep_proj2</a></span> <span class="kwd">in</span> <span class="id">SEP</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">SEP</span>. <span class="id">des_ifs</span>; <span class="tactic">try</span> (<span class="tactic">by</span> (<span class="id">inv</span> <span class="id">STK</span>; <span class="id">clarify</span>; <span class="id">inv</span> <span class="id">MAINARGS0</span>)). <span class="tactic">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_assoc">sep_assoc</a></span> <span class="kwd">in</span> <span class="id">SEP</span>. <span class="id">eexact</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj2">sep_proj2</a></span> <span class="kwd">in</span> <span class="id">SEP</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">SEP</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_assoc">sep_assoc</a></span> <span class="kwd">in</span> <span class="id">SEP</span>. <span class="id">eexact</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;} <span class="id">des</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_get_outgoing">frame_get_outgoing</a></span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">ARGS</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#slot_outgoing_argument_valid">slot_outgoing_argument_valid</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">v</span> &amp; <span class="id">A</span> &amp; <span class="id">B</span>).<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Mach.html#exec_Mgetparam">exec_Mgetparam</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="compcert.backend.Stackingproof.html#unfold_transf_function">unfold_transf_function</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">TRANSL</span>). <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Mach.html#fn_link_ofs">fn_link_ofs</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_get_parent">frame_get_parent</a></span>. <span class="id">eexact</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="id">SimMemInj.spl</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">coqlib</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs_set_reg">agree_regs_set_reg</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs_set_reg">agree_regs_set_reg</a></span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_incoming">agree_incoming</a></span> <span class="tactic">by</span> <span class="tactic">eauto</span>. <span class="tactic">exact</span> <span class="id">B</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs_set_reg">agree_locs_set_reg</a></span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs_undef_locs">agree_locs_undef_locs</a></span>; <span class="tactic">auto</span>.<br/>
+ <span class="comment">(*&nbsp;Lgetstack,&nbsp;outgoing&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_get_outgoing">frame_get_outgoing</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">v</span> &amp; <span class="id">A</span> &amp; <span class="id">B</span>).<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Mach.html#exec_Mgetstack">exec_Mgetstack</a></span>. <span class="tactic">exact</span> <span class="id">A</span>.<br/>
&nbsp;&nbsp;<span class="id">SimMemInj.spl</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">coqlib</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs_set_reg">agree_regs_set_reg</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs_set_reg">agree_locs_set_reg</a></span>; <span class="tactic">auto</span>.<br/>
<br/>
- <span class="comment">(*&nbsp;Lsetstack&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Lineartyping.html#wt_state_setstack">wt_state_setstack</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">SV</span> &amp; <span class="id">SW</span>).<br/>
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">ofs</span>' := <span class="kwd">match</span> <span class="id">sl</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="kwd">Local</span> =&gt; <span class="id"><a href="compcert.backend.Stacking.html#offset_local">offset_local</a></span> (<span class="id"><a href="compcert.x86.Stacklayout.html#make_env">make_env</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#function_bounds">function_bounds</a></span> <span class="id">f</span>)) <span class="id">ofs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.Locations.html#Incoming">Incoming</a></span> =&gt; 0 <span class="comment">(*&nbsp;dummy&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id"><a href="compcert.backend.Locations.html#Outgoing">Outgoing</a></span> =&gt; <span class="id"><a href="compcert.backend.Stacking.html#offset_arg">offset_arg</a></span> <span class="id">ofs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">end</span>).<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_undef_regs">frame_undef_regs</a></span> <span class="kwd">with</span> (<span class="id">rl</span> := <span class="id"><a href="compcert.x86.Machregs.html#destroyed_by_setstack">destroyed_by_setstack</a></span> <span class="id">ty</span>) <span class="kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">A</span>: <span class="id">exists</span> <span class="id">m</span>'',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Mach.html#store_stack">store_stack</a></span> <span class="id">m</span>' (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">sp</span>' <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) <span class="id">ty</span> (<span class="id"><a href="compcert.lib.Integers.html#Ptrofs.repr">Ptrofs.repr</a></span> <span class="id">ofs</span>') (<span class="id">rs0</span> <span class="id">src</span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">m</span>''<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id">m</span>'' |= <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span> <span class="id">f</span> <span class="id">j</span> <span class="id">sp</span>' (<span class="id"><a href="compcert.backend.Locations.html#Locmap.set">Locmap.set</a></span> (<span class="id"><a href="compcert.backend.Locations.html#S">S</a></span> <span class="id">sl</span> <span class="id">ofs</span> <span class="id">ty</span>) (<span class="id">rs</span> (<span class="id"><a href="compcert.backend.Locations.html#R">R</a></span> <span class="id">src</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.LTL.html#undef_regs">LTL.undef_regs</a></span> (<span class="id"><a href="compcert.x86.Machregs.html#destroyed_by_setstack">destroyed_by_setstack</a></span> <span class="id">ty</span>) <span class="id">rs</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.Linear.html#parent_locset">parent_locset</a></span> <span class="id">s</span>) (<span class="id"><a href="compcert.backend.Mach.html#parent_sp">parent_sp</a></span> <span class="id">cs</span>') (<span class="id"><a href="compcert.backend.Mach.html#parent_ra">parent_ra</a></span> <span class="id">cs</span>')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;** <span class="id">stack_contents</span> <span class="id">j</span> <span class="id">s</span> <span class="id">cs</span>' ** <span class="id"><a href="compcert.common.Separation.html#minjection">minjection</a></span> <span class="id">j</span> <span class="id">m</span> ** <span class="id"><a href="compcert.common.Separation.html#globalenv_inject">globalenv_inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.ge">ge</a></span> <span class="id">j</span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">unfold</span> <span class="id">ofs</span>'; <span class="tactic">destruct</span> <span class="id">sl</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_set_local">frame_set_local</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_set_outgoing">frame_set_outgoing</a></span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">SEP</span>; <span class="tactic">destruct</span> <span class="id">A</span> <span class="kwd">as</span> (<span class="id">m</span>'' &amp; <span class="id">STORE</span> &amp; <span class="id">SEP</span>).<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one</a></span>. <span class="tactic">destruct</span> <span class="id">sl</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="id">eexact</span> <span class="id">STORE</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="id">eexact</span> <span class="id">STORE</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">LE</span>: <span class="id">SimMemInj.le</span>' <span class="id">sm0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.common.SimMemInj.html#mk">SimMemInj.mk</a></span> <span class="id">m</span> <span class="id">m</span>'' <span class="id">j</span> <span class="id">sm0</span>.(<span class="id"><a href="compcert.common.SimMemInj.html#src_external">SimMemInj.src_external</a></span>) <span class="id">sm0</span>.(<span class="id"><a href="compcert.common.SimMemInj.html#tgt_external">SimMemInj.tgt_external</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sm0</span>.(<span class="id"><a href="compcert.common.SimMemInj.html#src_parent_nb">SimMemInj.src_parent_nb</a></span>) <span class="id">sm0</span>.(<span class="id"><a href="compcert.common.SimMemInj.html#tgt_parent_nb">SimMemInj.tgt_parent_nb</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sm0</span>.(<span class="id"><a href="compcert.common.SimMemInj.html#src_ge_nb">SimMemInj.src_ge_nb</a></span>) <span class="id">sm0</span>.(<span class="id"><a href="compcert.common.SimMemInj.html#tgt_ge_nb">SimMemInj.tgt_ge_nb</a></span>))).<br/>
&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">MCOMPAT</span>. <span class="id">inv</span> <span class="id">MWF</span>. <span class="id">econs</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.unchanged_on_refl">Mem.unchanged_on_refl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Mach.html#store_stack">store_stack</a></span>, <span class="id"><a href="compcert.common.Memory.html#Mem.storev">Mem.storev</a></span> <span class="kwd">in</span> *. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">STORE</span>. <span class="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.store_unchanged_on">Mem.store_unchanged_on</a></span>; <span class="tactic">eauto</span>. <span class="id">des</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.SimMemInj.html#frozen_refl">SimMemInj.frozen_refl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.SimMemInj.html#frozen_refl">SimMemInj.frozen_refl</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">ii</span>. <span class="id">ss</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Mach.html#store_stack">store_stack</a></span>, <span class="id"><a href="compcert.common.Memory.html#Mem.storev">Mem.storev</a></span> <span class="kwd">in</span> *. <span class="id">ss</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_store_2">Mem.perm_store_2</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id">SimMemInj.spl_approx</span> <span class="id">sm0</span>. <span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;{ <span class="id">SimMemInj.compat_tac</span>. }<br/>
&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#spvalid_le">spvalid_le</a></span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">MCOMPAT</span>. <span class="id">inv</span> <span class="id">MWF</span>. <span class="id">econs</span>; <span class="id">ss</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">etransitivity</span>; <span class="tactic">eauto</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.common.SimMemInj.html#tgt_private">SimMemInj.tgt_private</a></span>. <span class="id">ii</span>. <span class="id">ss</span>. <span class="id">des</span>. <span class="tactic">split</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.common.SimMemInj.html#valid_blocks">SimMemInj.valid_blocks</a></span>, <span class="id"><a href="compcert.common.Memory.html#Mem.valid_block">Mem.valid_block</a></span>, <span class="id"><a href="compcert.backend.Mach.html#store_stack">store_stack</a></span>, <span class="id"><a href="compcert.common.Memory.html#Mem.storev">Mem.storev</a></span> <span class="kwd">in</span> *. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="compcert.common.Memory.html#Mem.nextblock_store">Mem.nextblock_store</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Mach.html#store_stack">store_stack</a></span>, <span class="id"><a href="compcert.common.Memory.html#Mem.storev">Mem.storev</a></span> <span class="kwd">in</span> *. <span class="id">ss</span>. <span class="id">erewrite</span> <span class="id"><a href="compcert.common.Memory.html#Mem.nextblock_store">Mem.nextblock_store</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">MCOMPAT</span>. <span class="id">ii</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.common.SimMemInj.html#tgt_private">SimMemInj.tgt_private</a></span>, <span class="id"><a href="compcert.common.Events.html#loc_out_of_reach">loc_out_of_reach</a></span> <span class="kwd">in</span> *. <span class="id">ss</span>. <span class="id">exploit</span> <span class="id">PRIV</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">X</span> <span class="id">Y</span>]. <span class="tactic">split</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Mach.html#store_stack">store_stack</a></span>, <span class="id"><a href="compcert.common.Memory.html#Mem.storev">Mem.storev</a></span> <span class="kwd">in</span> *. <span class="id">inv</span> <span class="id">STORE</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.store_valid_block_1">Mem.store_valid_block_1</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">MCOMPAT</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#match_stacks_le">match_stacks_le</a></span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">eauto</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs_set_slot">agree_regs_set_slot</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs_undef_regs">agree_regs_undef_regs</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs_set_slot">agree_locs_set_slot</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs_undef_locs">agree_locs_undef_locs</a></span>. <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#destroyed_by_setstack_caller_save">destroyed_by_setstack_caller_save</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eauto</span>. <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">coqlib</span>. <span class="tactic">eauto</span>.<br/>
<br/>
- <span class="comment">(*&nbsp;Lop&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">exists</span> <span class="id">v</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.x86.Op.html#eval_operation">eval_operation</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.ge">ge</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">sp</span>' <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) (<span class="id"><a href="compcert.backend.Stacking.html#transl_op">transl_op</a></span> (<span class="id"><a href="compcert.x86.Stacklayout.html#make_env">make_env</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#function_bounds">function_bounds</a></span> <span class="id">f</span>)) <span class="id">op</span>) <span class="id">rs0</span>##<span class="id">args</span> <span class="id">m</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">v</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id">j</span> <span class="id">v</span> <span class="id">v</span>').<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.x86.Op.html#eval_operation_inject">eval_operation_inject</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Separation.html#globalenv_inject_preserves_globals">globalenv_inject_preserves_globals</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj2">sep_proj2</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj2">sep_proj2</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj2">sep_proj2</a></span>. <span class="id">eexact</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_reglist">agree_reglist</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj2">sep_proj2</a></span> <span class="kwd">in</span> <span class="id">SEP</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj2">sep_proj2</a></span> <span class="kwd">in</span> <span class="id">SEP</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj1">sep_proj1</a></span> <span class="kwd">in</span> <span class="id">SEP</span>. <span class="tactic">exact</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H0</span> <span class="kwd">as</span> [<span class="id">v</span>' [<span class="id">A</span> <span class="id">B</span>]].<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one</a></span>. <span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;<span class="id">instantiate</span> (1 := <span class="id">v</span>'). <span class="tactic">rewrite</span> &lt;- <span class="id">A</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.x86.Op.html#eval_operation_preserved">eval_operation_preserved</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">exact</span> <span class="id"><a href="compcert.backend.Stackingproof.html#symbols_preserved">symbols_preserved</a></span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">SimMemInj.spl</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">coqlib</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs_set_reg">agree_regs_set_reg</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Stackingproof.html#transl_destroyed_by_op">transl_destroyed_by_op</a></span>.  <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs_undef_regs">agree_regs_undef_regs</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs_set_reg">agree_locs_set_reg</a></span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs_undef_locs">agree_locs_undef_locs</a></span>. <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#destroyed_by_op_caller_save">destroyed_by_op_caller_save</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_set_reg">frame_set_reg</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_undef_regs">frame_undef_regs</a></span>. <span class="tactic">exact</span> <span class="id">SEP</span>.<br/>
<br/>
- <span class="comment">(*&nbsp;Lload&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">exists</span> <span class="id">a</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.x86.Op.html#eval_addressing">eval_addressing</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.ge">ge</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">sp</span>' <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) (<span class="id"><a href="compcert.backend.Stacking.html#transl_addr">transl_addr</a></span> (<span class="id"><a href="compcert.x86.Stacklayout.html#make_env">make_env</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#function_bounds">function_bounds</a></span> <span class="id">f</span>)) <span class="id">addr</span>) <span class="id">rs0</span>##<span class="id">args</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">a</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id">j</span> <span class="id">a</span> <span class="id">a</span>').<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.x86.Op.html#eval_addressing_inject">eval_addressing_inject</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Separation.html#globalenv_inject_preserves_globals">globalenv_inject_preserves_globals</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj2">sep_proj2</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj2">sep_proj2</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj2">sep_proj2</a></span>. <span class="id">eexact</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_reglist">agree_reglist</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H1</span> <span class="kwd">as</span> [<span class="id">a</span>' [<span class="id">A</span> <span class="id">B</span>]].<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Separation.html#loadv_parallel_rule">loadv_parallel_rule</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj2">sep_proj2</a></span> <span class="kwd">in</span> <span class="id">SEP</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj2">sep_proj2</a></span> <span class="kwd">in</span> <span class="id">SEP</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj1">sep_proj1</a></span> <span class="kwd">in</span> <span class="id">SEP</span>. <span class="id">eexact</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eauto</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">v</span>' [<span class="id">C</span> <span class="id">D</span>]].<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one</a></span>. <span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;<span class="id">instantiate</span> (1 := <span class="id">a</span>'). <span class="tactic">rewrite</span> &lt;- <span class="id">A</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.x86.Op.html#eval_addressing_preserved">eval_addressing_preserved</a></span>. <span class="tactic">exact</span> <span class="id"><a href="compcert.backend.Stackingproof.html#symbols_preserved">symbols_preserved</a></span>.<br/>
&nbsp;&nbsp;<span class="id">eexact</span> <span class="id">C</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">SimMemInj.spl</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">coqlib</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs_set_reg">agree_regs_set_reg</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Stackingproof.html#transl_destroyed_by_load">transl_destroyed_by_load</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs_undef_regs">agree_regs_undef_regs</a></span>; <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs_set_reg">agree_locs_set_reg</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs_undef_locs">agree_locs_undef_locs</a></span>. <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#destroyed_by_load_caller_save">destroyed_by_load_caller_save</a></span>. <span class="tactic">auto</span>.<br/>
<br/>
- <span class="comment">(*&nbsp;Lstore&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">exists</span> <span class="id">a</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.x86.Op.html#eval_addressing">eval_addressing</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.ge">ge</a></span> (<span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id">sp</span>' <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>) (<span class="id"><a href="compcert.backend.Stacking.html#transl_addr">transl_addr</a></span> (<span class="id"><a href="compcert.x86.Stacklayout.html#make_env">make_env</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#function_bounds">function_bounds</a></span> <span class="id">f</span>)) <span class="id">addr</span>) <span class="id">rs0</span>##<span class="id">args</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id">a</span>'<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id"><a href="compcert.common.Values.html#Val.inject">Val.inject</a></span> <span class="id">j</span> <span class="id">a</span> <span class="id">a</span>').<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.x86.Op.html#eval_addressing_inject">eval_addressing_inject</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Separation.html#globalenv_inject_preserves_globals">globalenv_inject_preserves_globals</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj2">sep_proj2</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj2">sep_proj2</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj2">sep_proj2</a></span>. <span class="id">eexact</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_reglist">agree_reglist</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H1</span> <span class="kwd">as</span> [<span class="id">a</span>' [<span class="id">A</span> <span class="id">B</span>]].<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_swap3">sep_swap3</a></span> <span class="kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Separation.html#storev_parallel_rule">storev_parallel_rule</a></span>. <span class="id">eexact</span> <span class="id">SEP</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id">AGREGS</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">INJ</span>: <span class="id">m</span>'0 |= <span class="id"><a href="compcert.common.Separation.html#minjection">minjection</a></span> <span class="id">j</span> <span class="id">m</span>). <span class="tactic">eapply</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">SEP</span>; <span class="tactic">intros</span> (<span class="id">m1</span>' &amp; <span class="id">C</span> &amp; <span class="id">SEP</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_swap3">sep_swap3</a></span> <span class="kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one</a></span>. <span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;<span class="id">instantiate</span> (1 := <span class="id">a</span>'). <span class="tactic">rewrite</span> &lt;- <span class="id">A</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.x86.Op.html#eval_addressing_preserved">eval_addressing_preserved</a></span>. <span class="tactic">exact</span> <span class="id"><a href="compcert.backend.Stackingproof.html#symbols_preserved">symbols_preserved</a></span>.<br/>
&nbsp;&nbsp;<span class="id">eexact</span> <span class="id">C</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">MCOMPAT</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.common.SimMemInj.html#storev_mapped">SimMemInj.storev_mapped</a></span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">des</span>. <span class="id">SimMemInj.spl_exact</span> <span class="id">sm1</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="id">SimMemInj.compat_tac</span>.<br/>
&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#spvalid_le">spvalid_le</a></span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;{ <span class="id">ii</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.common.SimMemInj.html#tgt_private">SimMemInj.tgt_private</a></span>, <span class="id"><a href="compcert.common.Events.html#loc_out_of_reach">loc_out_of_reach</a></span>, <span class="id"><a href="compcert.common.Memory.html#Mem.storev">Mem.storev</a></span> <span class="kwd">in</span> *. <span class="id">des_ifs_safe</span>. <span class="id">exploit</span> <span class="id">PRIV</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">X</span> <span class="id">Y</span>]. <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">ii</span>. <span class="tactic">eapply</span> <span class="id">X</span>. <span class="tactic">rewrite</span> &lt;- <span class="id">MINJ</span>. <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_store_2">Mem.perm_store_2</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.store_valid_block_1">Mem.store_valid_block_1</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#match_stacks_le">match_stacks_le</a></span>; <span class="tactic">eauto</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ii</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.common.Memory.html#Mem.storev">Mem.storev</a></span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="id">des_ifs_safe</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_store_2">Mem.perm_store_2</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">eauto</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Stackingproof.html#transl_destroyed_by_store">transl_destroyed_by_store</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs_undef_regs">agree_regs_undef_regs</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs_undef_locs">agree_locs_undef_locs</a></span>. <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#destroyed_by_store_caller_save">destroyed_by_store_caller_save</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">coqlib</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_undef_regs">frame_undef_regs</a></span>; <span class="tactic">eauto</span>.<br/>
<br/>
- <span class="comment">(*&nbsp;Lcall&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Stackingproof.html#find_function_ptr_translated">find_function_ptr_translated</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj2">sep_proj2</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj2">sep_proj2</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj2">sep_proj2</a></span>. <span class="id">eexact</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="id">i</span>; <span class="id">des</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Stackingproof.html#is_tail_transf_function">is_tail_transf_function</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> <span class="id">IST</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Stackingproof.html#transl_code_eq">transl_code_eq</a></span> <span class="kwd">in</span> <span class="id">IST</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">IST</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.return_address_offset_exists">return_address_offset_exists</a></span>. { <span class="tactic">rewrite</span> <span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_funct_find_funct_ptr">Genv.find_funct_find_funct_ptr</a></span>. <span class="tactic">eauto</span>. } <span class="id">eexact</span> <span class="id">IST</span>. <span class="tactic">intros</span> [<span class="id">ra</span> <span class="id">D</span>].<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one</a></span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="id">econs</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">SimMemInj.spl</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">coqlib</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Values.html#Val.Vptr_has_type">Val.Vptr_has_type</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">red</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.le_trans">Z.le_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="compcert.x86.Conventions1.html#size_arguments">size_arguments</a></span> <span class="id">sig</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.x86.Conventions1.html#loc_arguments_bounded">loc_arguments_bounded</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intro</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">FPTR</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="id">des_ifs</span>.<br/>
&nbsp;&nbsp;{ <span class="id">ss</span>. <span class="id">des_ifs</span>; <span class="tactic">try</span> (<span class="tactic">by</span> (<span class="id">inv</span> <span class="id">STACKS</span>; <span class="id">clarify</span>; <span class="id">inv</span> <span class="id">MAINARGS</span>)). <span class="tactic">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_assoc">sep_assoc</a></span>. <span class="tactic">exact</span> <span class="id">SEP</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_assoc">sep_assoc</a></span>. <span class="tactic">exact</span> <span class="id">SEP</span>.<br/>
<br/>
- <span class="comment">(*&nbsp;Ltailcall&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="compcert.common.Separation.html#sep_swap">sep_swap</a></span> (<span class="id">stack_contents</span> <span class="id">j</span> <span class="id">s</span> <span class="id">cs</span>')) <span class="kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Stackingproof.html#function_epilogue_correct">function_epilogue_correct</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">INJ</span>: <span class="id">m</span>'0 |= <span class="id"><a href="compcert.common.Separation.html#minjection">minjection</a></span> <span class="id">j</span> <span class="id">m</span>). <span class="tactic">apply</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">SEP</span>. <span class="tactic">intros</span> (<span class="id">rs1</span> &amp; <span class="id">m1</span>' &amp; <span class="id">P</span> &amp; <span class="id">Q</span> &amp; <span class="id">R</span> &amp; <span class="id">S</span> &amp; <span class="id">T</span> &amp; <span class="id">U</span> &amp; <span class="id">SEP</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_swap">sep_swap</a></span> <span class="kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Stackingproof.html#find_function_ptr_translated">find_function_ptr_translated</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj2">sep_proj2</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj2">sep_proj2</a></span>. <span class="id">eexact</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="id">i</span>; <span class="id">des</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_right">plus_right</a></span>. <span class="id">eexact</span> <span class="id">S</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="id">econs</span>; <span class="tactic">eauto</span>. <span class="id">traceEq</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">MCOMPAT</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.common.SimMemInj.html#free_left">SimMemInj.free_left</a></span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">des</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.SimMemInj.html#free_right">SimMemInj.free_right</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;{ <span class="tactic">rewrite</span> <span class="id">MTGT</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;{ <span class="id">ii</span>. <span class="tactic">red</span>. <span class="id">esplits</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">MINJ</span>. <span class="tactic">subst</span> <span class="id">m</span>'. <span class="id">ii</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Stackingproof.html#unfold_transf_function">unfold_transf_function</a></span>; <span class="tactic">eauto</span>. <span class="id">ii</span>. <span class="tactic">subst</span> <span class="id">tf</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">BDD</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span>(<span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#classic">Classical_Prop.classic</a></span>(0 &lt;= <span class="id">ofs</span> &lt; <span class="id"><a href="compcert.backend.Bounds.html#fe_stack_data">fe_stack_data</a></span> (<span class="id"><a href="compcert.x86.Stacklayout.html#make_env">make_env</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#function_bounds">function_bounds</a></span> <span class="id">f</span>)) \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Bounds.html#fe_stack_data">fe_stack_data</a></span> (<span class="id"><a href="compcert.x86.Stacklayout.html#make_env">make_env</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#function_bounds">function_bounds</a></span> <span class="id">f</span>)) + <span class="id"><a href="compcert.backend.Linear.html#fn_stacksize">Linear.fn_stacksize</a></span> <span class="id">f</span> &lt;= <span class="id">ofs</span> &lt; <span class="id"><a href="compcert.backend.Bounds.html#fe_size">fe_size</a></span> (<span class="id"><a href="compcert.x86.Stacklayout.html#make_env">make_env</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#function_bounds">function_bounds</a></span> <span class="id">f</span>)))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id">PRIV</span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_free_3">Mem.perm_free_3</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">assert</span>(<span class="id"><a href="compcert.backend.Bounds.html#fe_stack_data">fe_stack_data</a></span> (<span class="id"><a href="compcert.x86.Stacklayout.html#make_env">make_env</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#function_bounds">function_bounds</a></span> <span class="id">f</span>)) &lt;= <span class="id">ofs</span> &lt; <span class="id"><a href="compcert.backend.Bounds.html#fe_stack_data">fe_stack_data</a></span> (<span class="id"><a href="compcert.x86.Stacklayout.html#make_env">make_env</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#function_bounds">function_bounds</a></span> <span class="id">f</span>)) + <span class="id"><a href="compcert.backend.Linear.html#fn_stacksize">Linear.fn_stacksize</a></span> <span class="id">f</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> <span class="id">ofs</span> (<span class="id"><a href="compcert.backend.Bounds.html#fe_stack_data">fe_stack_data</a></span> (<span class="id"><a href="compcert.x86.Stacklayout.html#make_env">make_env</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#function_bounds">function_bounds</a></span> <span class="id">f</span>)))). <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zle">zle</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#fe_stack_data">fe_stack_data</a></span> (<span class="id"><a href="compcert.x86.Stacklayout.html#make_env">make_env</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#function_bounds">function_bounds</a></span> <span class="id">f</span>)) + <span class="id"><a href="compcert.backend.Linear.html#fn_stacksize">Linear.fn_stacksize</a></span> <span class="id">f</span>) <span class="id">ofs</span>); <span class="id">xomega</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">H4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.Values.html#eq_block">eq_block</a></span> <span class="id">b0</span> <span class="id">stk</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">subst</span> <span class="id">b0</span>. <span class="tactic">rewrite</span> <span class="id">INJSP</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="id">clarify</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_free_2">Mem.perm_free_2</a></span>; <span class="tactic">try</span> <span class="tactic">eapply</span> <span class="id">H2</span>; <span class="tactic">eauto</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">exploit</span> <span class="id"><a href="compcert.common.Memory.html#Mem.mi_no_overlap">Mem.mi_no_overlap</a></span>; <span class="tactic">try</span> <span class="tactic">eapply</span> <span class="id">INJ</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_free_3">Mem.perm_free_3</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Memory.html#Mem.free_range_perm">Mem.free_range_perm</a></span>. <span class="tactic">eapply</span> <span class="id">H2</span>. <span class="id">instantiate</span> (1 := <span class="id">ofs</span> - <span class="id"><a href="compcert.backend.Bounds.html#fe_stack_data">fe_stack_data</a></span> (<span class="id"><a href="compcert.x86.Stacklayout.html#make_env">make_env</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#function_bounds">function_bounds</a></span> <span class="id">f</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">xomega</span>. <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">X</span> | <span class="id">X</span>]. <span class="tactic">congruence</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">MTGT</span>. <span class="tactic">red</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.common.Memory.html#Mem.free_range_perm">Mem.free_range_perm</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{ <span class="id">ii</span>. <span class="tactic">eapply</span> <span class="id">SPVALID1</span>. <span class="id">inv</span> <span class="id">MLE</span>. <span class="tactic">rewrite</span> <span class="id">TGTPARENTEQ</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="id">i</span>; <span class="id">des</span>. <span class="id">SimMemInj.spl_exact</span> <span class="id">sm2</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;{ <span class="id">SimMemInj.compat_tac</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#match_stacks_change_sig">match_stacks_change_sig</a></span> <span class="kwd">with</span> (<span class="id"><a href="compcert.backend.Linear.html#fn_sig">Linear.fn_sig</a></span> <span class="id">f</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#match_stacks_le">match_stacks_le</a></span>; <span class="tactic">eauto</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#match_stacks_le">match_stacks_le</a></span>; <span class="tactic">eauto</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ii</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_free_3">Mem.perm_free_3</a></span>; <span class="tactic">eauto</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Conventions.html#zero_size_arguments_tailcall_possible">zero_size_arguments_tailcall_possible</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Lineartyping.html#wt_state_tailcall">wt_state_tailcall</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intro</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">FPTR</span>. <span class="tactic">eauto</span>. }<br/>
<br/>
- <span class="comment">(*&nbsp;Lbuiltin&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">GENVINJ</span>: <span class="id">m</span>'0 |= <span class="id"><a href="compcert.common.Separation.html#globalenv_inject">globalenv_inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.ge">ge</a></span> <span class="id">j</span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj2">sep_proj2</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj2">sep_proj2</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj2">sep_proj2</a></span>. <span class="id">eexact</span> <span class="id">SEP</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">PRES_GLB</span>: <span class="id"><a href="compcert.common.Events.html#meminj_preserves_globals">meminj_preserves_globals</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.ge">ge</a></span> <span class="id">j</span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Separation.html#globalenv_inject_preserves_globals">globalenv_inject_preserves_globals</a></span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">INJECT</span>: <span class="id"><a href="compcert.common.Memory.html#Mem.inject">Mem.inject</a></span> <span class="id">j</span> <span class="id">m</span> <span class="id">m</span>'0). { <span class="tactic">eapply</span> <span class="id">SEP</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">BOUND</span> <span class="kwd">as</span> [<span class="id">BND1</span> <span class="id">BND2</span>].<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Stackingproof.html#transl_builtin_args_correct">transl_builtin_args_correct</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_swap">sep_swap</a></span> <span class="kwd">in</span> <span class="id">SEP</span>; <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj2">sep_proj2</a></span> <span class="kwd">in</span> <span class="id">SEP</span>; <span class="id">eexact</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eauto</span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#forallb_forall">forallb_forall</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Lineartyping.html#wt_state_builtin">wt_state_builtin</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">exact</span> <span class="id">BND2</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">vargs</span>' [<span class="id">P</span> <span class="id">Q</span>]].<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.common.Separation.html#sep_assoc">sep_assoc</a></span>, <span class="id"><a href="compcert.common.Separation.html#sep_comm">sep_comm</a></span>, <span class="id"><a href="compcert.common.Separation.html#sep_assoc">sep_assoc</a></span> <span class="kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Separation.html#external_call_parallel_rule">external_call_parallel_rule</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#match_stacks_symbols_inject">match_stacks_symbols_inject</a></span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">SEP</span>; <span class="tactic">intros</span> (<span class="id">j</span>' &amp; <span class="id">res</span>' &amp; <span class="id">m1</span>' &amp; <span class="id">EC</span> &amp; <span class="id">RES</span> &amp; <span class="id">SEP</span> &amp; <span class="id">INCR</span> &amp; <span class="id">ISEP</span> &amp; <span class="id">UNCH1</span> &amp; <span class="id">UNCH2</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.common.Separation.html#sep_assoc">sep_assoc</a></span>, <span class="id"><a href="compcert.common.Separation.html#sep_comm">sep_comm</a></span>, <span class="id"><a href="compcert.common.Separation.html#sep_assoc">sep_assoc</a></span> <span class="kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one</a></span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Events.html#eval_builtin_args_preserved">eval_builtin_args_preserved</a></span> <span class="kwd">with</span> (<span class="id">ge1</span> := <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.ge">ge</a></span>); <span class="tactic">eauto</span>. <span class="tactic">exact</span> <span class="id"><a href="compcert.backend.Stackingproof.html#symbols_preserved">symbols_preserved</a></span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.SimMemInj.html#external_call">SimMemInj.external_call</a></span>; <span class="tactic">try</span> <span class="tactic">by</span> (<span class="id">inv</span> <span class="id">MCOMPAT</span>; <span class="tactic">eauto</span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id">SEP</span>. }<br/>
&nbsp;&nbsp;<span class="id">i</span>; <span class="id">des</span>. <span class="id">SimMemInj.spl_exact</span> <span class="id">sm1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#match_states_intro">match_states_intro</a></span> <span class="kwd">with</span> (<span class="id">j</span> := <span class="id">j</span>'); <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">coqlib</span>.<br/>
&nbsp;&nbsp;<span class="id">SimMemInj.compat_tac</span>.<br/>
&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#spvalid_le">spvalid_le</a></span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">MCOMPAT</span>. <span class="id">ii</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.common.SimMemInj.html#tgt_private">SimMemInj.tgt_private</a></span>, <span class="id"><a href="compcert.common.Events.html#loc_out_of_reach">loc_out_of_reach</a></span> <span class="kwd">in</span> *. <span class="id">ss</span>. <span class="id">exploit</span> <span class="id">PRIV</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">X</span> <span class="id">Y</span>]. <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">ii</span>. <span class="tactic">destruct</span> (<span class="id">sm0</span>.(<span class="id"><a href="compcert.common.SimMemInj.html#inj">SimMemInj.inj</a></span>) <span class="id">b0</span>) <span class="kwd">as</span> [[<span class="id">sp1</span> <span class="id">delta1</span>] |] <span class="id">eqn</span>:?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id">exploit</span> <span class="id">INCR</span>; <span class="tactic">eauto</span>. <span class="id">ii</span>. <span class="id">clarify</span>. <span class="tactic">eapply</span> <span class="id">PRIV</span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Events.html#external_call_max_perm">external_call_max_perm</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#plt">plt</a></span> <span class="id">b0</span> (<span class="id"><a href="compcert.common.Memory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">sm0</span>.(<span class="id"><a href="compcert.common.SimMemInj.html#src">SimMemInj.src</a></span>))); <span class="tactic">auto</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.common.Memory.html#Mem.mi_freeblocks">Mem.mi_freeblocks</a></span>; <span class="tactic">try</span> <span class="tactic">eapply</span> <span class="id">n</span>. <span class="tactic">eauto</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id">ISEP</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Events.html#external_call_valid_block">external_call_valid_block</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">MCOMPAT</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">SAME</span>: <span class="kwd">forall</span> (<span class="id">b0</span> <span class="id">b2</span> : <span class="id"><a href="compcert.common.Values.html#block">block</a></span>) (<span class="id">delta</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Memory.html#Mem.valid_block">Mem.valid_block</a></span> (<span class="id"><a href="compcert.common.SimMemInj.html#tgt">SimMemInj.tgt</a></span> <span class="id">sm0</span>) <span class="id"><a href="compcert.backend.Stackingproof.html#b2">b2</a></span> -&gt; (<span class="id"><a href="compcert.common.SimMemInj.html#inj">SimMemInj.inj</a></span> <span class="id">sm1</span>) <span class="id"><a href="compcert.backend.Stackingproof.html#b0">b0</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#b2">b2</a></span>, <span class="id"><a href="compcert.backend.Stackingproof.html#delta">delta</a></span>) -&gt; <span class="id"><a href="compcert.common.SimMemInj.html#inj">SimMemInj.inj</a></span> <span class="id">sm0</span> <span class="id"><a href="compcert.backend.Stackingproof.html#b0">b0</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#b2">b2</a></span>, <span class="id"><a href="compcert.backend.Stackingproof.html#delta">delta</a></span>)).<br/>
&nbsp;&nbsp;{ <span class="id">ii</span>. <span class="id">ss</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.SimMemInj.html#frozen_preserves_tgt">SimMemInj.frozen_preserves_tgt</a></span>; <span class="tactic">try</span> (<span class="id">erewrite</span> &lt;- <span class="id"><a href="compcert.common.SimMemInj.html#inject_separated_frozen">SimMemInj.inject_separated_frozen</a></span>; <span class="tactic">eauto</span>); <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#match_stacks_change_meminj">match_stacks_change_meminj</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;{ <span class="id">i</span>. <span class="tactic">apply</span> <span class="id">SAME</span>; <span class="tactic">eauto</span>. <span class="id">ss</span>. <span class="id">des</span>. <span class="id">inv</span> <span class="id">GENVINJ0</span>. <span class="id">inv</span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.SECOMPATSRC">SECOMPATSRC</a></span>. <span class="tactic">rewrite</span> <span class="id">NB</span> <span class="kwd">in</span> *. <span class="id">exploit</span> <span class="id">DOMAIN</span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">clarify</span>. <span class="id">exploit</span> <span class="id">INCR</span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">clarify</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.common.Memory.html#Mem.valid_block">Mem.valid_block</a></span>. <span class="id">xomega</span>. }<br/>
&nbsp;&nbsp;{ <span class="id">i</span>. <span class="tactic">apply</span> <span class="id">SAME</span>; <span class="tactic">eauto</span>. <span class="id">ss</span>. <span class="id">des</span>. <span class="id">inv</span> <span class="id">GENVINJ0</span>. <span class="id">inv</span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.SECOMPATTGT">SECOMPATTGT</a></span>. <span class="tactic">rewrite</span> <span class="id">NB</span> <span class="kwd">in</span> *. <span class="id">inv</span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.MATCH_GENV">MATCH_GENV</a></span>. <span class="tactic">rewrite</span> <span class="id">mge_next</span> <span class="kwd">in</span> *. <span class="id">exploit</span> <span class="id">DOMAIN</span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">clarify</span>. <span class="id">exploit</span> <span class="id">INCR</span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">clarify</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.common.Memory.html#Mem.valid_block">Mem.valid_block</a></span>. <span class="id">xomega</span>. }<br/>
&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#match_stacks_le">match_stacks_le</a></span>; <span class="tactic">eauto</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">ii</span>. <span class="id">ss</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Events.html#external_call_max_perm">external_call_max_perm</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.valid_block_inject_1">Mem.valid_block_inject_1</a></span>; <span class="tactic">try</span> <span class="tactic">eapply</span> <span class="id">SAME</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs_set_res">agree_regs_set_res</a></span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs_undef_regs">agree_regs_undef_regs</a></span>; <span class="tactic">auto</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs_inject_incr">agree_regs_inject_incr</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs_set_res">agree_locs_set_res</a></span>; <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs_undef_regs">agree_locs_undef_regs</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_set_res">frame_set_res</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_undef_regs">frame_undef_regs</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents_incr">frame_contents_incr</a></span> <span class="kwd">with</span> <span class="id">j</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_swap2">sep_swap2</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#stack_contents_change_meminj">stack_contents_change_meminj</a></span> <span class="kwd">with</span> <span class="id">j</span>; <span class="tactic">auto</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_swap2">sep_swap2</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">exact</span> <span class="id">SEP</span>.<br/>
<br/>
- <span class="comment">(*&nbsp;Llabel&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one</a></span>; <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Mach.html#exec_Mlabel">exec_Mlabel</a></span>.<br/>
&nbsp;&nbsp;<span class="id">SimMemInj.spl</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">coqlib</span>.<br/>
<br/>
- <span class="comment">(*&nbsp;Lgoto&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one</a></span>; <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Mach.html#exec_Mgoto">exec_Mgoto</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#transl_find_label">transl_find_label</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">SimMemInj.spl</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#find_label_tail">find_label_tail</a></span>; <span class="tactic">eauto</span>.<br/>
<br/>
- <span class="comment">(*&nbsp;Lcond,&nbsp;true&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Mach.html#exec_Mcond_true">exec_Mcond_true</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.x86.Op.html#eval_condition_inject">eval_condition_inject</a></span> <span class="kwd">with</span> (<span class="id">m1</span> := <span class="id">m</span>). <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_reglist">agree_reglist</a></span>; <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Separation.html#sep_pick3">sep_pick3</a></span> <span class="kwd">in</span> <span class="id">SEP</span>; <span class="tactic">exact</span> <span class="id">SEP</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#transl_find_label">transl_find_label</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">SimMemInj.spl</span>. <span class="id">inv</span> <span class="id">MCOMPAT</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="id">SimMemInj.compat_tac</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs_undef_regs">agree_regs_undef_regs</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs_undef_locs">agree_locs_undef_locs</a></span>. <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#destroyed_by_cond_caller_save">destroyed_by_cond_caller_save</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#find_label_tail">find_label_tail</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_undef_regs">frame_undef_regs</a></span>; <span class="tactic">auto</span>.<br/>
<br/>
- <span class="comment">(*&nbsp;Lcond,&nbsp;false&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Mach.html#exec_Mcond_false">exec_Mcond_false</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.x86.Op.html#eval_condition_inject">eval_condition_inject</a></span> <span class="kwd">with</span> (<span class="id">m1</span> := <span class="id">m</span>). <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_reglist">agree_reglist</a></span>; <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Separation.html#sep_pick3">sep_pick3</a></span> <span class="kwd">in</span> <span class="id">SEP</span>; <span class="tactic">exact</span> <span class="id">SEP</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">SimMemInj.spl</span>. <span class="id">inv</span> <span class="id">MCOMPAT</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="id">SimMemInj.compat_tac</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs_undef_regs">agree_regs_undef_regs</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs_undef_locs">agree_locs_undef_locs</a></span>. <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#destroyed_by_cond_caller_save">destroyed_by_cond_caller_save</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">coqlib</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_undef_regs">frame_undef_regs</a></span>; <span class="tactic">auto</span>.<br/>
<br/>
- <span class="comment">(*&nbsp;Ljumptable&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">rs0</span> <span class="id">arg</span> = <span class="id"><a href="compcert.common.Values.html#Vint">Vint</a></span> <span class="id">n</span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">generalize</span> (<span class="id">AGREGS</span> <span class="id">arg</span>). <span class="tactic">rewrite</span> <span class="id">H</span>. <span class="tactic">intro</span> <span class="id">IJ</span>; <span class="id">inv</span> <span class="id">IJ</span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one</a></span>; <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Mach.html#exec_Mjumptable">exec_Mjumptable</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#transl_find_label">transl_find_label</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">SimMemInj.spl</span>. <span class="id">inv</span> <span class="id">MCOMPAT</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="id">SimMemInj.compat_tac</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs_undef_regs">agree_regs_undef_regs</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs_undef_locs">agree_locs_undef_locs</a></span>. <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#destroyed_by_jumptable_caller_save">destroyed_by_jumptable_caller_save</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#find_label_tail">find_label_tail</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_undef_regs">frame_undef_regs</a></span>; <span class="tactic">auto</span>.<br/>
<br/>
- <span class="comment">(*&nbsp;Lreturn&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="compcert.common.Separation.html#sep_swap">sep_swap</a></span> (<span class="id">stack_contents</span> <span class="id">j</span> <span class="id">s</span> <span class="id">cs</span>')) <span class="kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Stackingproof.html#function_epilogue_correct">function_epilogue_correct</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">rs</span>' &amp; <span class="id">m1</span>' &amp; <span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span> &amp; <span class="id">D</span> &amp; <span class="id">E</span> &amp; <span class="id">F</span> &amp; <span class="id">G</span>).<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_right">plus_right</a></span>. <span class="id">eexact</span> <span class="id">D</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="id">traceEq</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">MCOMPAT</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.common.SimMemInj.html#free_left">SimMemInj.free_left</a></span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">des</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.SimMemInj.html#free_right">SimMemInj.free_right</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;{ <span class="tactic">rewrite</span> <span class="id">MTGT</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;{ <span class="id">ii</span>. <span class="tactic">red</span>. <span class="id">esplits</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">MINJ</span>. <span class="tactic">subst</span> <span class="id">m</span>'. <span class="id">ii</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Stackingproof.html#unfold_transf_function">unfold_transf_function</a></span>; <span class="tactic">eauto</span>. <span class="id">ii</span>. <span class="tactic">subst</span> <span class="id">tf</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">BDD</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span>(<span class="id"><a href="http://coq.inria.fr/library/Coq.Logic.Classical_Prop.html#classic">Classical_Prop.classic</a></span>(0 &lt;= <span class="id">ofs</span> &lt; <span class="id"><a href="compcert.backend.Bounds.html#fe_stack_data">fe_stack_data</a></span> (<span class="id"><a href="compcert.x86.Stacklayout.html#make_env">make_env</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#function_bounds">function_bounds</a></span> <span class="id">f</span>)) \/<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Bounds.html#fe_stack_data">fe_stack_data</a></span> (<span class="id"><a href="compcert.x86.Stacklayout.html#make_env">make_env</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#function_bounds">function_bounds</a></span> <span class="id">f</span>)) + <span class="id"><a href="compcert.backend.Linear.html#fn_stacksize">Linear.fn_stacksize</a></span> <span class="id">f</span> &lt;= <span class="id">ofs</span> &lt; <span class="id"><a href="compcert.backend.Bounds.html#fe_size">fe_size</a></span> (<span class="id"><a href="compcert.x86.Stacklayout.html#make_env">make_env</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#function_bounds">function_bounds</a></span> <span class="id">f</span>)))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id">PRIV</span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_free_3">Mem.perm_free_3</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">assert</span>(<span class="id"><a href="compcert.backend.Bounds.html#fe_stack_data">fe_stack_data</a></span> (<span class="id"><a href="compcert.x86.Stacklayout.html#make_env">make_env</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#function_bounds">function_bounds</a></span> <span class="id">f</span>)) &lt;= <span class="id">ofs</span> &lt; <span class="id"><a href="compcert.backend.Bounds.html#fe_stack_data">fe_stack_data</a></span> (<span class="id"><a href="compcert.x86.Stacklayout.html#make_env">make_env</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#function_bounds">function_bounds</a></span> <span class="id">f</span>)) + <span class="id"><a href="compcert.backend.Linear.html#fn_stacksize">Linear.fn_stacksize</a></span> <span class="id">f</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> <span class="id">ofs</span> (<span class="id"><a href="compcert.backend.Bounds.html#fe_stack_data">fe_stack_data</a></span> (<span class="id"><a href="compcert.x86.Stacklayout.html#make_env">make_env</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#function_bounds">function_bounds</a></span> <span class="id">f</span>)))). <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zle">zle</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#fe_stack_data">fe_stack_data</a></span> (<span class="id"><a href="compcert.x86.Stacklayout.html#make_env">make_env</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#function_bounds">function_bounds</a></span> <span class="id">f</span>)) + <span class="id"><a href="compcert.backend.Linear.html#fn_stacksize">Linear.fn_stacksize</a></span> <span class="id">f</span>) <span class="id">ofs</span>); <span class="id">xomega</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.Values.html#eq_block">eq_block</a></span> <span class="id">b0</span> <span class="id">stk</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">subst</span> <span class="id">b0</span>. <span class="tactic">rewrite</span> <span class="id">INJSP</span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="id">clarify</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_free_2">Mem.perm_free_2</a></span>; <span class="tactic">try</span> <span class="tactic">eapply</span> <span class="id">H</span>; <span class="tactic">eauto</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">exploit</span> <span class="id"><a href="compcert.common.Memory.html#Mem.mi_no_overlap">Mem.mi_no_overlap</a></span>; <span class="tactic">try</span> <span class="tactic">eapply</span> <span class="id">SEP</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_free_3">Mem.perm_free_3</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Memory.html#Mem.free_range_perm">Mem.free_range_perm</a></span>. <span class="tactic">eapply</span> <span class="id">H</span>. <span class="id">instantiate</span> (1 := <span class="id">ofs</span> - <span class="id"><a href="compcert.backend.Bounds.html#fe_stack_data">fe_stack_data</a></span> (<span class="id"><a href="compcert.x86.Stacklayout.html#make_env">make_env</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#function_bounds">function_bounds</a></span> <span class="id">f</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">xomega</span>. <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">mem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">X</span> | <span class="id">X</span>]. <span class="tactic">congruence</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">rewrite</span> <span class="id">MTGT</span>. <span class="tactic">red</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.common.Memory.html#Mem.free_range_perm">Mem.free_range_perm</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{ <span class="id">ii</span>. <span class="tactic">eapply</span> <span class="id">SPVALID1</span>. <span class="id">inv</span> <span class="id">MLE</span>. <span class="tactic">rewrite</span> <span class="id">TGTPARENTEQ</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="id">i</span>; <span class="id">des</span>. <span class="id">SimMemInj.spl_exact</span> <span class="id">sm2</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;{ <span class="id">SimMemInj.compat_tac</span>. }<br/>
&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#match_stacks_le">match_stacks_le</a></span>; <span class="tactic">eauto</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#match_stacks_le">match_stacks_le</a></span>; <span class="tactic">eauto</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ii</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_free_3">Mem.perm_free_3</a></span>; <span class="tactic">eauto</span>. <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">intro</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_swap">sep_swap</a></span>; <span class="tactic">exact</span> <span class="id">G</span>.<br/>
<br/>
- <span class="comment">(*&nbsp;internal&nbsp;function&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">GENVINJ</span>: <span class="id">m</span>'0 |= <span class="id"><a href="compcert.common.Separation.html#globalenv_inject">globalenv_inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.ge">ge</a></span> <span class="id">j</span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj2">sep_proj2</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj2">sep_proj2</a></span>. <span class="id">eexact</span> <span class="id">SEP</span>. }<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Stackingproof.html#functions_translated">functions_translated</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">tf</span> &amp; <span class="id">FIND</span> &amp; <span class="id">TRANSL</span>).<br/>
&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">fptr</span> = <span class="id">tfptr</span> /\ <span class="id">exists</span> <span class="id">fb</span>, <span class="id">fptr</span> = <span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#fb">fb</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">repeat</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj2">sep_proj2</a></span> <span class="kwd">in</span> <span class="id">SEP</span>. <span class="id">inv</span> <span class="id">SEP</span>. <span class="id">des</span>. <span class="id">inv</span> <span class="id">H1</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_funct">Genv.find_funct</a></span> <span class="kwd">in</span> *. <span class="id">des_ifs</span>. <span class="id">inv</span> <span class="id">FPTR0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">FUNCTIONS</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">exploit</span> <span class="id">DOMAIN</span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">des</span>. <span class="id">clarify</span>. <span class="id">esplits</span>; <span class="tactic">eauto</span>. } <span class="id">des</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;<span class="id">revert</span> <span class="id">TRANSL</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Stacking.html#transf_fundef">transf_fundef</a></span>, <span class="id"><a href="compcert.common.AST.html#transf_partial_fundef">transf_partial_fundef</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.backend.Stacking.html#transf_function">transf_function</a></span> <span class="id">f</span>) <span class="kwd">as</span> [<span class="id">tfn</span>|] <span class="id">eqn</span>:<span class="id">TRANSL</span>; <span class="tactic">simpl</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">EQ</span>; <span class="tactic">inversion</span> <span class="id">EQ</span>; <span class="tactic">clear</span> <span class="id">EQ</span>; <span class="tactic">subst</span> <span class="id">tf</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_comm">sep_comm</a></span>, <span class="id"><a href="compcert.common.Separation.html#sep_assoc">sep_assoc</a></span> <span class="kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Lineartyping.html#wt_callstate_agree">wt_callstate_agree</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">AGCS</span> <span class="id">AGARGS</span>].<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Stackingproof.html#function_prologue_correct">function_prologue_correct</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Lineartyping.html#wt_callstate_wt_regs">wt_callstate_wt_regs</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#match_stacks_type_sp">match_stacks_type_sp</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#match_stacks_type_retaddr">match_stacks_type_retaddr</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;{ <span class="id">ii</span>. <span class="id">inv</span> <span class="id">MWF</span>. <span class="id">inv</span> <span class="id">MCOMPAT</span>. <span class="tactic">eapply</span> <span class="id">TGTEXT</span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="tactic">red</span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="id">des</span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">INJ</span>:<span class="id">Mem.inject</span>' <span class="id">j</span> <span class="id">m</span> <span class="id">m</span>'0). <span class="tactic">apply</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">SEP</span>;<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">j</span>' &amp; <span class="id">rs</span>' &amp; <span class="id">m2</span>' &amp; <span class="id">sp</span>' &amp; <span class="id">m3</span>' &amp; <span class="id">m4</span>' &amp; <span class="id">m5</span>' &amp; <span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span> &amp; <span class="id">D</span> &amp; <span class="id">E</span> &amp; <span class="id">F</span> &amp; <span class="id">SEP</span> &amp; <span class="id">J</span> &amp; <span class="id">INJ_SEP</span> &amp; <span class="id">UNCH</span> &amp; <span class="id">MAX</span> &amp; <span class="id">K</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="compcert.common.Separation.html#sep_comm">sep_comm</a></span> (<span class="id"><a href="compcert.common.Separation.html#globalenv_inject">globalenv_inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.ge">ge</a></span> <span class="id">j</span>')) <span class="kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="compcert.common.Separation.html#sep_swap">sep_swap</a></span> (<span class="id"><a href="compcert.common.Separation.html#minjection">minjection</a></span> <span class="id">j</span>' <span class="id">m</span>')) <span class="kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_left">plus_left</a></span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="compcert.backend.Stackingproof.html#unfold_transf_function">unfold_transf_function</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">TRANSL</span>). <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Mach.html#fn_code">fn_code</a></span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Stacking.html#transl_body">transl_body</a></span>.<br/>
&nbsp;&nbsp;<span class="id">eexact</span> <span class="id">D</span>. <span class="id">traceEq</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">NEXTBLOCK</span>:<span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> (<span class="id"><a href="compcert.common.Memory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">m</span>'0) (<span class="id"><a href="compcert.common.Memory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">m5</span>')).<br/>
&nbsp;&nbsp;{ <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Mach.html#store_stack">store_stack</a></span>, <span class="id"><a href="compcert.common.Memory.html#Mem.storev">Mem.storev</a></span> <span class="kwd">in</span> *. <span class="id">ss</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.common.Memory.html#Mem.nextblock_alloc">Mem.nextblock_alloc</a></span>; <span class="tactic">eauto</span>. <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Memory.html#Mem.nextblock_store">Mem.nextblock_store</a></span>. <span class="tactic">eapply</span> <span class="id">B</span>. <span class="id">i</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.common.Memory.html#Mem.nextblock_store">Mem.nextblock_store</a></span>. <span class="tactic">eauto</span>. <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.lib.Coqlib.html#Ple_trans">Ple_trans</a></span>; <span class="tactic">try</span> <span class="tactic">eapply</span> <span class="id">UNCH</span>. <span class="tactic">rewrite</span> <span class="id">H2</span>. <span class="tactic">rewrite</span> <span class="id">H1</span>. <span class="tactic">rewrite</span> <span class="id">H0</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">LE</span>: <span class="id">SimMemInj.le</span>' <span class="id">sm0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.common.SimMemInj.html#mk">SimMemInj.mk</a></span> <span class="id">m</span>' <span class="id">m5</span>' <span class="id">j</span>' <span class="id">sm0</span>.(<span class="id"><a href="compcert.common.SimMemInj.html#src_external">SimMemInj.src_external</a></span>) <span class="id">sm0</span>.(<span class="id"><a href="compcert.common.SimMemInj.html#tgt_external">SimMemInj.tgt_external</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sm0</span>.(<span class="id"><a href="compcert.common.SimMemInj.html#src_parent_nb">SimMemInj.src_parent_nb</a></span>) <span class="id">sm0</span>.(<span class="id"><a href="compcert.common.SimMemInj.html#tgt_parent_nb">SimMemInj.tgt_parent_nb</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">sm0</span>.(<span class="id"><a href="compcert.common.SimMemInj.html#src_ge_nb">SimMemInj.src_ge_nb</a></span>) <span class="id">sm0</span>.(<span class="id"><a href="compcert.common.SimMemInj.html#tgt_ge_nb">SimMemInj.tgt_ge_nb</a></span>))).<br/>
<br/>
&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">MCOMPAT</span>. <span class="id">inv</span> <span class="id">MWF</span>. <span class="id">econs</span>; <span class="id">ss</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.alloc_unchanged_on">Mem.alloc_unchanged_on</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Mach.html#store_stack">store_stack</a></span>, <span class="id"><a href="compcert.common.Memory.html#Mem.storev">Mem.storev</a></span> <span class="kwd">in</span> *. <span class="id">ss</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.unchanged_on_trans">Mem.unchanged_on_trans</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.alloc_unchanged_on">Mem.alloc_unchanged_on</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.unchanged_on_trans">Mem.unchanged_on_trans</a></span> <span class="kwd">with</span> <span class="id">m3</span>'; [|<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.unchanged_on_trans">Mem.unchanged_on_trans</a></span> <span class="kwd">with</span> <span class="id">m4</span>'; [|<span class="tactic">eauto</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.store_unchanged_on">Mem.store_unchanged_on</a></span>; <span class="tactic">eauto</span>. <span class="id">ii</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.fresh_block_alloc">Mem.fresh_block_alloc</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id">TGTEXT</span> <span class="kwd">in</span> <span class="id">H1</span>. <span class="tactic">red</span> <span class="kwd">in</span> <span class="id">H1</span>. <span class="id">des</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.store_unchanged_on">Mem.store_unchanged_on</a></span>; <span class="tactic">eauto</span>. <span class="id">ii</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.fresh_block_alloc">Mem.fresh_block_alloc</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id">TGTEXT</span> <span class="kwd">in</span> <span class="id">H1</span>. <span class="tactic">red</span> <span class="kwd">in</span> <span class="id">H1</span>. <span class="id">des</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.SimMemInj.html#frozen_shortened">SimMemInj.frozen_shortened</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.SimMemInj.html#frozen_shortened">SimMemInj.frozen_shortened</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.SimMemInj.html#inject_separated_frozen">SimMemInj.inject_separated_frozen</a></span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.SimMemInj.html#frozen_shortened">SimMemInj.frozen_shortened</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.SimMemInj.html#inject_separated_frozen">SimMemInj.inject_separated_frozen</a></span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">ii</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_alloc_4">Mem.perm_alloc_4</a></span>; <span class="tactic">eauto</span>. <span class="id">ii</span>. <span class="tactic">subst</span> <span class="id">b</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.fresh_block_alloc">Mem.fresh_block_alloc</a></span>. <span class="tactic">eapply</span> <span class="id">H</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">ii</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Mach.html#store_stack">store_stack</a></span>, <span class="id"><a href="compcert.common.Memory.html#Mem.storev">Mem.storev</a></span> <span class="kwd">in</span> *. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_alloc_4">Mem.perm_alloc_4</a></span>; <span class="tactic">eauto</span>; <span class="id">cycle</span> 1. <span class="id">exploit</span> <span class="id"><a href="compcert.common.Memory.html#Mem.alloc_result">Mem.alloc_result</a></span>; <span class="tactic">eauto</span>. <span class="id">ii</span>. <span class="tactic">subst</span>. <span class="tactic">red</span> <span class="kwd">in</span> <span class="id">VALID</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_store_2">Mem.perm_store_2</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_store_2">Mem.perm_store_2</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">MAX</span>; <span class="tactic">eauto</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.common.Memory.html#Mem.valid_block">Mem.valid_block</a></span> <span class="kwd">in</span> *. <span class="id">erewrite</span> <span class="id"><a href="compcert.common.Memory.html#Mem.nextblock_store">Mem.nextblock_store</a></span>; <span class="tactic">try</span> <span class="tactic">eapply</span> <span class="id">C</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="compcert.common.Memory.html#Mem.nextblock_store">Mem.nextblock_store</a></span>; <span class="tactic">try</span> <span class="tactic">eapply</span> <span class="id">B</span>. <span class="id">erewrite</span> <span class="id"><a href="compcert.common.Memory.html#Mem.nextblock_alloc">Mem.nextblock_alloc</a></span>; <span class="tactic">try</span> <span class="tactic">eapply</span> <span class="id">A</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id">SimMemInj.spl_approx</span> <span class="id">sm0</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#match_states_intro">match_states_intro</a></span> <span class="kwd">with</span> (<span class="id">j</span> := <span class="id">j</span>'); <span class="tactic">eauto</span> <span class="kwd">with</span> <span class="id">coqlib</span>.<br/>
&nbsp;&nbsp;<span class="id">SimMemInj.compat_tac</span>.<br/>
&nbsp;&nbsp;{ <span class="id">des</span>. <span class="id">ss</span>. <span class="id">inv</span> <span class="id">MCOMPAT</span>. <span class="comment">(*&nbsp;inv&nbsp;LE.&nbsp;ss.&nbsp;*)</span> <span class="id">esplits</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exploit</span> <span class="id"><a href="compcert.common.Memory.html#Mem.valid_new_block">Mem.valid_new_block</a></span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">clarify</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.valid_block_unchanged_on">Mem.valid_block_unchanged_on</a></span>; <span class="tactic">eauto</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Mach.html#store_stack">store_stack</a></span> <span class="kwd">in</span> *. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.store_valid_block_1">Mem.store_valid_block_1</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.store_valid_block_1">Mem.store_valid_block_1</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">erewrite</span> <span class="id"><a href="compcert.common.Memory.html#Mem.alloc_result">Mem.alloc_result</a></span> <span class="kwd">with</span> (<span class="id">b</span> := <span class="id">sp</span>'); <span class="tactic">eauto</span>. <span class="id">inv</span> <span class="id">MWF</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">erewrite</span> <span class="id"><a href="compcert.common.Memory.html#Mem.alloc_result">Mem.alloc_result</a></span> <span class="kwd">with</span> (<span class="id">b</span> := <span class="id">sp</span>'); <span class="tactic">eauto</span>. <span class="id">inv</span> <span class="id">MWF</span>. <span class="tactic">intros</span> ? <span class="id">T</span>. <span class="tactic">apply</span> <span class="id">TGTEXT</span> <span class="kwd">in</span> <span class="id">T</span>. <span class="id">rr</span> <span class="kwd">in</span> <span class="id">T</span>. <span class="id">des</span>. <span class="id">r</span> <span class="kwd">in</span> <span class="id">T0</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.common.Memory.html#Mem.valid_block">Mem.valid_block</a></span> <span class="kwd">in</span> *. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{ <span class="id">inv</span> <span class="id">MCOMPAT</span>. <span class="id">inv</span> <span class="id">MWF</span>. <span class="id">econs</span>; <span class="id">ss</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">etransitivity</span>; <span class="tactic">eauto</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.common.SimMemInj.html#src_private">SimMemInj.src_private</a></span>. <span class="id">ii</span>. <span class="id">des</span>. <span class="id">ss</span>. <span class="id">splits</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.SimMemInj.html#loc_unmapped_frozen">SimMemInj.loc_unmapped_frozen</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.SimMemInj.html#inject_separated_frozen">SimMemInj.inject_separated_frozen</a></span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id">exploit</span> <span class="id"><a href="compcert.common.Memory.html#Mem.nextblock_alloc">Mem.nextblock_alloc</a></span>. <span class="tactic">eapply</span> <span class="id">H</span>. <span class="id">i</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.common.SimMemInj.html#valid_blocks">SimMemInj.valid_blocks</a></span>, <span class="id"><a href="compcert.common.Memory.html#Mem.valid_block">Mem.valid_block</a></span> <span class="kwd">in</span> *. <span class="tactic">rewrite</span> <span class="id">H0</span>. <span class="id">xomega</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">etransitivity</span>; <span class="tactic">eauto</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.common.SimMemInj.html#tgt_private">SimMemInj.tgt_private</a></span>. <span class="id">ii</span>. <span class="id">ss</span>. <span class="id">des</span>. <span class="id">esplits</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.SimMemInj.html#loc_out_of_reach_frozen">SimMemInj.loc_out_of_reach_frozen</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.SimMemInj.html#inject_separated_frozen">SimMemInj.inject_separated_frozen</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ii</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_alloc_4">Mem.perm_alloc_4</a></span>; <span class="tactic">eauto</span>. <span class="id">ii</span>. <span class="tactic">subst</span> <span class="id">b0</span>. <span class="tactic">eapply</span> <span class="id">K</span> <span class="kwd">in</span> <span class="id">MAPPED</span>. <span class="id">clarify</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.fresh_block_alloc">Mem.fresh_block_alloc</a></span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="tactic">unfold</span> <span class="id"><a href="compcert.common.SimMemInj.html#valid_blocks">SimMemInj.valid_blocks</a></span>, <span class="id"><a href="compcert.common.Memory.html#Mem.valid_block">Mem.valid_block</a></span> <span class="kwd">in</span> *. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.nextblock_alloc">Mem.nextblock_alloc</a></span> <span class="kwd">in</span> <span class="id">A</span>. <span class="id">xomega</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exploit</span> <span class="id"><a href="compcert.common.Memory.html#Mem.nextblock_alloc">Mem.nextblock_alloc</a></span>. <span class="tactic">eapply</span> <span class="id">H</span>. <span class="id">i</span>. <span class="tactic">rewrite</span> <span class="id">H0</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">exploit</span> <span class="id"><a href="compcert.common.Memory.html#Mem.nextblock_alloc">Mem.nextblock_alloc</a></span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{ <span class="id">ii</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.common.SimMemInj.html#tgt_private">SimMemInj.tgt_private</a></span>, <span class="id"><a href="compcert.common.Events.html#loc_out_of_reach">loc_out_of_reach</a></span> <span class="kwd">in</span> *. <span class="tactic">simpl</span>. <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">ii</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_alloc_inv">Mem.perm_alloc_inv</a></span>. <span class="id">eexact</span> <span class="id">H</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.Values.html#eq_block">eq_block</a></span> <span class="id">b0</span> <span class="id">stk</span>); <span class="id">i</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">subst</span>. <span class="tactic">rewrite</span> <span class="id">J</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">delta</span> = <span class="id"><a href="compcert.backend.Bounds.html#fe_stack_data">fe_stack_data</a></span> (<span class="id"><a href="compcert.x86.Stacklayout.html#make_env">make_env</a></span> (<span class="id"><a href="compcert.backend.Bounds.html#function_bounds">function_bounds</a></span> <span class="id">f</span>))). <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">delta</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.backend.Stackingproof.html#unfold_transf_function">unfold_transf_function</a></span>; <span class="tactic">eauto</span>. <span class="id">ii</span>. <span class="tactic">subst</span> <span class="id">tfn</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.fresh_block_alloc">Mem.fresh_block_alloc</a></span>. <span class="tactic">eapply</span> <span class="id">A</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.mi_mappedblocks">Mem.mi_mappedblocks</a></span>; <span class="tactic">eauto</span>. <span class="id">erewrite</span> <span class="id"><a href="compcert.common.SimMemInj.html#frozen_preserves_src">SimMemInj.frozen_preserves_src</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.SimMemInj.html#inject_separated_frozen">SimMemInj.inject_separated_frozen</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_valid_block">Mem.perm_valid_block</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.valid_block_unchanged_on">Mem.valid_block_unchanged_on</a></span>; <span class="tactic">eauto</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Mach.html#store_stack">store_stack</a></span>, <span class="id"><a href="compcert.common.Memory.html#Mem.storev">Mem.storev</a></span> <span class="kwd">in</span> *. <span class="id">des_ifs_safe</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.store_valid_block_1">Mem.store_valid_block_1</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.store_valid_block_1">Mem.store_valid_block_1</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.valid_new_block">Mem.valid_new_block</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">MCOMPAT</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">SAME</span>: <span class="kwd">forall</span> (<span class="id">b0</span> <span class="id">b2</span> : <span class="id"><a href="compcert.common.Values.html#block">block</a></span>) (<span class="id">delta</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Memory.html#Mem.valid_block">Mem.valid_block</a></span> (<span class="id"><a href="compcert.common.SimMemInj.html#tgt">SimMemInj.tgt</a></span> <span class="id">sm0</span>) <span class="id"><a href="compcert.backend.Stackingproof.html#b2">b2</a></span> -&gt; <span class="id">j</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#b0">b0</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#b2">b2</a></span>, <span class="id"><a href="compcert.backend.Stackingproof.html#delta">delta</a></span>) -&gt; <span class="id"><a href="compcert.common.SimMemInj.html#inj">SimMemInj.inj</a></span> <span class="id">sm0</span> <span class="id"><a href="compcert.backend.Stackingproof.html#b0">b0</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#b2">b2</a></span>, <span class="id"><a href="compcert.backend.Stackingproof.html#delta">delta</a></span>)).<br/>
&nbsp;&nbsp;{ <span class="id">ii</span>. <span class="id">ss</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.SimMemInj.html#frozen_preserves_tgt">SimMemInj.frozen_preserves_tgt</a></span>; <span class="tactic">try</span> (<span class="id">erewrite</span> &lt;- <span class="id"><a href="compcert.common.SimMemInj.html#inject_separated_frozen">SimMemInj.inject_separated_frozen</a></span>; <span class="tactic">eauto</span>); <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#match_stacks_change_meminj">match_stacks_change_meminj</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;{ <span class="id">i</span>. <span class="tactic">apply</span> <span class="id">SAME</span>; <span class="tactic">eauto</span>. <span class="id">ss</span>. <span class="id">des</span>. <span class="id">inv</span> <span class="id">GENVINJ0</span>. <span class="id">inv</span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.SECOMPATSRC">SECOMPATSRC</a></span>. <span class="tactic">rewrite</span> <span class="id">NB</span> <span class="kwd">in</span> *. <span class="id">exploit</span> <span class="id">DOMAIN</span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">clarify</span>. <span class="id">exploit</span> <span class="id">K</span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">clarify</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.common.Memory.html#Mem.valid_block">Mem.valid_block</a></span>. <span class="id">xomega</span>. }<br/>
&nbsp;&nbsp;{ <span class="id">i</span>. <span class="tactic">apply</span> <span class="id">SAME</span>; <span class="tactic">eauto</span>. <span class="id">ss</span>. <span class="id">des</span>. <span class="id">inv</span> <span class="id">GENVINJ0</span>. <span class="id">inv</span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.SECOMPATTGT">SECOMPATTGT</a></span>. <span class="tactic">rewrite</span> <span class="id">NB</span> <span class="kwd">in</span> *. <span class="id">inv</span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.MATCH_GENV">MATCH_GENV</a></span>. <span class="tactic">rewrite</span> <span class="id">mge_next</span> <span class="kwd">in</span> *. <span class="id">exploit</span> <span class="id">DOMAIN</span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">clarify</span>. <span class="id">exploit</span> <span class="id">K</span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">clarify</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.common.Memory.html#Mem.valid_block">Mem.valid_block</a></span>. <span class="id">xomega</span>. }<br/>
&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#match_stacks_le">match_stacks_le</a></span>; <span class="tactic">eauto</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id">ii</span>. <span class="id">ss</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.perm_alloc_4">Mem.perm_alloc_4</a></span>; <span class="tactic">eauto</span>. <span class="id">ii</span>. <span class="tactic">subst</span> <span class="id">b</span>. <span class="tactic">rewrite</span> <span class="id">J</span> <span class="kwd">in</span> <span class="id">H1</span>. <span class="id">clarify</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.fresh_block_alloc">Mem.fresh_block_alloc</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_swap">sep_swap</a></span> <span class="kwd">in</span> <span class="id">SEP</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_swap">sep_swap</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#stack_contents_change_meminj">stack_contents_change_meminj</a></span>; <span class="tactic">eauto</span>.<br/>
<br/>
- <span class="comment">(*&nbsp;external&nbsp;function&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">GENVINJ</span>: <span class="id">m</span>'0 |= <span class="id"><a href="compcert.common.Separation.html#globalenv_inject">globalenv_inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.ge">ge</a></span> <span class="id">j</span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj2">sep_proj2</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj2">sep_proj2</a></span>. <span class="id">eexact</span> <span class="id">SEP</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">PRES_GLB</span>: <span class="id"><a href="compcert.common.Events.html#meminj_preserves_globals">meminj_preserves_globals</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.ge">ge</a></span> <span class="id">j</span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Separation.html#globalenv_inject_preserves_globals">globalenv_inject_preserves_globals</a></span>. <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">INJECT</span>: <span class="id"><a href="compcert.common.Memory.html#Mem.inject">Mem.inject</a></span> <span class="id">j</span> <span class="id">m</span> <span class="id">m</span>'0). { <span class="tactic">eapply</span> <span class="id">SEP</span>. }<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Stackingproof.html#functions_translated">functions_translated</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">tf</span> &amp; <span class="id">FIND</span> &amp; <span class="id">TRANSL</span>).<br/>
&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">fptr</span> = <span class="id">tfptr</span> /\ <span class="id">exists</span> <span class="id">fb</span>, <span class="id">fptr</span> = <span class="id"><a href="compcert.common.Values.html#Vptr">Vptr</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#fb">fb</a></span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.zero">Ptrofs.zero</a></span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">repeat</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj2">sep_proj2</a></span> <span class="kwd">in</span> <span class="id">SEP</span>. <span class="id">inv</span> <span class="id">SEP</span>. <span class="id">des</span>. <span class="id">inv</span> <span class="id">H1</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_funct">Genv.find_funct</a></span> <span class="kwd">in</span> *. <span class="id">des_ifs</span>. <span class="id">inv</span> <span class="id">FPTR0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> <span class="id">FUNCTIONS</span>; <span class="tactic">eauto</span>. <span class="id">i</span>. <span class="id">exploit</span> <span class="id">DOMAIN</span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">des</span>. <span class="id">clarify</span>. <span class="id">esplits</span>; <span class="tactic">eauto</span>. } <span class="id">des</span>. <span class="id">clarify</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">TRANSL</span>. <span class="tactic">inversion</span> <span class="id">TRANSL</span>; <span class="tactic">subst</span> <span class="id">tf</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Lineartyping.html#wt_callstate_agree">wt_callstate_agree</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">AGCS</span> <span class="id">AGARGS</span>].<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Stackingproof.html#transl_external_arguments">transl_external_arguments</a></span>; <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Separation.html#sep_proj1">sep_proj1</a></span> <span class="kwd">in</span> <span class="id">SEP</span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">vl</span> [<span class="id">ARGS</span> <span class="id">VINJ</span>]].<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_comm">sep_comm</a></span>, <span class="id"><a href="compcert.common.Separation.html#sep_assoc">sep_assoc</a></span> <span class="kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Separation.html#external_call_parallel_rule">external_call_parallel_rule</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#match_stacks_symbols_inject">match_stacks_symbols_inject</a></span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">j</span>' &amp; <span class="id">res</span>' &amp; <span class="id">m1</span>' &amp; <span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span> &amp; <span class="id">D</span> &amp; <span class="id">E</span> &amp; <span class="id">F</span> &amp; <span class="id">G</span>).<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Mach.html#exec_function_external">exec_function_external</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.SimMemInj.html#external_call">SimMemInj.external_call</a></span>; <span class="tactic">try</span> <span class="tactic">by</span> (<span class="id">inv</span> <span class="id">MCOMPAT</span>; <span class="tactic">eauto</span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id">C</span>. } <span class="id">i</span>; <span class="id">des</span>. <span class="id">SimMemInj.spl_exact</span> <span class="id">sm1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#match_states_return">match_states_return</a></span> <span class="kwd">with</span> (<span class="id">j</span> := <span class="id">j</span>').<br/>
&nbsp;&nbsp;<span class="id">SimMemInj.compat_tac</span>.<br/>
&nbsp;&nbsp;{ <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">MCOMPAT</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">SAME</span>: <span class="kwd">forall</span> (<span class="id">b0</span> <span class="id">b2</span> : <span class="id"><a href="compcert.common.Values.html#block">block</a></span>) (<span class="id">delta</span> : <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.common.Memory.html#Mem.valid_block">Mem.valid_block</a></span> (<span class="id"><a href="compcert.common.SimMemInj.html#tgt">SimMemInj.tgt</a></span> <span class="id">sm0</span>) <span class="id"><a href="compcert.backend.Stackingproof.html#b2">b2</a></span> -&gt; (<span class="id"><a href="compcert.common.SimMemInj.html#inj">SimMemInj.inj</a></span> <span class="id">sm1</span>) <span class="id"><a href="compcert.backend.Stackingproof.html#b0">b0</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#b2">b2</a></span>, <span class="id"><a href="compcert.backend.Stackingproof.html#delta">delta</a></span>) -&gt; <span class="id"><a href="compcert.common.SimMemInj.html#inj">SimMemInj.inj</a></span> <span class="id">sm0</span> <span class="id"><a href="compcert.backend.Stackingproof.html#b0">b0</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#b2">b2</a></span>, <span class="id"><a href="compcert.backend.Stackingproof.html#delta">delta</a></span>)).<br/>
&nbsp;&nbsp;{ <span class="id">ii</span>. <span class="id">ss</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.SimMemInj.html#frozen_preserves_tgt">SimMemInj.frozen_preserves_tgt</a></span>; <span class="tactic">try</span> (<span class="id">erewrite</span> &lt;- <span class="id"><a href="compcert.common.SimMemInj.html#inject_separated_frozen">SimMemInj.inject_separated_frozen</a></span>; <span class="tactic">eauto</span>); <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#match_stacks_change_meminj">match_stacks_change_meminj</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;{ <span class="id">i</span>. <span class="tactic">apply</span> <span class="id">SAME</span>; <span class="tactic">eauto</span>. <span class="id">ss</span>. <span class="id">des</span>. <span class="id">inv</span> <span class="id">GENVINJ0</span>. <span class="id">inv</span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.SECOMPATSRC">SECOMPATSRC</a></span>. <span class="tactic">rewrite</span> <span class="id">NB</span> <span class="kwd">in</span> *. <span class="id">exploit</span> <span class="id">DOMAIN</span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">clarify</span>. <span class="id">exploit</span> <span class="id">D</span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">clarify</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.common.Memory.html#Mem.valid_block">Mem.valid_block</a></span>. <span class="id">xomega</span>. }<br/>
&nbsp;&nbsp;{ <span class="id">i</span>. <span class="tactic">apply</span> <span class="id">SAME</span>; <span class="tactic">eauto</span>. <span class="id">ss</span>. <span class="id">des</span>. <span class="id">inv</span> <span class="id">GENVINJ0</span>. <span class="id">inv</span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.SECOMPATTGT">SECOMPATTGT</a></span>. <span class="tactic">rewrite</span> <span class="id">NB</span> <span class="kwd">in</span> *. <span class="id">inv</span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.MATCH_GENV">MATCH_GENV</a></span>. <span class="tactic">rewrite</span> <span class="id">mge_next</span> <span class="kwd">in</span> *. <span class="id">exploit</span> <span class="id">DOMAIN</span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">clarify</span>. <span class="id">exploit</span> <span class="id">D</span>; <span class="tactic">eauto</span>. <span class="id">i</span>; <span class="id">clarify</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.common.Memory.html#Mem.valid_block">Mem.valid_block</a></span>. <span class="id">xomega</span>. }<br/>
&nbsp;&nbsp;{ <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#match_stacks_le">match_stacks_le</a></span>; <span class="tactic">eauto</span>; <span class="tactic">try</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ii</span>. <span class="id">ss</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Events.html#external_call_max_perm">external_call_max_perm</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Memory.html#Mem.valid_block_inject_1">Mem.valid_block_inject_1</a></span>; <span class="tactic">try</span> <span class="tactic">eapply</span> <span class="id">SAME</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs_set_pair">agree_regs_set_pair</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs_undef_caller_save_regs">agree_regs_undef_caller_save_regs</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_regs_inject_incr">agree_regs_inject_incr</a></span> <span class="kwd">with</span> <span class="id">j</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_callee_save_regs_set_result">agree_callee_save_regs_set_result</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_callee_save_regs_after">agree_callee_save_regs_after</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#stack_contents_change_meminj">stack_contents_change_meminj</a></span> <span class="kwd">with</span> <span class="id">j</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_comm">sep_comm</a></span>, <span class="id"><a href="compcert.common.Separation.html#sep_assoc">sep_assoc</a></span>; <span class="tactic">auto</span>.<br/>
<br/>
- <span class="comment">(*&nbsp;return&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">STACKS</span>; <span class="id">exploit</span> <span class="id"><a href="compcert.backend.Lineartyping.html#wt_returnstate_agree">wt_returnstate_agree</a></span>; <span class="tactic">eauto</span>; <span class="tactic">intros</span> [<span class="id">AGCS</span> <span class="id">OUTU</span>].<br/>
&nbsp;&nbsp;{ <span class="tactic">rewrite</span> <span class="id">MAINARGS</span> <span class="kwd">in</span> *. <span class="id">ss</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">AGCS</span>. <span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Mach.html#exec_return">exec_return</a></span>. <span class="id">SimMemInj.spl</span>. <span class="id">econs</span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">assert</span>(<span class="id">SEP0</span>: <span class="id">m</span>' |= <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents">frame_contents</a></span> <span class="id">f</span> <span class="id">j</span> <span class="id">sp</span>' <span class="id">rs0</span> (<span class="id"><a href="compcert.backend.Linear.html#parent_locset">parent_locset</a></span> <span class="id">s</span>) (<span class="id"><a href="compcert.backend.Mach.html#parent_sp">parent_sp</a></span> <span class="id">cs</span>'0) (<span class="id"><a href="compcert.backend.Mach.html#parent_ra">parent_ra</a></span> <span class="id">cs</span>'0) **<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">stack_contents</span> <span class="id">j</span> <span class="id">s</span> <span class="id">cs</span>'0 ** <span class="id"><a href="compcert.common.Separation.html#minjection">minjection</a></span> <span class="id">j</span> <span class="id">m</span> ** <span class="id"><a href="compcert.common.Separation.html#globalenv_inject">globalenv_inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA.ge">ge</a></span> <span class="id">j</span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">destruct</span> <span class="id"><a href="compcert.backend.Conventions.html#main_args">main_args</a></span> <span class="id">eqn</span>:<span class="id">MAINARGS</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">AGCS</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">SEP</span>. <span class="id">ss</span>. <span class="id">des_ifs</span>; <span class="tactic">try</span> (<span class="tactic">by</span> (<span class="id">inv</span> <span class="id">STK</span>; <span class="id">clarify</span>; <span class="id">inv</span> <span class="id">MAINARGS0</span>)). <span class="tactic">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_assoc">sep_assoc</a></span> <span class="kwd">in</span> <span class="id">SEP</span>. <span class="id">ss</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">AGCS</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">SEP</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_assoc">sep_assoc</a></span> <span class="kwd">in</span> <span class="id">SEP</span>.<br/>
&nbsp;&nbsp;<span class="id">ss</span>. }<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.common.Smallstep.html#plus_one">plus_one</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Mach.html#exec_return">exec_return</a></span>.<br/>
&nbsp;&nbsp;<span class="id">SimMemInj.spl</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#agree_locs_return">agree_locs_return</a></span> <span class="kwd">with</span> <span class="id">rs0</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#frame_contents_exten">frame_contents_exten</a></span> <span class="kwd">with</span> <span class="id">rs0</span> (<span class="id"><a href="compcert.backend.Linear.html#parent_locset">parent_locset</a></span> <span class="id">s</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Values.html#Val.lessdef_same">Val.lessdef_same</a></span>; <span class="tactic">apply</span> <span class="id">AGCS</span>; <span class="tactic">red</span>; <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">rewrite</span> (<span class="id">OUTU</span> <span class="id">ty</span> <span class="id">ofs</span>); <span class="tactic">auto</span>.<br/>
<span class="id">Unshelve</span>.<br/>
&nbsp;&nbsp;<span class="id">all</span>: <span class="tactic">by</span> (<span class="tactic">try</span> <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.SimMemInj.html#inject_separated_frozen">SimMemInj.inject_separated_frozen</a></span>; <span class="tactic">eauto</span>).<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.CORELEMMA">CORELEMMA</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="PRESERVATION.WHOLE">WHOLE</a></span>.<br/>
<br/>
<span class="kwd">Local</span> <span class="id">Existing</span> <span class="kwd">Instance</span> <span class="id">main_args_none</span>.<br/>
<span class="kwd">Let</span> <span class="id"><a name="PRESERVATION.WHOLE.ge">ge</a></span> := <span class="id"><a href="compcert.common.Globalenvs.html#Genv.globalenv">Genv.globalenv</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.prog">prog</a></span>.<br/>
<span class="kwd">Let</span> <span class="id"><a name="PRESERVATION.WHOLE.tge">tge</a></span> := <span class="id"><a href="compcert.common.Globalenvs.html#Genv.globalenv">Genv.globalenv</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.tprog">tprog</a></span>.<br/>
<span class="kwd">Let</span> <span class="id"><a name="PRESERVATION.WHOLE.match_states">match_states</a></span> := <span class="id"><a href="compcert.backend.Stackingproof.html#match_states">match_states</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.WHOLE.ge">ge</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.WHOLE.tge">tge</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.WHOLE.ge">ge</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.WHOLE.tge">tge</a></span>.<br/>
<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="PRESERVATION.WHOLE.return_address_offset_exists">return_address_offset_exists</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">f</span> <span class="id">sg</span> <span class="id">ros</span> <span class="id">c</span> <span class="id">v</span> (<span class="id">FUNCT</span>: <span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_funct">Genv.find_funct</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.WHOLE.tge">tge</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#v">v</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="compcert.common.AST.html#Internal">Internal</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f">f</a></span>)),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#is_tail">is_tail</a></span> (<span class="id"><a href="compcert.backend.Mach.html#Mcall">Mcall</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sg">sg</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ros">ros</a></span> :: <span class="id"><a href="compcert.backend.Stackingproof.html#c">c</a></span>) (<span class="id"><a href="compcert.backend.Mach.html#fn_code">fn_code</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f">f</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">ofs</span>, <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.return_address_offset">return_address_offset</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f">f</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#c">c</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#ofs">ofs</a></span>.<br/>
<br/>
<span class="kwd">Let</span> <span class="id"><a name="PRESERVATION.WHOLE.MATCH_GENV">MATCH_GENV</a></span>: <span class="id"><a href="compcert.common.Globalenvs.html#Genv.match_genvs">Genv.match_genvs</a></span> (<span class="id"><a href="compcert.common.Linking.html#match_globdef">match_globdef</a></span> (<span class="kwd">fun</span> <span class="id">_</span> <span class="id">f</span> <span class="id">tf</span> =&gt; <span class="id"><a href="compcert.backend.Stacking.html#transf_fundef">transf_fundef</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#f">f</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#tf">tf</a></span>) <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#eq">eq</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.prog">prog</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.WHOLE.ge">ge</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.WHOLE.tge">tge</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4087')">Proof.</div>
<div class="proofscript" id="proof4087">
 <span class="tactic">apply</span> <span class="id"><a href="compcert.common.Globalenvs.html#Genv.globalenvs_match">Genv.globalenvs_match</a></span>; <span class="tactic">eauto</span>. Qed.</div>
<br/>
<span class="kwd">Local</span> <span class="id">Opaque</span> <span class="id"><a href="compcert.common.Separation.html#sepconj">sepconj</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="transf_initial_states">transf_initial_states</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">st1</span>, <span class="id"><a href="compcert.backend.Linear.html#initial_state">Linear.initial_state</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.prog">prog</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#st1">st1</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">st2</span>, <span class="id"><a href="compcert.backend.Mach.html#initial_state">Mach.initial_state</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.tprog">tprog</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#st2">st2</a></span> /\ <span class="id">exists</span> <span class="id">sm</span>, <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.WHOLE.match_states">match_states</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#st1">st1</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#st2">st2</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sm">sm</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4088')">Proof.</div>
<div class="proofscript" id="proof4088">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> (<span class="id"><a href="compcert.common.Globalenvs.html#Genv.init_mem_transf_partial">Genv.init_mem_transf_partial</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.TRANSF">TRANSF</a></span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> (<span class="id"><a href="compcert.common.Linking.html#match_program_main">match_program_main</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.TRANSF">TRANSF</a></span>).<br/>
&nbsp;&nbsp;<span class="id">erewrite</span> <span class="id"><a href="compcert.backend.Stackingproof.html#symbols_preserved">symbols_preserved</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">j</span> := <span class="id"><a href="compcert.common.Memory.html#Mem.flat_inj">Mem.flat_inj</a></span> (<span class="id"><a href="compcert.common.Memory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">m0</span>)).<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="compcert.common.SimMemInj.html#mk">SimMemInj.mk</a></span> <span class="id">m0</span> <span class="id">m0</span> <span class="id">j</span> <span class="id">bot2</span> <span class="id">bot2</span> 1%<span class="id">positive</span> 1%<span class="id">positive</span> 1%<span class="id">positive</span> 1%<span class="id">positive</span>).<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#match_states_call">match_states_call</a></span> <span class="kwd">with</span> (<span class="id">j</span> := <span class="id">j</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;{ <span class="id">SimMemInj.compat_tac</span>. }<br/>
&nbsp;&nbsp;{ <span class="id">econs</span>; <span class="id">ss</span>; <span class="tactic">eauto</span>; <span class="tactic">try</span> <span class="id">xomega</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Globalenvs.html#Genv.initmem_inject">Genv.initmem_inject</a></span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="id">constructor</span>. <span class="id">ss</span>. { <span class="tactic">unfold</span> <span class="id">j</span>. <span class="id">erewrite</span> &lt;- <span class="id"><a href="compcert.common.Globalenvs.html#Genv.init_mem_genv_next">Genv.init_mem_genv_next</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> (<span class="id"><a href="compcert.common.Events.html#init_symbols_inject">init_symbols_inject</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.WHOLE.MATCH_GENV">MATCH_GENV</a></span>); <span class="tactic">eauto</span>. } <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;{ <span class="id">exploit</span> <span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_symbol_not_fresh">Genv.find_symbol_not_fresh</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intro</span> <span class="id">P</span>. <span class="tactic">unfold</span> <span class="id">j</span>, <span class="id"><a href="compcert.common.Memory.html#Mem.flat_inj">Mem.flat_inj</a></span>. <span class="id">econs</span>; <span class="id">ss</span>; <span class="tactic">eauto</span>; <span class="id">des_ifs</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.add_zero_l">Ptrofs.add_zero_l</a></span>; <span class="id">ss</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.common.Separation.html#sep_pure">sep_pure</a></span>. <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">split</span>;[|<span class="tactic">split</span>].<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Globalenvs.html#Genv.initmem_inject">Genv.initmem_inject</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="id">exists</span> (<span class="id"><a href="compcert.common.Memory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">m0</span>); <span class="id">splits</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#Ple_refl">Ple_refl</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">j</span>, <span class="id"><a href="compcert.common.Memory.html#Mem.flat_inj">Mem.flat_inj</a></span>; <span class="id">constructor</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#pred_dec_true">pred_dec_true</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#plt">plt</a></span> <span class="id">b1</span> (<span class="id"><a href="compcert.common.Memory.html#Mem.nextblock">Mem.nextblock</a></span> <span class="id">m0</span>)); <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">change</span> (<span class="id"><a href="compcert.common.Memory.html#Mem.valid_block">Mem.valid_block</a></span> <span class="id">m0</span> <span class="id">b0</span>). <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_symbol_not_fresh">Genv.find_symbol_not_fresh</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">change</span> (<span class="id"><a href="compcert.common.Memory.html#Mem.valid_block">Mem.valid_block</a></span> <span class="id">m0</span> <span class="id">b0</span>). <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_funct_ptr_not_fresh">Genv.find_funct_ptr_not_fresh</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">change</span> (<span class="id"><a href="compcert.common.Memory.html#Mem.valid_block">Mem.valid_block</a></span> <span class="id">m0</span> <span class="id">b0</span>). <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_var_info_not_fresh">Genv.find_var_info_not_fresh</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">erewrite</span> &lt;- <span class="id"><a href="compcert.common.Globalenvs.html#Genv.init_mem_genv_next">Genv.init_mem_genv_next</a></span>; <span class="tactic">eauto</span>. <span class="tactic">reflexivity</span>. <br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">simpl</span>; <span class="tactic">tauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="transf_final_states">transf_final_states</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">st1</span> <span class="id">st2</span> <span class="id">r</span>,<br/>
&nbsp;&nbsp;(<span class="id">exists</span> <span class="id">sm</span>, <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.WHOLE.match_states">match_states</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#st1">st1</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#st2">st2</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#sm">sm</a></span>)-&gt; <span class="id"><a href="compcert.backend.Linear.html#final_state">Linear.final_state</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#st1">st1</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span> -&gt; <span class="id"><a href="compcert.backend.Mach.html#final_state">Mach.final_state</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#st2">st2</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4089')">Proof.</div>
<div class="proofscript" id="proof4089">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">des</span>. <span class="id">inv</span> <span class="id">H0</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="id">inv</span> <span class="id">STACKS</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">R</span>: <span class="id">exists</span> <span class="id">r</span>, <span class="id"><a href="compcert.x86.Conventions1.html#loc_result">loc_result</a></span> <span class="id"><a href="compcert.common.AST.html#signature_main">signature_main</a></span> = <span class="id"><a href="compcert.common.AST.html#One">One</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#r">r</a></span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">destruct</span> (<span class="id"><a href="compcert.x86.Conventions1.html#loc_result">loc_result</a></span> <span class="id"><a href="compcert.common.AST.html#signature_main">signature_main</a></span>) <span class="kwd">as</span> [<span class="id">r1</span> | <span class="id">r1</span> <span class="id">r2</span>] <span class="id">eqn</span>:<span class="id">LR</span>.<br/>
&nbsp;&nbsp;- <span class="id">exists</span> <span class="id">r1</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">generalize</span> (<span class="id"><a href="compcert.x86.Conventions1.html#loc_result_type">loc_result_type</a></span> <span class="id"><a href="compcert.common.AST.html#signature_main">signature_main</a></span>). <span class="tactic">rewrite</span> <span class="id">LR</span>. <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">R</span> <span class="kwd">as</span> [<span class="id">rres</span> <span class="id">EQ</span>]. <span class="tactic">rewrite</span> <span class="id">EQ</span> <span class="kwd">in</span> <span class="id">H1</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">AGREGS</span> <span class="id">rres</span>). <span class="tactic">rewrite</span> <span class="id">H1</span>. <span class="tactic">intros</span> <span class="id">A</span>; <span class="id">inv</span> <span class="id">A</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="wt_prog">wt_prog</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">i</span> <span class="id">fd</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="compcert.backend.Stackingproof.html#i">i</a></span>, <span class="id"><a href="compcert.common.AST.html#Gfun">Gfun</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#fd">fd</a></span>) <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.prog">prog</a></span>.(<span class="id"><a href="compcert.common.AST.html#prog_defs">prog_defs</a></span>) -&gt; <span class="id"><a href="compcert.backend.Lineartyping.html#wt_fundef">wt_fundef</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#fd">fd</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4090')">Proof.</div>
<div class="proofscript" id="proof4090">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.lib.Coqlib.html#list_forall2_in_left">list_forall2_in_left</a></span>. <span class="id">eexact</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#proj1">proj1</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.TRANSF">TRANSF</a></span>). <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> ([<span class="id">i</span>' <span class="id">g</span>] &amp; <span class="id">P</span> &amp; <span class="id">Q</span> &amp; <span class="id">R</span>). <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="id">inv</span> <span class="id">R</span>. <span class="tactic">destruct</span> <span class="id">fd</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
- <span class="id">monadInv</span> <span class="id">H2</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Stacking.html#transf_function">transf_function</a></span> <span class="kwd">in</span> <span class="id">EQ</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.backend.Lineartyping.html#wt_function">wt_function</a></span> <span class="id">f</span>). <span class="tactic">auto</span>. <span class="tactic">discriminate</span>.<br/>
- <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="transf_program_correct">transf_program_correct</a></span>:<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Smallstep.html#forward_simulation">forward_simulation</a></span> (<span class="id"><a href="compcert.backend.Linear.html#semantics">Linear.semantics</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.prog">prog</a></span>) (<span class="id"><a href="compcert.backend.Mach.html#semantics">Mach.semantics</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.return_address_offset">return_address_offset</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.tprog">tprog</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof4091')">Proof.</div>
<div class="proofscript" id="proof4091">
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">ms</span> := <span class="kwd">fun</span> <span class="id">s</span> <span class="id">s</span>' =&gt; <span class="id"><a href="compcert.backend.Lineartyping.html#wt_state">wt_state</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#s">s</a></span> /\ <span class="id">exists</span> <span class="id">sm</span>, <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.WHOLE.match_states">match_states</a></span> <span class="id"><a href="compcert.backend.Stackingproof.html#s">s</a></span> <span class="id">s</span>' <span class="id"><a href="compcert.backend.Stackingproof.html#sm">sm</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Smallstep.html#forward_simulation_plus">forward_simulation_plus</a></span> <span class="kwd">with</span> (<span class="id">match_states</span> := <span class="id">ms</span>).<br/>
- <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#senv_preserved">senv_preserved</a></span>; <span class="tactic">auto</span>.<br/>
- <span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.backend.Stackingproof.html#transf_initial_states">transf_initial_states</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">st2</span> [<span class="id">A</span> <span class="id">B</span>]].<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">st2</span>; <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Lineartyping.html#wt_initial_state">wt_initial_state</a></span> <span class="kwd">with</span> (<span class="id">prog</span> := <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.prog">prog</a></span>); <span class="tactic">auto</span>.<br/>
- <span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Stackingproof.html#transf_final_states">transf_final_states</a></span>; <span class="tactic">eauto</span>.<br/>
- <span class="tactic">intros</span>. <span class="tactic">destruct</span> <span class="id">H0</span>. <span class="id">des</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Stackingproof.html#transf_step_correct">transf_step_correct</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">s2</span>' [<span class="id">A</span> <span class="id">B</span>]].<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">s2</span>'; <span class="tactic">split</span>. <span class="tactic">exact</span> <span class="id">A</span>. <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Lineartyping.html#step_type_preservation">step_type_preservation</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;{ <span class="id">ii</span>. <span class="id">ss</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Globalenvs.html#Genv.find_funct_inversion">Genv.find_funct_inversion</a></span>; <span class="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="id">eexact</span> <span class="id"><a href="compcert.backend.Stackingproof.html#wt_prog">wt_prog</a></span>. <span class="id">des</span>. <span class="id">esplits</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION.WHOLE">WHOLE</a></span>.<br/>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.backend.Stackingproof.html#PRESERVATION">PRESERVATION</a></span>.<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</div>
</body>
</html>
