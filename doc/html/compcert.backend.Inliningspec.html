
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module Inliningspec</title>
<meta name="description" content="Documentation of Coq module Inliningspec" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module Inliningspec</h1>
<div class="coq">
<br/>
<div class="doc">RTL function inlining: relational specification </div>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.lib.Coqlib.html">Coqlib</a></span> <span class="id"><a href="compcert.lib.Wfsimpl.html">Wfsimpl</a></span> <span class="id"><a href="compcert.lib.Maps.html">Maps</a></span> <span class="id"><a href="compcert.common.Errors.html">Errors</a></span> <span class="id"><a href="compcert.lib.Integers.html">Integers</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.common.AST.html">AST</a></span> <span class="id"><a href="compcert.common.Linking.html">Linking</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.x86.Op.html">Op</a></span> <span class="id"><a href="compcert.backend.Registers.html">Registers</a></span> <span class="id"><a href="compcert.backend.RTL.html">RTL</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.backend.Inlining.html">Inlining</a></span>.<br/>
<br/>
<h2> Soundness of function environments. </h2>
<br/>
<div class="doc">A compile-time function environment is compatible with a whole
  program if the following condition holds. </div>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="fenv_compat">fenv_compat</a></span> (<span class="id">p</span>: <span class="id"><a href="compcert.backend.RTL.html#program">program</a></span>) (<span class="id">fenv</span>: <span class="id"><a href="compcert.backend.Inlining.html#funenv">funenv</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">id</span> <span class="id">f</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#fenv">fenv</a></span>!<span class="id"><a href="compcert.backend.Inliningspec.html#id">id</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#f">f</a></span> -&gt; (<span class="id"><a href="compcert.common.AST.html#prog_defmap">prog_defmap</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#p">p</a></span>)!<span class="id"><a href="compcert.backend.Inliningspec.html#id">id</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="compcert.common.AST.html#Gfun">Gfun</a></span> (<span class="id"><a href="compcert.common.AST.html#Internal">Internal</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#f">f</a></span>)).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="funenv_program_compat">funenv_program_compat</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">p</span>, <span class="id"><a href="compcert.backend.Inliningspec.html#fenv_compat">fenv_compat</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#p">p</a></span> (<span class="id"><a href="compcert.backend.Inlining.html#funenv_program">funenv_program</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#p">p</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2719')">Proof.</div>
<div class="proofscript" id="proof2719">
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">P</span> := <span class="kwd">fun</span> (<span class="id">dm</span>: <span class="id"><a href="compcert.lib.Maps.html#PTree.t">PTree.t</a></span> (<span class="id"><a href="compcert.common.AST.html#globdef">globdef</a></span> <span class="id"><a href="compcert.backend.RTL.html#fundef">fundef</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#unit">unit</a></span>)) (<span class="id">fenv</span>: <span class="id"><a href="compcert.backend.Inlining.html#funenv">funenv</a></span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">id</span> <span class="id">f</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#fenv">fenv</a></span>!<span class="id"><a href="compcert.backend.Inliningspec.html#id">id</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#f">f</a></span> -&gt; <span class="id"><a href="compcert.backend.Inliningspec.html#dm">dm</a></span>!<span class="id"><a href="compcert.backend.Inliningspec.html#id">id</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="compcert.common.AST.html#Gfun">Gfun</a></span> (<span class="id"><a href="compcert.common.AST.html#Internal">Internal</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#f">f</a></span>))).<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">REMOVE</span>: <span class="kwd">forall</span> <span class="id">dm</span> <span class="id">fenv</span> <span class="id">id</span> <span class="id">g</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> <span class="id"><a href="compcert.backend.Inliningspec.html#dm">dm</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#fenv">fenv</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="compcert.lib.Maps.html#PTree.set">PTree.set</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#id">id</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#g">g</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#dm">dm</a></span>) (<span class="id"><a href="compcert.lib.Maps.html#PTree.remove">PTree.remove</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#id">id</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#fenv">fenv</a></span>)).<br/>
&nbsp;&nbsp;{ <span class="tactic">unfold</span> <span class="id">P</span>; <span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Maps.html#PTree.grspec">PTree.grspec</a></span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Maps.html#PTree.elt_eq">PTree.elt_eq</a></span> <span class="id">id0</span> <span class="id">id</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Maps.html#PTree.gso">PTree.gso</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">ADD</span>: <span class="kwd">forall</span> <span class="id">io</span> <span class="id">dm</span> <span class="id">fenv</span> <span class="id">idg</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> <span class="id"><a href="compcert.backend.Inliningspec.html#dm">dm</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#fenv">fenv</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="compcert.lib.Maps.html#PTree.set">PTree.set</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#idg">idg</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#idg">idg</a></span>) <span class="id"><a href="compcert.backend.Inliningspec.html#dm">dm</a></span>) (<span class="id"><a href="compcert.backend.Inlining.html#add_globdef">add_globdef</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#io">io</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#fenv">fenv</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#idg">idg</a></span>)).<br/>
&nbsp;&nbsp;{ <span class="tactic">intros</span> <span class="id">io</span> <span class="id">dm</span> <span class="id">fenv</span> [<span class="id">id</span> <span class="id">g</span>]; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">g</span> <span class="kwd">as</span> [ [<span class="id">f</span>|<span class="id">ef</span>] | <span class="id">v</span>]; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.backend.Inlining.html#should_inline">should_inline</a></span> <span class="id">io</span> <span class="id">id</span> <span class="id">f</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">rewrite</span> ! <span class="id"><a href="compcert.lib.Maps.html#PTree.gsspec">PTree.gsspec</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#peq">peq</a></span> <span class="id">id0</span> <span class="id">id</span>); <span class="tactic">auto</span>. <span class="id">inv</span> <span class="id">H0</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">REC</span>: <span class="kwd">forall</span> <span class="id">p</span> <span class="id">l</span> <span class="id">dm</span> <span class="id">fenv</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> <span class="id"><a href="compcert.backend.Inliningspec.html#dm">dm</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#fenv">fenv</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">P</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_left">fold_left</a></span> (<span class="kwd">fun</span> <span class="id">x</span> <span class="id">idg</span> =&gt; <span class="id"><a href="compcert.lib.Maps.html#PTree.set">PTree.set</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#idg">idg</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#idg">idg</a></span>) <span class="id"><a href="compcert.backend.Inliningspec.html#x">x</a></span>) <span class="id"><a href="compcert.backend.Inliningspec.html#l">l</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#dm">dm</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_left">fold_left</a></span> (<span class="id"><a href="compcert.backend.Inlining.html#add_globdef">add_globdef</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#p">p</a></span>) <span class="id"><a href="compcert.backend.Inliningspec.html#l">l</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#fenv">fenv</a></span>)).<br/>
&nbsp;&nbsp;{ <span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="tactic">apply</span> <span class="id">IHl</span>. <span class="tactic">apply</span> <span class="id">ADD</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id">REC</span>. <span class="tactic">red</span>; <span class="tactic">intros</span>.  <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Maps.html#PTree.gempty">PTree.gempty</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">discriminate</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="fenv_compat_linkorder">fenv_compat_linkorder</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">cunit</span> <span class="id">prog</span> <span class="id">fenv</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#linkorder">linkorder</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#cunit">cunit</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#prog">prog</a></span> -&gt; <span class="id"><a href="compcert.backend.Inliningspec.html#fenv_compat">fenv_compat</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#cunit">cunit</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#fenv">fenv</a></span> -&gt; <span class="id"><a href="compcert.backend.Inliningspec.html#fenv_compat">fenv_compat</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#prog">prog</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#fenv">fenv</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2720')">Proof.</div>
<div class="proofscript" id="proof2720">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id">H0</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.common.Linking.html#prog_defmap_linkorder">prog_defmap_linkorder</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">H</span> <span class="id">H1</span>) <span class="kwd">as</span> (<span class="id">gd</span>' &amp; <span class="id">P</span> &amp; <span class="id">Q</span>).<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Q</span>. <span class="id">inv</span> <span class="id">H3</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<h2> Properties of shifting </h2>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="shiftpos_eq">shiftpos_eq</a></span>: <span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Zpos">Zpos</a></span> (<span class="id"><a href="compcert.backend.Inlining.html#shiftpos">shiftpos</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#x">x</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#y">y</a></span>) = (<span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Zpos">Zpos</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#x">x</a></span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Zpos">Zpos</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#y">y</a></span>) - 1.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2721')">Proof.</div>
<div class="proofscript" id="proof2721">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Inlining.html#shiftpos">shiftpos</a></span>. <span class="id">zify</span>.  <span class="tactic">try</span> <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Pos2Z.inj_sub">Pos2Z.inj_sub</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">zify</span>. <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="shiftpos_inj">shiftpos_inj</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span> <span class="id">n</span>, <span class="id"><a href="compcert.backend.Inlining.html#shiftpos">shiftpos</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#x">x</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#n">n</a></span> = <span class="id"><a href="compcert.backend.Inlining.html#shiftpos">shiftpos</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#y">y</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#n">n</a></span> -&gt; <span class="id"><a href="compcert.backend.Inliningspec.html#x">x</a></span> = <span class="id"><a href="compcert.backend.Inliningspec.html#y">y</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2722')">Proof.</div>
<div class="proofscript" id="proof2722">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Zpos">Zpos</a></span> (<span class="id"><a href="compcert.backend.Inlining.html#shiftpos">shiftpos</a></span> <span class="id">x</span> <span class="id">n</span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Zpos">Zpos</a></span> (<span class="id"><a href="compcert.backend.Inlining.html#shiftpos">shiftpos</a></span> <span class="id">y</span> <span class="id">n</span>)) <span class="tactic">by</span> <span class="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> ! <span class="id"><a href="compcert.backend.Inliningspec.html#shiftpos_eq">shiftpos_eq</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pos">Z.pos</a></span> <span class="id">x</span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.pos">Z.pos</a></span> <span class="id">y</span>) <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">congruence</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="shiftpos_diff">shiftpos_diff</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span> <span class="id">n</span>, <span class="id"><a href="compcert.backend.Inliningspec.html#x">x</a></span> &lt;&gt; <span class="id"><a href="compcert.backend.Inliningspec.html#y">y</a></span> -&gt; <span class="id"><a href="compcert.backend.Inlining.html#shiftpos">shiftpos</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#x">x</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#n">n</a></span> &lt;&gt; <span class="id"><a href="compcert.backend.Inlining.html#shiftpos">shiftpos</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#y">y</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#n">n</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2723')">Proof.</div>
<div class="proofscript" id="proof2723">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">elim</span> <span class="id">H</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningspec.html#shiftpos_inj">shiftpos_inj</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="shiftpos_above">shiftpos_above</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">n</span>, <span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#n">n</a></span> (<span class="id"><a href="compcert.backend.Inlining.html#shiftpos">shiftpos</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#x">x</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#n">n</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2724')">Proof.</div>
<div class="proofscript" id="proof2724">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span>; <span class="id">zify</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Inliningspec.html#shiftpos_eq">shiftpos_eq</a></span>. <span class="id">xomega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="shiftpos_not_below">shiftpos_not_below</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">n</span>, <span class="id"><a href="compcert.lib.Coqlib.html#Plt">Plt</a></span> (<span class="id"><a href="compcert.backend.Inlining.html#shiftpos">shiftpos</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#x">x</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#n">n</a></span>) <span class="id"><a href="compcert.backend.Inliningspec.html#n">n</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#False">False</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2725')">Proof.</div>
<div class="proofscript" id="proof2725">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">generalize</span> (<span class="id"><a href="compcert.backend.Inliningspec.html#shiftpos_above">shiftpos_above</a></span> <span class="id">x</span> <span class="id">n</span>). <span class="id">xomega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="shiftpos_below">shiftpos_below</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">n</span>, <span class="id"><a href="compcert.lib.Coqlib.html#Plt">Plt</a></span> (<span class="id"><a href="compcert.backend.Inlining.html#shiftpos">shiftpos</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#x">x</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#n">n</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.add">Pos.add</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#x">x</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#n">n</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2726')">Proof.</div>
<div class="proofscript" id="proof2726">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.lib.Coqlib.html#Plt">Plt</a></span>; <span class="id">zify</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.backend.Inliningspec.html#shiftpos_eq">shiftpos_eq</a></span>. <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="shiftpos_le">shiftpos_le</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span> <span class="id">n</span>, <span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#x">x</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#y">y</a></span> -&gt; <span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> (<span class="id"><a href="compcert.backend.Inlining.html#shiftpos">shiftpos</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#x">x</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#n">n</a></span>) (<span class="id"><a href="compcert.backend.Inlining.html#shiftpos">shiftpos</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#y">y</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#n">n</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2727')">Proof.</div>
<div class="proofscript" id="proof2727">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> <span class="kwd">in</span> *; <span class="id">zify</span>. <span class="tactic">rewrite</span> ! <span class="id"><a href="compcert.backend.Inliningspec.html#shiftpos_eq">shiftpos_eq</a></span>. <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<br/>
<h2> Working with the state monad </h2>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="bind_inversion">bind_inversion</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">A</span> <span class="id">B</span>: <span class="kwd">Type</span>) (<span class="id">f</span>: <span class="id"><a href="compcert.backend.Inlining.html#mon">mon</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#A">A</a></span>) (<span class="id">g</span>: <span class="id"><a href="compcert.backend.Inliningspec.html#A">A</a></span> -&gt; <span class="id"><a href="compcert.backend.Inlining.html#mon">mon</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#B">B</a></span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">y</span>: <span class="id"><a href="compcert.backend.Inliningspec.html#B">B</a></span>) (<span class="id">s1</span> <span class="id">s3</span>: <span class="id"><a href="compcert.backend.Inlining.html#state">state</a></span>) (<span class="id">i</span>: <span class="id"><a href="compcert.backend.Inlining.html#sincr">sincr</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#s1">s1</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#s3">s3</a></span>),<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inlining.html#bind">bind</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#f">f</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#g">g</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#s1">s1</a></span> = <span class="id"><a href="compcert.backend.Inlining.html#R">R</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#y">y</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#s3">s3</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#i">i</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">x</span>, <span class="id">exists</span> <span class="id">s2</span>, <span class="id">exists</span> <span class="id">i1</span>, <span class="id">exists</span> <span class="id">i2</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#f">f</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#s1">s1</a></span> = <span class="id"><a href="compcert.backend.Inlining.html#R">R</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#x">x</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#s2">s2</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#i1">i1</a></span> /\ <span class="id"><a href="compcert.backend.Inliningspec.html#g">g</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#x">x</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#s2">s2</a></span> = <span class="id"><a href="compcert.backend.Inlining.html#R">R</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#y">y</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#s3">s3</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#i2">i2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2728')">Proof.</div>
<div class="proofscript" id="proof2728">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Inlining.html#bind">bind</a></span>; <span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id">f</span> <span class="id">s1</span>). <span class="id">exists</span> <span class="id">x</span>; <span class="id">exists</span> <span class="id">s</span>'; <span class="id">exists</span> <span class="id">I</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">g</span> <span class="id">x</span> <span class="id">s</span>'). <span class="id">inv</span> <span class="id">H</span>. <span class="id">exists</span> <span class="id">I0</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Ltac</span> <span class="id">monadInv1</span> <span class="id">H</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">type</span> <span class="id">of</span> <span class="id">H</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| (<span class="id"><a href="compcert.backend.Inlining.html#R">R</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> = <span class="id"><a href="compcert.backend.Inlining.html#R">R</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">clear</span> <span class="id">H</span>; <span class="tactic">try</span> <span class="tactic">subst</span><br/>
&nbsp;&nbsp;| (<span class="id"><a href="compcert.backend.Inlining.html#ret">ret</a></span> <span class="id">_</span> <span class="id">_</span> = <span class="id"><a href="compcert.backend.Inlining.html#R">R</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">H</span>; <span class="tactic">clear</span> <span class="id">H</span>; <span class="tactic">try</span> <span class="tactic">subst</span><br/>
&nbsp;&nbsp;| (<span class="id"><a href="compcert.backend.Inlining.html#bind">bind</a></span> ?<span class="id">F</span> ?<span class="id">G</span> ?<span class="id">S</span> = <span class="id"><a href="compcert.backend.Inlining.html#R">R</a></span> ?<span class="id">X</span> ?<span class="id">S</span>' ?<span class="id">I</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">x</span> := <span class="tactic">fresh</span> "<span class="id">x</span>" <span class="kwd">in</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">s</span> := <span class="tactic">fresh</span> "<span class="id">s</span>" <span class="kwd">in</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">i1</span> := <span class="tactic">fresh</span> "<span class="id">INCR</span>" <span class="kwd">in</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">i2</span> := <span class="tactic">fresh</span> "<span class="id">INCR</span>" <span class="kwd">in</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">EQ1</span> := <span class="tactic">fresh</span> "<span class="id">EQ</span>" <span class="kwd">in</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">let</span> <span class="id">EQ2</span> := <span class="tactic">fresh</span> "<span class="id">EQ</span>" <span class="kwd">in</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.backend.Inliningspec.html#bind_inversion">bind_inversion</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">F</span> <span class="id">G</span> <span class="id">X</span> <span class="id">S</span> <span class="id">S</span>' <span class="id">I</span> <span class="id">H</span>) <span class="kwd">as</span> [<span class="id">x</span> [<span class="id">s</span> [<span class="id">i1</span> [<span class="id">i2</span> [<span class="id">EQ1</span> <span class="id">EQ2</span>]]]]];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">clear</span> <span class="id">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">try</span> (<span class="id">monadInv1</span> <span class="id">EQ2</span>)))))))<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Ltac</span> <span class="id">monadInv</span> <span class="id">H</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">type</span> <span class="id">of</span> <span class="id">H</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| (<span class="id"><a href="compcert.backend.Inlining.html#ret">ret</a></span> <span class="id">_</span> <span class="id">_</span> = <span class="id"><a href="compcert.backend.Inlining.html#R">R</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) =&gt; <span class="id">monadInv1</span> <span class="id">H</span><br/>
&nbsp;&nbsp;| (<span class="id"><a href="compcert.backend.Inlining.html#bind">bind</a></span> ?<span class="id">F</span> ?<span class="id">G</span> ?<span class="id">S</span> = <span class="id"><a href="compcert.backend.Inlining.html#R">R</a></span> ?<span class="id">X</span> ?<span class="id">S</span>' ?<span class="id">I</span>) =&gt; <span class="id">monadInv1</span> <span class="id">H</span><br/>
&nbsp;&nbsp;| (?<span class="id">F</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> = <span class="id"><a href="compcert.backend.Inlining.html#R">R</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="tactic">progress</span> <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>) || <span class="tactic">unfold</span> <span class="id">F</span> <span class="kwd">in</span> <span class="id">H</span>); <span class="id">monadInv1</span> <span class="id">H</span><br/>
&nbsp;&nbsp;| (?<span class="id">F</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> = <span class="id"><a href="compcert.backend.Inlining.html#R">R</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="tactic">progress</span> <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>) || <span class="tactic">unfold</span> <span class="id">F</span> <span class="kwd">in</span> <span class="id">H</span>); <span class="id">monadInv1</span> <span class="id">H</span><br/>
&nbsp;&nbsp;| (?<span class="id">F</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> = <span class="id"><a href="compcert.backend.Inlining.html#R">R</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="tactic">progress</span> <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>) || <span class="tactic">unfold</span> <span class="id">F</span> <span class="kwd">in</span> <span class="id">H</span>); <span class="id">monadInv1</span> <span class="id">H</span><br/>
&nbsp;&nbsp;| (?<span class="id">F</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> = <span class="id"><a href="compcert.backend.Inlining.html#R">R</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="tactic">progress</span> <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>) || <span class="tactic">unfold</span> <span class="id">F</span> <span class="kwd">in</span> <span class="id">H</span>); <span class="id">monadInv1</span> <span class="id">H</span><br/>
&nbsp;&nbsp;| (?<span class="id">F</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> = <span class="id"><a href="compcert.backend.Inlining.html#R">R</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="tactic">progress</span> <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>) || <span class="tactic">unfold</span> <span class="id">F</span> <span class="kwd">in</span> <span class="id">H</span>); <span class="id">monadInv1</span> <span class="id">H</span><br/>
&nbsp;&nbsp;| (?<span class="id">F</span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span> = <span class="id"><a href="compcert.backend.Inlining.html#R">R</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="tactic">progress</span> <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>) || <span class="tactic">unfold</span> <span class="id">F</span> <span class="kwd">in</span> <span class="id">H</span>); <span class="id">monadInv1</span> <span class="id">H</span><br/>
&nbsp;&nbsp;| (?<span class="id">F</span> <span class="id">_</span> <span class="id">_</span> = <span class="id"><a href="compcert.backend.Inlining.html#R">R</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="tactic">progress</span> <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>) || <span class="tactic">unfold</span> <span class="id">F</span> <span class="kwd">in</span> <span class="id">H</span>); <span class="id">monadInv1</span> <span class="id">H</span><br/>
&nbsp;&nbsp;| (?<span class="id">F</span> <span class="id">_</span> = <span class="id"><a href="compcert.backend.Inlining.html#R">R</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">_</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="tactic">progress</span> <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>) || <span class="tactic">unfold</span> <span class="id">F</span> <span class="kwd">in</span> <span class="id">H</span>); <span class="id">monadInv1</span> <span class="id">H</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Fixpoint</span> <span class="id"><a name="mlist_iter2">mlist_iter2</a></span> {<span class="id">A</span> <span class="id">B</span>: <span class="kwd">Type</span>} (<span class="id">f</span>: <span class="id"><a href="compcert.backend.Inliningspec.html#A">A</a></span> -&gt; <span class="id"><a href="compcert.backend.Inliningspec.html#B">B</a></span> -&gt; <span class="id"><a href="compcert.backend.Inlining.html#mon">mon</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#unit">unit</a></span>) (<span class="id">l</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> (<span class="id"><a href="compcert.backend.Inliningspec.html#A">A</a></span>*<span class="id"><a href="compcert.backend.Inliningspec.html#B">B</a></span>)): <span class="id"><a href="compcert.backend.Inlining.html#mon">mon</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#unit">unit</a></span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.backend.Inliningspec.html#l">l</a></span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> =&gt; <span class="id"><a href="compcert.backend.Inlining.html#ret">ret</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span><br/>
&nbsp;&nbsp;| (<span class="id">x</span>,<span class="id">y</span>) :: <span class="id">l</span>' =&gt; <span class="tactic">do</span> <span class="id">z</span> &lt;- <span class="id"><a href="compcert.backend.Inliningspec.html#f">f</a></span> <span class="id">x</span> <span class="id">y</span>; <span class="id"><a href="compcert.backend.Inliningspec.html#mlist_iter2">mlist_iter2</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#f">f</a></span> <span class="id">l</span>'<br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="mlist_iter2_fold">mlist_iter2_fold</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">A</span> <span class="id">B</span>: <span class="kwd">Type</span>) (<span class="id">f</span>: <span class="id"><a href="compcert.backend.Inliningspec.html#A">A</a></span> -&gt; <span class="id"><a href="compcert.backend.Inliningspec.html#B">B</a></span> -&gt; <span class="id"><a href="compcert.backend.Inlining.html#mon">mon</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#unit">unit</a></span>) <span class="id">l</span> <span class="id">s</span>,<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">i</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#mlist_iter2">mlist_iter2</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#f">f</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#l">l</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#s">s</a></span> =<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inlining.html#R">R</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_left">fold_left</a></span> (<span class="kwd">fun</span> <span class="id">a</span> <span class="id">p</span> =&gt; <span class="kwd">match</span> <span class="id"><a href="compcert.backend.Inliningspec.html#f">f</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#p">p</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#snd">snd</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#p">p</a></span>) <span class="id"><a href="compcert.backend.Inliningspec.html#a">a</a></span> <span class="kwd">with</span> <span class="id"><a href="compcert.backend.Inlining.html#R">R</a></span> <span class="id">_</span> <span class="id">s2</span> <span class="id">_</span> =&gt; <span class="id">s2</span> <span class="kwd">end</span>) <span class="id"><a href="compcert.backend.Inliningspec.html#l">l</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#s">s</a></span>) <span class="id"><a href="compcert.backend.Inliningspec.html#i">i</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2729')">Proof.</div>
<div class="proofscript" id="proof2729">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">exists</span> (<span class="id"><a href="compcert.backend.Inlining.html#sincr_refl">sincr_refl</a></span> <span class="id">s</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">a</span> <span class="kwd">as</span> [<span class="id">x</span> <span class="id">y</span>]. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Inlining.html#bind">bind</a></span>. <span class="tactic">simpl</span>. <span class="tactic">destruct</span> (<span class="id">f</span> <span class="id">x</span> <span class="id">y</span> <span class="id">s</span>) <span class="kwd">as</span> [<span class="id">xx</span> <span class="id">s1</span> <span class="id">i1</span>].<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id">IHl</span> <span class="id">s1</span>) <span class="kwd">as</span> [<span class="id">i2</span> <span class="id">EQ</span>]. <span class="tactic">rewrite</span> <span class="id">EQ</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="ptree_mfold_spec">ptree_mfold_spec</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> (<span class="id">A</span>: <span class="kwd">Type</span>) (<span class="id">f</span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#positive">positive</a></span> -&gt; <span class="id"><a href="compcert.backend.Inliningspec.html#A">A</a></span> -&gt; <span class="id"><a href="compcert.backend.Inlining.html#mon">mon</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#unit">unit</a></span>) <span class="id">t</span> <span class="id">s</span> <span class="id">x</span> <span class="id">s</span>' <span class="id">i</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inlining.html#ptree_mfold">ptree_mfold</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#f">f</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#t">t</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#s">s</a></span> = <span class="id"><a href="compcert.backend.Inlining.html#R">R</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#x">x</a></span> <span class="id">s</span>' <span class="id"><a href="compcert.backend.Inliningspec.html#i">i</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">i</span>', <span class="id"><a href="compcert.backend.Inliningspec.html#mlist_iter2">mlist_iter2</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#f">f</a></span> (<span class="id"><a href="compcert.lib.Maps.html#PTree.elements">PTree.elements</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#t">t</a></span>) <span class="id"><a href="compcert.backend.Inliningspec.html#s">s</a></span> = <span class="id"><a href="compcert.backend.Inlining.html#R">R</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span> <span class="id">s</span>' <span class="id">i</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2730')">Proof.</div>
<div class="proofscript" id="proof2730">
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.backend.Inliningspec.html#mlist_iter2_fold">mlist_iter2_fold</a></span> <span class="id">_</span> <span class="id">_</span> <span class="id">f</span> (<span class="id"><a href="compcert.lib.Maps.html#PTree.elements">PTree.elements</a></span> <span class="id">t</span>) <span class="id">s</span>) <span class="kwd">as</span> [<span class="id">i</span>' <span class="id">EQ</span>].<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Inlining.html#ptree_mfold">ptree_mfold</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="id">inv</span> <span class="id">H</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Maps.html#PTree.fold_spec">PTree.fold_spec</a></span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="id">eexact</span> <span class="id">EQ</span>.<br/>
Qed.</div>
<br/>
<h2> Relational specification of the translation of moves </h2>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="tr_moves">tr_moves</a></span> (<span class="id">c</span>: <span class="id"><a href="compcert.backend.RTL.html#code">code</a></span>) : <span class="id"><a href="compcert.backend.RTL.html#node">node</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.backend.Registers.html#reg">reg</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list">list</a></span> <span class="id"><a href="compcert.backend.Registers.html#reg">reg</a></span> -&gt; <span class="id"><a href="compcert.backend.RTL.html#node">node</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="tr_moves_cons">tr_moves_cons</a></span>: <span class="kwd">forall</span> <span class="id">pc1</span> <span class="id">src</span> <span class="id">srcs</span> <span class="id">dst</span> <span class="id">dsts</span> <span class="id">pc2</span> <span class="id">pc3</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#tr_moves">tr_moves</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#c">c</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#pc1">pc1</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#srcs">srcs</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#dsts">dsts</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#pc2">pc2</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#c">c</a></span>!<span class="id"><a href="compcert.backend.Inliningspec.html#pc2">pc2</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="compcert.backend.RTL.html#Iop">Iop</a></span> <span class="id"><a href="compcert.x86.Op.html#Omove">Omove</a></span> (<span class="id"><a href="compcert.backend.Inliningspec.html#src">src</a></span> :: <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span>) <span class="id"><a href="compcert.backend.Inliningspec.html#dst">dst</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#pc3">pc3</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#tr_moves">tr_moves</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#c">c</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#pc1">pc1</a></span> (<span class="id"><a href="compcert.backend.Inliningspec.html#src">src</a></span> :: <span class="id"><a href="compcert.backend.Inliningspec.html#srcs">srcs</a></span>) (<span class="id"><a href="compcert.backend.Inliningspec.html#dst">dst</a></span> :: <span class="id"><a href="compcert.backend.Inliningspec.html#dsts">dsts</a></span>) <span class="id"><a href="compcert.backend.Inliningspec.html#pc3">pc3</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="tr_moves_nil">tr_moves_nil</a></span>: <span class="kwd">forall</span> <span class="id">srcs</span> <span class="id">dsts</span> <span class="id">pc</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#srcs">srcs</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> \/ <span class="id"><a href="compcert.backend.Inliningspec.html#dsts">dsts</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nil">nil</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#tr_moves">tr_moves</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#c">c</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#srcs">srcs</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#dsts">dsts</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="add_moves_unchanged">add_moves_unchanged</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">srcs</span> <span class="id">dsts</span> <span class="id">pc2</span> <span class="id">s</span> <span class="id">pc1</span> <span class="id">s</span>' <span class="id">i</span> <span class="id">pc</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inlining.html#add_moves">add_moves</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#srcs">srcs</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#dsts">dsts</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#pc2">pc2</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#s">s</a></span> = <span class="id"><a href="compcert.backend.Inlining.html#R">R</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#pc1">pc1</a></span> <span class="id">s</span>' <span class="id"><a href="compcert.backend.Inliningspec.html#i">i</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#Plt">Plt</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#st_nextnode">st_nextnode</a></span>) \/ <span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> <span class="id">s</span>'.(<span class="id"><a href="compcert.backend.Inlining.html#st_nextnode">st_nextnode</a></span>) <span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">s</span>'.(<span class="id"><a href="compcert.backend.Inlining.html#st_code">st_code</a></span>)!<span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span> = <span class="id"><a href="compcert.backend.Inliningspec.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#st_code">st_code</a></span>)!<span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2731')">Proof.</div>
<div class="proofscript" id="proof2731">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">srcs</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">monadInv</span> <span class="id">H</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">dsts</span>; <span class="id">monadInv</span> <span class="id">H</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">transitivity</span> (<span class="id"><a href="compcert.backend.Inlining.html#st_code">st_code</a></span> <span class="id">s0</span>)!<span class="id">pc</span>. <span class="tactic">eapply</span> <span class="id">IHsrcs</span>; <span class="tactic">eauto</span>. <span class="id">monadInv</span> <span class="id">EQ</span>; <span class="tactic">simpl</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="id">monadInv</span> <span class="id">EQ</span>; <span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Maps.html#PTree.gso">PTree.gso</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">INCR0</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="id">xomega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="add_moves_spec">add_moves_spec</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">srcs</span> <span class="id">dsts</span> <span class="id">pc2</span> <span class="id">s</span> <span class="id">pc1</span> <span class="id">s</span>' <span class="id">i</span> <span class="id">c</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inlining.html#add_moves">add_moves</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#srcs">srcs</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#dsts">dsts</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#pc2">pc2</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#s">s</a></span> = <span class="id"><a href="compcert.backend.Inlining.html#R">R</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#pc1">pc1</a></span> <span class="id">s</span>' <span class="id"><a href="compcert.backend.Inliningspec.html#i">i</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">pc</span>, <span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#st_nextnode">st_nextnode</a></span>) <span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span> -&gt; <span class="id"><a href="compcert.lib.Coqlib.html#Plt">Plt</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span> <span class="id">s</span>'.(<span class="id"><a href="compcert.backend.Inlining.html#st_nextnode">st_nextnode</a></span>) -&gt; <span class="id"><a href="compcert.backend.Inliningspec.html#c">c</a></span>!<span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span> = <span class="id">s</span>'.(<span class="id"><a href="compcert.backend.Inlining.html#st_code">st_code</a></span>)!<span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#tr_moves">tr_moves</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#c">c</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#pc1">pc1</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#srcs">srcs</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#dsts">dsts</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#pc2">pc2</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2732')">Proof.</div>
<div class="proofscript" id="proof2732">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">srcs</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">monadInv</span> <span class="id">H</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningspec.html#tr_moves_nil">tr_moves_nil</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">dsts</span>; <span class="id">monadInv</span> <span class="id">H</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningspec.html#tr_moves_nil">tr_moves_nil</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningspec.html#tr_moves_cons">tr_moves_cons</a></span> <span class="kwd">with</span> <span class="id">x</span>. <span class="tactic">eapply</span> <span class="id">IHsrcs</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">inversion</span> <span class="id">INCR</span>. <span class="tactic">apply</span> <span class="id">H0</span>; <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="id">monadInv</span> <span class="id">EQ</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H0</span>. <span class="id">erewrite</span> <span class="id"><a href="compcert.backend.Inliningspec.html#add_moves_unchanged">add_moves_unchanged</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Maps.html#PTree.gss">PTree.gss</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">INCR</span>; <span class="tactic">inversion</span> <span class="id">INCR0</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="id">xomega</span>.<br/>
Qed.</div>
<br/>
<h2> Relational specification of CFG expansion </h2>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="INLINING_SPEC">INLINING_SPEC</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="INLINING_SPEC.fenv">fenv</a></span>: <span class="id"><a href="compcert.backend.Inlining.html#funenv">funenv</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="context_below">context_below</a></span> (<span class="id">ctx1</span> <span class="id">ctx2</span>: <span class="id"><a href="compcert.backend.Inlining.html#context">context</a></span>): <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.add">Pos.add</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx1">ctx1</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dreg">dreg</a></span>) <span class="id"><a href="compcert.backend.Inliningspec.html#ctx1">ctx1</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#mreg">mreg</a></span>)) <span class="id"><a href="compcert.backend.Inliningspec.html#ctx2">ctx2</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dreg">dreg</a></span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="context_stack_call">context_stack_call</a></span> (<span class="id">ctx1</span> <span class="id">ctx2</span>: <span class="id"><a href="compcert.backend.Inlining.html#context">context</a></span>): <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#ctx1">ctx1</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#mstk">mstk</a></span>) &gt;= 0 /\ <span class="id"><a href="compcert.backend.Inliningspec.html#ctx1">ctx1</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span>) + <span class="id"><a href="compcert.backend.Inliningspec.html#ctx1">ctx1</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#mstk">mstk</a></span>) &lt;= <span class="id"><a href="compcert.backend.Inliningspec.html#ctx2">ctx2</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span>).<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="context_stack_tailcall">context_stack_tailcall</a></span> (<span class="id">ctx1</span>: <span class="id"><a href="compcert.backend.Inlining.html#context">context</a></span>) (<span class="id">f</span>: <span class="id"><a href="compcert.backend.RTL.html#function">function</a></span>) (<span class="id">ctx2</span>: <span class="id"><a href="compcert.backend.Inlining.html#context">context</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#ctx2">ctx2</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span>) = <span class="id"><a href="compcert.lib.Coqlib.html#align">align</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx1">ctx1</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span>) (<span class="id"><a href="compcert.backend.Inlining.html#min_alignment">min_alignment</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#f">f</a></span>.(<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span>)).<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="INLINING_SPEC.INLINING_BODY_SPEC">INLINING_BODY_SPEC</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="INLINING_SPEC.INLINING_BODY_SPEC.stacksize">stacksize</a></span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.<br/>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="tr_instr">tr_instr</a></span>: <span class="id"><a href="compcert.backend.Inlining.html#context">context</a></span> -&gt; <span class="id"><a href="compcert.backend.RTL.html#node">node</a></span> -&gt; <span class="id"><a href="compcert.backend.RTL.html#instruction">instruction</a></span> -&gt; <span class="id"><a href="compcert.backend.RTL.html#code">code</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="tr_nop">tr_nop</a></span>: <span class="kwd">forall</span> <span class="id">ctx</span> <span class="id">pc</span> <span class="id">c</span> <span class="id">s</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#c">c</a></span>!(<span class="id"><a href="compcert.backend.Inlining.html#spc">spc</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="compcert.backend.RTL.html#Inop">Inop</a></span> (<span class="id"><a href="compcert.backend.Inlining.html#spc">spc</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#s">s</a></span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#tr_instr">tr_instr</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span> (<span class="id"><a href="compcert.backend.RTL.html#Inop">Inop</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#s">s</a></span>) <span class="id"><a href="compcert.backend.Inliningspec.html#c">c</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="tr_op">tr_op</a></span>: <span class="kwd">forall</span> <span class="id">ctx</span> <span class="id">pc</span> <span class="id">c</span> <span class="id">op</span> <span class="id">args</span> <span class="id">res</span> <span class="id">s</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#res">res</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#mreg">mreg</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#c">c</a></span>!(<span class="id"><a href="compcert.backend.Inlining.html#spc">spc</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="compcert.backend.RTL.html#Iop">Iop</a></span> (<span class="id"><a href="compcert.backend.Inlining.html#sop">sop</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#op">op</a></span>) (<span class="id"><a href="compcert.backend.Inlining.html#sregs">sregs</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#args">args</a></span>) (<span class="id"><a href="compcert.backend.Inlining.html#sreg">sreg</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#res">res</a></span>) (<span class="id"><a href="compcert.backend.Inlining.html#spc">spc</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#s">s</a></span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#tr_instr">tr_instr</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span> (<span class="id"><a href="compcert.backend.RTL.html#Iop">Iop</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#op">op</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#args">args</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#res">res</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#s">s</a></span>) <span class="id"><a href="compcert.backend.Inliningspec.html#c">c</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="tr_load">tr_load</a></span>: <span class="kwd">forall</span> <span class="id">ctx</span> <span class="id">pc</span> <span class="id">c</span> <span class="id">chunk</span> <span class="id">addr</span> <span class="id">args</span> <span class="id">res</span> <span class="id">s</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#res">res</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#mreg">mreg</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#c">c</a></span>!(<span class="id"><a href="compcert.backend.Inlining.html#spc">spc</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="compcert.backend.RTL.html#Iload">Iload</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#chunk">chunk</a></span> (<span class="id"><a href="compcert.backend.Inlining.html#saddr">saddr</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#addr">addr</a></span>) (<span class="id"><a href="compcert.backend.Inlining.html#sregs">sregs</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#args">args</a></span>) (<span class="id"><a href="compcert.backend.Inlining.html#sreg">sreg</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#res">res</a></span>) (<span class="id"><a href="compcert.backend.Inlining.html#spc">spc</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#s">s</a></span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#tr_instr">tr_instr</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span> (<span class="id"><a href="compcert.backend.RTL.html#Iload">Iload</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#chunk">chunk</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#addr">addr</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#args">args</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#res">res</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#s">s</a></span>) <span class="id"><a href="compcert.backend.Inliningspec.html#c">c</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="tr_store">tr_store</a></span>: <span class="kwd">forall</span> <span class="id">ctx</span> <span class="id">pc</span> <span class="id">c</span> <span class="id">chunk</span> <span class="id">addr</span> <span class="id">args</span> <span class="id">src</span> <span class="id">s</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#c">c</a></span>!(<span class="id"><a href="compcert.backend.Inlining.html#spc">spc</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="compcert.backend.RTL.html#Istore">Istore</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#chunk">chunk</a></span> (<span class="id"><a href="compcert.backend.Inlining.html#saddr">saddr</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#addr">addr</a></span>) (<span class="id"><a href="compcert.backend.Inlining.html#sregs">sregs</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#args">args</a></span>) (<span class="id"><a href="compcert.backend.Inlining.html#sreg">sreg</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#src">src</a></span>) (<span class="id"><a href="compcert.backend.Inlining.html#spc">spc</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#s">s</a></span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#tr_instr">tr_instr</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span> (<span class="id"><a href="compcert.backend.RTL.html#Istore">Istore</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#chunk">chunk</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#addr">addr</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#args">args</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#src">src</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#s">s</a></span>) <span class="id"><a href="compcert.backend.Inliningspec.html#c">c</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="tr_call">tr_call</a></span>: <span class="kwd">forall</span> <span class="id">ctx</span> <span class="id">pc</span> <span class="id">c</span> <span class="id">sg</span> <span class="id">ros</span> <span class="id">args</span> <span class="id">res</span> <span class="id">s</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#res">res</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#mreg">mreg</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#c">c</a></span>!(<span class="id"><a href="compcert.backend.Inlining.html#spc">spc</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="compcert.backend.RTL.html#Icall">Icall</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#sg">sg</a></span> (<span class="id"><a href="compcert.backend.Inlining.html#sros">sros</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ros">ros</a></span>) (<span class="id"><a href="compcert.backend.Inlining.html#sregs">sregs</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#args">args</a></span>) (<span class="id"><a href="compcert.backend.Inlining.html#sreg">sreg</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#res">res</a></span>) (<span class="id"><a href="compcert.backend.Inlining.html#spc">spc</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#s">s</a></span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#tr_instr">tr_instr</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span> (<span class="id"><a href="compcert.backend.RTL.html#Icall">Icall</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#sg">sg</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ros">ros</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#args">args</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#res">res</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#s">s</a></span>) <span class="id"><a href="compcert.backend.Inliningspec.html#c">c</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="tr_call_inlined">tr_call_inlined</a></span>:<span class="kwd">forall</span> <span class="id">ctx</span> <span class="id">pc</span> <span class="id">sg</span> <span class="id">id</span> <span class="id">args</span> <span class="id">res</span> <span class="id">s</span> <span class="id">c</span> <span class="id">f</span> <span class="id">pc1</span> <span class="id">ctx</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#res">res</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#mreg">mreg</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#INLINING_SPEC.fenv">fenv</a></span>!<span class="id"><a href="compcert.backend.Inliningspec.html#id">id</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#f">f</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#c">c</a></span>!(<span class="id"><a href="compcert.backend.Inlining.html#spc">spc</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="compcert.backend.RTL.html#Inop">Inop</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#pc1">pc1</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#tr_moves">tr_moves</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#c">c</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#pc1">pc1</a></span> (<span class="id"><a href="compcert.backend.Inlining.html#sregs">sregs</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#args">args</a></span>) (<span class="id"><a href="compcert.backend.Inlining.html#sregs">sregs</a></span> <span class="id">ctx</span>' <span class="id"><a href="compcert.backend.Inliningspec.html#f">f</a></span>.(<span class="id"><a href="compcert.backend.RTL.html#fn_params">fn_params</a></span>)) (<span class="id"><a href="compcert.backend.Inlining.html#spc">spc</a></span> <span class="id">ctx</span>' <span class="id"><a href="compcert.backend.Inliningspec.html#f">f</a></span>.(<span class="id"><a href="compcert.backend.RTL.html#fn_entrypoint">fn_entrypoint</a></span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#tr_funbody">tr_funbody</a></span> <span class="id">ctx</span>' <span class="id"><a href="compcert.backend.Inliningspec.html#f">f</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#c">c</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ctx</span>'.(<span class="id"><a href="compcert.backend.Inlining.html#retinfo">retinfo</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="compcert.backend.Inlining.html#spc">spc</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#s">s</a></span>, <span class="id"><a href="compcert.backend.Inlining.html#sreg">sreg</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#res">res</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#context_below">context_below</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id">ctx</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#context_stack_call">context_stack_call</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id">ctx</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#tr_instr">tr_instr</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span> (<span class="id"><a href="compcert.backend.RTL.html#Icall">Icall</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#sg">sg</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#inr">inr</a></span> <span class="id">_</span> <span class="id"><a href="compcert.backend.Inliningspec.html#id">id</a></span>) <span class="id"><a href="compcert.backend.Inliningspec.html#args">args</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#res">res</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#s">s</a></span>) <span class="id"><a href="compcert.backend.Inliningspec.html#c">c</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="tr_tailcall">tr_tailcall</a></span>: <span class="kwd">forall</span> <span class="id">ctx</span> <span class="id">pc</span> <span class="id">c</span> <span class="id">sg</span> <span class="id">ros</span> <span class="id">args</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#c">c</a></span>!(<span class="id"><a href="compcert.backend.Inlining.html#spc">spc</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="compcert.backend.RTL.html#Itailcall">Itailcall</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#sg">sg</a></span> (<span class="id"><a href="compcert.backend.Inlining.html#sros">sros</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ros">ros</a></span>) (<span class="id"><a href="compcert.backend.Inlining.html#sregs">sregs</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#args">args</a></span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#retinfo">retinfo</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#tr_instr">tr_instr</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span> (<span class="id"><a href="compcert.backend.RTL.html#Itailcall">Itailcall</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#sg">sg</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ros">ros</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#args">args</a></span>) <span class="id"><a href="compcert.backend.Inliningspec.html#c">c</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="tr_tailcall_call">tr_tailcall_call</a></span>: <span class="kwd">forall</span> <span class="id">ctx</span> <span class="id">pc</span> <span class="id">c</span> <span class="id">sg</span> <span class="id">ros</span> <span class="id">args</span> <span class="id">res</span> <span class="id">s</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#c">c</a></span>!(<span class="id"><a href="compcert.backend.Inlining.html#spc">spc</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="compcert.backend.RTL.html#Icall">Icall</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#sg">sg</a></span> (<span class="id"><a href="compcert.backend.Inlining.html#sros">sros</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ros">ros</a></span>) (<span class="id"><a href="compcert.backend.Inlining.html#sregs">sregs</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#args">args</a></span>) <span class="id"><a href="compcert.backend.Inliningspec.html#res">res</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#s">s</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#retinfo">retinfo</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="compcert.backend.Inliningspec.html#s">s</a></span>, <span class="id"><a href="compcert.backend.Inliningspec.html#res">res</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#tr_instr">tr_instr</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span> (<span class="id"><a href="compcert.backend.RTL.html#Itailcall">Itailcall</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#sg">sg</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ros">ros</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#args">args</a></span>) <span class="id"><a href="compcert.backend.Inliningspec.html#c">c</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="tr_tailcall_inlined">tr_tailcall_inlined</a></span>: <span class="kwd">forall</span> <span class="id">ctx</span> <span class="id">pc</span> <span class="id">sg</span> <span class="id">id</span> <span class="id">args</span> <span class="id">c</span> <span class="id">f</span> <span class="id">pc1</span> <span class="id">ctx</span>',<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#INLINING_SPEC.fenv">fenv</a></span>!<span class="id"><a href="compcert.backend.Inliningspec.html#id">id</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#f">f</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#c">c</a></span>!(<span class="id"><a href="compcert.backend.Inlining.html#spc">spc</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="compcert.backend.RTL.html#Inop">Inop</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#pc1">pc1</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#tr_moves">tr_moves</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#c">c</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#pc1">pc1</a></span> (<span class="id"><a href="compcert.backend.Inlining.html#sregs">sregs</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#args">args</a></span>) (<span class="id"><a href="compcert.backend.Inlining.html#sregs">sregs</a></span> <span class="id">ctx</span>' <span class="id"><a href="compcert.backend.Inliningspec.html#f">f</a></span>.(<span class="id"><a href="compcert.backend.RTL.html#fn_params">fn_params</a></span>)) (<span class="id"><a href="compcert.backend.Inlining.html#spc">spc</a></span> <span class="id">ctx</span>' <span class="id"><a href="compcert.backend.Inliningspec.html#f">f</a></span>.(<span class="id"><a href="compcert.backend.RTL.html#fn_entrypoint">fn_entrypoint</a></span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#tr_funbody">tr_funbody</a></span> <span class="id">ctx</span>' <span class="id"><a href="compcert.backend.Inliningspec.html#f">f</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#c">c</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">ctx</span>'.(<span class="id"><a href="compcert.backend.Inlining.html#retinfo">retinfo</a></span>) = <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#retinfo">retinfo</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#context_below">context_below</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id">ctx</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#context_stack_tailcall">context_stack_tailcall</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#f">f</a></span> <span class="id">ctx</span>' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#tr_instr">tr_instr</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span> (<span class="id"><a href="compcert.backend.RTL.html#Itailcall">Itailcall</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#sg">sg</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#inr">inr</a></span> <span class="id">_</span> <span class="id"><a href="compcert.backend.Inliningspec.html#id">id</a></span>) <span class="id"><a href="compcert.backend.Inliningspec.html#args">args</a></span>) <span class="id"><a href="compcert.backend.Inliningspec.html#c">c</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="tr_builtin">tr_builtin</a></span>: <span class="kwd">forall</span> <span class="id">ctx</span> <span class="id">pc</span> <span class="id">c</span> <span class="id">ef</span> <span class="id">args</span> <span class="id">res</span> <span class="id">s</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">match</span> <span class="id"><a href="compcert.backend.Inliningspec.html#res">res</a></span> <span class="kwd">with</span> <span class="id"><a href="compcert.common.AST.html#BR">BR</a></span> <span class="id">r</span> =&gt; <span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> <span class="id">r</span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#mreg">mreg</a></span>) | <span class="id">_</span> =&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Logic.html#True">True</a></span> <span class="kwd">end</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#c">c</a></span>!(<span class="id"><a href="compcert.backend.Inlining.html#spc">spc</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="compcert.backend.RTL.html#Ibuiltin">Ibuiltin</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ef">ef</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">map</a></span> (<span class="id"><a href="compcert.backend.Inlining.html#sbuiltinarg">sbuiltinarg</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>) <span class="id"><a href="compcert.backend.Inliningspec.html#args">args</a></span>) (<span class="id"><a href="compcert.backend.Inlining.html#sbuiltinres">sbuiltinres</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#res">res</a></span>) (<span class="id"><a href="compcert.backend.Inlining.html#spc">spc</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#s">s</a></span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#tr_instr">tr_instr</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span> (<span class="id"><a href="compcert.backend.RTL.html#Ibuiltin">Ibuiltin</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ef">ef</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#args">args</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#res">res</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#s">s</a></span>) <span class="id"><a href="compcert.backend.Inliningspec.html#c">c</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="tr_cond">tr_cond</a></span>: <span class="kwd">forall</span> <span class="id">ctx</span> <span class="id">pc</span> <span class="id">cond</span> <span class="id">args</span> <span class="id">s1</span> <span class="id">s2</span> <span class="id">c</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#c">c</a></span>!(<span class="id"><a href="compcert.backend.Inlining.html#spc">spc</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="compcert.backend.RTL.html#Icond">Icond</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#cond">cond</a></span> (<span class="id"><a href="compcert.backend.Inlining.html#sregs">sregs</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#args">args</a></span>) (<span class="id"><a href="compcert.backend.Inlining.html#spc">spc</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#s1">s1</a></span>) (<span class="id"><a href="compcert.backend.Inlining.html#spc">spc</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#s2">s2</a></span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#tr_instr">tr_instr</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span> (<span class="id"><a href="compcert.backend.RTL.html#Icond">Icond</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#cond">cond</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#args">args</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#s1">s1</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#s2">s2</a></span>) <span class="id"><a href="compcert.backend.Inliningspec.html#c">c</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="tr_jumptable">tr_jumptable</a></span>: <span class="kwd">forall</span> <span class="id">ctx</span> <span class="id">pc</span> <span class="id">r</span> <span class="id">tbl</span> <span class="id">c</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#c">c</a></span>!(<span class="id"><a href="compcert.backend.Inlining.html#spc">spc</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="compcert.backend.RTL.html#Ijumptable">Ijumptable</a></span> (<span class="id"><a href="compcert.backend.Inlining.html#sreg">sreg</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#r">r</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="id"><a href="compcert.backend.Inlining.html#spc">spc</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>) <span class="id"><a href="compcert.backend.Inliningspec.html#tbl">tbl</a></span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#tr_instr">tr_instr</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span> (<span class="id"><a href="compcert.backend.RTL.html#Ijumptable">Ijumptable</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#r">r</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#tbl">tbl</a></span>) <span class="id"><a href="compcert.backend.Inliningspec.html#c">c</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="tr_return">tr_return</a></span>: <span class="kwd">forall</span> <span class="id">ctx</span> <span class="id">pc</span> <span class="id">or</span> <span class="id">c</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#c">c</a></span>!(<span class="id"><a href="compcert.backend.Inlining.html#spc">spc</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="compcert.backend.RTL.html#Ireturn">Ireturn</a></span> (<span class="id"><a href="compcert.lib.Coqlib.html#option_map">option_map</a></span> (<span class="id"><a href="compcert.backend.Inlining.html#sreg">sreg</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>) <span class="id"><a href="compcert.backend.Inliningspec.html#or">or</a></span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#retinfo">retinfo</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#tr_instr">tr_instr</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span> (<span class="id"><a href="compcert.backend.RTL.html#Ireturn">Ireturn</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#or">or</a></span>) <span class="id"><a href="compcert.backend.Inliningspec.html#c">c</a></span><br/>
&nbsp;&nbsp;| <span class="id"><a name="tr_return_inlined">tr_return_inlined</a></span>: <span class="kwd">forall</span> <span class="id">ctx</span> <span class="id">pc</span> <span class="id">or</span> <span class="id">c</span> <span class="id">rinfo</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#c">c</a></span>!(<span class="id"><a href="compcert.backend.Inlining.html#spc">spc</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="compcert.backend.Inlining.html#inline_return">inline_return</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#or">or</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#rinfo">rinfo</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#retinfo">retinfo</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#rinfo">rinfo</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#tr_instr">tr_instr</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span> (<span class="id"><a href="compcert.backend.RTL.html#Ireturn">Ireturn</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#or">or</a></span>) <span class="id"><a href="compcert.backend.Inliningspec.html#c">c</a></span><br/>
<br/>
<span class="kwd">with</span> <span class="id"><a name="tr_funbody">tr_funbody</a></span>: <span class="id"><a href="compcert.backend.Inlining.html#context">context</a></span> -&gt; <span class="id"><a href="compcert.backend.RTL.html#function">function</a></span> -&gt; <span class="id"><a href="compcert.backend.RTL.html#code">code</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="tr_funbody_intro">tr_funbody_intro</a></span>: <span class="kwd">forall</span> <span class="id">ctx</span> <span class="id">f</span> <span class="id">c</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">r</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#r">r</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#f">f</a></span>.(<span class="id"><a href="compcert.backend.RTL.html#fn_params">fn_params</a></span>) -&gt; <span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#r">r</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#mreg">mreg</a></span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">pc</span> <span class="id">i</span>, <span class="id"><a href="compcert.backend.Inliningspec.html#f">f</a></span>.(<span class="id"><a href="compcert.backend.RTL.html#fn_code">fn_code</a></span>)!<span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#i">i</a></span> -&gt; <span class="id"><a href="compcert.backend.Inliningspec.html#tr_instr">tr_instr</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#i">i</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#c">c</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#mstk">mstk</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.max">Z.max</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#f">f</a></span>.(<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span>) 0 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.Inlining.html#min_alignment">min_alignment</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#f">f</a></span>.(<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span>) | <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span>) &gt;= 0 -&gt; <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span>) + <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#mstk">mstk</a></span>) &lt;= <span class="id"><a href="compcert.backend.Inliningspec.html#INLINING_SPEC.INLINING_BODY_SPEC.stacksize">stacksize</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#tr_funbody">tr_funbody</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#f">f</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#c">c</a></span>.<br/>
<br/>
<span class="kwd">Definition</span> <span class="id"><a name="fenv_agree">fenv_agree</a></span> (<span class="id">fe</span>: <span class="id"><a href="compcert.backend.Inlining.html#funenv">funenv</a></span>) : <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">id</span> <span class="id">f</span>, <span class="id"><a href="compcert.backend.Inliningspec.html#fe">fe</a></span>!<span class="id"><a href="compcert.backend.Inliningspec.html#id">id</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#f">f</a></span> -&gt; <span class="id"><a href="compcert.backend.Inliningspec.html#INLINING_SPEC.fenv">fenv</a></span>!<span class="id"><a href="compcert.backend.Inliningspec.html#id">id</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#f">f</a></span>.<br/>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="INLINING_SPEC.INLINING_BODY_SPEC.EXPAND_INSTR">EXPAND_INSTR</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="INLINING_SPEC.INLINING_BODY_SPEC.EXPAND_INSTR.fe">fe</a></span>: <span class="id"><a href="compcert.backend.Inlining.html#funenv">funenv</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="INLINING_SPEC.INLINING_BODY_SPEC.EXPAND_INSTR.FE">FE</a></span>: <span class="id"><a href="compcert.backend.Inliningspec.html#fenv_agree">fenv_agree</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#INLINING_SPEC.INLINING_BODY_SPEC.EXPAND_INSTR.fe">fe</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="INLINING_SPEC.INLINING_BODY_SPEC.EXPAND_INSTR.rec">rec</a></span>: <span class="kwd">forall</span> <span class="id">fe</span>', (<span class="id"><a href="compcert.backend.Inlining.html#size_fenv">size_fenv</a></span> <span class="id">fe</span>' &lt; <span class="id"><a href="compcert.backend.Inlining.html#size_fenv">size_fenv</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#INLINING_SPEC.INLINING_BODY_SPEC.EXPAND_INSTR.fe">fe</a></span>)%<span class="id">nat</span> -&gt; <span class="id"><a href="compcert.backend.Inlining.html#context">context</a></span> -&gt; <span class="id"><a href="compcert.backend.RTL.html#function">function</a></span> -&gt; <span class="id"><a href="compcert.backend.Inlining.html#mon">mon</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#unit">unit</a></span>.<br/>
<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="INLINING_SPEC.INLINING_BODY_SPEC.EXPAND_INSTR.rec_unchanged">rec_unchanged</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">fe</span>' (<span class="id">L</span>: (<span class="id"><a href="compcert.backend.Inlining.html#size_fenv">size_fenv</a></span> <span class="id">fe</span>' &lt; <span class="id"><a href="compcert.backend.Inlining.html#size_fenv">size_fenv</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#INLINING_SPEC.INLINING_BODY_SPEC.EXPAND_INSTR.fe">fe</a></span>)%<span class="id">nat</span>) <span class="id">ctx</span> <span class="id">f</span> <span class="id">s</span> <span class="id">x</span> <span class="id">s</span>' <span class="id">i</span> <span class="id">pc</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#INLINING_SPEC.INLINING_BODY_SPEC.EXPAND_INSTR.rec">rec</a></span> <span class="id">fe</span>' <span class="id"><a href="compcert.backend.Inliningspec.html#L">L</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#f">f</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#s">s</a></span> = <span class="id"><a href="compcert.backend.Inlining.html#R">R</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#x">x</a></span> <span class="id">s</span>' <span class="id"><a href="compcert.backend.Inliningspec.html#i">i</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dpc">dpc</a></span>) <span class="id"><a href="compcert.backend.Inliningspec.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#st_nextnode">st_nextnode</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#Plt">Plt</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dpc">dpc</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">s</span>'.(<span class="id"><a href="compcert.backend.Inlining.html#st_code">st_code</a></span>)!<span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span> = <span class="id"><a href="compcert.backend.Inliningspec.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#st_code">st_code</a></span>)!<span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span>.<br/>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="set_instr_other">set_instr_other</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">pc</span> <span class="id">instr</span> <span class="id">s</span> <span class="id">x</span> <span class="id">s</span>' <span class="id">i</span> <span class="id">pc</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inlining.html#set_instr">set_instr</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#instr">instr</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#s">s</a></span> = <span class="id"><a href="compcert.backend.Inlining.html#R">R</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#x">x</a></span> <span class="id">s</span>' <span class="id"><a href="compcert.backend.Inliningspec.html#i">i</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">pc</span>' &lt;&gt; <span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">s</span>'.(<span class="id"><a href="compcert.backend.Inlining.html#st_code">st_code</a></span>)!<span class="id">pc</span>' = <span class="id"><a href="compcert.backend.Inliningspec.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#st_code">st_code</a></span>)!<span class="id">pc</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2733')">Proof.</div>
<div class="proofscript" id="proof2733">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">monadInv</span> <span class="id">H</span>; <span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Maps.html#PTree.gso">PTree.gso</a></span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="set_instr_same">set_instr_same</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">pc</span> <span class="id">instr</span> <span class="id">s</span> <span class="id">x</span> <span class="id">s</span>' <span class="id">i</span> <span class="id">c</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inlining.html#set_instr">set_instr</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#instr">instr</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#s">s</a></span> = <span class="id"><a href="compcert.backend.Inlining.html#R">R</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#x">x</a></span> <span class="id">s</span>' <span class="id"><a href="compcert.backend.Inliningspec.html#i">i</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#c">c</a></span>!(<span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span>) = <span class="id">s</span>'.(<span class="id"><a href="compcert.backend.Inlining.html#st_code">st_code</a></span>)!<span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#c">c</a></span>!(<span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#instr">instr</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2734')">Proof.</div>
<div class="proofscript" id="proof2734">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id">H0</span>. <span class="id">monadInv</span> <span class="id">H</span>; <span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Maps.html#PTree.gss">PTree.gss</a></span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="expand_instr_unchanged">expand_instr_unchanged</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ctx</span> <span class="id">pc</span> <span class="id">instr</span> <span class="id">s</span> <span class="id">x</span> <span class="id">s</span>' <span class="id">i</span> <span class="id">pc</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inlining.html#expand_instr">expand_instr</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#INLINING_SPEC.INLINING_BODY_SPEC.EXPAND_INSTR.fe">fe</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#INLINING_SPEC.INLINING_BODY_SPEC.EXPAND_INSTR.rec">rec</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#instr">instr</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#s">s</a></span> = <span class="id"><a href="compcert.backend.Inlining.html#R">R</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#x">x</a></span> <span class="id">s</span>' <span class="id"><a href="compcert.backend.Inliningspec.html#i">i</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dpc">dpc</a></span>) <span class="id"><a href="compcert.backend.Inliningspec.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#st_nextnode">st_nextnode</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#Plt">Plt</a></span> <span class="id">pc</span>' <span class="id"><a href="compcert.backend.Inliningspec.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#st_nextnode">st_nextnode</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">pc</span>' &lt;&gt; <span class="id"><a href="compcert.backend.Inlining.html#spc">spc</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">s</span>'.(<span class="id"><a href="compcert.backend.Inlining.html#st_code">st_code</a></span>)!<span class="id">pc</span>' = <span class="id"><a href="compcert.backend.Inliningspec.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#st_code">st_code</a></span>)!<span class="id">pc</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2735')">Proof.</div>
<div class="proofscript" id="proof2735">
&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="id"><a href="compcert.backend.Inliningspec.html#set_instr_other">set_instr_other</a></span>; <span class="tactic">intros</span> <span class="id">A</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Inlining.html#expand_instr">expand_instr</a></span> <span class="kwd">in</span> <span class="id">H</span>; <span class="tactic">destruct</span> <span class="id">instr</span>; <span class="tactic">eauto</span>.<br/>
<span class="comment">(*&nbsp;call&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.backend.Inlining.html#can_inline">can_inline</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#INLINING_SPEC.INLINING_BODY_SPEC.EXPAND_INSTR.fe">fe</a></span> <span class="id">s1</span>). <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">monadInv</span> <span class="id">H</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Inlining.html#inline_function">inline_function</a></span> <span class="kwd">in</span> <span class="id">EQ</span>. <span class="id">monadInv</span> <span class="id">EQ</span>.<br/>
&nbsp;&nbsp;<span class="tactic">transitivity</span> (<span class="id">s2</span>.(<span class="id"><a href="compcert.backend.Inlining.html#st_code">st_code</a></span>)!<span class="id">pc</span>'). <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">transitivity</span> (<span class="id">s5</span>.(<span class="id"><a href="compcert.backend.Inlining.html#st_code">st_code</a></span>)!<span class="id">pc</span>'). <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningspec.html#add_moves_unchanged">add_moves_unchanged</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">inversion</span> <span class="id">INCR5</span>. <span class="tactic">inversion</span> <span class="id">INCR3</span>. <span class="id">monadInv</span> <span class="id">EQ1</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">transitivity</span> (<span class="id">s4</span>.(<span class="id"><a href="compcert.backend.Inlining.html#st_code">st_code</a></span>)!<span class="id">pc</span>'). <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningspec.html#INLINING_SPEC.INLINING_BODY_SPEC.EXPAND_INSTR.rec_unchanged">rec_unchanged</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="id">monadInv</span> <span class="id">EQ</span>; <span class="tactic">simpl</span>. <span class="id">monadInv</span> <span class="id">EQ1</span>; <span class="tactic">simpl</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="id">monadInv</span> <span class="id">EQ1</span>; <span class="tactic">simpl</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">monadInv</span> <span class="id">EQ</span>; <span class="tactic">simpl</span>. <span class="id">monadInv</span> <span class="id">EQ1</span>; <span class="tactic">simpl</span>. <span class="tactic">auto</span>.<br/>
<span class="comment">(*&nbsp;tailcall&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.backend.Inlining.html#can_inline">can_inline</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#INLINING_SPEC.INLINING_BODY_SPEC.EXPAND_INSTR.fe">fe</a></span> <span class="id">s1</span>).<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.backend.Inlining.html#retinfo">retinfo</a></span> <span class="id">ctx</span>) <span class="kwd">as</span> [[<span class="id">rpc</span> <span class="id">rreg</span>]|]; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">monadInv</span> <span class="id">H</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Inlining.html#inline_tail_function">inline_tail_function</a></span> <span class="kwd">in</span> <span class="id">EQ</span>. <span class="id">monadInv</span> <span class="id">EQ</span>.<br/>
&nbsp;&nbsp;<span class="tactic">transitivity</span> (<span class="id">s2</span>.(<span class="id"><a href="compcert.backend.Inlining.html#st_code">st_code</a></span>)!<span class="id">pc</span>'). <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">transitivity</span> (<span class="id">s5</span>.(<span class="id"><a href="compcert.backend.Inlining.html#st_code">st_code</a></span>)!<span class="id">pc</span>'). <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningspec.html#add_moves_unchanged">add_moves_unchanged</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">left</span>. <span class="tactic">inversion</span> <span class="id">INCR5</span>. <span class="tactic">inversion</span> <span class="id">INCR3</span>. <span class="id">monadInv</span> <span class="id">EQ1</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">transitivity</span> (<span class="id">s4</span>.(<span class="id"><a href="compcert.backend.Inlining.html#st_code">st_code</a></span>)!<span class="id">pc</span>'). <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningspec.html#INLINING_SPEC.INLINING_BODY_SPEC.EXPAND_INSTR.rec_unchanged">rec_unchanged</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="id">monadInv</span> <span class="id">EQ</span>; <span class="tactic">simpl</span>. <span class="id">monadInv</span> <span class="id">EQ1</span>; <span class="tactic">simpl</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="id">monadInv</span> <span class="id">EQ1</span>; <span class="tactic">simpl</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id">monadInv</span> <span class="id">EQ</span>; <span class="tactic">simpl</span>. <span class="id">monadInv</span> <span class="id">EQ1</span>; <span class="tactic">simpl</span>. <span class="tactic">auto</span>.<br/>
<span class="comment">(*&nbsp;return&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.backend.Inlining.html#retinfo">retinfo</a></span> <span class="id">ctx</span>) <span class="kwd">as</span> [[<span class="id">rpc</span> <span class="id">rreg</span>]|]; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="iter_expand_instr_unchanged">iter_expand_instr_unchanged</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ctx</span> <span class="id">pc</span> <span class="id">l</span> <span class="id">s</span> <span class="id">x</span> <span class="id">s</span>' <span class="id">i</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#mlist_iter2">mlist_iter2</a></span> (<span class="id"><a href="compcert.backend.Inlining.html#expand_instr">expand_instr</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#INLINING_SPEC.INLINING_BODY_SPEC.EXPAND_INSTR.fe">fe</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#INLINING_SPEC.INLINING_BODY_SPEC.EXPAND_INSTR.rec">rec</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>) <span class="id"><a href="compcert.backend.Inliningspec.html#l">l</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#s">s</a></span> = <span class="id"><a href="compcert.backend.Inlining.html#R">R</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#x">x</a></span> <span class="id">s</span>' <span class="id"><a href="compcert.backend.Inliningspec.html#i">i</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dpc">dpc</a></span>) <span class="id"><a href="compcert.backend.Inliningspec.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#st_nextnode">st_nextnode</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#Plt">Plt</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#st_nextnode">st_nextnode</a></span>) -&gt;<br/>
&nbsp;&nbsp;~<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (<span class="id"><a href="compcert.backend.Inlining.html#spc">spc</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">_</span> <span class="id">_</span>) <span class="id"><a href="compcert.backend.Inliningspec.html#l">l</a></span>)) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#list_norepet">list_norepet</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">_</span> <span class="id">_</span>) <span class="id"><a href="compcert.backend.Inliningspec.html#l">l</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">s</span>'.(<span class="id"><a href="compcert.backend.Inlining.html#st_code">st_code</a></span>)!<span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span> = <span class="id"><a href="compcert.backend.Inliningspec.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#st_code">st_code</a></span>)!<span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2736')">Proof.</div>
<div class="proofscript" id="proof2736">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;base&nbsp;case&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">monadInv</span> <span class="id">H</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;inductive&nbsp;case&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">a</span> <span class="kwd">as</span> [<span class="id">pc1</span> <span class="id">instr1</span>]; <span class="tactic">simpl</span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">monadInv</span> <span class="id">H</span>. <span class="id">inv</span> <span class="id">H3</span>.<br/>
&nbsp;&nbsp;<span class="tactic">transitivity</span> ((<span class="id"><a href="compcert.backend.Inlining.html#st_code">st_code</a></span> <span class="id">s0</span>)!<span class="id">pc</span>).<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">IHl</span>; <span class="tactic">eauto</span>. <span class="tactic">destruct</span> <span class="id">INCR</span>; <span class="id">xomega</span>. <span class="tactic">destruct</span> <span class="id">INCR</span>; <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningspec.html#expand_instr_unchanged">expand_instr_unchanged</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="expand_cfg_rec_unchanged">expand_cfg_rec_unchanged</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ctx</span> <span class="id">f</span> <span class="id">s</span> <span class="id">x</span> <span class="id">s</span>' <span class="id">i</span> <span class="id">pc</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inlining.html#expand_cfg_rec">expand_cfg_rec</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#INLINING_SPEC.INLINING_BODY_SPEC.EXPAND_INSTR.fe">fe</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#INLINING_SPEC.INLINING_BODY_SPEC.EXPAND_INSTR.rec">rec</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#f">f</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#s">s</a></span> = <span class="id"><a href="compcert.backend.Inlining.html#R">R</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#x">x</a></span> <span class="id">s</span>' <span class="id"><a href="compcert.backend.Inliningspec.html#i">i</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dpc">dpc</a></span>) <span class="id"><a href="compcert.backend.Inliningspec.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#st_nextnode">st_nextnode</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#Plt">Plt</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dpc">dpc</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">s</span>'.(<span class="id"><a href="compcert.backend.Inlining.html#st_code">st_code</a></span>)!<span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span> = <span class="id"><a href="compcert.backend.Inliningspec.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#st_code">st_code</a></span>)!<span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2737')">Proof.</div>
<div class="proofscript" id="proof2737">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Inlining.html#expand_cfg_rec">expand_cfg_rec</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="id">monadInv</span> <span class="id">H</span>. <span class="tactic">inversion</span> <span class="id">EQ</span>.<br/>
&nbsp;&nbsp;<span class="tactic">transitivity</span> ((<span class="id"><a href="compcert.backend.Inlining.html#st_code">st_code</a></span> <span class="id">s0</span>)!<span class="id">pc</span>).<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.Inliningspec.html#ptree_mfold_spec">ptree_mfold_spec</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">INCR</span>' <span class="id">ITER</span>].<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningspec.html#iter_expand_instr_unchanged">iter_expand_instr_unchanged</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">s0</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">s0</span>; <span class="tactic">simpl</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.lib.Coqlib.html#list_in_map_inv">list_in_map_inv</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">pc1</span> [<span class="id">A</span> <span class="id">B</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">pc</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Inlining.html#spc">spc</a></span> <span class="kwd">in</span> <span class="id">H1</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningspec.html#shiftpos_not_below">shiftpos_not_below</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Maps.html#PTree.elements_keys_norepet">PTree.elements_keys_norepet</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">s0</span>; <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="INLINING_SPEC.INLINING_BODY_SPEC.EXPAND_INSTR.rec_spec">rec_spec</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">fe</span>' (<span class="id">L</span>: (<span class="id"><a href="compcert.backend.Inlining.html#size_fenv">size_fenv</a></span> <span class="id">fe</span>' &lt; <span class="id"><a href="compcert.backend.Inlining.html#size_fenv">size_fenv</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#INLINING_SPEC.INLINING_BODY_SPEC.EXPAND_INSTR.fe">fe</a></span>)%<span class="id">nat</span>) <span class="id">ctx</span> <span class="id">f</span> <span class="id">s</span> <span class="id">x</span> <span class="id">s</span>' <span class="id">i</span> <span class="id">c</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#INLINING_SPEC.INLINING_BODY_SPEC.EXPAND_INSTR.rec">rec</a></span> <span class="id">fe</span>' <span class="id"><a href="compcert.backend.Inliningspec.html#L">L</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#f">f</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#s">s</a></span> = <span class="id"><a href="compcert.backend.Inlining.html#R">R</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#x">x</a></span> <span class="id">s</span>' <span class="id"><a href="compcert.backend.Inliningspec.html#i">i</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#fenv_agree">fenv_agree</a></span> <span class="id">fe</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> (<span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dpc">dpc</a></span>) + <span class="id"><a href="compcert.backend.RTL.html#max_pc_function">max_pc_function</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#f">f</a></span>) <span class="id"><a href="compcert.backend.Inliningspec.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#st_nextnode">st_nextnode</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#mreg">mreg</a></span>) = <span class="id"><a href="compcert.backend.RTL.html#max_reg_function">max_reg_function</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#f">f</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.add">Pos.add</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dreg">dreg</a></span>) <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#mreg">mreg</a></span>)) <span class="id"><a href="compcert.backend.Inliningspec.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#st_nextreg">st_nextreg</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#mstk">mstk</a></span>) &gt;= 0 -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#mstk">mstk</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.max">Z.max</a></span> (<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#f">f</a></span>) 0 -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.Inlining.html#min_alignment">min_alignment</a></span> (<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#f">f</a></span>) | <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span>)) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span>) &gt;= 0 -&gt;<br/>
&nbsp;&nbsp;<span class="id">s</span>'.(<span class="id"><a href="compcert.backend.Inlining.html#st_stksize">st_stksize</a></span>) &lt;= <span class="id"><a href="compcert.backend.Inliningspec.html#INLINING_SPEC.INLINING_BODY_SPEC.stacksize">stacksize</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">pc</span>, <span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dpc">dpc</a></span>) <span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span> -&gt; <span class="id"><a href="compcert.lib.Coqlib.html#Plt">Plt</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span> <span class="id">s</span>'.(<span class="id"><a href="compcert.backend.Inlining.html#st_nextnode">st_nextnode</a></span>) -&gt; <span class="id"><a href="compcert.backend.Inliningspec.html#c">c</a></span>!<span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span> = <span class="id">s</span>'.(<span class="id"><a href="compcert.backend.Inlining.html#st_code">st_code</a></span>)!<span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#tr_funbody">tr_funbody</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#f">f</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#c">c</a></span>.<br/>
<br/>
<span class="kwd">Remark</span> <span class="id"><a name="min_alignment_pos">min_alignment_pos</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">sz</span>, <span class="id"><a href="compcert.backend.Inlining.html#min_alignment">min_alignment</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#sz">sz</a></span> &gt; 0.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2738')">Proof.</div>
<div class="proofscript" id="proof2738">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Inlining.html#min_alignment">min_alignment</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zle">zle</a></span> <span class="id">sz</span> 1). <span class="tactic">omega</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zle">zle</a></span> <span class="id">sz</span> 2). <span class="tactic">omega</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zle">zle</a></span> <span class="id">sz</span> 4); <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Ltac</span> <span class="id">inv_incr</span> :=<br/>
&nbsp;&nbsp;<span class="kwd">match</span> <span class="id">goal</span> <span class="kwd">with</span><br/>
&nbsp;&nbsp;| [ <span class="id">H</span>: <span class="id"><a href="compcert.backend.Inlining.html#sincr">sincr</a></span> <span class="id">_</span> <span class="id">_</span> |- <span class="id">_</span> ] =&gt; <span class="tactic">destruct</span> <span class="id">H</span>; <span class="id">inv_incr</span><br/>
&nbsp;&nbsp;| <span class="id">_</span> =&gt; <span class="id">idtac</span><br/>
&nbsp;&nbsp;<span class="kwd">end</span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="expand_instr_spec">expand_instr_spec</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ctx</span> <span class="id">pc</span> <span class="id">instr</span> <span class="id">s</span> <span class="id">x</span> <span class="id">s</span>' <span class="id">i</span> <span class="id">c</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inlining.html#expand_instr">expand_instr</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#INLINING_SPEC.INLINING_BODY_SPEC.EXPAND_INSTR.fe">fe</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#INLINING_SPEC.INLINING_BODY_SPEC.EXPAND_INSTR.rec">rec</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#instr">instr</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#s">s</a></span> = <span class="id"><a href="compcert.backend.Inlining.html#R">R</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#x">x</a></span> <span class="id">s</span>' <span class="id"><a href="compcert.backend.Inliningspec.html#i">i</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">r</span>, <span class="id"><a href="compcert.backend.RTL.html#instr_defs">instr_defs</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#instr">instr</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#r">r</a></span> -&gt; <span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#r">r</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#mreg">mreg</a></span>)) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#Plt">Plt</a></span> (<span class="id"><a href="compcert.backend.Inlining.html#spc">spc</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span>) <span class="id"><a href="compcert.backend.Inliningspec.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#st_nextnode">st_nextnode</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> (<span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dreg">dreg</a></span>) + <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#mreg">mreg</a></span>)) <span class="id"><a href="compcert.backend.Inliningspec.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#st_nextreg">st_nextreg</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#mstk">mstk</a></span>) &gt;= 0 -&gt; <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span>) &gt;= 0 -&gt;<br/>
&nbsp;&nbsp;<span class="id">s</span>'.(<span class="id"><a href="compcert.backend.Inlining.html#st_stksize">st_stksize</a></span>) &lt;= <span class="id"><a href="compcert.backend.Inliningspec.html#INLINING_SPEC.INLINING_BODY_SPEC.stacksize">stacksize</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">pc</span>', <span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#st_nextnode">st_nextnode</a></span>) <span class="id">pc</span>' -&gt; <span class="id"><a href="compcert.lib.Coqlib.html#Plt">Plt</a></span> <span class="id">pc</span>' <span class="id">s</span>'.(<span class="id"><a href="compcert.backend.Inlining.html#st_nextnode">st_nextnode</a></span>) -&gt; <span class="id"><a href="compcert.backend.Inliningspec.html#c">c</a></span>!<span class="id">pc</span>' = <span class="id">s</span>'.(<span class="id"><a href="compcert.backend.Inlining.html#st_code">st_code</a></span>)!<span class="id">pc</span>') -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#c">c</a></span>!(<span class="id"><a href="compcert.backend.Inlining.html#spc">spc</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span>) = <span class="id">s</span>'.(<span class="id"><a href="compcert.backend.Inlining.html#st_code">st_code</a></span>)!(<span class="id"><a href="compcert.backend.Inlining.html#spc">spc</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#tr_instr">tr_instr</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#instr">instr</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#c">c</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2739')">Proof.</div>
<div class="proofscript" id="proof2739">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> <span class="id">c</span>; <span class="tactic">intros</span> <span class="id">EXP</span> <span class="id">DEFS</span> <span class="id">OPC</span> <span class="id">OREG</span> <span class="id">STK1</span> <span class="id">STK2</span> <span class="id">STK3</span> <span class="id">S1</span> <span class="id">S2</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="id"><a href="compcert.backend.Inliningspec.html#set_instr_same">set_instr_same</a></span>; <span class="tactic">intros</span> <span class="id">BASE</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Inlining.html#expand_instr">expand_instr</a></span> <span class="kwd">in</span> <span class="id">EXP</span>; <span class="tactic">destruct</span> <span class="id">instr</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">DEFS</span>;<br/>
&nbsp;&nbsp;<span class="tactic">try</span> (<span class="id">econstructor</span>; <span class="tactic">eauto</span>; <span class="tactic">fail</span>).<br/>
<span class="comment">(*&nbsp;call&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.backend.Inlining.html#can_inline">can_inline</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#INLINING_SPEC.INLINING_BODY_SPEC.EXPAND_INSTR.fe">fe</a></span> <span class="id">s1</span>) <span class="kwd">as</span> [|<span class="id">id</span> <span class="id">f</span> <span class="id">P</span> <span class="id">Q</span>].<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;not&nbsp;inlined&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningspec.html#tr_call">tr_call</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;inlined&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">s1</span>.<br/>
&nbsp;&nbsp;<span class="id">monadInv</span> <span class="id">EXP</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Inlining.html#inline_function">inline_function</a></span> <span class="kwd">in</span> <span class="id">EQ</span>; <span class="id">monadInv</span> <span class="id">EQ</span>.<br/>
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">ctx</span>' := <span class="id"><a href="compcert.backend.Inlining.html#callcontext">callcontext</a></span> <span class="id">ctx</span> <span class="id">x1</span> <span class="id">x2</span> (<span class="id"><a href="compcert.backend.RTL.html#max_reg_function">max_reg_function</a></span> <span class="id">f</span>) (<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span> <span class="id">f</span>) <span class="id">n</span> <span class="id">r</span>).<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">EQ0</span>; <span class="tactic">inversion</span> <span class="id">EQ1</span>; <span class="tactic">inversion</span> <span class="id">EQ</span>. <span class="id">inv_incr</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningspec.html#tr_call_inlined">tr_call_inlined</a></span> <span class="kwd">with</span> (<span class="id">pc1</span> := <span class="id">x0</span>) (<span class="id">ctx</span>' := <span class="id">ctx</span>') (<span class="id">f</span> := <span class="id">f</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">BASE</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningspec.html#add_moves_spec">add_moves_spec</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id">S1</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningspec.html#set_instr_other">set_instr_other</a></span>; <span class="tactic">eauto</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.RTL.html#node">node</a></span>; <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">xomega</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningspec.html#INLINING_SPEC.INLINING_BODY_SPEC.EXPAND_INSTR.rec_spec">rec_spec</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Maps.html#PTree.grspec">PTree.grspec</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Maps.html#PTree.elt_eq">PTree.elt_eq</a></span> <span class="id">id0</span> <span class="id">id</span>); <span class="tactic">try</span> <span class="tactic">discriminate</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">subst</span> <span class="id">s2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">subst</span> <span class="id">s3</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#align_divides">align_divides</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningspec.html#min_alignment_pos">min_alignment_pos</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span> <span class="id">ctx</span> + <span class="id"><a href="compcert.backend.Inlining.html#mstk">mstk</a></span> <span class="id">ctx</span> &lt;= <span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span> <span class="id">ctx</span>'). <span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#align_le">align_le</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningspec.html#min_alignment_pos">min_alignment_pos</a></span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">rewrite</span> <span class="id">S1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">transitivity</span> (<span class="id">s1</span>.(<span class="id"><a href="compcert.backend.Inlining.html#st_code">st_code</a></span>)!<span class="id">pc0</span>). <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningspec.html#set_instr_other">set_instr_other</a></span>; <span class="tactic">eauto</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.RTL.html#node">node</a></span> <span class="kwd">in</span> *; <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningspec.html#add_moves_unchanged">add_moves_unchanged</a></span>; <span class="tactic">eauto</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.RTL.html#node">node</a></span> <span class="kwd">in</span> *; <span class="id">xomega</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">simpl</span>. <span class="tactic">subst</span> <span class="id">s2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">simpl</span>. <span class="tactic">split</span>. <span class="tactic">auto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#align_le">align_le</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningspec.html#min_alignment_pos">min_alignment_pos</a></span>.<br/>
<span class="comment">(*&nbsp;tailcall&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.backend.Inlining.html#can_inline">can_inline</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#INLINING_SPEC.INLINING_BODY_SPEC.EXPAND_INSTR.fe">fe</a></span> <span class="id">s1</span>) <span class="kwd">as</span> [|<span class="id">id</span> <span class="id">f</span> <span class="id">P</span> <span class="id">Q</span>].<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;not&nbsp;inlined&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.backend.Inlining.html#retinfo">retinfo</a></span> <span class="id">ctx</span>) <span class="kwd">as</span> [[<span class="id">rpc</span> <span class="id">rreg</span>] | ] <span class="id">eqn</span>:?.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;turned&nbsp;into&nbsp;a&nbsp;call&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningspec.html#tr_tailcall_call">tr_tailcall_call</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;preserved&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningspec.html#tr_tailcall">tr_tailcall</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;inlined&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">s1</span>.<br/>
&nbsp;&nbsp;<span class="id">monadInv</span> <span class="id">EXP</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Inlining.html#inline_function">inline_function</a></span> <span class="kwd">in</span> <span class="id">EQ</span>; <span class="id">monadInv</span> <span class="id">EQ</span>.<br/>
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">ctx</span>' := <span class="id"><a href="compcert.backend.Inlining.html#tailcontext">tailcontext</a></span> <span class="id">ctx</span> <span class="id">x1</span> <span class="id">x2</span> (<span class="id"><a href="compcert.backend.RTL.html#max_reg_function">max_reg_function</a></span> <span class="id">f</span>) (<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span> <span class="id">f</span>)) <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">EQ0</span>; <span class="tactic">inversion</span> <span class="id">EQ1</span>; <span class="tactic">inversion</span> <span class="id">EQ</span>. <span class="id">inv_incr</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningspec.html#tr_tailcall_inlined">tr_tailcall_inlined</a></span> <span class="kwd">with</span> (<span class="id">pc1</span> := <span class="id">x0</span>) (<span class="id">ctx</span>' := <span class="id">ctx</span>') (<span class="id">f</span> := <span class="id">f</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">BASE</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningspec.html#add_moves_spec">add_moves_spec</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id">S1</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningspec.html#set_instr_other">set_instr_other</a></span>; <span class="tactic">eauto</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.RTL.html#node">node</a></span>; <span class="id">xomega</span>. <span class="id">xomega</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningspec.html#INLINING_SPEC.INLINING_BODY_SPEC.EXPAND_INSTR.rec_spec">rec_spec</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Maps.html#PTree.grspec">PTree.grspec</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Maps.html#PTree.elt_eq">PTree.elt_eq</a></span> <span class="id">id0</span> <span class="id">id</span>); <span class="tactic">try</span> <span class="tactic">discriminate</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">subst</span> <span class="id">s3</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="tactic">subst</span> <span class="id">s2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">subst</span> <span class="id">s3</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#align_divides">align_divides</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningspec.html#min_alignment_pos">min_alignment_pos</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span> <span class="id">ctx</span> &lt;= <span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span> <span class="id">ctx</span>'). <span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#align_le">align_le</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningspec.html#min_alignment_pos">min_alignment_pos</a></span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">rewrite</span> <span class="id">S1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">transitivity</span> (<span class="id">s1</span>.(<span class="id"><a href="compcert.backend.Inlining.html#st_code">st_code</a></span>))!<span class="id">pc0</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningspec.html#set_instr_other">set_instr_other</a></span>; <span class="tactic">eauto</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.RTL.html#node">node</a></span> <span class="kwd">in</span> *; <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningspec.html#add_moves_unchanged">add_moves_unchanged</a></span>; <span class="tactic">eauto</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.RTL.html#node">node</a></span> <span class="kwd">in</span> *; <span class="id">xomega</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">simpl</span>.<br/>
<span class="tactic">subst</span> <span class="id">s2</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> *; <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">auto</span>.<br/>
<span class="comment">(*&nbsp;builtin&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningspec.html#tr_builtin">tr_builtin</a></span>; <span class="tactic">eauto</span>. <span class="tactic">destruct</span> <span class="id">b</span>; <span class="tactic">eauto</span>.<br/>
<span class="comment">(*&nbsp;return&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.backend.Inlining.html#retinfo">retinfo</a></span> <span class="id">ctx</span>) <span class="kwd">as</span> [[<span class="id">rpc</span> <span class="id">rreg</span>] | ] <span class="id">eqn</span>:?.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;inlined&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningspec.html#tr_return_inlined">tr_return_inlined</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;unchanged&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningspec.html#tr_return">tr_return</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="iter_expand_instr_spec">iter_expand_instr_spec</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ctx</span> <span class="id">l</span> <span class="id">s</span> <span class="id">x</span> <span class="id">s</span>' <span class="id">i</span> <span class="id">c</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#mlist_iter2">mlist_iter2</a></span> (<span class="id"><a href="compcert.backend.Inlining.html#expand_instr">expand_instr</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#INLINING_SPEC.INLINING_BODY_SPEC.EXPAND_INSTR.fe">fe</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#INLINING_SPEC.INLINING_BODY_SPEC.EXPAND_INSTR.rec">rec</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>) <span class="id"><a href="compcert.backend.Inliningspec.html#l">l</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#s">s</a></span> = <span class="id"><a href="compcert.backend.Inlining.html#R">R</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#x">x</a></span> <span class="id">s</span>' <span class="id"><a href="compcert.backend.Inliningspec.html#i">i</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#list_norepet">list_norepet</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#map">List.map</a></span> (@<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> <span class="id">_</span> <span class="id">_</span>) <span class="id"><a href="compcert.backend.Inliningspec.html#l">l</a></span>) -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">pc</span> <span class="id">instr</span> <span class="id">r</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span>, <span class="id"><a href="compcert.backend.Inliningspec.html#instr">instr</a></span>) <span class="id"><a href="compcert.backend.Inliningspec.html#l">l</a></span> -&gt; <span class="id"><a href="compcert.backend.RTL.html#instr_defs">instr_defs</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#instr">instr</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#r">r</a></span> -&gt; <span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#r">r</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#mreg">mreg</a></span>)) -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">pc</span> <span class="id">instr</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span>, <span class="id"><a href="compcert.backend.Inliningspec.html#instr">instr</a></span>) <span class="id"><a href="compcert.backend.Inliningspec.html#l">l</a></span> -&gt; <span class="id"><a href="compcert.lib.Coqlib.html#Plt">Plt</a></span> (<span class="id"><a href="compcert.backend.Inlining.html#spc">spc</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span>) <span class="id"><a href="compcert.backend.Inliningspec.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#st_nextnode">st_nextnode</a></span>)) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> (<span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dreg">dreg</a></span>) + <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#mreg">mreg</a></span>)) <span class="id"><a href="compcert.backend.Inliningspec.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#st_nextreg">st_nextreg</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#mstk">mstk</a></span>) &gt;= 0 -&gt; <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span>) &gt;= 0 -&gt;<br/>
&nbsp;&nbsp;<span class="id">s</span>'.(<span class="id"><a href="compcert.backend.Inlining.html#st_stksize">st_stksize</a></span>) &lt;= <span class="id"><a href="compcert.backend.Inliningspec.html#INLINING_SPEC.INLINING_BODY_SPEC.stacksize">stacksize</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">pc</span>', <span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#st_nextnode">st_nextnode</a></span>) <span class="id">pc</span>' -&gt; <span class="id"><a href="compcert.lib.Coqlib.html#Plt">Plt</a></span> <span class="id">pc</span>' <span class="id">s</span>'.(<span class="id"><a href="compcert.backend.Inlining.html#st_nextnode">st_nextnode</a></span>) -&gt; <span class="id"><a href="compcert.backend.Inliningspec.html#c">c</a></span>!<span class="id">pc</span>' = <span class="id">s</span>'.(<span class="id"><a href="compcert.backend.Inlining.html#st_code">st_code</a></span>)!<span class="id">pc</span>') -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">pc</span> <span class="id">instr</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span>, <span class="id"><a href="compcert.backend.Inliningspec.html#instr">instr</a></span>) <span class="id"><a href="compcert.backend.Inliningspec.html#l">l</a></span> -&gt; <span class="id"><a href="compcert.backend.Inliningspec.html#c">c</a></span>!(<span class="id"><a href="compcert.backend.Inlining.html#spc">spc</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span>) = <span class="id">s</span>'.(<span class="id"><a href="compcert.backend.Inlining.html#st_code">st_code</a></span>)!(<span class="id"><a href="compcert.backend.Inlining.html#spc">spc</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span>)) -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">pc</span> <span class="id">instr</span>, <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#In">In</a></span> (<span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span>, <span class="id"><a href="compcert.backend.Inliningspec.html#instr">instr</a></span>) <span class="id"><a href="compcert.backend.Inliningspec.html#l">l</a></span> -&gt; <span class="id"><a href="compcert.backend.Inliningspec.html#tr_instr">tr_instr</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#instr">instr</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#c">c</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2740')">Proof.</div>
<div class="proofscript" id="proof2740">
&nbsp;&nbsp;<span class="tactic">induction</span> <span class="id">l</span>; <span class="tactic">simpl</span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;base&nbsp;case&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">contradiction</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;inductive&nbsp;case&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">a</span> <span class="kwd">as</span> [<span class="id">pc1</span> <span class="id">instr1</span>]; <span class="tactic">simpl</span> <span class="kwd">in</span> *. <span class="id">inv</span> <span class="id">H0</span>. <span class="id">monadInv</span> <span class="id">H</span>. <span class="id">inv_incr</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">A</span>: <span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> <span class="id">ctx</span>.(<span class="id"><a href="compcert.backend.Inlining.html#dpc">dpc</a></span>) <span class="id">s0</span>.(<span class="id"><a href="compcert.backend.Inlining.html#st_nextnode">st_nextnode</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">B</span>: <span class="id"><a href="compcert.lib.Coqlib.html#Plt">Plt</a></span> (<span class="id"><a href="compcert.backend.Inlining.html#spc">spc</a></span> <span class="id">ctx</span> <span class="id">pc</span>) (<span class="id"><a href="compcert.backend.Inlining.html#st_nextnode">st_nextnode</a></span> <span class="id">s</span>)) <span class="tactic">by</span> <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Inlining.html#spc">spc</a></span> <span class="kwd">in</span> <span class="id">B</span>. <span class="tactic">generalize</span> (<span class="id"><a href="compcert.backend.Inliningspec.html#shiftpos_above">shiftpos_above</a></span> <span class="id">pc</span> (<span class="id"><a href="compcert.backend.Inlining.html#dpc">dpc</a></span> <span class="id">ctx</span>)). <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">H9</span>. <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;same&nbsp;pc&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningspec.html#expand_instr_spec">expand_instr_spec</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">transitivity</span> ((<span class="id"><a href="compcert.backend.Inlining.html#st_code">st_code</a></span> <span class="id">s</span>')!<span class="id">pc</span>').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id">H7</span>. <span class="tactic">auto</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningspec.html#iter_expand_instr_unchanged">iter_expand_instr_unchanged</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#list_map_compose">list_map_compose</a></span> <span class="kwd">in</span> <span class="id">H9</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.lib.Coqlib.html#list_in_map_inv">list_in_map_inv</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [[<span class="id">pc0</span> <span class="id">instr0</span>] [<span class="id">P</span> <span class="id">Q</span>]]. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">P</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="compcert.lib.Coqlib.html#Plt">Plt</a></span> (<span class="id"><a href="compcert.backend.Inlining.html#spc">spc</a></span> <span class="id">ctx</span> <span class="id">pc0</span>) (<span class="id"><a href="compcert.backend.Inlining.html#st_nextnode">st_nextnode</a></span> <span class="id">s</span>)) <span class="tactic">by</span> <span class="tactic">eauto</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">transitivity</span> ((<span class="id"><a href="compcert.backend.Inlining.html#st_code">st_code</a></span> <span class="id">s</span>')!(<span class="id"><a href="compcert.backend.Inlining.html#spc">spc</a></span> <span class="id">ctx</span> <span class="id">pc</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id">H8</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningspec.html#iter_expand_instr_unchanged">iter_expand_instr_unchanged</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="compcert.lib.Coqlib.html#Plt">Plt</a></span> (<span class="id"><a href="compcert.backend.Inlining.html#spc">spc</a></span> <span class="id">ctx</span> <span class="id">pc</span>) (<span class="id"><a href="compcert.backend.Inlining.html#st_nextnode">st_nextnode</a></span> <span class="id">s</span>)) <span class="tactic">by</span> <span class="tactic">eauto</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#list_map_compose">list_map_compose</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.lib.Coqlib.html#list_in_map_inv">list_in_map_inv</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [[<span class="id">pc0</span> <span class="id">instr0</span>] [<span class="id">P</span> <span class="id">Q</span>]]. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">P</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">pc</span> = <span class="id">pc0</span>) <span class="tactic">by</span> (<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningspec.html#shiftpos_inj">shiftpos_inj</a></span>; <span class="tactic">eauto</span>). <span class="tactic">subst</span> <span class="id">pc0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">elim</span> <span class="id">H12</span>. <span class="id">change</span> <span class="id">pc</span> <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#fst">fst</a></span> (<span class="id">pc</span>, <span class="id">instr0</span>)). <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#in_map">List.in_map</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;older&nbsp;pc&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id">inv_incr</span>. <span class="tactic">eapply</span> <span class="id">IHl</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.lt_le_trans">Pos.lt_le_trans</a></span>. <span class="tactic">eapply</span> <span class="id">H2</span>. <span class="id">right</span>; <span class="tactic">eauto</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">eapply</span> <span class="id"><a href="compcert.lib.Coqlib.html#Ple_trans">Ple_trans</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id">H7</span>; <span class="tactic">auto</span>. <span class="id">xomega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="expand_cfg_rec_spec">expand_cfg_rec_spec</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">ctx</span> <span class="id">f</span> <span class="id">s</span> <span class="id">x</span> <span class="id">s</span>' <span class="id">i</span> <span class="id">c</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inlining.html#expand_cfg_rec">expand_cfg_rec</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#INLINING_SPEC.INLINING_BODY_SPEC.EXPAND_INSTR.fe">fe</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#INLINING_SPEC.INLINING_BODY_SPEC.EXPAND_INSTR.rec">rec</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#f">f</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#s">s</a></span> = <span class="id"><a href="compcert.backend.Inlining.html#R">R</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#x">x</a></span> <span class="id">s</span>' <span class="id"><a href="compcert.backend.Inliningspec.html#i">i</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> (<span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dpc">dpc</a></span>) + <span class="id"><a href="compcert.backend.RTL.html#max_pc_function">max_pc_function</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#f">f</a></span>) <span class="id"><a href="compcert.backend.Inliningspec.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#st_nextnode">st_nextnode</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#mreg">mreg</a></span>) = <span class="id"><a href="compcert.backend.RTL.html#max_reg_function">max_reg_function</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#f">f</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> (<span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dreg">dreg</a></span>) + <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#mreg">mreg</a></span>)) <span class="id"><a href="compcert.backend.Inliningspec.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#st_nextreg">st_nextreg</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#mstk">mstk</a></span>) &gt;= 0 -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#mstk">mstk</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.max">Z.max</a></span> (<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#f">f</a></span>) 0 -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.Inlining.html#min_alignment">min_alignment</a></span> (<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#f">f</a></span>) | <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span>)) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span>) &gt;= 0 -&gt;<br/>
&nbsp;&nbsp;<span class="id">s</span>'.(<span class="id"><a href="compcert.backend.Inlining.html#st_stksize">st_stksize</a></span>) &lt;= <span class="id"><a href="compcert.backend.Inliningspec.html#INLINING_SPEC.INLINING_BODY_SPEC.stacksize">stacksize</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">pc</span>', <span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dpc">dpc</a></span>) <span class="id">pc</span>' -&gt; <span class="id"><a href="compcert.lib.Coqlib.html#Plt">Plt</a></span> <span class="id">pc</span>' <span class="id">s</span>'.(<span class="id"><a href="compcert.backend.Inlining.html#st_nextnode">st_nextnode</a></span>) -&gt; <span class="id"><a href="compcert.backend.Inliningspec.html#c">c</a></span>!<span class="id">pc</span>' = <span class="id">s</span>'.(<span class="id"><a href="compcert.backend.Inlining.html#st_code">st_code</a></span>)!<span class="id">pc</span>') -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#tr_funbody">tr_funbody</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#f">f</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#c">c</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2741')">Proof.</div>
<div class="proofscript" id="proof2741">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Inlining.html#expand_cfg_rec">expand_cfg_rec</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="id">monadInv</span> <span class="id">H</span>. <span class="tactic">inversion</span> <span class="id">EQ</span>.<br/>
&nbsp;&nbsp;<span class="id">constructor</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id">H1</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.RTL.html#max_reg_function_params">max_reg_function_params</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.backend.Inliningspec.html#ptree_mfold_spec">ptree_mfold_spec</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">INCR</span>' <span class="id">ITER</span>].<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningspec.html#iter_expand_instr_spec">iter_expand_instr_spec</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Maps.html#PTree.elements_keys_norepet">PTree.elements_keys_norepet</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">rewrite</span> <span class="id">H1</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.RTL.html#max_reg_function_def">max_reg_function_def</a></span> <span class="kwd">with</span> (<span class="id">i</span> := <span class="id">instr</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.lib.Maps.html#PTree.elements_complete">PTree.elements_complete</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> <span class="id">pc0</span> (<span class="id"><a href="compcert.backend.RTL.html#max_pc_function">max_pc_function</a></span> <span class="id">f</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.RTL.html#max_pc_function_sound">max_pc_function_sound</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.lib.Maps.html#PTree.elements_complete">PTree.elements_complete</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.lt_le_trans">Pos.lt_le_trans</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningspec.html#shiftpos_below">shiftpos_below</a></span>. <span class="tactic">subst</span> <span class="id">s0</span>; <span class="tactic">simpl</span>; <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">subst</span> <span class="id">s0</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id">H8</span>; <span class="tactic">auto</span>. <span class="tactic">subst</span> <span class="id">s0</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H11</span>; <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id">H8</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningspec.html#shiftpos_above">shiftpos_above</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> <span class="id">pc0</span> (<span class="id"><a href="compcert.backend.RTL.html#max_pc_function">max_pc_function</a></span> <span class="id">f</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.RTL.html#max_pc_function_sound">max_pc_function_sound</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.lib.Maps.html#PTree.elements_complete">PTree.elements_complete</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.PArith.BinPos.html#Pos.lt_le_trans">Pos.lt_le_trans</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningspec.html#shiftpos_below">shiftpos_below</a></span>. <span class="tactic">inversion</span> <span class="id">i</span>; <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Maps.html#PTree.elements_correct">PTree.elements_correct</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">auto</span>. <span class="tactic">auto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">inversion</span> <span class="id">INCR0</span>. <span class="tactic">subst</span> <span class="id">s0</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">STKSIZE</span>; <span class="id">xomega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.backend.Inliningspec.html#INLINING_SPEC.INLINING_BODY_SPEC.EXPAND_INSTR">EXPAND_INSTR</a></span>.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="expand_cfg_unchanged">expand_cfg_unchanged</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">fe</span> <span class="id">ctx</span> <span class="id">f</span> <span class="id">s</span> <span class="id">x</span> <span class="id">s</span>' <span class="id">i</span> <span class="id">pc</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inlining.html#expand_cfg">expand_cfg</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#fe">fe</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#f">f</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#s">s</a></span> = <span class="id"><a href="compcert.backend.Inlining.html#R">R</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#x">x</a></span> <span class="id">s</span>' <span class="id"><a href="compcert.backend.Inliningspec.html#i">i</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dpc">dpc</a></span>) <span class="id"><a href="compcert.backend.Inliningspec.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#st_nextnode">st_nextnode</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#Plt">Plt</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dpc">dpc</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">s</span>'.(<span class="id"><a href="compcert.backend.Inlining.html#st_code">st_code</a></span>)!<span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span> = <span class="id"><a href="compcert.backend.Inliningspec.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#st_code">st_code</a></span>)!<span class="id"><a href="compcert.backend.Inliningspec.html#pc">pc</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2742')">Proof.</div>
<div class="proofscript" id="proof2742">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">fe0</span>; <span class="tactic">pattern</span> <span class="id">fe0</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Wf.html#well_founded_ind">well_founded_ind</a></span> <span class="kwd">with</span> (<span class="id">R</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Wf_nat.html#ltof">ltof</a></span> <span class="id">_</span> <span class="id"><a href="compcert.backend.Inlining.html#size_fenv">size_fenv</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Wf_nat.html#well_founded_ltof">well_founded_ltof</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Inlining.html#expand_cfg">expand_cfg</a></span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Wfsimpl.html#unroll_Fixm">unroll_Fixm</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningspec.html#expand_cfg_rec_unchanged">expand_cfg_rec_unchanged</a></span>; <span class="tactic">eauto</span>. <span class="tactic">assumption</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="expand_cfg_spec">expand_cfg_spec</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">fe</span> <span class="id">ctx</span> <span class="id">f</span> <span class="id">s</span> <span class="id">x</span> <span class="id">s</span>' <span class="id">i</span> <span class="id">c</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inlining.html#expand_cfg">expand_cfg</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#fe">fe</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#f">f</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#s">s</a></span> = <span class="id"><a href="compcert.backend.Inlining.html#R">R</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#x">x</a></span> <span class="id">s</span>' <span class="id"><a href="compcert.backend.Inliningspec.html#i">i</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#fenv_agree">fenv_agree</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#fe">fe</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> (<span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dpc">dpc</a></span>) + <span class="id"><a href="compcert.backend.RTL.html#max_pc_function">max_pc_function</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#f">f</a></span>) <span class="id"><a href="compcert.backend.Inliningspec.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#st_nextnode">st_nextnode</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#mreg">mreg</a></span>) = <span class="id"><a href="compcert.backend.RTL.html#max_reg_function">max_reg_function</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#f">f</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> (<span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dreg">dreg</a></span>) + <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#mreg">mreg</a></span>)) <span class="id"><a href="compcert.backend.Inliningspec.html#s">s</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#st_nextreg">st_nextreg</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#mstk">mstk</a></span>) &gt;= 0 -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#mstk">mstk</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.max">Z.max</a></span> (<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#f">f</a></span>) 0 -&gt;<br/>
&nbsp;&nbsp;(<span class="id"><a href="compcert.backend.Inlining.html#min_alignment">min_alignment</a></span> (<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#f">f</a></span>) | <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span>)) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span>) &gt;= 0 -&gt;<br/>
&nbsp;&nbsp;<span class="id">s</span>'.(<span class="id"><a href="compcert.backend.Inlining.html#st_stksize">st_stksize</a></span>) &lt;= <span class="id"><a href="compcert.backend.Inliningspec.html#INLINING_SPEC.INLINING_BODY_SPEC.stacksize">stacksize</a></span> -&gt;<br/>
&nbsp;&nbsp;(<span class="kwd">forall</span> <span class="id">pc</span>', <span class="id"><a href="compcert.lib.Coqlib.html#Ple">Ple</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dpc">dpc</a></span>) <span class="id">pc</span>' -&gt; <span class="id"><a href="compcert.lib.Coqlib.html#Plt">Plt</a></span> <span class="id">pc</span>' <span class="id">s</span>'.(<span class="id"><a href="compcert.backend.Inlining.html#st_nextnode">st_nextnode</a></span>) -&gt; <span class="id"><a href="compcert.backend.Inliningspec.html#c">c</a></span>!<span class="id">pc</span>' = <span class="id">s</span>'.(<span class="id"><a href="compcert.backend.Inlining.html#st_code">st_code</a></span>)!<span class="id">pc</span>') -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#tr_funbody">tr_funbody</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#f">f</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#c">c</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2743')">Proof.</div>
<div class="proofscript" id="proof2743">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">fe0</span>; <span class="tactic">pattern</span> <span class="id">fe0</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Wf.html#well_founded_ind">well_founded_ind</a></span> <span class="kwd">with</span> (<span class="id">R</span> := <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Wf_nat.html#ltof">ltof</a></span> <span class="id">_</span> <span class="id"><a href="compcert.backend.Inlining.html#size_fenv">size_fenv</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Arith.Wf_nat.html#well_founded_ltof">well_founded_ltof</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Inlining.html#expand_cfg">expand_cfg</a></span> <span class="kwd">in</span> <span class="id">H0</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Wfsimpl.html#unroll_Fixm">unroll_Fixm</a></span> <span class="kwd">in</span> <span class="id">H0</span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningspec.html#expand_cfg_rec_spec">expand_cfg_rec_spec</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">intros</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningspec.html#expand_cfg_unchanged">expand_cfg_unchanged</a></span>; <span class="tactic">eauto</span>. <span class="tactic">assumption</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.backend.Inliningspec.html#INLINING_SPEC.INLINING_BODY_SPEC">INLINING_BODY_SPEC</a></span>.<br/>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.backend.Inliningspec.html#INLINING_SPEC">INLINING_SPEC</a></span>.<br/>
<br/>
<h2> Relational specification of the translation of a function </h2>
<br/>
<span class="kwd">Inductive</span> <span class="id"><a name="tr_function">tr_function</a></span>: <span class="id"><a href="compcert.backend.RTL.html#program">program</a></span> -&gt; <span class="id"><a href="compcert.backend.RTL.html#function">function</a></span> -&gt; <span class="id"><a href="compcert.backend.RTL.html#function">function</a></span> -&gt; <span class="kwd">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id"><a name="tr_function_intro">tr_function_intro</a></span>: <span class="kwd">forall</span> <span class="id">p</span> <span class="id">fenv</span> <span class="id">f</span> <span class="id">f</span>' <span class="id">ctx</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#fenv_compat">fenv_compat</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#p">p</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#fenv">fenv</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#tr_funbody">tr_funbody</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#fenv">fenv</a></span> <span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span>) <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#f">f</a></span> <span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_code">fn_code</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#dstk">dstk</a></span>) = 0 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span>.(<span class="id"><a href="compcert.backend.Inlining.html#retinfo">retinfo</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#None">None</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_sig">fn_sig</a></span>) = <span class="id"><a href="compcert.backend.Inliningspec.html#f">f</a></span>.(<span class="id"><a href="compcert.backend.RTL.html#fn_sig">fn_sig</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_params">fn_params</a></span>) = <span class="id"><a href="compcert.backend.Inlining.html#sregs">sregs</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#f">f</a></span>.(<span class="id"><a href="compcert.backend.RTL.html#fn_params">fn_params</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">f</span>'.(<span class="id"><a href="compcert.backend.RTL.html#fn_entrypoint">fn_entrypoint</a></span>) = <span class="id"><a href="compcert.backend.Inlining.html#spc">spc</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#ctx">ctx</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#f">f</a></span>.(<span class="id"><a href="compcert.backend.RTL.html#fn_entrypoint">fn_entrypoint</a></span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 &lt;= <span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span> <span class="id">f</span>' &lt; <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.max_unsigned">Ptrofs.max_unsigned</a></span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#tr_function">tr_function</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#p">p</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#f">f</a></span> <span class="id">f</span>'.<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="tr_function_linkorder">tr_function_linkorder</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">cunit</span> <span class="id">prog</span> <span class="id">f</span> <span class="id">f</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Linking.html#linkorder">linkorder</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#cunit">cunit</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#prog">prog</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#tr_function">tr_function</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#cunit">cunit</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#f">f</a></span> <span class="id">f</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#tr_function">tr_function</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#prog">prog</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#f">f</a></span> <span class="id">f</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2744')">Proof.</div>
<div class="proofscript" id="proof2744">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">inv</span> <span class="id">H0</span>. <span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningspec.html#fenv_compat_linkorder">fenv_compat_linkorder</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="transf_function_spec">transf_function_spec</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">cunit</span> <span class="id">f</span> <span class="id">f</span>',<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inlining.html#transf_function">transf_function</a></span> (<span class="id"><a href="compcert.backend.Inlining.html#funenv_program">funenv_program</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#cunit">cunit</a></span>) <span class="id"><a href="compcert.backend.Inliningspec.html#f">f</a></span> = <span class="id"><a href="compcert.common.Errors.html#OK">OK</a></span> <span class="id">f</span>' -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.Inliningspec.html#tr_function">tr_function</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#cunit">cunit</a></span> <span class="id"><a href="compcert.backend.Inliningspec.html#f">f</a></span> <span class="id">f</span>'.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2745')">Proof.</div>
<div class="proofscript" id="proof2745">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.Inlining.html#transf_function">transf_function</a></span> <span class="kwd">in</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">fenv</span> := <span class="id"><a href="compcert.backend.Inlining.html#funenv_program">funenv_program</a></span> <span class="id">cunit</span>) <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.backend.Inlining.html#expand_function">expand_function</a></span> <span class="id">fenv</span> <span class="id">f</span> <span class="id"><a href="compcert.backend.Inlining.html#initstate">initstate</a></span>) <span class="kwd">as</span> [<span class="id">ctx</span> <span class="id">s</span> <span class="id">i</span>] <span class="id">eqn</span>:?.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> (<span class="id"><a href="compcert.backend.Inlining.html#st_stksize">st_stksize</a></span> <span class="id">s</span>) <span class="id"><a href="compcert.lib.Integers.html#Ptrofs.max_unsigned">Ptrofs.max_unsigned</a></span>); <span class="id">inv</span> <span class="id">H</span>.<br/>
&nbsp;&nbsp;<span class="id">monadInv</span> <span class="id">Heqr</span>. <span class="tactic">set</span> (<span class="id">ctx</span> := <span class="id"><a href="compcert.backend.Inlining.html#initcontext">initcontext</a></span> <span class="id">x</span> <span class="id">x0</span> (<span class="id"><a href="compcert.backend.RTL.html#max_reg_function">max_reg_function</a></span> <span class="id">f</span>) (<span class="id"><a href="compcert.backend.RTL.html#fn_stacksize">fn_stacksize</a></span> <span class="id">f</span>)) <span class="kwd">in</span> *.<br/>
<span class="id">Opaque</span> <span class="id"><a href="compcert.backend.Inlining.html#initstate">initstate</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">INCR3</span>. <span class="tactic">inversion</span> <span class="id">EQ1</span>. <span class="tactic">inversion</span> <span class="id">EQ</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningspec.html#tr_function_intro">tr_function_intro</a></span> <span class="kwd">with</span> <span class="id">fenv</span> <span class="id">ctx</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.Inliningspec.html#funenv_program_compat">funenv_program_compat</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.Inliningspec.html#expand_cfg_spec">expand_cfg_spec</a></span> <span class="kwd">with</span> (<span class="id">fe</span> := <span class="id">fenv</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">ctx</span>; <span class="tactic">rewrite</span> &lt;- <span class="id">H1</span>; <span class="tactic">rewrite</span> &lt;- <span class="id">H2</span>; <span class="tactic">rewrite</span> &lt;- <span class="id">H3</span>; <span class="tactic">simpl</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">ctx</span>; <span class="tactic">rewrite</span> &lt;- <span class="id">H0</span>; <span class="tactic">rewrite</span> &lt;- <span class="id">H1</span>; <span class="tactic">simpl</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="id">xomega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.divide_0_r">Z.divide_0_r</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">split</span>; <span class="tactic">auto</span>. <span class="tactic">destruct</span> <span class="id">INCR2</span>. <span class="tactic">destruct</span> <span class="id">INCR1</span>. <span class="tactic">destruct</span> <span class="id">INCR0</span>. <span class="tactic">destruct</span> <span class="id">INCR</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="id">change</span> 0 <span class="kwd">with</span> (<span class="id"><a href="compcert.backend.Inlining.html#st_stksize">st_stksize</a></span> <span class="id"><a href="compcert.backend.Inlining.html#initstate">initstate</a></span>). <span class="tactic">omega</span>.<br/>
Qed.</div>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</div>
</body>
</html>
