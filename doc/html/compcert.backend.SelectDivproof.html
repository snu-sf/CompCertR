
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Module SelectDivproof</title>
<meta name="description" content="Documentation of Coq module SelectDivproof" />
<link href="coq2html.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="coq2html.js"> </script>
</head>

<body onload="hideAll('proofscript')">
<h1 class="title">Module SelectDivproof</h1>
<div class="coq">
<br/>
<div class="doc">Correctness of instruction selection for integer division </div>
<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zquot.html">Zquot</a></span> <span class="id"><a href="compcert.lib.Coqlib.html">Coqlib</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.common.AST.html">AST</a></span> <span class="id"><a href="compcert.lib.Integers.html">Integers</a></span> <span class="id"><a href="compcert.lib.Floats.html">Floats</a></span> <span class="id"><a href="compcert.common.Values.html">Values</a></span> <span class="id"><a href="compcert.common.Memory.html">Memory</a></span> <span class="id"><a href="compcert.common.Globalenvs.html">Globalenvs</a></span> <span class="id"><a href="compcert.common.Events.html">Events</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.backend.Cminor.html">Cminor</a></span> <span class="id"><a href="compcert.x86.Op.html">Op</a></span> <span class="id"><a href="compcert.backend.CminorSel.html">CminorSel</a></span>.<br/>
<span class="kwd">Require</span> <span class="kwd">Import</span> <span class="id"><a href="compcert.x86.SelectOp.html">SelectOp</a></span> <span class="id"><a href="compcert.x86.SelectOpproof.html">SelectOpproof</a></span> <span class="id"><a href="compcert.backend.SplitLong.html">SplitLong</a></span> <span class="id"><a href="compcert.backend.SplitLongproof.html">SplitLongproof</a></span> <span class="id"><a href="compcert.x86.SelectLong.html">SelectLong</a></span> <span class="id"><a href="compcert.x86.SelectLongproof.html">SelectLongproof</a></span> <span class="id"><a href="compcert.backend.SelectDiv.html">SelectDiv</a></span>.<br/>
<br/>
<span class="kwd">Local</span> <span class="kwd">Open</span> <span class="kwd">Scope</span> <span class="id">cminorsel_scope</span>.<br/>
<br/>
<h1> Main approximation theorems </h1>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="Z_DIV_MUL">Z_DIV_MUL</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Z_DIV_MUL.N">N</a></span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.      <span class="docright">(* number of relevant bits  *)</span><br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="Z_DIV_MUL.N_pos">N_pos</a></span>: <span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.N">N</a></span> &gt;= 0.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="Z_DIV_MUL.d">d</a></span>: <span class="id"><a href="http://coq.inria.fr/library/Coq.Numbers.BinNums.html#Z">Z</a></span>.      <span class="docright">(* divisor  *)</span><br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="Z_DIV_MUL.d_pos">d_pos</a></span>: <span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.d">d</a></span> &gt; 0.<br/>
<br/>
<div class="doc">This is theorem 4.2 from Granlund and Montgomery, PLDI 1994. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Zdiv_mul_pos">Zdiv_mul_pos</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.SelectDivproof.html#l">l</a></span> &gt;= 0 -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (<span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.N">N</a></span>+<span class="id"><a href="compcert.backend.SelectDivproof.html#l">l</a></span>) &lt;= <span class="id"><a href="compcert.backend.SelectDivproof.html#m">m</a></span> * <span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.d">d</a></span> &lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (<span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.N">N</a></span>+<span class="id"><a href="compcert.backend.SelectDivproof.html#l">l</a></span>) + <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;0 &lt;= <span class="id"><a href="compcert.backend.SelectDivproof.html#n">n</a></span> &lt; <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.N">N</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.div">Z.div</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#n">n</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.d">d</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.div">Z.div</a></span> (<span class="id"><a href="compcert.backend.SelectDivproof.html#m">m</a></span> * <span class="id"><a href="compcert.backend.SelectDivproof.html#n">n</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (<span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.N">N</a></span> + <span class="id"><a href="compcert.backend.SelectDivproof.html#l">l</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2385')">Proof.</div>
<div class="proofscript" id="proof2385">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">m</span> <span class="id">l</span> <span class="id">l_pos</span> [<span class="id">LO</span> <span class="id">HI</span>] <span class="id">n</span> <span class="id">RANGE</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zdiv.html#Z_div_mod_eq">Z_div_mod_eq</a></span> <span class="id">n</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.d">d</a></span>). <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">q</span> := <span class="id">n</span> / <span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.d">d</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">r</span> := <span class="id">n</span> <span class="id">mod</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.d">d</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">EUCL</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (0 &lt;= <span class="id">r</span> &lt;= <span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.d">d</a></span> - 1).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">r</span>. <span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zdiv.html#Z_mod_lt">Z_mod_lt</a></span> <span class="id">n</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.d">d</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.d_pos">d_pos</a></span>). <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (0 &lt;= <span class="id">m</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zmult_le_0_reg_r">Zmult_le_0_reg_r</a></span> <span class="kwd">with</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.d">d</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p_gt_ZERO">two_p_gt_ZERO</a></span> (<span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.N">N</a></span> + <span class="id">l</span>)). <span class="tactic">omega</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">k</span> := <span class="id">m</span> * <span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.d">d</a></span> - <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (<span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.N">N</a></span> + <span class="id">l</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (0 &lt;= <span class="id">k</span> &lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> <span class="id">l</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">k</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> ((<span class="id">m</span> * <span class="id">n</span> - <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (<span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.N">N</a></span> + <span class="id">l</span>) * <span class="id">q</span>) * <span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.d">d</a></span> = <span class="id">k</span> * <span class="id">n</span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (<span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.N">N</a></span> + <span class="id">l</span>) * <span class="id">r</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">k</span>. <span class="tactic">rewrite</span> <span class="id">EUCL</span>. <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (0 &lt;= <span class="id">k</span> * <span class="id">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.mul_nonneg_nonneg">Z.mul_nonneg_nonneg</a></span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">k</span> * <span class="id">n</span> &lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (<span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.N">N</a></span> + <span class="id">l</span>) - <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> <span class="id">l</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.le_trans">Z.le_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> <span class="id">l</span> * <span class="id">n</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zmult_le_compat_r">Zmult_le_compat_r</a></span>. <span class="tactic">omega</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.N">N</a></span> + <span class="id">l</span>) <span class="kwd">with</span> (<span class="id">l</span> + <span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.N">N</a></span>) <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p_is_exp">two_p_is_exp</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> <span class="id">l</span> * <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.N">N</a></span> - <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> <span class="id">l</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> <span class="id">l</span> * (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.N">N</a></span> - 1))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zmult_le_compat_l">Zmult_le_compat_l</a></span>. <span class="tactic">omega</span>. <span class="id">exploit</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p_gt_ZERO">two_p_gt_ZERO</a></span> <span class="id">l</span>). <span class="tactic">omega</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">omega</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (0 &lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (<span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.N">N</a></span> + <span class="id">l</span>) * <span class="id">r</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.mul_nonneg_nonneg">Z.mul_nonneg_nonneg</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p_gt_ZERO">two_p_gt_ZERO</a></span> (<span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.N">N</a></span> + <span class="id">l</span>)). <span class="tactic">omega</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (<span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.N">N</a></span> + <span class="id">l</span>) * <span class="id">r</span> &lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (<span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.N">N</a></span> + <span class="id">l</span>) * <span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.d">d</a></span> - <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (<span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.N">N</a></span> + <span class="id">l</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (<span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.N">N</a></span> + <span class="id">l</span>) * <span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.d">d</a></span> - <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (<span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.N">N</a></span> + <span class="id">l</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (<span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.N">N</a></span> + <span class="id">l</span>) * (<span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.d">d</a></span> - 1)) <span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zmult_le_compat_l">Zmult_le_compat_l</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p_gt_ZERO">two_p_gt_ZERO</a></span> (<span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.N">N</a></span> + <span class="id">l</span>)). <span class="tactic">omega</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (0 &lt;= <span class="id">m</span> * <span class="id">n</span> - <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (<span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.N">N</a></span> + <span class="id">l</span>) * <span class="id">q</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zmult_le_reg_r">Zmult_le_reg_r</a></span> <span class="kwd">with</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.d">d</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (0 * <span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.d">d</a></span>) <span class="kwd">with</span> 0 <span class="tactic">by</span> <span class="tactic">ring</span>.  <span class="tactic">rewrite</span> <span class="id">H2</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">m</span> * <span class="id">n</span> - <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (<span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.N">N</a></span> + <span class="id">l</span>) * <span class="id">q</span> &lt; <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (<span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.N">N</a></span> + <span class="id">l</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zmult_lt_reg_r">Zmult_lt_reg_r</a></span> <span class="kwd">with</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.d">d</a></span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.le_lt_trans">Z.le_lt_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (<span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.N">N</a></span> + <span class="id">l</span>) * <span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.d">d</a></span> - <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> <span class="id">l</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p_gt_ZERO">two_p_gt_ZERO</a></span> <span class="id">l</span>). <span class="tactic">omega</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">symmetry</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#Zdiv_unique">Zdiv_unique</a></span> <span class="kwd">with</span> (<span class="id">m</span> * <span class="id">n</span> - <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (<span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.N">N</a></span> + <span class="id">l</span>) * <span class="id">q</span>).<br/>
&nbsp;&nbsp;<span class="tactic">ring</span>. <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Zdiv_unique_2">Zdiv_unique_2</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span> <span class="id">q</span>, <span class="id"><a href="compcert.backend.SelectDivproof.html#y">y</a></span> &gt; 0 -&gt; 0 &lt; <span class="id"><a href="compcert.backend.SelectDivproof.html#y">y</a></span> * <span class="id"><a href="compcert.backend.SelectDivproof.html#q">q</a></span> - <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span> &lt;= <span class="id"><a href="compcert.backend.SelectDivproof.html#y">y</a></span> -&gt; <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.div">Z.div</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#y">y</a></span> = <span class="id"><a href="compcert.backend.SelectDivproof.html#q">q</a></span> - 1.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2386')">Proof.</div>
<div class="proofscript" id="proof2386">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#Zdiv_unique">Zdiv_unique</a></span> <span class="kwd">with</span> (<span class="id">x</span> - (<span class="id">q</span> - 1) * <span class="id">y</span>). <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> ((<span class="id">q</span> - 1) * <span class="id">y</span>) <span class="kwd">with</span> (<span class="id">y</span> * <span class="id">q</span> - <span class="id">y</span>) <span class="tactic">by</span> <span class="tactic">ring</span>. <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Zdiv_mul_opp">Zdiv_mul_opp</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.SelectDivproof.html#l">l</a></span> &gt;= 0 -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (<span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.N">N</a></span>+<span class="id"><a href="compcert.backend.SelectDivproof.html#l">l</a></span>) &lt; <span class="id"><a href="compcert.backend.SelectDivproof.html#m">m</a></span> * <span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.d">d</a></span> &lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (<span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.N">N</a></span>+<span class="id"><a href="compcert.backend.SelectDivproof.html#l">l</a></span>) + <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;0 &lt; <span class="id"><a href="compcert.backend.SelectDivproof.html#n">n</a></span> &lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.N">N</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.div">Z.div</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#n">n</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.d">d</a></span> = - <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.div">Z.div</a></span> (<span class="id"><a href="compcert.backend.SelectDivproof.html#m">m</a></span> * (-<span class="id"><a href="compcert.backend.SelectDivproof.html#n">n</a></span>)) (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (<span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.N">N</a></span> + <span class="id"><a href="compcert.backend.SelectDivproof.html#l">l</a></span>)) - 1.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2387')">Proof.</div>
<div class="proofscript" id="proof2387">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">m</span> <span class="id">l</span> <span class="id">l_pos</span> [<span class="id">LO</span> <span class="id">HI</span>] <span class="id">n</span> <span class="id">RANGE</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">m</span> * (-<span class="id">n</span>)) <span class="kwd">with</span> (- (<span class="id">m</span> * <span class="id">n</span>)) <span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zdiv.html#Z_div_mod_eq">Z_div_mod_eq</a></span> <span class="id">n</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.d">d</a></span>). <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">q</span> := <span class="id">n</span> / <span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.d">d</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">r</span> := <span class="id">n</span> <span class="id">mod</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.d">d</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">intro</span> <span class="id">EUCL</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (0 &lt;= <span class="id">r</span> &lt;= <span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.d">d</a></span> - 1).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">r</span>. <span class="tactic">generalize</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zdiv.html#Z_mod_lt">Z_mod_lt</a></span> <span class="id">n</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.d">d</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.d_pos">d_pos</a></span>). <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (0 &lt;= <span class="id">m</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zmult_le_0_reg_r">Zmult_le_0_reg_r</a></span> <span class="kwd">with</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.d">d</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p_gt_ZERO">two_p_gt_ZERO</a></span> (<span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.N">N</a></span> + <span class="id">l</span>)). <span class="tactic">omega</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">cut</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.div">Z.div</a></span> (- (<span class="id">m</span> * <span class="id">n</span>)) (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (<span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.N">N</a></span> + <span class="id">l</span>)) = -<span class="id">q</span> - 1).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#Zdiv_unique_2">Zdiv_unique_2</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p_gt_ZERO">two_p_gt_ZERO</a></span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (<span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.N">N</a></span> + <span class="id">l</span>) * - <span class="id">q</span> - - (<span class="id">m</span> * <span class="id">n</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> (<span class="id">m</span> * <span class="id">n</span> - <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (<span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.N">N</a></span> + <span class="id">l</span>) * <span class="id">q</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">k</span> := <span class="id">m</span> * <span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.d">d</a></span> - <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (<span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.N">N</a></span> + <span class="id">l</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (0 &lt; <span class="id">k</span> &lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> <span class="id">l</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">k</span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> ((<span class="id">m</span> * <span class="id">n</span> - <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (<span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.N">N</a></span> + <span class="id">l</span>) * <span class="id">q</span>) * <span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.d">d</a></span> = <span class="id">k</span> * <span class="id">n</span> + <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (<span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.N">N</a></span> + <span class="id">l</span>) * <span class="id">r</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id">k</span>. <span class="tactic">rewrite</span> <span class="id">EUCL</span>. <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zmult_lt_reg_r">Zmult_lt_reg_r</a></span> <span class="kwd">with</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.d">d</a></span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (0 * <span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.d">d</a></span>) <span class="kwd">with</span> 0 <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (0 &lt; <span class="id">k</span> * <span class="id">n</span>). <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.mul_pos_pos">Z.mul_pos_pos</a></span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (0 &lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (<span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.N">N</a></span> + <span class="id">l</span>) * <span class="id">r</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.mul_nonneg_nonneg">Z.mul_nonneg_nonneg</a></span>. <span class="id">exploit</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p_gt_ZERO">two_p_gt_ZERO</a></span> (<span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.N">N</a></span> + <span class="id">l</span>)); <span class="tactic">omega</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zmult_le_reg_r">Zmult_le_reg_r</a></span> <span class="kwd">with</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.d">d</a></span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">H2</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">k</span> * <span class="id">n</span> &lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (<span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.N">N</a></span> + <span class="id">l</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.add_comm">Z.add_comm</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p_is_exp">two_p_is_exp</a></span>; <span class="tactic">try</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.le_trans">Z.le_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> <span class="id">l</span> * <span class="id">n</span>). <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zmult_le_compat_r">Zmult_le_compat_r</a></span>. <span class="tactic">omega</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zmult_le_compat_l">Zmult_le_compat_l</a></span>. <span class="tactic">omega</span>. <span class="id">exploit</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p_gt_ZERO">two_p_gt_ZERO</a></span> <span class="id">l</span>). <span class="tactic">omega</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (<span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.N">N</a></span> + <span class="id">l</span>) * <span class="id">r</span> &lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (<span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.N">N</a></span> + <span class="id">l</span>) * <span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.d">d</a></span> - <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (<span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.N">N</a></span> + <span class="id">l</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (<span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.N">N</a></span> + <span class="id">l</span>) * <span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.d">d</a></span> - <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (<span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.N">N</a></span> + <span class="id">l</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (<span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.N">N</a></span> + <span class="id">l</span>) * (<span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.d">d</a></span> - 1))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zmult_le_compat_l">Zmult_le_compat_l</a></span>. <span class="tactic">omega</span>. <span class="id">exploit</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p_gt_ZERO">two_p_gt_ZERO</a></span> (<span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.N">N</a></span> + <span class="id">l</span>)). <span class="tactic">omega</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<div class="doc">This is theorem 5.1 from Granlund and Montgomery, PLDI 1994. </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="Zquot_mul">Zquot_mul</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">m</span> <span class="id">l</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.SelectDivproof.html#l">l</a></span> &gt;= 0 -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (<span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.N">N</a></span>+<span class="id"><a href="compcert.backend.SelectDivproof.html#l">l</a></span>) &lt; <span class="id"><a href="compcert.backend.SelectDivproof.html#m">m</a></span> * <span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.d">d</a></span> &lt;= <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (<span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.N">N</a></span>+<span class="id"><a href="compcert.backend.SelectDivproof.html#l">l</a></span>) + <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#l">l</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;- <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.N">N</a></span> &lt;= <span class="id"><a href="compcert.backend.SelectDivproof.html#n">n</a></span> &lt; <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.N">N</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.quot">Z.quot</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#n">n</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.d">d</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.div">Z.div</a></span> (<span class="id"><a href="compcert.backend.SelectDivproof.html#m">m</a></span> * <span class="id"><a href="compcert.backend.SelectDivproof.html#n">n</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (<span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.N">N</a></span> + <span class="id"><a href="compcert.backend.SelectDivproof.html#l">l</a></span>)) + (<span class="kwd">if</span> <span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#n">n</a></span> 0 <span class="kwd">then</span> 1 <span class="kwd">else</span> 0).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2388')">Proof.</div>
<div class="proofscript" id="proof2388">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> <span class="id">n</span> 0).<br/>
&nbsp;&nbsp;<span class="id">exploit</span> (<span class="id"><a href="compcert.backend.SelectDivproof.html#Zdiv_mul_opp">Zdiv_mul_opp</a></span> <span class="id">m</span> <span class="id">l</span> <span class="id">H</span> <span class="id">H0</span> (-<span class="id">n</span>)). <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (- - <span class="id">n</span>) <span class="kwd">with</span> <span class="id">n</span> <span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.quot">Z.quot</a></span> <span class="id">n</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.d">d</a></span>) <span class="kwd">with</span> (- <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.quot">Z.quot</a></span> (-<span class="id">n</span>) <span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL.d">d</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zquot.html#Zquot_Zdiv_pos">Zquot_Zdiv_pos</a></span> <span class="tactic">by</span> <span class="tactic">omega</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.quot_opp_l">Z.quot_opp_l</a></span> <span class="tactic">by</span> <span class="tactic">omega</span>. <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.add_0_r">Z.add_0_r</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zquot.html#Zquot_Zdiv_pos">Zquot_Zdiv_pos</a></span> <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#Zdiv_mul_pos">Zdiv_mul_pos</a></span>; <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#Z_DIV_MUL">Z_DIV_MUL</a></span>.<br/>
<br/>
<h1> Correctness of the division parameters </h1>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="divs_mul_params_sound">divs_mul_params_sound</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">d</span> <span class="id">m</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.SelectDiv.html#divs_mul_params">divs_mul_params</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#d">d</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="compcert.backend.SelectDivproof.html#p">p</a></span>, <span class="id"><a href="compcert.backend.SelectDivproof.html#m">m</a></span>) -&gt;<br/>
&nbsp;&nbsp;0 &lt;= <span class="id"><a href="compcert.backend.SelectDivproof.html#m">m</a></span> &lt; <span class="id"><a href="compcert.lib.Integers.html#Int.modulus">Int.modulus</a></span> /\ 0 &lt;= <span class="id"><a href="compcert.backend.SelectDivproof.html#p">p</a></span> &lt; 32 /\<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Integers.html#Int.min_signed">Int.min_signed</a></span> &lt;= <span class="id"><a href="compcert.backend.SelectDivproof.html#n">n</a></span> &lt;= <span class="id"><a href="compcert.lib.Integers.html#Int.max_signed">Int.max_signed</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.quot">Z.quot</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#n">n</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#d">d</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.div">Z.div</a></span> (<span class="id"><a href="compcert.backend.SelectDivproof.html#m">m</a></span> * <span class="id"><a href="compcert.backend.SelectDivproof.html#n">n</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (32 + <span class="id"><a href="compcert.backend.SelectDivproof.html#p">p</a></span>)) + (<span class="kwd">if</span> <span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#n">n</a></span> 0 <span class="kwd">then</span> 1 <span class="kwd">else</span> 0).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2389')">Proof with</div>
<div class="proofscript" id="proof2389">
 (<span class="tactic">try</span> <span class="tactic">discriminate</span>).<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.SelectDiv.html#divs_mul_params">divs_mul_params</a></span>; <span class="tactic">intros</span> <span class="id">d</span> <span class="id">m</span>' <span class="id">p</span>'.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.backend.SelectDiv.html#find_div_mul_params">find_div_mul_params</a></span> <span class="id"><a href="compcert.lib.Integers.html#Int.wordsize">Int.wordsize</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.lib.Integers.html#Int.half_modulus">Int.half_modulus</a></span> - <span class="id"><a href="compcert.lib.Integers.html#Int.half_modulus">Int.half_modulus</a></span> <span class="id">mod</span> <span class="id">d</span> - 1) <span class="id">d</span> 32)<br/>
&nbsp;&nbsp;<span class="kwd">as</span> [[<span class="id">p</span> <span class="id">m</span>] | ]...<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">p</span> - 32). <span class="tactic">intro</span> <span class="id">p1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> 0 <span class="id">d</span>)...<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (32 + <span class="id">p1</span>)) (<span class="id">m</span> * <span class="id">d</span>))...<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zle">zle</a></span> (<span class="id">m</span> * <span class="id">d</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (32 + <span class="id">p1</span>) + <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (<span class="id">p1</span> + 1)))...<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zle">zle</a></span> 0 <span class="id">m</span>)...<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> <span class="id">m</span> <span class="id"><a href="compcert.lib.Integers.html#Int.modulus">Int.modulus</a></span>)...<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zle">zle</a></span> 0 <span class="id">p1</span>)...<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> <span class="id">p1</span> 32)...<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">EQ</span>; <span class="id">inv</span> <span class="id">EQ</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">auto</span>. <span class="tactic">split</span>. <span class="tactic">auto</span>. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (32 + <span class="id">p</span>') <span class="kwd">with</span> (31 + (<span class="id">p</span>' + 1)) <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#Zquot_mul">Zquot_mul</a></span>; <span class="tactic">try</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (31 + (<span class="id">p</span>' + 1)) <span class="kwd">with</span> (32 + <span class="id">p</span>') <span class="tactic">by</span> <span class="tactic">omega</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="id">change</span> (<span class="id"><a href="compcert.lib.Integers.html#Int.min_signed">Int.min_signed</a></span> &lt;= <span class="id">n</span> &lt; <span class="id"><a href="compcert.lib.Integers.html#Int.half_modulus">Int.half_modulus</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.lib.Integers.html#Int.max_signed">Int.max_signed</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="divu_mul_params_sound">divu_mul_params_sound</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">d</span> <span class="id">m</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.SelectDiv.html#divu_mul_params">divu_mul_params</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#d">d</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="compcert.backend.SelectDivproof.html#p">p</a></span>, <span class="id"><a href="compcert.backend.SelectDivproof.html#m">m</a></span>) -&gt;<br/>
&nbsp;&nbsp;0 &lt;= <span class="id"><a href="compcert.backend.SelectDivproof.html#m">m</a></span> &lt; <span class="id"><a href="compcert.lib.Integers.html#Int.modulus">Int.modulus</a></span> /\ 0 &lt;= <span class="id"><a href="compcert.backend.SelectDivproof.html#p">p</a></span> &lt; 32 /\<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;0 &lt;= <span class="id"><a href="compcert.backend.SelectDivproof.html#n">n</a></span> &lt; <span class="id"><a href="compcert.lib.Integers.html#Int.modulus">Int.modulus</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.div">Z.div</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#n">n</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#d">d</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.div">Z.div</a></span> (<span class="id"><a href="compcert.backend.SelectDivproof.html#m">m</a></span> * <span class="id"><a href="compcert.backend.SelectDivproof.html#n">n</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (32 + <span class="id"><a href="compcert.backend.SelectDivproof.html#p">p</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2390')">Proof with</div>
<div class="proofscript" id="proof2390">
 (<span class="tactic">try</span> <span class="tactic">discriminate</span>).<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.SelectDiv.html#divu_mul_params">divu_mul_params</a></span>; <span class="tactic">intros</span> <span class="id">d</span> <span class="id">m</span>' <span class="id">p</span>'.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.backend.SelectDiv.html#find_div_mul_params">find_div_mul_params</a></span> <span class="id"><a href="compcert.lib.Integers.html#Int.wordsize">Int.wordsize</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.lib.Integers.html#Int.modulus">Int.modulus</a></span> - <span class="id"><a href="compcert.lib.Integers.html#Int.modulus">Int.modulus</a></span> <span class="id">mod</span> <span class="id">d</span> - 1) <span class="id">d</span> 32)<br/>
&nbsp;&nbsp;<span class="kwd">as</span> [[<span class="id">p</span> <span class="id">m</span>] | ]...<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">p</span> - 32); <span class="tactic">intro</span> <span class="id">p1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> 0 <span class="id">d</span>)...<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zle">zle</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (32 + <span class="id">p1</span>)) (<span class="id">m</span> * <span class="id">d</span>))...<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zle">zle</a></span> (<span class="id">m</span> * <span class="id">d</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (32 + <span class="id">p1</span>) + <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> <span class="id">p1</span>))...<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zle">zle</a></span> 0 <span class="id">m</span>)...<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> <span class="id">m</span> <span class="id"><a href="compcert.lib.Integers.html#Int.modulus">Int.modulus</a></span>)...<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zle">zle</a></span> 0 <span class="id">p1</span>)...<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> <span class="id">p1</span> 32)...<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">EQ</span>; <span class="id">inv</span> <span class="id">EQ</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">auto</span>. <span class="tactic">split</span>. <span class="tactic">auto</span>. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#Zdiv_mul_pos">Zdiv_mul_pos</a></span>; <span class="tactic">try</span> <span class="tactic">omega</span>. <span class="tactic">assumption</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="divs_mul_shift_gen">divs_mul_shift_gen</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span> <span class="id">m</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.SelectDiv.html#divs_mul_params">divs_mul_params</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int.signed">Int.signed</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#y">y</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="compcert.backend.SelectDivproof.html#p">p</a></span>, <span class="id"><a href="compcert.backend.SelectDivproof.html#m">m</a></span>) -&gt;<br/>
&nbsp;&nbsp;0 &lt;= <span class="id"><a href="compcert.backend.SelectDivproof.html#m">m</a></span> &lt; <span class="id"><a href="compcert.lib.Integers.html#Int.modulus">Int.modulus</a></span> /\ 0 &lt;= <span class="id"><a href="compcert.backend.SelectDivproof.html#p">p</a></span> &lt; 32 /\<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Integers.html#Int.divs">Int.divs</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#y">y</a></span> = <span class="id"><a href="compcert.lib.Integers.html#Int.add">Int.add</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int.shr">Int.shr</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int.repr">Int.repr</a></span> ((<span class="id"><a href="compcert.lib.Integers.html#Int.signed">Int.signed</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span> * <span class="id"><a href="compcert.backend.SelectDivproof.html#m">m</a></span>) / <span class="id"><a href="compcert.lib.Integers.html#Int.modulus">Int.modulus</a></span>)) (<span class="id"><a href="compcert.lib.Integers.html#Int.repr">Int.repr</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#p">p</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.lib.Integers.html#Int.shru">Int.shru</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int.repr">Int.repr</a></span> 31)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2391')">Proof.</div>
<div class="proofscript" id="proof2391">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">set</span> (<span class="id">n</span> := <span class="id"><a href="compcert.lib.Integers.html#Int.signed">Int.signed</a></span> <span class="id">x</span>). <span class="tactic">set</span> (<span class="id">d</span> := <span class="id"><a href="compcert.lib.Integers.html#Int.signed">Int.signed</a></span> <span class="id">y</span>) <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#divs_mul_params_sound">divs_mul_params_sound</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span>).<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">auto</span>. <span class="tactic">split</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.lib.Integers.html#Int.divs">Int.divs</a></span>. <span class="id">fold</span> <span class="id">n</span>; <span class="id">fold</span> <span class="id">d</span>. <span class="tactic">rewrite</span> <span class="id">C</span> <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Integers.html#Int.signed_range">Int.signed_range</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p_is_exp">two_p_is_exp</a></span> <span class="tactic">by</span> <span class="tactic">omega</span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.lib.Coqlib.html#Zdiv_Zdiv">Zdiv_Zdiv</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Integers.html#Int.shru_lt_zero">Int.shru_lt_zero</a></span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.lib.Integers.html#Int.add">Int.add</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Integers.html#Int.eqm_samerepr">Int.eqm_samerepr</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Integers.html#Int.eqm_add">Int.eqm_add</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Integers.html#Int.shr_div_two_p">Int.shr_div_two_p</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Integers.html#Int.eqm_unsigned_repr_r">Int.eqm_unsigned_repr_r</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Integers.html#Int.eqm_refl2">Int.eqm_refl2</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Integers.html#Int.unsigned_repr">Int.unsigned_repr</a></span>. <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Integers.html#Int.signed_repr">Int.signed_repr</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Integers.html#Int.modulus_power">Int.modulus_power</a></span>. <span class="tactic">f_equal</span>. <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;<span class="tactic">cut</span> (<span class="id"><a href="compcert.lib.Integers.html#Int.min_signed">Int.min_signed</a></span> &lt;= <span class="id">n</span> * <span class="id">m</span> / <span class="id"><a href="compcert.lib.Integers.html#Int.modulus">Int.modulus</a></span> &lt; <span class="id"><a href="compcert.lib.Integers.html#Int.half_modulus">Int.half_modulus</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.lib.Integers.html#Int.max_signed">Int.max_signed</a></span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#Zdiv_interval_1">Zdiv_interval_1</a></span>. <span class="tactic">generalize</span> <span class="id"><a href="compcert.lib.Integers.html#Int.min_signed_neg">Int.min_signed_neg</a></span>; <span class="tactic">omega</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Integers.html#Int.half_modulus_pos">Int.half_modulus_pos</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Integers.html#Int.modulus_pos">Int.modulus_pos</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.le_trans">Z.le_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="compcert.lib.Integers.html#Int.min_signed">Int.min_signed</a></span> * <span class="id">m</span>). <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#Zmult_le_compat_l_neg">Zmult_le_compat_l_neg</a></span>. <span class="tactic">omega</span>. <span class="tactic">generalize</span> <span class="id"><a href="compcert.lib.Integers.html#Int.min_signed_neg">Int.min_signed_neg</a></span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zmult_le_compat_r">Zmult_le_compat_r</a></span>. <span class="tactic">unfold</span> <span class="id">n</span>; <span class="tactic">generalize</span> (<span class="id"><a href="compcert.lib.Integers.html#Int.signed_range">Int.signed_range</a></span> <span class="id">x</span>); <span class="tactic">tauto</span>. <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.le_lt_trans">Z.le_lt_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="compcert.lib.Integers.html#Int.half_modulus">Int.half_modulus</a></span> * <span class="id">m</span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zmult_le_compat_r">Zmult_le_compat_r</a></span>. <span class="tactic">generalize</span> (<span class="id"><a href="compcert.lib.Integers.html#Int.signed_range">Int.signed_range</a></span> <span class="id">x</span>); <span class="tactic">unfold</span> <span class="id">n</span>, <span class="id"><a href="compcert.lib.Integers.html#Int.max_signed">Int.max_signed</a></span>; <span class="tactic">omega</span>. <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zmult_lt_compat_l">Zmult_lt_compat_l</a></span>. <span class="tactic">generalize</span> <span class="id"><a href="compcert.lib.Integers.html#Int.half_modulus_pos">Int.half_modulus_pos</a></span>; <span class="tactic">omega</span>. <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (32 &lt; <span class="id"><a href="compcert.lib.Integers.html#Int.max_unsigned">Int.max_unsigned</a></span>) <span class="tactic">by</span> (<span class="tactic">compute</span>; <span class="tactic">auto</span>). <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.lib.Integers.html#Int.lt">Int.lt</a></span>; <span class="id">fold</span> <span class="id">n</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Integers.html#Int.signed_zero">Int.signed_zero</a></span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> <span class="id">n</span> 0); <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Integers.html#Int.eqm_unsigned_repr">Int.eqm_unsigned_repr</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p_gt_ZERO">two_p_gt_ZERO</a></span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p_gt_ZERO">two_p_gt_ZERO</a></span>. <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="divs_mul_shift_1">divs_mul_shift_1</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span> <span class="id">m</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.SelectDiv.html#divs_mul_params">divs_mul_params</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int.signed">Int.signed</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#y">y</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="compcert.backend.SelectDivproof.html#p">p</a></span>, <span class="id"><a href="compcert.backend.SelectDivproof.html#m">m</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.SelectDivproof.html#m">m</a></span> &lt; <span class="id"><a href="compcert.lib.Integers.html#Int.half_modulus">Int.half_modulus</a></span> -&gt;<br/>
&nbsp;&nbsp;0 &lt;= <span class="id"><a href="compcert.backend.SelectDivproof.html#p">p</a></span> &lt; 32 /\<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Integers.html#Int.divs">Int.divs</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#y">y</a></span> = <span class="id"><a href="compcert.lib.Integers.html#Int.add">Int.add</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int.shr">Int.shr</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int.mulhs">Int.mulhs</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int.repr">Int.repr</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#m">m</a></span>)) (<span class="id"><a href="compcert.lib.Integers.html#Int.repr">Int.repr</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#p">p</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.lib.Integers.html#Int.shru">Int.shru</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int.repr">Int.repr</a></span> 31)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2392')">Proof.</div>
<div class="proofscript" id="proof2392">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#divs_mul_shift_gen">divs_mul_shift_gen</a></span>; <span class="tactic">eauto</span>. <span class="id">instantiate</span> (1 := <span class="id">x</span>).<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span>). <span class="tactic">split</span>. <span class="tactic">auto</span>. <span class="tactic">rewrite</span> <span class="id">C</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.lib.Integers.html#Int.mulhs">Int.mulhs</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Integers.html#Int.signed_repr">Int.signed_repr</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="id"><a href="compcert.lib.Integers.html#Int.min_signed_neg">Int.min_signed_neg</a></span>; <span class="tactic">unfold</span> <span class="id"><a href="compcert.lib.Integers.html#Int.max_signed">Int.max_signed</a></span>; <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="divs_mul_shift_2">divs_mul_shift_2</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span> <span class="id">m</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.SelectDiv.html#divs_mul_params">divs_mul_params</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int.signed">Int.signed</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#y">y</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="compcert.backend.SelectDivproof.html#p">p</a></span>, <span class="id"><a href="compcert.backend.SelectDivproof.html#m">m</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.SelectDivproof.html#m">m</a></span> &gt;= <span class="id"><a href="compcert.lib.Integers.html#Int.half_modulus">Int.half_modulus</a></span> -&gt;<br/>
&nbsp;&nbsp;0 &lt;= <span class="id"><a href="compcert.backend.SelectDivproof.html#p">p</a></span> &lt; 32 /\<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Integers.html#Int.divs">Int.divs</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#y">y</a></span> = <span class="id"><a href="compcert.lib.Integers.html#Int.add">Int.add</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int.shr">Int.shr</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int.add">Int.add</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int.mulhs">Int.mulhs</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int.repr">Int.repr</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#m">m</a></span>)) <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span>) (<span class="id"><a href="compcert.lib.Integers.html#Int.repr">Int.repr</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#p">p</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.lib.Integers.html#Int.shru">Int.shru</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int.repr">Int.repr</a></span> 31)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2393')">Proof.</div>
<div class="proofscript" id="proof2393">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#divs_mul_shift_gen">divs_mul_shift_gen</a></span>; <span class="tactic">eauto</span>. <span class="id">instantiate</span> (1 := <span class="id">x</span>).<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span>). <span class="tactic">split</span>. <span class="tactic">auto</span>. <span class="tactic">rewrite</span> <span class="id">C</span>. <span class="tactic">f_equal</span>. <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Integers.html#Int.add_signed">Int.add_signed</a></span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.lib.Integers.html#Int.mulhs">Int.mulhs</a></span>. <span class="tactic">set</span> (<span class="id">n</span> := <span class="id"><a href="compcert.lib.Integers.html#Int.signed">Int.signed</a></span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;<span class="tactic">transitivity</span> (<span class="id"><a href="compcert.lib.Integers.html#Int.repr">Int.repr</a></span> (<span class="id">n</span> * (<span class="id">m</span> - <span class="id"><a href="compcert.lib.Integers.html#Int.modulus">Int.modulus</a></span>) / <span class="id"><a href="compcert.lib.Integers.html#Int.modulus">Int.modulus</a></span> + <span class="id">n</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">n</span> * (<span class="id">m</span> - <span class="id"><a href="compcert.lib.Integers.html#Int.modulus">Int.modulus</a></span>)) <span class="kwd">with</span> (<span class="id">n</span> * <span class="id">m</span> +  (-<span class="id">n</span>) * <span class="id"><a href="compcert.lib.Integers.html#Int.modulus">Int.modulus</a></span>) <span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zdiv.html#Z_div_plus">Z_div_plus</a></span>. <span class="tactic">ring</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Integers.html#Int.modulus_pos">Int.modulus_pos</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Integers.html#Int.eqm_samerepr">Int.eqm_samerepr</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Integers.html#Int.eqm_add">Int.eqm_add</a></span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">ints</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Integers.html#Int.eqm_sym">Int.eqm_sym</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.lib.Integers.html#Int.eqm_trans">Int.eqm_trans</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Integers.html#Int.eqm_signed_unsigned">Int.eqm_signed_unsigned</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Integers.html#Int.eqm_unsigned_repr_l">Int.eqm_unsigned_repr_l</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Integers.html#Int.eqm_refl2">Int.eqm_refl2</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="tactic">f_equal</span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">n</span> * <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span> / <span class="id"><a href="compcert.lib.Integers.html#Int.modulus">Int.modulus</a></span>)).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Integers.html#Int.signed_repr_eq">Int.signed_repr_eq</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#Zmod_small">Zmod_small</a></span> <span class="tactic">by</span> <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#zlt_false">zlt_false</a></span>. <span class="tactic">assumption</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="divu_mul_shift">divu_mul_shift</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span> <span class="id">m</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.SelectDiv.html#divu_mul_params">divu_mul_params</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int.unsigned">Int.unsigned</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#y">y</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="compcert.backend.SelectDivproof.html#p">p</a></span>, <span class="id"><a href="compcert.backend.SelectDivproof.html#m">m</a></span>) -&gt;<br/>
&nbsp;&nbsp;0 &lt;= <span class="id"><a href="compcert.backend.SelectDivproof.html#p">p</a></span> &lt; 32 /\<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Integers.html#Int.divu">Int.divu</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#y">y</a></span> = <span class="id"><a href="compcert.lib.Integers.html#Int.shru">Int.shru</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int.mulhu">Int.mulhu</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int.repr">Int.repr</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#m">m</a></span>)) (<span class="id"><a href="compcert.lib.Integers.html#Int.repr">Int.repr</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#p">p</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2394')">Proof.</div>
<div class="proofscript" id="proof2394">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#divu_mul_params_sound">divu_mul_params_sound</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span>).<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Integers.html#Int.shru_div_two_p">Int.shru_div_two_p</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Integers.html#Int.unsigned_repr">Int.unsigned_repr</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.lib.Integers.html#Int.divu">Int.divu</a></span>, <span class="id"><a href="compcert.lib.Integers.html#Int.mulhu">Int.mulhu</a></span>. <span class="tactic">f_equal</span>. <span class="tactic">rewrite</span> <span class="id">C</span> <span class="tactic">by</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Integers.html#Int.unsigned_range">Int.unsigned_range</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p_is_exp">two_p_is_exp</a></span> <span class="tactic">by</span> <span class="tactic">omega</span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.lib.Coqlib.html#Zdiv_Zdiv">Zdiv_Zdiv</a></span> <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p_gt_ZERO">two_p_gt_ZERO</a></span>; <span class="tactic">omega</span>).<br/>
&nbsp;&nbsp;<span class="tactic">f_equal</span>. <span class="tactic">rewrite</span> (<span class="id"><a href="compcert.lib.Integers.html#Int.unsigned_repr">Int.unsigned_repr</a></span> <span class="id">m</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Integers.html#Int.unsigned_repr">Int.unsigned_repr</a></span>. <span class="tactic">f_equal</span>. <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;<span class="tactic">cut</span> (0 &lt;= <span class="id"><a href="compcert.lib.Integers.html#Int.unsigned">Int.unsigned</a></span> <span class="id">x</span> * <span class="id">m</span> / <span class="id"><a href="compcert.lib.Integers.html#Int.modulus">Int.modulus</a></span> &lt; <span class="id"><a href="compcert.lib.Integers.html#Int.modulus">Int.modulus</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.lib.Integers.html#Int.max_unsigned">Int.max_unsigned</a></span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#Zdiv_interval_1">Zdiv_interval_1</a></span>. <span class="tactic">omega</span>. <span class="tactic">compute</span>; <span class="tactic">auto</span>. <span class="tactic">compute</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.mul_nonneg_nonneg">Z.mul_nonneg_nonneg</a></span>. <span class="tactic">generalize</span> (<span class="id"><a href="compcert.lib.Integers.html#Int.unsigned_range">Int.unsigned_range</a></span> <span class="id">x</span>); <span class="tactic">omega</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.le_lt_trans">Z.le_lt_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="compcert.lib.Integers.html#Int.modulus">Int.modulus</a></span> * <span class="id">m</span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zmult_le_compat_r">Zmult_le_compat_r</a></span>. <span class="tactic">generalize</span> (<span class="id"><a href="compcert.lib.Integers.html#Int.unsigned_range">Int.unsigned_range</a></span> <span class="id">x</span>); <span class="tactic">omega</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zmult_lt_compat_l">Zmult_lt_compat_l</a></span>. <span class="tactic">compute</span>; <span class="tactic">auto</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.lib.Integers.html#Int.max_unsigned">Int.max_unsigned</a></span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (32 &lt; <span class="id"><a href="compcert.lib.Integers.html#Int.max_unsigned">Int.max_unsigned</a></span>) <span class="tactic">by</span> (<span class="tactic">compute</span>; <span class="tactic">auto</span>). <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<div class="doc">Same, for 64-bit integers </div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="divls_mul_params_sound">divls_mul_params_sound</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">d</span> <span class="id">m</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.SelectDiv.html#divls_mul_params">divls_mul_params</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#d">d</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="compcert.backend.SelectDivproof.html#p">p</a></span>, <span class="id"><a href="compcert.backend.SelectDivproof.html#m">m</a></span>) -&gt;<br/>
&nbsp;&nbsp;0 &lt;= <span class="id"><a href="compcert.backend.SelectDivproof.html#m">m</a></span> &lt; <span class="id"><a href="compcert.lib.Integers.html#Int64.modulus">Int64.modulus</a></span> /\ 0 &lt;= <span class="id"><a href="compcert.backend.SelectDivproof.html#p">p</a></span> &lt; 64 /\<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Integers.html#Int64.min_signed">Int64.min_signed</a></span> &lt;= <span class="id"><a href="compcert.backend.SelectDivproof.html#n">n</a></span> &lt;= <span class="id"><a href="compcert.lib.Integers.html#Int64.max_signed">Int64.max_signed</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.quot">Z.quot</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#n">n</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#d">d</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.div">Z.div</a></span> (<span class="id"><a href="compcert.backend.SelectDivproof.html#m">m</a></span> * <span class="id"><a href="compcert.backend.SelectDivproof.html#n">n</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (64 + <span class="id"><a href="compcert.backend.SelectDivproof.html#p">p</a></span>)) + (<span class="kwd">if</span> <span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#n">n</a></span> 0 <span class="kwd">then</span> 1 <span class="kwd">else</span> 0).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2395')">Proof with</div>
<div class="proofscript" id="proof2395">
 (<span class="tactic">try</span> <span class="tactic">discriminate</span>).<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.SelectDiv.html#divls_mul_params">divls_mul_params</a></span>; <span class="tactic">intros</span> <span class="id">d</span> <span class="id">m</span>' <span class="id">p</span>'.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.backend.SelectDiv.html#find_div_mul_params">find_div_mul_params</a></span> <span class="id"><a href="compcert.lib.Integers.html#Int64.wordsize">Int64.wordsize</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.lib.Integers.html#Int64.half_modulus">Int64.half_modulus</a></span> - <span class="id"><a href="compcert.lib.Integers.html#Int64.half_modulus">Int64.half_modulus</a></span> <span class="id">mod</span> <span class="id">d</span> - 1) <span class="id">d</span> 64)<br/>
&nbsp;&nbsp;<span class="kwd">as</span> [[<span class="id">p</span> <span class="id">m</span>] | ]...<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">p</span> - 64). <span class="tactic">intro</span> <span class="id">p1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> 0 <span class="id">d</span>)...<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (64 + <span class="id">p1</span>)) (<span class="id">m</span> * <span class="id">d</span>))...<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zle">zle</a></span> (<span class="id">m</span> * <span class="id">d</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (64 + <span class="id">p1</span>) + <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (<span class="id">p1</span> + 1)))...<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zle">zle</a></span> 0 <span class="id">m</span>)...<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> <span class="id">m</span> <span class="id"><a href="compcert.lib.Integers.html#Int64.modulus">Int64.modulus</a></span>)...<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zle">zle</a></span> 0 <span class="id">p1</span>)...<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> <span class="id">p1</span> 64)...<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">EQ</span>; <span class="id">inv</span> <span class="id">EQ</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">auto</span>. <span class="tactic">split</span>. <span class="tactic">auto</span>. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (64 + <span class="id">p</span>') <span class="kwd">with</span> (63 + (<span class="id">p</span>' + 1)) <span class="tactic">by</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#Zquot_mul">Zquot_mul</a></span>; <span class="tactic">try</span> <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (63 + (<span class="id">p</span>' + 1)) <span class="kwd">with</span> (64 + <span class="id">p</span>') <span class="tactic">by</span> <span class="tactic">omega</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="id">change</span> (<span class="id"><a href="compcert.lib.Integers.html#Int64.min_signed">Int64.min_signed</a></span> &lt;= <span class="id">n</span> &lt; <span class="id"><a href="compcert.lib.Integers.html#Int64.half_modulus">Int64.half_modulus</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.lib.Integers.html#Int64.max_signed">Int64.max_signed</a></span> <span class="kwd">in</span> <span class="id">H</span>. <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="divlu_mul_params_sound">divlu_mul_params_sound</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">d</span> <span class="id">m</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.SelectDiv.html#divlu_mul_params">divlu_mul_params</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#d">d</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="compcert.backend.SelectDivproof.html#p">p</a></span>, <span class="id"><a href="compcert.backend.SelectDivproof.html#m">m</a></span>) -&gt;<br/>
&nbsp;&nbsp;0 &lt;= <span class="id"><a href="compcert.backend.SelectDivproof.html#m">m</a></span> &lt; <span class="id"><a href="compcert.lib.Integers.html#Int64.modulus">Int64.modulus</a></span> /\ 0 &lt;= <span class="id"><a href="compcert.backend.SelectDivproof.html#p">p</a></span> &lt; 64 /\<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">n</span>,<br/>
&nbsp;&nbsp;0 &lt;= <span class="id"><a href="compcert.backend.SelectDivproof.html#n">n</a></span> &lt; <span class="id"><a href="compcert.lib.Integers.html#Int64.modulus">Int64.modulus</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.div">Z.div</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#n">n</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#d">d</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.div">Z.div</a></span> (<span class="id"><a href="compcert.backend.SelectDivproof.html#m">m</a></span> * <span class="id"><a href="compcert.backend.SelectDivproof.html#n">n</a></span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (64 + <span class="id"><a href="compcert.backend.SelectDivproof.html#p">p</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2396')">Proof with</div>
<div class="proofscript" id="proof2396">
 (<span class="tactic">try</span> <span class="tactic">discriminate</span>).<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.SelectDiv.html#divlu_mul_params">divlu_mul_params</a></span>; <span class="tactic">intros</span> <span class="id">d</span> <span class="id">m</span>' <span class="id">p</span>'.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.backend.SelectDiv.html#find_div_mul_params">find_div_mul_params</a></span> <span class="id"><a href="compcert.lib.Integers.html#Int64.wordsize">Int64.wordsize</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.lib.Integers.html#Int64.modulus">Int64.modulus</a></span> - <span class="id"><a href="compcert.lib.Integers.html#Int64.modulus">Int64.modulus</a></span> <span class="id">mod</span> <span class="id">d</span> - 1) <span class="id">d</span> 64)<br/>
&nbsp;&nbsp;<span class="kwd">as</span> [[<span class="id">p</span> <span class="id">m</span>] | ]...<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> (<span class="id">p</span> - 64); <span class="tactic">intro</span> <span class="id">p1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> 0 <span class="id">d</span>)...<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zle">zle</a></span> (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (64 + <span class="id">p1</span>)) (<span class="id">m</span> * <span class="id">d</span>))...<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zle">zle</a></span> (<span class="id">m</span> * <span class="id">d</span>) (<span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (64 + <span class="id">p1</span>) + <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> <span class="id">p1</span>))...<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zle">zle</a></span> 0 <span class="id">m</span>)...<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> <span class="id">m</span> <span class="id"><a href="compcert.lib.Integers.html#Int64.modulus">Int64.modulus</a></span>)...<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zle">zle</a></span> 0 <span class="id">p1</span>)...<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> <span class="id">p1</span> 64)...<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">EQ</span>; <span class="id">inv</span> <span class="id">EQ</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">auto</span>. <span class="tactic">split</span>. <span class="tactic">auto</span>. <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#Zdiv_mul_pos">Zdiv_mul_pos</a></span>; <span class="tactic">try</span> <span class="tactic">omega</span>. <span class="tactic">assumption</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id">int64_shr</span>'<span class="id">_div_two_p</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>, <span class="id">Int64.shr</span>' <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#y">y</a></span> = <span class="id"><a href="compcert.lib.Integers.html#Int64.repr">Int64.repr</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int64.signed">Int64.signed</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span> / <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int.unsigned">Int.unsigned</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#y">y</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2397')">Proof.</div>
<div class="proofscript" id="proof2397">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">unfold</span> <span class="id">Int64.shr</span>'. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Integers.html#Int64.Zshiftr_div_two_p">Int64.Zshiftr_div_two_p</a></span>; <span class="tactic">auto</span>. <span class="tactic">generalize</span> (<span class="id"><a href="compcert.lib.Integers.html#Int.unsigned_range">Int.unsigned_range</a></span> <span class="id">y</span>); <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="divls_mul_shift_gen">divls_mul_shift_gen</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span> <span class="id">m</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.SelectDiv.html#divls_mul_params">divls_mul_params</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int64.signed">Int64.signed</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#y">y</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="compcert.backend.SelectDivproof.html#p">p</a></span>, <span class="id"><a href="compcert.backend.SelectDivproof.html#m">m</a></span>) -&gt;<br/>
&nbsp;&nbsp;0 &lt;= <span class="id"><a href="compcert.backend.SelectDivproof.html#m">m</a></span> &lt; <span class="id"><a href="compcert.lib.Integers.html#Int64.modulus">Int64.modulus</a></span> /\ 0 &lt;= <span class="id"><a href="compcert.backend.SelectDivproof.html#p">p</a></span> &lt; 64 /\<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Integers.html#Int64.divs">Int64.divs</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#y">y</a></span> = <span class="id"><a href="compcert.lib.Integers.html#Int64.add">Int64.add</a></span> (<span class="id">Int64.shr</span>' (<span class="id"><a href="compcert.lib.Integers.html#Int64.repr">Int64.repr</a></span> ((<span class="id"><a href="compcert.lib.Integers.html#Int64.signed">Int64.signed</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span> * <span class="id"><a href="compcert.backend.SelectDivproof.html#m">m</a></span>) / <span class="id"><a href="compcert.lib.Integers.html#Int64.modulus">Int64.modulus</a></span>)) (<span class="id"><a href="compcert.lib.Integers.html#Int.repr">Int.repr</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#p">p</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id"><a href="compcert.lib.Integers.html#Int64.shru">Int64.shru</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int64.repr">Int64.repr</a></span> 63)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2398')">Proof.</div>
<div class="proofscript" id="proof2398">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">set</span> (<span class="id">n</span> := <span class="id"><a href="compcert.lib.Integers.html#Int64.signed">Int64.signed</a></span> <span class="id">x</span>). <span class="tactic">set</span> (<span class="id">d</span> := <span class="id"><a href="compcert.lib.Integers.html#Int64.signed">Int64.signed</a></span> <span class="id">y</span>) <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#divls_mul_params_sound">divls_mul_params_sound</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span>).<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">auto</span>. <span class="tactic">split</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.lib.Integers.html#Int64.divs">Int64.divs</a></span>. <span class="id">fold</span> <span class="id">n</span>; <span class="id">fold</span> <span class="id">d</span>. <span class="tactic">rewrite</span> <span class="id">C</span> <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Integers.html#Int64.signed_range">Int64.signed_range</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p_is_exp">two_p_is_exp</a></span> <span class="tactic">by</span> <span class="tactic">omega</span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.lib.Coqlib.html#Zdiv_Zdiv">Zdiv_Zdiv</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Integers.html#Int64.shru_lt_zero">Int64.shru_lt_zero</a></span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.lib.Integers.html#Int64.add">Int64.add</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Integers.html#Int64.eqm_samerepr">Int64.eqm_samerepr</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Integers.html#Int64.eqm_add">Int64.eqm_add</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">int64_shr</span>'<span class="id">_div_two_p</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Integers.html#Int64.eqm_unsigned_repr_r">Int64.eqm_unsigned_repr_r</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Integers.html#Int64.eqm_refl2">Int64.eqm_refl2</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Integers.html#Int.unsigned_repr">Int.unsigned_repr</a></span>. <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Integers.html#Int64.signed_repr">Int64.signed_repr</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Integers.html#Int64.modulus_power">Int64.modulus_power</a></span>. <span class="tactic">f_equal</span>. <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;<span class="tactic">cut</span> (<span class="id"><a href="compcert.lib.Integers.html#Int64.min_signed">Int64.min_signed</a></span> &lt;= <span class="id">n</span> * <span class="id">m</span> / <span class="id"><a href="compcert.lib.Integers.html#Int64.modulus">Int64.modulus</a></span> &lt; <span class="id"><a href="compcert.lib.Integers.html#Int64.half_modulus">Int64.half_modulus</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.lib.Integers.html#Int64.max_signed">Int64.max_signed</a></span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#Zdiv_interval_1">Zdiv_interval_1</a></span>. <span class="tactic">generalize</span> <span class="id"><a href="compcert.lib.Integers.html#Int64.min_signed_neg">Int64.min_signed_neg</a></span>; <span class="tactic">omega</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Integers.html#Int64.half_modulus_pos">Int64.half_modulus_pos</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Integers.html#Int64.modulus_pos">Int64.modulus_pos</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.le_trans">Z.le_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="compcert.lib.Integers.html#Int64.min_signed">Int64.min_signed</a></span> * <span class="id">m</span>). <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#Zmult_le_compat_l_neg">Zmult_le_compat_l_neg</a></span>. <span class="tactic">omega</span>. <span class="tactic">generalize</span> <span class="id"><a href="compcert.lib.Integers.html#Int64.min_signed_neg">Int64.min_signed_neg</a></span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zmult_le_compat_r">Zmult_le_compat_r</a></span>. <span class="tactic">unfold</span> <span class="id">n</span>; <span class="tactic">generalize</span> (<span class="id"><a href="compcert.lib.Integers.html#Int64.signed_range">Int64.signed_range</a></span> <span class="id">x</span>); <span class="tactic">tauto</span>. <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.le_lt_trans">Z.le_lt_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="compcert.lib.Integers.html#Int64.half_modulus">Int64.half_modulus</a></span> * <span class="id">m</span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zmult_le_compat_r">Zmult_le_compat_r</a></span>. <span class="tactic">generalize</span> (<span class="id"><a href="compcert.lib.Integers.html#Int64.signed_range">Int64.signed_range</a></span> <span class="id">x</span>); <span class="tactic">unfold</span> <span class="id">n</span>, <span class="id"><a href="compcert.lib.Integers.html#Int64.max_signed">Int64.max_signed</a></span>; <span class="tactic">omega</span>. <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zmult_lt_compat_l">Zmult_lt_compat_l</a></span>. <span class="tactic">generalize</span> <span class="id"><a href="compcert.lib.Integers.html#Int64.half_modulus_pos">Int64.half_modulus_pos</a></span>; <span class="tactic">omega</span>. <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (64 &lt; <span class="id"><a href="compcert.lib.Integers.html#Int.max_unsigned">Int.max_unsigned</a></span>) <span class="tactic">by</span> (<span class="tactic">compute</span>; <span class="tactic">auto</span>). <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.lib.Integers.html#Int64.lt">Int64.lt</a></span>; <span class="id">fold</span> <span class="id">n</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Integers.html#Int64.signed_zero">Int64.signed_zero</a></span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> <span class="id">n</span> 0); <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Integers.html#Int64.eqm_unsigned_repr">Int64.eqm_unsigned_repr</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p_gt_ZERO">two_p_gt_ZERO</a></span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p_gt_ZERO">two_p_gt_ZERO</a></span>. <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="divls_mul_shift_1">divls_mul_shift_1</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span> <span class="id">m</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.SelectDiv.html#divls_mul_params">divls_mul_params</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int64.signed">Int64.signed</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#y">y</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="compcert.backend.SelectDivproof.html#p">p</a></span>, <span class="id"><a href="compcert.backend.SelectDivproof.html#m">m</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.SelectDivproof.html#m">m</a></span> &lt; <span class="id"><a href="compcert.lib.Integers.html#Int64.half_modulus">Int64.half_modulus</a></span> -&gt;<br/>
&nbsp;&nbsp;0 &lt;= <span class="id"><a href="compcert.backend.SelectDivproof.html#p">p</a></span> &lt; 64 /\<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Integers.html#Int64.divs">Int64.divs</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#y">y</a></span> = <span class="id"><a href="compcert.lib.Integers.html#Int64.add">Int64.add</a></span> (<span class="id">Int64.shr</span>' (<span class="id"><a href="compcert.lib.Integers.html#Int64.mulhs">Int64.mulhs</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int64.repr">Int64.repr</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#m">m</a></span>)) (<span class="id"><a href="compcert.lib.Integers.html#Int.repr">Int.repr</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#p">p</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Int64.shru</span>' <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int.repr">Int.repr</a></span> 63)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2399')">Proof.</div>
<div class="proofscript" id="proof2399">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#divls_mul_shift_gen">divls_mul_shift_gen</a></span>; <span class="tactic">eauto</span>. <span class="id">instantiate</span> (1 := <span class="id">x</span>).<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span>). <span class="tactic">split</span>. <span class="tactic">auto</span>. <span class="tactic">rewrite</span> <span class="id">C</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.lib.Integers.html#Int64.mulhs">Int64.mulhs</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Integers.html#Int64.signed_repr">Int64.signed_repr</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="id"><a href="compcert.lib.Integers.html#Int64.min_signed_neg">Int64.min_signed_neg</a></span>; <span class="tactic">unfold</span> <span class="id"><a href="compcert.lib.Integers.html#Int64.max_signed">Int64.max_signed</a></span>; <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="divls_mul_shift_2">divls_mul_shift_2</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span> <span class="id">m</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.SelectDiv.html#divls_mul_params">divls_mul_params</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int64.signed">Int64.signed</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#y">y</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="compcert.backend.SelectDivproof.html#p">p</a></span>, <span class="id"><a href="compcert.backend.SelectDivproof.html#m">m</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.SelectDivproof.html#m">m</a></span> &gt;= <span class="id"><a href="compcert.lib.Integers.html#Int64.half_modulus">Int64.half_modulus</a></span> -&gt;<br/>
&nbsp;&nbsp;0 &lt;= <span class="id"><a href="compcert.backend.SelectDivproof.html#p">p</a></span> &lt; 64 /\<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Integers.html#Int64.divs">Int64.divs</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#y">y</a></span> = <span class="id"><a href="compcert.lib.Integers.html#Int64.add">Int64.add</a></span> (<span class="id">Int64.shr</span>' (<span class="id"><a href="compcert.lib.Integers.html#Int64.add">Int64.add</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int64.mulhs">Int64.mulhs</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int64.repr">Int64.repr</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#m">m</a></span>)) <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span>) (<span class="id"><a href="compcert.lib.Integers.html#Int.repr">Int.repr</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#p">p</a></span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id">Int64.shru</span>' <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int.repr">Int.repr</a></span> 63)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2400')">Proof.</div>
<div class="proofscript" id="proof2400">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#divls_mul_shift_gen">divls_mul_shift_gen</a></span>; <span class="tactic">eauto</span>. <span class="id">instantiate</span> (1 := <span class="id">x</span>).<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span>). <span class="tactic">split</span>. <span class="tactic">auto</span>. <span class="tactic">rewrite</span> <span class="id">C</span>. <span class="tactic">f_equal</span>. <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Integers.html#Int64.add_signed">Int64.add_signed</a></span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.lib.Integers.html#Int64.mulhs">Int64.mulhs</a></span>. <span class="tactic">set</span> (<span class="id">n</span> := <span class="id"><a href="compcert.lib.Integers.html#Int64.signed">Int64.signed</a></span> <span class="id">x</span>).<br/>
&nbsp;&nbsp;<span class="tactic">transitivity</span> (<span class="id"><a href="compcert.lib.Integers.html#Int64.repr">Int64.repr</a></span> (<span class="id">n</span> * (<span class="id">m</span> - <span class="id"><a href="compcert.lib.Integers.html#Int64.modulus">Int64.modulus</a></span>) / <span class="id"><a href="compcert.lib.Integers.html#Int64.modulus">Int64.modulus</a></span> + <span class="id">n</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id">n</span> * (<span class="id">m</span> - <span class="id"><a href="compcert.lib.Integers.html#Int64.modulus">Int64.modulus</a></span>)) <span class="kwd">with</span> (<span class="id">n</span> * <span class="id">m</span> +  (-<span class="id">n</span>) * <span class="id"><a href="compcert.lib.Integers.html#Int64.modulus">Int64.modulus</a></span>) <span class="tactic">by</span> <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zdiv.html#Z_div_plus">Z_div_plus</a></span>. <span class="tactic">ring</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Integers.html#Int64.modulus_pos">Int64.modulus_pos</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Integers.html#Int64.eqm_samerepr">Int64.eqm_samerepr</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Integers.html#Int64.eqm_add">Int64.eqm_add</a></span>; <span class="tactic">auto</span> <span class="kwd">with</span> <span class="id">ints</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Integers.html#Int64.eqm_sym">Int64.eqm_sym</a></span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.lib.Integers.html#Int64.eqm_trans">Int64.eqm_trans</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Integers.html#Int64.eqm_signed_unsigned">Int64.eqm_signed_unsigned</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Integers.html#Int64.eqm_unsigned_repr_l">Int64.eqm_unsigned_repr_l</a></span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Integers.html#Int64.eqm_refl2">Int64.eqm_refl2</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> (<span class="tactic">f_equal</span> (<span class="kwd">fun</span> <span class="id">x</span> =&gt; <span class="id">n</span> * <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span> / <span class="id"><a href="compcert.lib.Integers.html#Int64.modulus">Int64.modulus</a></span>)).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Integers.html#Int64.signed_repr_eq">Int64.signed_repr_eq</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#Zmod_small">Zmod_small</a></span> <span class="tactic">by</span> <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#zlt_false">zlt_false</a></span>. <span class="tactic">assumption</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Remark</span> <span class="id">int64_shru</span>'<span class="id">_div_two_p</span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span>, <span class="id">Int64.shru</span>' <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#y">y</a></span> = <span class="id"><a href="compcert.lib.Integers.html#Int64.repr">Int64.repr</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int64.unsigned">Int64.unsigned</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span> / <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p">two_p</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int.unsigned">Int.unsigned</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#y">y</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2401')">Proof.</div>
<div class="proofscript" id="proof2401">
&nbsp;&nbsp;<span class="tactic">intros</span>; <span class="tactic">unfold</span> <span class="id">Int64.shru</span>'. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Integers.html#Int64.Zshiftr_div_two_p">Int64.Zshiftr_div_two_p</a></span>; <span class="tactic">auto</span>. <span class="tactic">generalize</span> (<span class="id"><a href="compcert.lib.Integers.html#Int.unsigned_range">Int.unsigned_range</a></span> <span class="id">y</span>); <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="divlu_mul_shift">divlu_mul_shift</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">x</span> <span class="id">y</span> <span class="id">m</span> <span class="id">p</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.SelectDiv.html#divlu_mul_params">divlu_mul_params</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int64.unsigned">Int64.unsigned</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#y">y</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="compcert.backend.SelectDivproof.html#p">p</a></span>, <span class="id"><a href="compcert.backend.SelectDivproof.html#m">m</a></span>) -&gt;<br/>
&nbsp;&nbsp;0 &lt;= <span class="id"><a href="compcert.backend.SelectDivproof.html#p">p</a></span> &lt; 64 /\<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.lib.Integers.html#Int64.divu">Int64.divu</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#y">y</a></span> = <span class="id">Int64.shru</span>' (<span class="id"><a href="compcert.lib.Integers.html#Int64.mulhu">Int64.mulhu</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int64.repr">Int64.repr</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#m">m</a></span>)) (<span class="id"><a href="compcert.lib.Integers.html#Int.repr">Int.repr</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#p">p</a></span>).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2402')">Proof.</div>
<div class="proofscript" id="proof2402">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="id">exploit</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#divlu_mul_params_sound">divlu_mul_params_sound</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">A</span> &amp; <span class="id">B</span> &amp; <span class="id">C</span>).<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">int64_shru</span>'<span class="id">_div_two_p</span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Integers.html#Int.unsigned_repr">Int.unsigned_repr</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.lib.Integers.html#Int64.divu">Int64.divu</a></span>, <span class="id"><a href="compcert.lib.Integers.html#Int64.mulhu">Int64.mulhu</a></span>. <span class="tactic">f_equal</span>. <span class="tactic">rewrite</span> <span class="id">C</span> <span class="tactic">by</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Integers.html#Int64.unsigned_range">Int64.unsigned_range</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p_is_exp">two_p_is_exp</a></span> <span class="tactic">by</span> <span class="tactic">omega</span>. <span class="tactic">rewrite</span> &lt;- <span class="id"><a href="compcert.lib.Coqlib.html#Zdiv_Zdiv">Zdiv_Zdiv</a></span> <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zpower.html#two_p_gt_ZERO">two_p_gt_ZERO</a></span>; <span class="tactic">omega</span>).<br/>
&nbsp;&nbsp;<span class="tactic">f_equal</span>. <span class="tactic">rewrite</span> (<span class="id"><a href="compcert.lib.Integers.html#Int64.unsigned_repr">Int64.unsigned_repr</a></span> <span class="id">m</span>).<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Integers.html#Int64.unsigned_repr">Int64.unsigned_repr</a></span>. <span class="tactic">f_equal</span>. <span class="tactic">ring</span>.<br/>
&nbsp;&nbsp;<span class="tactic">cut</span> (0 &lt;= <span class="id"><a href="compcert.lib.Integers.html#Int64.unsigned">Int64.unsigned</a></span> <span class="id">x</span> * <span class="id">m</span> / <span class="id"><a href="compcert.lib.Integers.html#Int64.modulus">Int64.modulus</a></span> &lt; <span class="id"><a href="compcert.lib.Integers.html#Int64.modulus">Int64.modulus</a></span>).<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.lib.Integers.html#Int64.max_unsigned">Int64.max_unsigned</a></span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.lib.Coqlib.html#Zdiv_interval_1">Zdiv_interval_1</a></span>. <span class="tactic">omega</span>. <span class="tactic">compute</span>; <span class="tactic">auto</span>. <span class="tactic">compute</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">split</span>. <span class="tactic">simpl</span>. <span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.mul_nonneg_nonneg">Z.mul_nonneg_nonneg</a></span>. <span class="tactic">generalize</span> (<span class="id"><a href="compcert.lib.Integers.html#Int64.unsigned_range">Int64.unsigned_range</a></span> <span class="id">x</span>); <span class="tactic">omega</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.BinInt.html#Z.le_lt_trans">Z.le_lt_trans</a></span> <span class="kwd">with</span> (<span class="id"><a href="compcert.lib.Integers.html#Int64.modulus">Int64.modulus</a></span> * <span class="id">m</span>).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zmult_le_compat_r">Zmult_le_compat_r</a></span>. <span class="tactic">generalize</span> (<span class="id"><a href="compcert.lib.Integers.html#Int64.unsigned_range">Int64.unsigned_range</a></span> <span class="id">x</span>); <span class="tactic">omega</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.ZArith.Zorder.html#Zmult_lt_compat_l">Zmult_lt_compat_l</a></span>. <span class="tactic">compute</span>; <span class="tactic">auto</span>. <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.lib.Integers.html#Int64.max_unsigned">Int64.max_unsigned</a></span>; <span class="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (64 &lt; <span class="id"><a href="compcert.lib.Integers.html#Int.max_unsigned">Int.max_unsigned</a></span>) <span class="tactic">by</span> (<span class="tactic">compute</span>; <span class="tactic">auto</span>). <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<h1> Correctness of the smart constructors for division and modulus </h1>
<br/>
<span class="kwd">Section</span> <span class="id"><a name="CMCONSTRS">CMCONSTRS</a></span>.<br/>
<br/>
<span class="kwd">Variable</span> <span class="id"><a name="CMCONSTRS.prog">prog</a></span>: <span class="id"><a href="compcert.backend.CminorSel.html#program">program</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="CMCONSTRS.hf">hf</a></span>: <span class="id"><a href="compcert.backend.SplitLong.html#helper_functions">helper_functions</a></span>.<br/>
<span class="kwd">Hypothesis</span> <span class="id"><a name="CMCONSTRS.HELPERS">HELPERS</a></span>: <span class="id"><a href="compcert.backend.SplitLongproof.html#helper_functions_declared">helper_functions_declared</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.prog">prog</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.hf">hf</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="CMCONSTRS.se">se</a></span>: <span class="id"><a href="compcert.common.Globalenvs.html#Senv.t">Senv.t</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="CMCONSTRS.ge">ge</a></span> : <span class="id"><a href="compcert.backend.CminorSel.html#genv">genv</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="CMCONSTRS.sp">sp</a></span>: <span class="id"><a href="compcert.common.Values.html#val">val</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="CMCONSTRS.e">e</a></span>: <span class="id"><a href="compcert.backend.Cminor.html#env">env</a></span>.<br/>
<span class="kwd">Variable</span> <span class="id"><a name="CMCONSTRS.m">m</a></span>: <span class="id"><a href="compcert.common.Memory.html#mem">mem</a></span>.<br/>
<br/>
<span class="kwd">Notation</span> "'<span class="id">eval_expr</span>'" := (<span class="id"><a href="compcert.backend.CminorSel.html#eval_expr">eval_expr</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.se">se</a></span>) (<span class="id">only</span> <span class="id">parsing</span>).<br/>
<span class="kwd">Notation</span> "'<span class="id">eval_exprlist</span>'" := (<span class="id"><a href="compcert.backend.CminorSel.html#eval_exprlist">eval_exprlist</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.se">se</a></span>) (<span class="id">only</span> <span class="id">parsing</span>).<br/>
<br/>
<span class="kwd">Hypothesis</span> (<span class="id"><a name="CMCONSTRS.GENV_COMPAT">GENV_COMPAT</a></span>: <span class="id"><a href="compcert.common.Globalenvs.html#genv_compat">genv_compat</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.ge">ge</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.prog">prog</a></span>).<br/>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="is_intconst_sound">is_intconst_sound</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">v</span> <span class="id">a</span> <span class="id">n</span> <span class="id">le</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.SelectDiv.html#is_intconst">is_intconst</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#a">a</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#n">n</a></span> -&gt; <span class="id">eval_expr</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.ge">ge</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.sp">sp</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.e">e</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.m">m</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#le">le</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#a">a</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#v">v</a></span> -&gt; <span class="id"><a href="compcert.backend.SelectDivproof.html#v">v</a></span> = <span class="id"><a href="compcert.common.Values.html#Vint">Vint</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#n">n</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2403')">Proof with</div>
<div class="proofscript" id="proof2403">
 (<span class="tactic">try</span> <span class="tactic">discriminate</span>).<br/>
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.SelectDiv.html#is_intconst">is_intconst</a></span> <span class="kwd">in</span> *.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">a</span>... <span class="tactic">destruct</span> <span class="id">o</span>... <span class="id">inv</span> <span class="id">H</span>. <span class="id">inv</span> <span class="id">H0</span>. <span class="tactic">destruct</span> <span class="id">vl</span>; <span class="id">inv</span> <span class="id">H5</span>. <span class="tactic">auto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="eval_divu_mul">eval_divu_mul</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">le</span> <span class="id">x</span> <span class="id">y</span> <span class="id">p</span> <span class="id">M</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.SelectDiv.html#divu_mul_params">divu_mul_params</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int.unsigned">Int.unsigned</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#y">y</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="compcert.backend.SelectDivproof.html#p">p</a></span>, <span class="id"><a href="compcert.backend.SelectDivproof.html#M">M</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth_error">nth_error</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#le">le</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="compcert.common.Values.html#Vint">Vint</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">eval_expr</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.ge">ge</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.sp">sp</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.e">e</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.m">m</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#le">le</a></span> (<span class="id"><a href="compcert.backend.SelectDiv.html#divu_mul">divu_mul</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#p">p</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#M">M</a></span>) (<span class="id"><a href="compcert.common.Values.html#Vint">Vint</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int.divu">Int.divu</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#y">y</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2404')">Proof.</div>
<div class="proofscript" id="proof2404">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.SelectDiv.html#divu_mul">divu_mul</a></span>. <span class="id">exploit</span> (<span class="id"><a href="compcert.backend.SelectDivproof.html#divu_mul_shift">divu_mul_shift</a></span> <span class="id">x</span>); <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">A</span> <span class="id">B</span>].<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">C</span>: <span class="id">eval_expr</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.ge">ge</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.sp">sp</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.e">e</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.m">m</a></span> <span class="id">le</span> (<span class="id"><a href="compcert.backend.CminorSel.html#Eletvar">Eletvar</a></span> 0) (<span class="id"><a href="compcert.common.Values.html#Vint">Vint</a></span> <span class="id">x</span>)) <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.CminorSel.html#eval_Eletvar">eval_Eletvar</a></span>; <span class="tactic">eauto</span>).<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">D</span>: <span class="id">eval_expr</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.ge">ge</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.sp">sp</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.e">e</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.m">m</a></span> <span class="id">le</span> (<span class="id"><a href="compcert.backend.CminorSel.html#Eop">Eop</a></span> (<span class="id"><a href="compcert.x86.Op.html#Ointconst">Ointconst</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int.repr">Int.repr</a></span> <span class="id">M</span>)) <span class="id"><a href="compcert.backend.CminorSel.html#Enil">Enil</a></span>) (<span class="id"><a href="compcert.common.Values.html#Vint">Vint</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int.repr">Int.repr</a></span> <span class="id">M</span>))) <span class="tactic">by</span> <span class="id">EvalOp</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.x86.SelectOpproof.html#eval_mulhu">eval_mulhu</a></span>. <span class="id">eexact</span> <span class="id">C</span>. <span class="id">eexact</span> <span class="id">D</span>. <span class="tactic">intros</span> (<span class="id">v</span> &amp; <span class="id">E</span> &amp; <span class="id">F</span>). <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">F</span>. <span class="id">inv</span> <span class="id">F</span>. <br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.x86.SelectOpproof.html#eval_shruimm">eval_shruimm</a></span>. <span class="id">eexact</span> <span class="id">E</span>. <span class="id">instantiate</span> (1 := <span class="id"><a href="compcert.lib.Integers.html#Int.repr">Int.repr</a></span> <span class="id">p</span>).<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">v</span> [<span class="id">P</span> <span class="id">Q</span>]]. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">Q</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="compcert.lib.Integers.html#Int.ltu">Int.ltu</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int.repr">Int.repr</a></span> <span class="id">p</span>) <span class="id"><a href="compcert.lib.Integers.html#Int.iwordsize">Int.iwordsize</a></span>) <span class="kwd">with</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> <span class="kwd">in</span> <span class="id">Q</span>.<br/>
&nbsp;&nbsp;<span class="id">inv</span> <span class="id">Q</span>. <span class="tactic">rewrite</span> <span class="id">B</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.lib.Integers.html#Int.ltu">Int.ltu</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Integers.html#Int.unsigned_repr">Int.unsigned_repr</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#zlt_true">zlt_true</a></span>; <span class="tactic">auto</span>. <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (32 &lt; <span class="id"><a href="compcert.lib.Integers.html#Int.max_unsigned">Int.max_unsigned</a></span>) <span class="tactic">by</span> (<span class="tactic">compute</span>; <span class="tactic">auto</span>). <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="eval_divuimm">eval_divuimm</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">le</span> <span class="id">e1</span> <span class="id">x</span> <span class="id">n2</span> <span class="id">z</span>,<br/>
&nbsp;&nbsp;<span class="id">eval_expr</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.ge">ge</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.sp">sp</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.e">e</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.m">m</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#le">le</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#e1">e1</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Values.html#Val.divu">Val.divu</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span> (<span class="id"><a href="compcert.common.Values.html#Vint">Vint</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#n2">n2</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#z">z</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v</span>, <span class="id">eval_expr</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.ge">ge</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.sp">sp</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.e">e</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.m">m</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#le">le</a></span> (<span class="id"><a href="compcert.backend.SelectDiv.html#divuimm">divuimm</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#e1">e1</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#n2">n2</a></span>) <span class="id"><a href="compcert.backend.SelectDivproof.html#v">v</a></span> /\ <span class="id"><a href="compcert.common.Values.html#Val.lessdef">Val.lessdef</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#z">z</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#v">v</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2405')">Proof.</div>
<div class="proofscript" id="proof2405">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.SelectDiv.html#divuimm">divuimm</a></span>; <span class="tactic">intros</span>. <span class="tactic">generalize</span> <span class="id">H0</span>; <span class="tactic">intros</span> <span class="id">DIV</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">x</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">DIV</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Integers.html#Int.eq">Int.eq</a></span> <span class="id">n2</span> <span class="id"><a href="compcert.lib.Integers.html#Int.zero">Int.zero</a></span>) <span class="id">eqn</span>:<span class="id">Z2</span>; <span class="id">inv</span> <span class="id">DIV</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Integers.html#Int.is_power2">Int.is_power2</a></span> <span class="id">n2</span>) <span class="kwd">as</span> [<span class="id">l</span> | ] <span class="id">eqn</span>:<span class="id">P2</span>.<br/>
- <span class="id">erewrite</span> <span class="id"><a href="compcert.lib.Integers.html#Int.divu_pow2">Int.divu_pow2</a></span> <span class="tactic">by</span> <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">replace</span> (<span class="id"><a href="compcert.common.Values.html#Vint">Vint</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int.shru">Int.shru</a></span> <span class="id">i</span> <span class="id">l</span>)) <span class="kwd">with</span> (<span class="id"><a href="compcert.common.Values.html#Val.shru">Val.shru</a></span> (<span class="id"><a href="compcert.common.Values.html#Vint">Vint</a></span> <span class="id">i</span>) (<span class="id"><a href="compcert.common.Values.html#Vint">Vint</a></span> <span class="id">l</span>)).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.x86.SelectOpproof.html#eval_shruimm">eval_shruimm</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="id">erewrite</span> <span class="id"><a href="compcert.lib.Integers.html#Int.is_power2_range">Int.is_power2_range</a></span>; <span class="tactic">eauto</span>.<br/>
- <span class="tactic">destruct</span> (<span class="id"><a href="compcert.driver.Compopts.html#optim_for_size">Compopts.optim_for_size</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>).<br/>
&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="compcert.x86.SelectOpproof.html#eval_divu_base">eval_divu_base</a></span>; <span class="tactic">eauto</span>. <span class="id">EvalOp</span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">destruct</span> (<span class="id"><a href="compcert.backend.SelectDiv.html#divu_mul_params">divu_mul_params</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int.unsigned">Int.unsigned</a></span> <span class="id">n2</span>)) <span class="kwd">as</span> [[<span class="id">p</span> <span class="id">M</span>] | ] <span class="id">eqn</span>:<span class="id">PARAMS</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">exists</span> (<span class="id"><a href="compcert.common.Values.html#Vint">Vint</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int.divu">Int.divu</a></span> <span class="id">i</span> <span class="id">n2</span>)); <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#eval_divu_mul">eval_divu_mul</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">eapply</span> <span class="id"><a href="compcert.x86.SelectOpproof.html#eval_divu_base">eval_divu_base</a></span>; <span class="tactic">eauto</span>. <span class="id">EvalOp</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="eval_divu">eval_divu</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">le</span> <span class="id">a</span> <span class="id">b</span> <span class="id">x</span> <span class="id">y</span> <span class="id">z</span>,<br/>
&nbsp;&nbsp;<span class="id">eval_expr</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.ge">ge</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.sp">sp</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.e">e</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.m">m</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#le">le</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#a">a</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">eval_expr</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.ge">ge</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.sp">sp</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.e">e</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.m">m</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#le">le</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#b">b</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Values.html#Val.divu">Val.divu</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#y">y</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#z">z</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v</span>, <span class="id">eval_expr</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.ge">ge</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.sp">sp</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.e">e</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.m">m</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#le">le</a></span> (<span class="id"><a href="compcert.backend.SelectDiv.html#divu">divu</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#a">a</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#b">b</a></span>) <span class="id"><a href="compcert.backend.SelectDivproof.html#v">v</a></span> /\ <span class="id"><a href="compcert.common.Values.html#Val.lessdef">Val.lessdef</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#z">z</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#v">v</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2406')">Proof.</div>
<div class="proofscript" id="proof2406">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.SelectDiv.html#divu">divu</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.backend.SelectDiv.html#is_intconst">is_intconst</a></span> <span class="id">b</span>) <span class="kwd">as</span> [<span class="id">n2</span>|] <span class="id">eqn</span>:<span class="id">B</span>.<br/>
- <span class="id">exploit</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#is_intconst_sound">is_intconst_sound</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> <span class="id">EB</span>; <span class="tactic">clear</span> <span class="id">B</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.backend.SelectDiv.html#is_intconst">is_intconst</a></span> <span class="id">a</span>) <span class="kwd">as</span> [<span class="id">n1</span>|] <span class="id">eqn</span>:<span class="id">A</span>.<br/>
+ <span class="id">exploit</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#is_intconst_sound">is_intconst_sound</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> <span class="id">EA</span>; <span class="tactic">clear</span> <span class="id">A</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Integers.html#Int.eq">Int.eq</a></span> <span class="id">n2</span> <span class="id"><a href="compcert.lib.Integers.html#Int.zero">Int.zero</a></span>) <span class="id">eqn</span>:<span class="id">Z</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.x86.SelectOpproof.html#eval_divu_base">eval_divu_base</a></span>; <span class="tactic">eauto</span>. <br/>
&nbsp;&nbsp;<span class="tactic">subst</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H1</span>. <span class="tactic">rewrite</span> <span class="id">Z</span> <span class="kwd">in</span> <span class="id">H1</span>; <span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="id">TrivialExists</span>.<br/>
+ <span class="tactic">subst</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#eval_divuimm">eval_divuimm</a></span>; <span class="tactic">eauto</span>.<br/>
- <span class="tactic">eapply</span> <span class="id"><a href="compcert.x86.SelectOpproof.html#eval_divu_base">eval_divu_base</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="eval_mod_from_div">eval_mod_from_div</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">le</span> <span class="id">a</span> <span class="id">n</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;<span class="id">eval_expr</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.ge">ge</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.sp">sp</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.e">e</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.m">m</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#le">le</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#a">a</a></span> (<span class="id"><a href="compcert.common.Values.html#Vint">Vint</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#y">y</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth_error">nth_error</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#le">le</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="compcert.common.Values.html#Vint">Vint</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">eval_expr</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.ge">ge</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.sp">sp</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.e">e</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.m">m</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#le">le</a></span> (<span class="id"><a href="compcert.backend.SelectDiv.html#mod_from_div">mod_from_div</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#a">a</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#n">n</a></span>) (<span class="id"><a href="compcert.common.Values.html#Vint">Vint</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int.sub">Int.sub</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int.mul">Int.mul</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#y">y</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#n">n</a></span>))).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2407')">Proof.</div>
<div class="proofscript" id="proof2407">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.SelectDiv.html#mod_from_div">mod_from_div</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.x86.SelectOpproof.html#eval_mulimm">eval_mulimm</a></span>; <span class="tactic">eauto</span>. <span class="id">instantiate</span> (1 := <span class="id">n</span>). <span class="tactic">intros</span> [<span class="id">v</span> [<span class="id">A</span> <span class="id">B</span>]].<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">B</span>. <span class="id">inv</span> <span class="id">B</span>. <span class="id">EvalOp</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="eval_moduimm">eval_moduimm</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">le</span> <span class="id">e1</span> <span class="id">x</span> <span class="id">n2</span> <span class="id">z</span>,<br/>
&nbsp;&nbsp;<span class="id">eval_expr</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.ge">ge</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.sp">sp</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.e">e</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.m">m</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#le">le</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#e1">e1</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Values.html#Val.modu">Val.modu</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span> (<span class="id"><a href="compcert.common.Values.html#Vint">Vint</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#n2">n2</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#z">z</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v</span>, <span class="id">eval_expr</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.ge">ge</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.sp">sp</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.e">e</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.m">m</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#le">le</a></span> (<span class="id"><a href="compcert.backend.SelectDiv.html#moduimm">moduimm</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#e1">e1</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#n2">n2</a></span>) <span class="id"><a href="compcert.backend.SelectDivproof.html#v">v</a></span> /\ <span class="id"><a href="compcert.common.Values.html#Val.lessdef">Val.lessdef</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#z">z</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#v">v</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2408')">Proof.</div>
<div class="proofscript" id="proof2408">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.SelectDiv.html#moduimm">moduimm</a></span>; <span class="tactic">intros</span>. <span class="tactic">generalize</span> <span class="id">H0</span>; <span class="tactic">intros</span> <span class="id">MOD</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">x</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">MOD</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Integers.html#Int.eq">Int.eq</a></span> <span class="id">n2</span> <span class="id"><a href="compcert.lib.Integers.html#Int.zero">Int.zero</a></span>) <span class="id">eqn</span>:<span class="id">Z2</span>; <span class="id">inv</span> <span class="id">MOD</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Integers.html#Int.is_power2">Int.is_power2</a></span> <span class="id">n2</span>) <span class="kwd">as</span> [<span class="id">l</span> | ] <span class="id">eqn</span>:<span class="id">P2</span>.<br/>
- <span class="id">erewrite</span> <span class="id"><a href="compcert.lib.Integers.html#Int.modu_and">Int.modu_and</a></span> <span class="tactic">by</span> <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id">change</span> (<span class="id"><a href="compcert.common.Values.html#Vint">Vint</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int.and">Int.and</a></span> <span class="id">i</span> (<span class="id"><a href="compcert.lib.Integers.html#Int.sub">Int.sub</a></span> <span class="id">n2</span> <span class="id"><a href="compcert.lib.Integers.html#Int.one">Int.one</a></span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">with</span> (<span class="id"><a href="compcert.common.Values.html#Val.and">Val.and</a></span> (<span class="id"><a href="compcert.common.Values.html#Vint">Vint</a></span> <span class="id">i</span>) (<span class="id"><a href="compcert.common.Values.html#Vint">Vint</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int.sub">Int.sub</a></span> <span class="id">n2</span> <span class="id"><a href="compcert.lib.Integers.html#Int.one">Int.one</a></span>))).<br/>
&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.x86.SelectOpproof.html#eval_andimm">eval_andimm</a></span>. <span class="tactic">auto</span>.<br/>
- <span class="tactic">destruct</span> (<span class="id"><a href="compcert.driver.Compopts.html#optim_for_size">Compopts.optim_for_size</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>).<br/>
&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="compcert.x86.SelectOpproof.html#eval_modu_base">eval_modu_base</a></span>; <span class="tactic">eauto</span>. <span class="id">EvalOp</span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">destruct</span> (<span class="id"><a href="compcert.backend.SelectDiv.html#divu_mul_params">divu_mul_params</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int.unsigned">Int.unsigned</a></span> <span class="id">n2</span>)) <span class="kwd">as</span> [[<span class="id">p</span> <span class="id">M</span>] | ] <span class="id">eqn</span>:<span class="id">PARAMS</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#eval_mod_from_div">eval_mod_from_div</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#eval_divu_mul">eval_divu_mul</a></span>; <span class="tactic">eauto</span>. <span class="tactic">simpl</span>; <span class="tactic">eauto</span>. <span class="tactic">simpl</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Integers.html#Int.modu_divu">Int.modu_divu</a></span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="tactic">subst</span> <span class="id">n2</span>; <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">eapply</span> <span class="id"><a href="compcert.x86.SelectOpproof.html#eval_modu_base">eval_modu_base</a></span>; <span class="tactic">eauto</span>. <span class="id">EvalOp</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="eval_modu">eval_modu</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">le</span> <span class="id">a</span> <span class="id">b</span> <span class="id">x</span> <span class="id">y</span> <span class="id">z</span>,<br/>
&nbsp;&nbsp;<span class="id">eval_expr</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.ge">ge</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.sp">sp</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.e">e</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.m">m</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#le">le</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#a">a</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">eval_expr</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.ge">ge</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.sp">sp</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.e">e</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.m">m</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#le">le</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#b">b</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Values.html#Val.modu">Val.modu</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#y">y</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#z">z</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v</span>, <span class="id">eval_expr</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.ge">ge</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.sp">sp</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.e">e</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.m">m</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#le">le</a></span> (<span class="id"><a href="compcert.backend.SelectDiv.html#modu">modu</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#a">a</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#b">b</a></span>) <span class="id"><a href="compcert.backend.SelectDivproof.html#v">v</a></span> /\ <span class="id"><a href="compcert.common.Values.html#Val.lessdef">Val.lessdef</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#z">z</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#v">v</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2409')">Proof.</div>
<div class="proofscript" id="proof2409">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.SelectDiv.html#modu">modu</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.backend.SelectDiv.html#is_intconst">is_intconst</a></span> <span class="id">b</span>) <span class="kwd">as</span> [<span class="id">n2</span>|] <span class="id">eqn</span>:<span class="id">B</span>.<br/>
- <span class="id">exploit</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#is_intconst_sound">is_intconst_sound</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> <span class="id">EB</span>; <span class="tactic">clear</span> <span class="id">B</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.backend.SelectDiv.html#is_intconst">is_intconst</a></span> <span class="id">a</span>) <span class="kwd">as</span> [<span class="id">n1</span>|] <span class="id">eqn</span>:<span class="id">A</span>.<br/>
+ <span class="id">exploit</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#is_intconst_sound">is_intconst_sound</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> <span class="id">EA</span>; <span class="tactic">clear</span> <span class="id">A</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Integers.html#Int.eq">Int.eq</a></span> <span class="id">n2</span> <span class="id"><a href="compcert.lib.Integers.html#Int.zero">Int.zero</a></span>) <span class="id">eqn</span>:<span class="id">Z</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.x86.SelectOpproof.html#eval_modu_base">eval_modu_base</a></span>; <span class="tactic">eauto</span>. <br/>
&nbsp;&nbsp;<span class="tactic">subst</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H1</span>. <span class="tactic">rewrite</span> <span class="id">Z</span> <span class="kwd">in</span> <span class="id">H1</span>; <span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="id">TrivialExists</span>.<br/>
+ <span class="tactic">subst</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#eval_moduimm">eval_moduimm</a></span>; <span class="tactic">eauto</span>.<br/>
- <span class="tactic">eapply</span> <span class="id"><a href="compcert.x86.SelectOpproof.html#eval_modu_base">eval_modu_base</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="eval_divs_mul">eval_divs_mul</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">le</span> <span class="id">x</span> <span class="id">y</span> <span class="id">p</span> <span class="id">M</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.SelectDiv.html#divs_mul_params">divs_mul_params</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int.signed">Int.signed</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#y">y</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="compcert.backend.SelectDivproof.html#p">p</a></span>, <span class="id"><a href="compcert.backend.SelectDivproof.html#M">M</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth_error">nth_error</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#le">le</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="compcert.common.Values.html#Vint">Vint</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">eval_expr</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.ge">ge</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.sp">sp</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.e">e</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.m">m</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#le">le</a></span> (<span class="id"><a href="compcert.backend.SelectDiv.html#divs_mul">divs_mul</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#p">p</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#M">M</a></span>) (<span class="id"><a href="compcert.common.Values.html#Vint">Vint</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int.divs">Int.divs</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#y">y</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2410')">Proof.</div>
<div class="proofscript" id="proof2410">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.SelectDiv.html#divs_mul">divs_mul</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">C</span>: <span class="id">eval_expr</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.ge">ge</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.sp">sp</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.e">e</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.m">m</a></span> <span class="id">le</span> (<span class="id"><a href="compcert.backend.CminorSel.html#Eletvar">Eletvar</a></span> 0) (<span class="id"><a href="compcert.common.Values.html#Vint">Vint</a></span> <span class="id">x</span>)) <span class="tactic">by</span> (<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.CminorSel.html#eval_Eletvar">eval_Eletvar</a></span>; <span class="tactic">eauto</span>).<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">D</span>: <span class="id">eval_expr</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.ge">ge</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.sp">sp</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.e">e</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.m">m</a></span> <span class="id">le</span> (<span class="id"><a href="compcert.backend.CminorSel.html#Eop">Eop</a></span> (<span class="id"><a href="compcert.x86.Op.html#Ointconst">Ointconst</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int.repr">Int.repr</a></span> <span class="id">M</span>)) <span class="id"><a href="compcert.backend.CminorSel.html#Enil">Enil</a></span>) (<span class="id"><a href="compcert.common.Values.html#Vint">Vint</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int.repr">Int.repr</a></span> <span class="id">M</span>))) <span class="tactic">by</span> <span class="id">EvalOp</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.x86.SelectOpproof.html#eval_mulhs">eval_mulhs</a></span>. <span class="id">eexact</span> <span class="id">C</span>. <span class="id">eexact</span> <span class="id">D</span>. <span class="tactic">intros</span> (<span class="id">v</span> &amp; <span class="id">X</span> &amp; <span class="id">F</span>). <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">F</span>; <span class="id">inv</span> <span class="id">F</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.x86.SelectOpproof.html#eval_shruimm">eval_shruimm</a></span>. <span class="id">eexact</span> <span class="id">C</span>. <span class="id">instantiate</span> (1 := <span class="id"><a href="compcert.lib.Integers.html#Int.repr">Int.repr</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int.zwordsize">Int.zwordsize</a></span> - 1)).<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">v1</span> [<span class="id">Y</span> <span class="id">LD</span>]]. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">LD</span>.<br/>
&nbsp;&nbsp;<span class="id">change</span> (<span class="id"><a href="compcert.lib.Integers.html#Int.ltu">Int.ltu</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int.repr">Int.repr</a></span> 31) <span class="id"><a href="compcert.lib.Integers.html#Int.iwordsize">Int.iwordsize</a></span>) <span class="kwd">with</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> <span class="kwd">in</span> <span class="id">LD</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">LD</span>. <span class="id">inv</span> <span class="id">LD</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">RANGE</span>: 0 &lt;= <span class="id">p</span> &lt; 32 -&gt; <span class="id"><a href="compcert.lib.Integers.html#Int.ltu">Int.ltu</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int.repr">Int.repr</a></span> <span class="id">p</span>) <span class="id"><a href="compcert.lib.Integers.html#Int.iwordsize">Int.iwordsize</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.lib.Integers.html#Int.ltu">Int.ltu</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Integers.html#Int.unsigned_repr">Int.unsigned_repr</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#zlt_true">zlt_true</a></span> <span class="tactic">by</span> <span class="tactic">tauto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (32 &lt; <span class="id"><a href="compcert.lib.Integers.html#Int.max_unsigned">Int.max_unsigned</a></span>) <span class="tactic">by</span> (<span class="tactic">compute</span>; <span class="tactic">auto</span>). <span class="tactic">omega</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> <span class="id">M</span> <span class="id"><a href="compcert.lib.Integers.html#Int.half_modulus">Int.half_modulus</a></span>).<br/>
- <span class="id">exploit</span> (<span class="id"><a href="compcert.backend.SelectDivproof.html#divs_mul_shift_1">divs_mul_shift_1</a></span> <span class="id">x</span>); <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">A</span> <span class="id">B</span>].<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.x86.SelectOpproof.html#eval_shrimm">eval_shrimm</a></span>. <span class="id">eexact</span> <span class="id">X</span>. <span class="id">instantiate</span> (1 := <span class="id"><a href="compcert.lib.Integers.html#Int.repr">Int.repr</a></span> <span class="id">p</span>). <span class="tactic">intros</span> [<span class="id">v1</span> [<span class="id">Z</span> <span class="id">LD</span>]].<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">LD</span>. <span class="tactic">rewrite</span> <span class="id">RANGE</span> <span class="kwd">in</span> <span class="id">LD</span> <span class="tactic">by</span> <span class="tactic">auto</span>. <span class="id">inv</span> <span class="id">LD</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.x86.SelectOpproof.html#eval_add">eval_add</a></span>. <span class="id">eexact</span> <span class="id">Z</span>. <span class="id">eexact</span> <span class="id">Y</span>. <span class="tactic">intros</span> [<span class="id">v1</span> [<span class="id">W</span> <span class="id">LD</span>]].<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">LD</span>. <span class="id">inv</span> <span class="id">LD</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">B</span>. <span class="tactic">exact</span> <span class="id">W</span>.<br/>
- <span class="id">exploit</span> (<span class="id"><a href="compcert.backend.SelectDivproof.html#divs_mul_shift_2">divs_mul_shift_2</a></span> <span class="id">x</span>); <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">A</span> <span class="id">B</span>].<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.x86.SelectOpproof.html#eval_add">eval_add</a></span>. <span class="id">eexact</span> <span class="id">X</span>. <span class="id">eexact</span> <span class="id">C</span>. <span class="tactic">intros</span> [<span class="id">v1</span> [<span class="id">Z</span> <span class="id">LD</span>]].<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">LD</span>. <span class="id">inv</span> <span class="id">LD</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.x86.SelectOpproof.html#eval_shrimm">eval_shrimm</a></span>. <span class="id">eexact</span> <span class="id">Z</span>. <span class="id">instantiate</span> (1 := <span class="id"><a href="compcert.lib.Integers.html#Int.repr">Int.repr</a></span> <span class="id">p</span>). <span class="tactic">intros</span> [<span class="id">v1</span> [<span class="id">U</span> <span class="id">LD</span>]].<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">LD</span>. <span class="tactic">rewrite</span> <span class="id">RANGE</span> <span class="kwd">in</span> <span class="id">LD</span> <span class="tactic">by</span> <span class="tactic">auto</span>. <span class="id">inv</span> <span class="id">LD</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.x86.SelectOpproof.html#eval_add">eval_add</a></span>. <span class="id">eexact</span> <span class="id">U</span>. <span class="id">eexact</span> <span class="id">Y</span>. <span class="tactic">intros</span> [<span class="id">v1</span> [<span class="id">W</span> <span class="id">LD</span>]].<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">LD</span>. <span class="id">inv</span> <span class="id">LD</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">B</span>. <span class="tactic">exact</span> <span class="id">W</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="eval_divsimm">eval_divsimm</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">le</span> <span class="id">e1</span> <span class="id">x</span> <span class="id">n2</span> <span class="id">z</span>,<br/>
&nbsp;&nbsp;<span class="id">eval_expr</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.ge">ge</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.sp">sp</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.e">e</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.m">m</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#le">le</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#e1">e1</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Values.html#Val.divs">Val.divs</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span> (<span class="id"><a href="compcert.common.Values.html#Vint">Vint</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#n2">n2</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#z">z</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v</span>, <span class="id">eval_expr</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.ge">ge</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.sp">sp</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.e">e</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.m">m</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#le">le</a></span> (<span class="id"><a href="compcert.backend.SelectDiv.html#divsimm">divsimm</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#e1">e1</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#n2">n2</a></span>) <span class="id"><a href="compcert.backend.SelectDivproof.html#v">v</a></span> /\ <span class="id"><a href="compcert.common.Values.html#Val.lessdef">Val.lessdef</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#z">z</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#v">v</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2411')">Proof.</div>
<div class="proofscript" id="proof2411">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.SelectDiv.html#divsimm">divsimm</a></span>; <span class="tactic">intros</span>. <span class="tactic">generalize</span> <span class="id">H0</span>; <span class="tactic">intros</span> <span class="id">DIV</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">x</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">DIV</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Integers.html#Int.eq">Int.eq</a></span> <span class="id">n2</span> <span class="id"><a href="compcert.lib.Integers.html#Int.zero">Int.zero</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|| <span class="id"><a href="compcert.lib.Integers.html#Int.eq">Int.eq</a></span> <span class="id">i</span> (<span class="id"><a href="compcert.lib.Integers.html#Int.repr">Int.repr</a></span> <span class="id"><a href="compcert.lib.Integers.html#Int.min_signed">Int.min_signed</a></span>) &amp;&amp; <span class="id"><a href="compcert.lib.Integers.html#Int.eq">Int.eq</a></span> <span class="id">n2</span> <span class="id"><a href="compcert.lib.Integers.html#Int.mone">Int.mone</a></span>) <span class="id">eqn</span>:<span class="id">Z2</span>; <span class="id">inv</span> <span class="id">DIV</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Integers.html#Int.is_power2">Int.is_power2</a></span> <span class="id">n2</span>) <span class="kwd">as</span> [<span class="id">l</span> | ] <span class="id">eqn</span>:<span class="id">P2</span>.<br/>
- <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Integers.html#Int.ltu">Int.ltu</a></span> <span class="id">l</span> (<span class="id"><a href="compcert.lib.Integers.html#Int.repr">Int.repr</a></span> 31)) <span class="id">eqn</span>:<span class="id">LT31</span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="compcert.x86.SelectOpproof.html#eval_shrximm">eval_shrximm</a></span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Values.html#Val.divs_pow2">Val.divs_pow2</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="compcert.x86.SelectOpproof.html#eval_divs_base">eval_divs_base</a></span>; <span class="tactic">eauto</span>. <span class="id">EvalOp</span>.<br/>
- <span class="tactic">destruct</span> (<span class="id"><a href="compcert.driver.Compopts.html#optim_for_size">Compopts.optim_for_size</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>).<br/>
&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="compcert.x86.SelectOpproof.html#eval_divs_base">eval_divs_base</a></span>; <span class="tactic">eauto</span>. <span class="id">EvalOp</span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">destruct</span> (<span class="id"><a href="compcert.backend.SelectDiv.html#divs_mul_params">divs_mul_params</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int.signed">Int.signed</a></span> <span class="id">n2</span>)) <span class="kwd">as</span> [[<span class="id">p</span> <span class="id">M</span>] | ] <span class="id">eqn</span>:<span class="id">PARAMS</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">exists</span> (<span class="id"><a href="compcert.common.Values.html#Vint">Vint</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int.divs">Int.divs</a></span> <span class="id">i</span> <span class="id">n2</span>)); <span class="tactic">split</span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#eval_divs_mul">eval_divs_mul</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">eapply</span> <span class="id"><a href="compcert.x86.SelectOpproof.html#eval_divs_base">eval_divs_base</a></span>; <span class="tactic">eauto</span>. <span class="id">EvalOp</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="eval_divs">eval_divs</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">le</span> <span class="id">a</span> <span class="id">b</span> <span class="id">x</span> <span class="id">y</span> <span class="id">z</span>,<br/>
&nbsp;&nbsp;<span class="id">eval_expr</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.ge">ge</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.sp">sp</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.e">e</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.m">m</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#le">le</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#a">a</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">eval_expr</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.ge">ge</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.sp">sp</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.e">e</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.m">m</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#le">le</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#b">b</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Values.html#Val.divs">Val.divs</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#y">y</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#z">z</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v</span>, <span class="id">eval_expr</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.ge">ge</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.sp">sp</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.e">e</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.m">m</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#le">le</a></span> (<span class="id"><a href="compcert.backend.SelectDiv.html#divs">divs</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#a">a</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#b">b</a></span>) <span class="id"><a href="compcert.backend.SelectDivproof.html#v">v</a></span> /\ <span class="id"><a href="compcert.common.Values.html#Val.lessdef">Val.lessdef</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#z">z</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#v">v</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2412')">Proof.</div>
<div class="proofscript" id="proof2412">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.SelectDiv.html#divs">divs</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.backend.SelectDiv.html#is_intconst">is_intconst</a></span> <span class="id">b</span>) <span class="kwd">as</span> [<span class="id">n2</span>|] <span class="id">eqn</span>:<span class="id">B</span>.<br/>
- <span class="id">exploit</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#is_intconst_sound">is_intconst_sound</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> <span class="id">EB</span>; <span class="tactic">clear</span> <span class="id">B</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.backend.SelectDiv.html#is_intconst">is_intconst</a></span> <span class="id">a</span>) <span class="kwd">as</span> [<span class="id">n1</span>|] <span class="id">eqn</span>:<span class="id">A</span>.<br/>
+ <span class="id">exploit</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#is_intconst_sound">is_intconst_sound</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> <span class="id">EA</span>; <span class="tactic">clear</span> <span class="id">A</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Integers.html#Int.eq">Int.eq</a></span> <span class="id">n2</span> <span class="id"><a href="compcert.lib.Integers.html#Int.zero">Int.zero</a></span>) <span class="id">eqn</span>:<span class="id">Z</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.x86.SelectOpproof.html#eval_divs_base">eval_divs_base</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">subst</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H1</span>. <br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Integers.html#Int.eq">Int.eq</a></span> <span class="id">n2</span> <span class="id"><a href="compcert.lib.Integers.html#Int.zero">Int.zero</a></span> || <span class="id"><a href="compcert.lib.Integers.html#Int.eq">Int.eq</a></span> <span class="id">n1</span> (<span class="id"><a href="compcert.lib.Integers.html#Int.repr">Int.repr</a></span> <span class="id"><a href="compcert.lib.Integers.html#Int.min_signed">Int.min_signed</a></span>) &amp;&amp; <span class="id"><a href="compcert.lib.Integers.html#Int.eq">Int.eq</a></span> <span class="id">n2</span> <span class="id"><a href="compcert.lib.Integers.html#Int.mone">Int.mone</a></span>); <span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="id">TrivialExists</span>.<br/>
+ <span class="tactic">subst</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#eval_divsimm">eval_divsimm</a></span>; <span class="tactic">eauto</span>.<br/>
- <span class="tactic">eapply</span> <span class="id"><a href="compcert.x86.SelectOpproof.html#eval_divs_base">eval_divs_base</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="eval_modsimm">eval_modsimm</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">le</span> <span class="id">e1</span> <span class="id">x</span> <span class="id">n2</span> <span class="id">z</span>,<br/>
&nbsp;&nbsp;<span class="id">eval_expr</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.ge">ge</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.sp">sp</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.e">e</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.m">m</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#le">le</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#e1">e1</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Values.html#Val.mods">Val.mods</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span> (<span class="id"><a href="compcert.common.Values.html#Vint">Vint</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#n2">n2</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#z">z</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v</span>, <span class="id">eval_expr</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.ge">ge</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.sp">sp</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.e">e</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.m">m</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#le">le</a></span> (<span class="id"><a href="compcert.backend.SelectDiv.html#modsimm">modsimm</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#e1">e1</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#n2">n2</a></span>) <span class="id"><a href="compcert.backend.SelectDivproof.html#v">v</a></span> /\ <span class="id"><a href="compcert.common.Values.html#Val.lessdef">Val.lessdef</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#z">z</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#v">v</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2413')">Proof.</div>
<div class="proofscript" id="proof2413">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.SelectDiv.html#modsimm">modsimm</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Values.html#Val.mods_divs">Val.mods_divs</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">y</span> [<span class="id">A</span> <span class="id">B</span>]].<br/>
&nbsp;&nbsp;<span class="tactic">generalize</span> <span class="id">A</span>; <span class="tactic">intros</span> <span class="id">DIV</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">x</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">DIV</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Integers.html#Int.eq">Int.eq</a></span> <span class="id">n2</span> <span class="id"><a href="compcert.lib.Integers.html#Int.zero">Int.zero</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|| <span class="id"><a href="compcert.lib.Integers.html#Int.eq">Int.eq</a></span> <span class="id">i</span> (<span class="id"><a href="compcert.lib.Integers.html#Int.repr">Int.repr</a></span> <span class="id"><a href="compcert.lib.Integers.html#Int.min_signed">Int.min_signed</a></span>) &amp;&amp; <span class="id"><a href="compcert.lib.Integers.html#Int.eq">Int.eq</a></span> <span class="id">n2</span> <span class="id"><a href="compcert.lib.Integers.html#Int.mone">Int.mone</a></span>) <span class="id">eqn</span>:<span class="id">Z2</span>; <span class="id">inv</span> <span class="id">DIV</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Integers.html#Int.is_power2">Int.is_power2</a></span> <span class="id">n2</span>) <span class="kwd">as</span> [<span class="id">l</span> | ] <span class="id">eqn</span>:<span class="id">P2</span>.<br/>
- <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Integers.html#Int.ltu">Int.ltu</a></span> <span class="id">l</span> (<span class="id"><a href="compcert.lib.Integers.html#Int.repr">Int.repr</a></span> 31)) <span class="id">eqn</span>:<span class="id">LT31</span>.<br/>
&nbsp;&nbsp;+ <span class="id">exploit</span> (<span class="id"><a href="compcert.x86.SelectOpproof.html#eval_shrximm">eval_shrximm</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.se">se</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.ge">ge</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.sp">sp</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.e">e</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.m">m</a></span> (<span class="id"><a href="compcert.common.Values.html#Vint">Vint</a></span> <span class="id">i</span> :: <span class="id">le</span>) (<span class="id"><a href="compcert.backend.CminorSel.html#Eletvar">Eletvar</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">constructor</span>. <span class="tactic">simpl</span>; <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.common.Values.html#Val.divs_pow2">Val.divs_pow2</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">intros</span> [<span class="id">v1</span> [<span class="id">X</span> <span class="id">LD</span>]]. <span class="id">inv</span> <span class="id">LD</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>. <span class="id">econstructor</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">apply</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#eval_mod_from_div">eval_mod_from_div</a></span>. <span class="id">eexact</span> <span class="id">X</span>. <span class="tactic">simpl</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="compcert.x86.SelectOpproof.html#eval_mods_base">eval_mods_base</a></span>; <span class="tactic">eauto</span>. <span class="id">EvalOp</span>.<br/>
- <span class="tactic">destruct</span> (<span class="id"><a href="compcert.driver.Compopts.html#optim_for_size">Compopts.optim_for_size</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>).<br/>
&nbsp;&nbsp;+ <span class="tactic">eapply</span> <span class="id"><a href="compcert.x86.SelectOpproof.html#eval_mods_base">eval_mods_base</a></span>; <span class="tactic">eauto</span>. <span class="id">EvalOp</span>.<br/>
&nbsp;&nbsp;+ <span class="tactic">destruct</span> (<span class="id"><a href="compcert.backend.SelectDiv.html#divs_mul_params">divs_mul_params</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int.signed">Int.signed</a></span> <span class="id">n2</span>)) <span class="kwd">as</span> [[<span class="id">p</span> <span class="id">M</span>] | ] <span class="id">eqn</span>:<span class="id">PARAMS</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#eval_mod_from_div">eval_mod_from_div</a></span> <span class="kwd">with</span> (<span class="id">x</span> := <span class="id">i</span>); <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#eval_divs_mul">eval_divs_mul</a></span> <span class="kwd">with</span> (<span class="id">x</span> := <span class="id">i</span>); <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;* <span class="tactic">eapply</span> <span class="id"><a href="compcert.x86.SelectOpproof.html#eval_mods_base">eval_mods_base</a></span>; <span class="tactic">eauto</span>. <span class="id">EvalOp</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="eval_mods">eval_mods</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">le</span> <span class="id">a</span> <span class="id">b</span> <span class="id">x</span> <span class="id">y</span> <span class="id">z</span>,<br/>
&nbsp;&nbsp;<span class="id">eval_expr</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.ge">ge</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.sp">sp</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.e">e</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.m">m</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#le">le</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#a">a</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">eval_expr</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.ge">ge</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.sp">sp</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.e">e</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.m">m</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#le">le</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#b">b</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Values.html#Val.mods">Val.mods</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#y">y</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#z">z</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v</span>, <span class="id">eval_expr</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.ge">ge</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.sp">sp</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.e">e</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.m">m</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#le">le</a></span> (<span class="id"><a href="compcert.backend.SelectDiv.html#mods">mods</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#a">a</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#b">b</a></span>) <span class="id"><a href="compcert.backend.SelectDivproof.html#v">v</a></span> /\ <span class="id"><a href="compcert.common.Values.html#Val.lessdef">Val.lessdef</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#z">z</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#v">v</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2414')">Proof.</div>
<div class="proofscript" id="proof2414">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.SelectDiv.html#mods">mods</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.backend.SelectDiv.html#is_intconst">is_intconst</a></span> <span class="id">b</span>) <span class="kwd">as</span> [<span class="id">n2</span>|] <span class="id">eqn</span>:<span class="id">B</span>.<br/>
- <span class="id">exploit</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#is_intconst_sound">is_intconst_sound</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> <span class="id">EB</span>; <span class="tactic">clear</span> <span class="id">B</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.backend.SelectDiv.html#is_intconst">is_intconst</a></span> <span class="id">a</span>) <span class="kwd">as</span> [<span class="id">n1</span>|] <span class="id">eqn</span>:<span class="id">A</span>.<br/>
+ <span class="id">exploit</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#is_intconst_sound">is_intconst_sound</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> <span class="id">EA</span>; <span class="tactic">clear</span> <span class="id">A</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Integers.html#Int.eq">Int.eq</a></span> <span class="id">n2</span> <span class="id"><a href="compcert.lib.Integers.html#Int.zero">Int.zero</a></span>) <span class="id">eqn</span>:<span class="id">Z</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.x86.SelectOpproof.html#eval_mods_base">eval_mods_base</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">subst</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H1</span>. <br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Integers.html#Int.eq">Int.eq</a></span> <span class="id">n2</span> <span class="id"><a href="compcert.lib.Integers.html#Int.zero">Int.zero</a></span> || <span class="id"><a href="compcert.lib.Integers.html#Int.eq">Int.eq</a></span> <span class="id">n1</span> (<span class="id"><a href="compcert.lib.Integers.html#Int.repr">Int.repr</a></span> <span class="id"><a href="compcert.lib.Integers.html#Int.min_signed">Int.min_signed</a></span>) &amp;&amp; <span class="id"><a href="compcert.lib.Integers.html#Int.eq">Int.eq</a></span> <span class="id">n2</span> <span class="id"><a href="compcert.lib.Integers.html#Int.mone">Int.mone</a></span>); <span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="id">TrivialExists</span>.<br/>
+ <span class="tactic">subst</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#eval_modsimm">eval_modsimm</a></span>; <span class="tactic">eauto</span>.<br/>
- <span class="tactic">eapply</span> <span class="id"><a href="compcert.x86.SelectOpproof.html#eval_mods_base">eval_mods_base</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="eval_modl_from_divl">eval_modl_from_divl</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">le</span> <span class="id">a</span> <span class="id">n</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;<span class="id">eval_expr</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.ge">ge</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.sp">sp</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.e">e</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.m">m</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#le">le</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#a">a</a></span> (<span class="id"><a href="compcert.common.Values.html#Vlong">Vlong</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#y">y</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth_error">nth_error</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#le">le</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="compcert.common.Values.html#Vlong">Vlong</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">eval_expr</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.ge">ge</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.sp">sp</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.e">e</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.m">m</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#le">le</a></span> (<span class="id"><a href="compcert.backend.SelectDiv.html#modl_from_divl">modl_from_divl</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#a">a</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#n">n</a></span>) (<span class="id"><a href="compcert.common.Values.html#Vlong">Vlong</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int64.sub">Int64.sub</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int64.mul">Int64.mul</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#y">y</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#n">n</a></span>))).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2415')">Proof.</div>
<div class="proofscript" id="proof2415">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.SelectDiv.html#modl_from_divl">modl_from_divl</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.x86.SelectLongproof.html#eval_mullimm">eval_mullimm</a></span>; <span class="tactic">eauto</span>. <span class="id">instantiate</span> (1 := <span class="id">n</span>). <span class="tactic">intros</span> (<span class="id">v1</span> &amp; <span class="id">A1</span> &amp; <span class="id">B1</span>).<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">A0</span>: <span class="id">eval_expr</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.ge">ge</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.sp">sp</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.e">e</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.m">m</a></span> <span class="id">le</span> (<span class="id"><a href="compcert.backend.CminorSel.html#Eletvar">Eletvar</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span>) (<span class="id"><a href="compcert.common.Values.html#Vlong">Vlong</a></span> <span class="id">x</span>)) <span class="tactic">by</span> (<span class="id">constructor</span>; <span class="tactic">auto</span>).<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.x86.SelectLongproof.html#eval_subl">eval_subl</a></span> ; <span class="tactic">auto</span> ; <span class="tactic">try</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.HELPERS">HELPERS</a></span>. <span class="tactic">exact</span> <span class="id">A0</span>. <span class="tactic">exact</span> <span class="id">A1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">intros</span> (<span class="id">v2</span> &amp; <span class="id">A2</span> &amp; <span class="id">B2</span>).<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">B1</span>; <span class="id">inv</span> <span class="id">B1</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">B2</span>; <span class="id">inv</span> <span class="id">B2</span>. <span class="tactic">exact</span> <span class="id">A2</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="eval_divlu_mull">eval_divlu_mull</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">le</span> <span class="id">x</span> <span class="id">y</span> <span class="id">p</span> <span class="id">M</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.SelectDiv.html#divlu_mul_params">divlu_mul_params</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int64.unsigned">Int64.unsigned</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#y">y</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="compcert.backend.SelectDivproof.html#p">p</a></span>, <span class="id"><a href="compcert.backend.SelectDivproof.html#M">M</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth_error">nth_error</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#le">le</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="compcert.common.Values.html#Vlong">Vlong</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">eval_expr</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.ge">ge</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.sp">sp</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.e">e</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.m">m</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#le">le</a></span> (<span class="id"><a href="compcert.backend.SelectDiv.html#divlu_mull">divlu_mull</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#p">p</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#M">M</a></span>) (<span class="id"><a href="compcert.common.Values.html#Vlong">Vlong</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int64.divu">Int64.divu</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#y">y</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2416')">Proof.</div>
<div class="proofscript" id="proof2416">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.SelectDiv.html#divlu_mull">divlu_mull</a></span>. <span class="id">exploit</span> (<span class="id"><a href="compcert.backend.SelectDivproof.html#divlu_mul_shift">divlu_mul_shift</a></span> <span class="id">x</span>); <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">A</span> <span class="id">B</span>].<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">A0</span>: <span class="id">eval_expr</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.ge">ge</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.sp">sp</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.e">e</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.m">m</a></span> <span class="id">le</span> (<span class="id"><a href="compcert.backend.CminorSel.html#Eletvar">Eletvar</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span>) (<span class="id"><a href="compcert.common.Values.html#Vlong">Vlong</a></span> <span class="id">x</span>)) <span class="tactic">by</span> (<span class="id">constructor</span>; <span class="tactic">auto</span>).<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.x86.SelectLongproof.html#eval_mullhu">eval_mullhu</a></span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="id">eexact</span> <span class="id">A0</span>. <span class="id">instantiate</span> (1 := <span class="id"><a href="compcert.lib.Integers.html#Int64.repr">Int64.repr</a></span> <span class="id">M</span>). <span class="tactic">intros</span> (<span class="id">v1</span> &amp; <span class="id">A1</span> &amp; <span class="id">B1</span>).<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.x86.SelectLongproof.html#eval_shrluimm">eval_shrluimm</a></span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="id">eexact</span> <span class="id">A1</span>. <span class="id">instantiate</span> (1 := <span class="id"><a href="compcert.lib.Integers.html#Int.repr">Int.repr</a></span> <span class="id">p</span>). <span class="tactic">intros</span> (<span class="id">v2</span> &amp; <span class="id">A2</span> &amp; <span class="id">B2</span>).<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">B1</span>; <span class="id">inv</span> <span class="id">B1</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">B2</span>. <span class="tactic">replace</span> (<span class="id"><a href="compcert.lib.Integers.html#Int.ltu">Int.ltu</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int.repr">Int.repr</a></span> <span class="id">p</span>) <span class="id">Int64.iwordsize</span>') <span class="kwd">with</span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span> <span class="kwd">in</span> <span class="id">B2</span>. <span class="id">inv</span> <span class="id">B2</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">B</span>. <span class="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.lib.Integers.html#Int.ltu">Int.ltu</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Integers.html#Int.unsigned_repr">Int.unsigned_repr</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#zlt_true">zlt_true</a></span>; <span class="tactic">auto</span>. <span class="tactic">tauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (64 &lt; <span class="id"><a href="compcert.lib.Integers.html#Int.max_unsigned">Int.max_unsigned</a></span>) <span class="tactic">by</span> (<span class="tactic">compute</span>; <span class="tactic">auto</span>). <span class="tactic">omega</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="eval_divlu">eval_divlu</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">le</span> <span class="id">a</span> <span class="id">b</span> <span class="id">x</span> <span class="id">y</span> <span class="id">z</span>,<br/>
&nbsp;&nbsp;<span class="id">eval_expr</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.ge">ge</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.sp">sp</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.e">e</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.m">m</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#le">le</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#a">a</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">eval_expr</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.ge">ge</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.sp">sp</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.e">e</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.m">m</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#le">le</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#b">b</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Values.html#Val.divlu">Val.divlu</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#y">y</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#z">z</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v</span>, <span class="id">eval_expr</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.ge">ge</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.sp">sp</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.e">e</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.m">m</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#le">le</a></span> (<span class="id"><a href="compcert.backend.SelectDiv.html#divlu">divlu</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#a">a</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#b">b</a></span>) <span class="id"><a href="compcert.backend.SelectDivproof.html#v">v</a></span> /\ <span class="id"><a href="compcert.common.Values.html#Val.lessdef">Val.lessdef</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#z">z</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#v">v</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2417')">Proof.</div>
<div class="proofscript" id="proof2417">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.SelectDiv.html#divlu">divlu</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.x86.SelectLong.html#is_longconst">is_longconst</a></span> <span class="id">b</span>) <span class="kwd">as</span> [<span class="id">n2</span>|] <span class="id">eqn</span>:<span class="id">N2</span>.<br/>
- <span class="tactic">assert</span> (<span class="id">y</span> = <span class="id"><a href="compcert.common.Values.html#Vlong">Vlong</a></span> <span class="id">n2</span>) <span class="tactic">by</span> (<span class="tactic">eapply</span> <span class="id"><a href="compcert.x86.SelectLongproof.html#is_longconst_sound">is_longconst_sound</a></span>; <span class="tactic">eauto</span>). <span class="tactic">subst</span> <span class="id">y</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.x86.SelectLong.html#is_longconst">is_longconst</a></span> <span class="id">a</span>) <span class="kwd">as</span> [<span class="id">n1</span>|] <span class="id">eqn</span>:<span class="id">N1</span>.<br/>
+ <span class="tactic">assert</span> (<span class="id">x</span> = <span class="id"><a href="compcert.common.Values.html#Vlong">Vlong</a></span> <span class="id">n1</span>) <span class="tactic">by</span> (<span class="tactic">eapply</span> <span class="id"><a href="compcert.x86.SelectLongproof.html#is_longconst_sound">is_longconst_sound</a></span>; <span class="tactic">eauto</span>). <span class="tactic">subst</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H1</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Integers.html#Int64.eq">Int64.eq</a></span> <span class="id">n2</span> <span class="id"><a href="compcert.lib.Integers.html#Int64.zero">Int64.zero</a></span>); <span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.x86.SelectLongproof.html#eval_longconst">eval_longconst</a></span>. <span class="id">constructor</span>.<br/>
+ <span class="tactic">destruct</span> (<span class="id">Int64.is_power2</span>' <span class="id">n2</span>) <span class="kwd">as</span> [<span class="id">l</span>|] <span class="id">eqn</span>:<span class="id">POW</span>.<br/>
* <span class="id">exploit</span> <span class="id"><a href="compcert.common.Values.html#Val.divlu_pow2">Val.divlu_pow2</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> <span class="id">EQ</span>; <span class="tactic">subst</span> <span class="id">z</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.x86.SelectLongproof.html#eval_shrluimm">eval_shrluimm</a></span>; <span class="tactic">eauto</span>.<br/>
* <span class="tactic">destruct</span> (<span class="id"><a href="compcert.driver.Compopts.html#optim_for_size">Compopts.optim_for_size</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>). <span class="tactic">eapply</span> <span class="id"><a href="compcert.x86.SelectLongproof.html#eval_divlu_base">eval_divlu_base</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.backend.SelectDiv.html#divlu_mul_params">divlu_mul_params</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int64.unsigned">Int64.unsigned</a></span> <span class="id">n2</span>)) <span class="kwd">as</span> [[<span class="id">p</span> <span class="id">M</span>]|] <span class="id">eqn</span>:<span class="id">PARAMS</span>.<br/>
** <span class="tactic">destruct</span> <span class="id">x</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H1</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Integers.html#Int64.eq">Int64.eq</a></span> <span class="id">n2</span> <span class="id"><a href="compcert.lib.Integers.html#Int64.zero">Int64.zero</a></span>); <span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>; <span class="tactic">eauto</span>. <span class="id">econstructor</span>. <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#eval_divlu_mull">eval_divlu_mull</a></span>; <span class="tactic">eauto</span>.<br/>
** <span class="tactic">eapply</span> <span class="id"><a href="compcert.x86.SelectLongproof.html#eval_divlu_base">eval_divlu_base</a></span>; <span class="tactic">eauto</span>.<br/>
- <span class="tactic">eapply</span> <span class="id"><a href="compcert.x86.SelectLongproof.html#eval_divlu_base">eval_divlu_base</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="eval_modlu">eval_modlu</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">le</span> <span class="id">a</span> <span class="id">b</span> <span class="id">x</span> <span class="id">y</span> <span class="id">z</span>,<br/>
&nbsp;&nbsp;<span class="id">eval_expr</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.ge">ge</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.sp">sp</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.e">e</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.m">m</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#le">le</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#a">a</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">eval_expr</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.ge">ge</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.sp">sp</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.e">e</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.m">m</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#le">le</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#b">b</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Values.html#Val.modlu">Val.modlu</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#y">y</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#z">z</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v</span>, <span class="id">eval_expr</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.ge">ge</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.sp">sp</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.e">e</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.m">m</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#le">le</a></span> (<span class="id"><a href="compcert.backend.SelectDiv.html#modlu">modlu</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#a">a</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#b">b</a></span>) <span class="id"><a href="compcert.backend.SelectDivproof.html#v">v</a></span> /\ <span class="id"><a href="compcert.common.Values.html#Val.lessdef">Val.lessdef</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#z">z</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#v">v</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2418')">Proof.</div>
<div class="proofscript" id="proof2418">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.SelectDiv.html#modlu">modlu</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.x86.SelectLong.html#is_longconst">is_longconst</a></span> <span class="id">b</span>) <span class="kwd">as</span> [<span class="id">n2</span>|] <span class="id">eqn</span>:<span class="id">N2</span>.<br/>
- <span class="tactic">assert</span> (<span class="id">y</span> = <span class="id"><a href="compcert.common.Values.html#Vlong">Vlong</a></span> <span class="id">n2</span>) <span class="tactic">by</span> (<span class="tactic">eapply</span> <span class="id"><a href="compcert.x86.SelectLongproof.html#is_longconst_sound">is_longconst_sound</a></span>; <span class="tactic">eauto</span>). <span class="tactic">subst</span> <span class="id">y</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.x86.SelectLong.html#is_longconst">is_longconst</a></span> <span class="id">a</span>) <span class="kwd">as</span> [<span class="id">n1</span>|] <span class="id">eqn</span>:<span class="id">N1</span>.<br/>
+ <span class="tactic">assert</span> (<span class="id">x</span> = <span class="id"><a href="compcert.common.Values.html#Vlong">Vlong</a></span> <span class="id">n1</span>) <span class="tactic">by</span> (<span class="tactic">eapply</span> <span class="id"><a href="compcert.x86.SelectLongproof.html#is_longconst_sound">is_longconst_sound</a></span>; <span class="tactic">eauto</span>). <span class="tactic">subst</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H1</span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Integers.html#Int64.eq">Int64.eq</a></span> <span class="id">n2</span> <span class="id"><a href="compcert.lib.Integers.html#Int64.zero">Int64.zero</a></span>); <span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.x86.SelectLongproof.html#eval_longconst">eval_longconst</a></span>. <span class="id">constructor</span>.<br/>
+ <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Integers.html#Int64.is_power2">Int64.is_power2</a></span> <span class="id">n2</span>) <span class="kwd">as</span> [<span class="id">l</span>|] <span class="id">eqn</span>:<span class="id">POW</span>.<br/>
* <span class="id">exploit</span> <span class="id"><a href="compcert.common.Values.html#Val.modlu_pow2">Val.modlu_pow2</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> <span class="id">EQ</span>; <span class="tactic">subst</span> <span class="id">z</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.x86.SelectLongproof.html#eval_andl">eval_andl</a></span>; <span class="tactic">eauto</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.x86.SelectLongproof.html#eval_longconst">eval_longconst</a></span>.<br/>
* <span class="tactic">destruct</span> (<span class="id"><a href="compcert.driver.Compopts.html#optim_for_size">Compopts.optim_for_size</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>). <span class="tactic">eapply</span> <span class="id"><a href="compcert.x86.SelectLongproof.html#eval_modlu_base">eval_modlu_base</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.backend.SelectDiv.html#divlu_mul_params">divlu_mul_params</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int64.unsigned">Int64.unsigned</a></span> <span class="id">n2</span>)) <span class="kwd">as</span> [[<span class="id">p</span> <span class="id">M</span>]|] <span class="id">eqn</span>:<span class="id">PARAMS</span>.<br/>
** <span class="tactic">destruct</span> <span class="id">x</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H1</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Integers.html#Int64.eq">Int64.eq</a></span> <span class="id">n2</span> <span class="id"><a href="compcert.lib.Integers.html#Int64.zero">Int64.zero</a></span>) <span class="id">eqn</span>:<span class="id">Z</span>; <span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Integers.html#Int64.modu_divu">Int64.modu_divu</a></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>; <span class="tactic">eauto</span>. <span class="id">econstructor</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#eval_modl_from_divl">eval_modl_from_divl</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#eval_divlu_mull">eval_divlu_mull</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">red</span>; <span class="tactic">intros</span>; <span class="tactic">subst</span> <span class="id">n2</span>; <span class="tactic">discriminate</span> <span class="id">Z</span>.<br/>
** <span class="tactic">eapply</span> <span class="id"><a href="compcert.x86.SelectLongproof.html#eval_modlu_base">eval_modlu_base</a></span>; <span class="tactic">eauto</span>.<br/>
- <span class="tactic">eapply</span> <span class="id"><a href="compcert.x86.SelectLongproof.html#eval_modlu_base">eval_modlu_base</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Lemma</span> <span class="id"><a name="eval_divls_mull">eval_divls_mull</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">le</span> <span class="id">x</span> <span class="id">y</span> <span class="id">p</span> <span class="id">M</span>,<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.backend.SelectDiv.html#divls_mul_params">divls_mul_params</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int64.signed">Int64.signed</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#y">y</a></span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span>(<span class="id"><a href="compcert.backend.SelectDivproof.html#p">p</a></span>, <span class="id"><a href="compcert.backend.SelectDivproof.html#M">M</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="http://coq.inria.fr/library/Coq.Lists.List.html#nth_error">nth_error</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#le">le</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="compcert.common.Values.html#Vlong">Vlong</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id">eval_expr</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.ge">ge</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.sp">sp</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.e">e</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.m">m</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#le">le</a></span> (<span class="id"><a href="compcert.backend.SelectDiv.html#divls_mull">divls_mull</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#p">p</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#M">M</a></span>) (<span class="id"><a href="compcert.common.Values.html#Vlong">Vlong</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int64.divs">Int64.divs</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#y">y</a></span>)).<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2419')">Proof.</div>
<div class="proofscript" id="proof2419">
&nbsp;&nbsp;<span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.SelectDiv.html#divls_mull">divls_mull</a></span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">A0</span>: <span class="id">eval_expr</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.ge">ge</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.sp">sp</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.e">e</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.m">m</a></span> <span class="id">le</span> (<span class="id"><a href="compcert.backend.CminorSel.html#Eletvar">Eletvar</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span>) (<span class="id"><a href="compcert.common.Values.html#Vlong">Vlong</a></span> <span class="id">x</span>)).<br/>
&nbsp;&nbsp;{ <span class="id">constructor</span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.x86.SelectLongproof.html#eval_mullhs">eval_mullhs</a></span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="id">eexact</span> <span class="id">A0</span>. <span class="id">instantiate</span> (1 := <span class="id"><a href="compcert.lib.Integers.html#Int64.repr">Int64.repr</a></span> <span class="id">M</span>).  <span class="tactic">intros</span> (<span class="id">v1</span> &amp; <span class="id">A1</span> &amp; <span class="id">B1</span>).<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.x86.SelectLongproof.html#eval_addl">eval_addl</a></span>; <span class="tactic">auto</span>; <span class="tactic">try</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.HELPERS">HELPERS</a></span>. <span class="id">eexact</span> <span class="id">A1</span>. <span class="id">eexact</span> <span class="id">A0</span>. <span class="tactic">intros</span> (<span class="id">v2</span> &amp; <span class="id">A2</span> &amp; <span class="id">B2</span>).<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.x86.SelectLongproof.html#eval_shrluimm">eval_shrluimm</a></span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="id">eexact</span> <span class="id">A0</span>. <span class="id">instantiate</span> (1 := <span class="id"><a href="compcert.lib.Integers.html#Int.repr">Int.repr</a></span> 63). <span class="tactic">intros</span> (<span class="id">v3</span> &amp; <span class="id">A3</span> &amp; <span class="id">B3</span>).<br/>
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">a4</span> := <span class="kwd">if</span> <span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> <span class="id">M</span> <span class="id"><a href="compcert.lib.Integers.html#Int64.half_modulus">Int64.half_modulus</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">then</span> <span class="id"><a href="compcert.x86.SelectLong.html#mullhs">mullhs</a></span> (<span class="id"><a href="compcert.backend.CminorSel.html#Eletvar">Eletvar</a></span> 0) (<span class="id"><a href="compcert.lib.Integers.html#Int64.repr">Int64.repr</a></span> <span class="id">M</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="kwd">else</span> <span class="id"><a href="compcert.x86.SelectLong.html#addl">addl</a></span> (<span class="id"><a href="compcert.x86.SelectLong.html#mullhs">mullhs</a></span> (<span class="id"><a href="compcert.backend.CminorSel.html#Eletvar">Eletvar</a></span> 0) (<span class="id"><a href="compcert.lib.Integers.html#Int64.repr">Int64.repr</a></span> <span class="id">M</span>)) (<span class="id"><a href="compcert.backend.CminorSel.html#Eletvar">Eletvar</a></span> 0)).<br/>
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">v4</span> := <span class="kwd">if</span> <span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> <span class="id">M</span> <span class="id"><a href="compcert.lib.Integers.html#Int64.half_modulus">Int64.half_modulus</a></span> <span class="kwd">then</span> <span class="id">v1</span> <span class="kwd">else</span> <span class="id">v2</span>).<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">A4</span>: <span class="id">eval_expr</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.ge">ge</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.sp">sp</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.e">e</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.m">m</a></span> <span class="id">le</span> <span class="id">a4</span> <span class="id">v4</span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">unfold</span> <span class="id">a4</span>, <span class="id">v4</span>; <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> <span class="id">M</span> <span class="id"><a href="compcert.lib.Integers.html#Int64.half_modulus">Int64.half_modulus</a></span>); <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.x86.SelectLongproof.html#eval_shrlimm">eval_shrlimm</a></span>. <span class="tactic">eauto</span>. <span class="tactic">eauto</span>. <span class="id">eexact</span> <span class="id">A4</span>. <span class="id">instantiate</span> (1 := <span class="id"><a href="compcert.lib.Integers.html#Int.repr">Int.repr</a></span> <span class="id">p</span>). <span class="tactic">intros</span> (<span class="id">v5</span> &amp; <span class="id">A5</span> &amp; <span class="id">B5</span>).<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.x86.SelectLongproof.html#eval_addl">eval_addl</a></span>; <span class="tactic">auto</span>; <span class="tactic">try</span> <span class="tactic">apply</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.HELPERS">HELPERS</a></span>. <span class="id">eexact</span> <span class="id">A5</span>. <span class="id">eexact</span> <span class="id">A3</span>. <span class="tactic">intros</span> (<span class="id">v6</span> &amp; <span class="id">A6</span> &amp; <span class="id">B6</span>).<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">RANGE</span>: <span class="kwd">forall</span> <span class="id">x</span>, 0 &lt;= <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span> &lt; 64 -&gt; <span class="id"><a href="compcert.lib.Integers.html#Int.ltu">Int.ltu</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int.repr">Int.repr</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span>) <span class="id">Int64.iwordsize</span>' = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true">true</a></span>).<br/>
&nbsp;&nbsp;{ <span class="tactic">intros</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.lib.Integers.html#Int.ltu">Int.ltu</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Integers.html#Int.unsigned_repr">Int.unsigned_repr</a></span>. <span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Coqlib.html#zlt_true">zlt_true</a></span> <span class="tactic">by</span> <span class="tactic">tauto</span>. <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">assert</span> (64 &lt; <span class="id"><a href="compcert.lib.Integers.html#Int.max_unsigned">Int.max_unsigned</a></span>) <span class="tactic">by</span> (<span class="tactic">compute</span>; <span class="tactic">auto</span>). <span class="tactic">omega</span>. }<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">B1</span>; <span class="id">inv</span> <span class="id">B1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">B2</span>; <span class="id">inv</span> <span class="id">B2</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">B3</span>; <span class="tactic">rewrite</span> <span class="id">RANGE</span> <span class="kwd">in</span> <span class="id">B3</span> <span class="tactic">by</span> <span class="tactic">omega</span>; <span class="id">inv</span> <span class="id">B3</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Coqlib.html#zlt">zlt</a></span> <span class="id">M</span> <span class="id"><a href="compcert.lib.Integers.html#Int64.half_modulus">Int64.half_modulus</a></span>).<br/>
- <span class="id">exploit</span> (<span class="id"><a href="compcert.backend.SelectDivproof.html#divls_mul_shift_1">divls_mul_shift_1</a></span> <span class="id">x</span>); <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">A</span> <span class="id">B</span>].<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">B5</span>; <span class="tactic">rewrite</span> <span class="id">RANGE</span> <span class="kwd">in</span> <span class="id">B5</span> <span class="tactic">by</span> <span class="tactic">auto</span>; <span class="id">inv</span> <span class="id">B5</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">B6</span>; <span class="id">inv</span> <span class="id">B6</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">B</span>; <span class="tactic">exact</span> <span class="id">A6</span>.<br/>
- <span class="id">exploit</span> (<span class="id"><a href="compcert.backend.SelectDivproof.html#divls_mul_shift_2">divls_mul_shift_2</a></span> <span class="id">x</span>); <span class="tactic">eauto</span>. <span class="tactic">intros</span> [<span class="id">A</span> <span class="id">B</span>].<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">B5</span>; <span class="tactic">rewrite</span> <span class="id">RANGE</span> <span class="kwd">in</span> <span class="id">B5</span> <span class="tactic">by</span> <span class="tactic">auto</span>; <span class="id">inv</span> <span class="id">B5</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">B6</span>; <span class="id">inv</span> <span class="id">B6</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id">B</span>; <span class="tactic">exact</span> <span class="id">A6</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="eval_divls">eval_divls</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">le</span> <span class="id">a</span> <span class="id">b</span> <span class="id">x</span> <span class="id">y</span> <span class="id">z</span>,<br/>
&nbsp;&nbsp;<span class="id">eval_expr</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.ge">ge</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.sp">sp</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.e">e</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.m">m</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#le">le</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#a">a</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">eval_expr</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.ge">ge</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.sp">sp</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.e">e</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.m">m</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#le">le</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#b">b</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Values.html#Val.divls">Val.divls</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#y">y</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#z">z</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v</span>, <span class="id">eval_expr</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.ge">ge</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.sp">sp</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.e">e</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.m">m</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#le">le</a></span> (<span class="id"><a href="compcert.backend.SelectDiv.html#divls">divls</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#a">a</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#b">b</a></span>) <span class="id"><a href="compcert.backend.SelectDivproof.html#v">v</a></span> /\ <span class="id"><a href="compcert.common.Values.html#Val.lessdef">Val.lessdef</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#z">z</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#v">v</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2420')">Proof.</div>
<div class="proofscript" id="proof2420">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.SelectDiv.html#divls">divls</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.x86.SelectLong.html#is_longconst">is_longconst</a></span> <span class="id">b</span>) <span class="kwd">as</span> [<span class="id">n2</span>|] <span class="id">eqn</span>:<span class="id">N2</span>.<br/>
- <span class="tactic">assert</span> (<span class="id">y</span> = <span class="id"><a href="compcert.common.Values.html#Vlong">Vlong</a></span> <span class="id">n2</span>) <span class="tactic">by</span> (<span class="tactic">eapply</span> <span class="id"><a href="compcert.x86.SelectLongproof.html#is_longconst_sound">is_longconst_sound</a></span>; <span class="tactic">eauto</span>). <span class="tactic">subst</span> <span class="id">y</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.x86.SelectLong.html#is_longconst">is_longconst</a></span> <span class="id">a</span>) <span class="kwd">as</span> [<span class="id">n1</span>|] <span class="id">eqn</span>:<span class="id">N1</span>.<br/>
+ <span class="tactic">assert</span> (<span class="id">x</span> = <span class="id"><a href="compcert.common.Values.html#Vlong">Vlong</a></span> <span class="id">n1</span>) <span class="tactic">by</span> (<span class="tactic">eapply</span> <span class="id"><a href="compcert.x86.SelectLongproof.html#is_longconst_sound">is_longconst_sound</a></span>; <span class="tactic">eauto</span>). <span class="tactic">subst</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Integers.html#Int64.eq">Int64.eq</a></span> <span class="id">n2</span> <span class="id"><a href="compcert.lib.Integers.html#Int64.zero">Int64.zero</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|| <span class="id"><a href="compcert.lib.Integers.html#Int64.eq">Int64.eq</a></span> <span class="id">n1</span> (<span class="id"><a href="compcert.lib.Integers.html#Int64.repr">Int64.repr</a></span> <span class="id"><a href="compcert.lib.Integers.html#Int64.min_signed">Int64.min_signed</a></span>) &amp;&amp; <span class="id"><a href="compcert.lib.Integers.html#Int64.eq">Int64.eq</a></span> <span class="id">n2</span> <span class="id"><a href="compcert.lib.Integers.html#Int64.mone">Int64.mone</a></span>); <span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.x86.SelectLongproof.html#eval_longconst">eval_longconst</a></span>. <span class="id">constructor</span>.<br/>
+ <span class="tactic">destruct</span> (<span class="id">Int64.is_power2</span>' <span class="id">n2</span>) <span class="kwd">as</span> [<span class="id">l</span>|] <span class="id">eqn</span>:<span class="id">POW</span>.<br/>
* <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Integers.html#Int.ltu">Int.ltu</a></span> <span class="id">l</span> (<span class="id"><a href="compcert.lib.Integers.html#Int.repr">Int.repr</a></span> 63)) <span class="id">eqn</span>:<span class="id">LT</span>.<br/>
** <span class="id">exploit</span> <span class="id"><a href="compcert.common.Values.html#Val.divls_pow2">Val.divls_pow2</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> <span class="id">EQ</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.x86.SelectLongproof.html#eval_shrxlimm">eval_shrxlimm</a></span>; <span class="tactic">eauto</span>.<br/>
** <span class="tactic">eapply</span> <span class="id"><a href="compcert.x86.SelectLongproof.html#eval_divls_base">eval_divls_base</a></span>; <span class="tactic">eauto</span>.<br/>
* <span class="tactic">destruct</span> (<span class="id"><a href="compcert.driver.Compopts.html#optim_for_size">Compopts.optim_for_size</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>). <span class="tactic">eapply</span> <span class="id"><a href="compcert.x86.SelectLongproof.html#eval_divls_base">eval_divls_base</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.backend.SelectDiv.html#divls_mul_params">divls_mul_params</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int64.signed">Int64.signed</a></span> <span class="id">n2</span>)) <span class="kwd">as</span> [[<span class="id">p</span> <span class="id">M</span>]|] <span class="id">eqn</span>:<span class="id">PARAMS</span>.<br/>
** <span class="tactic">destruct</span> <span class="id">x</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H1</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Integers.html#Int64.eq">Int64.eq</a></span> <span class="id">n2</span> <span class="id"><a href="compcert.lib.Integers.html#Int64.zero">Int64.zero</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|| <span class="id"><a href="compcert.lib.Integers.html#Int64.eq">Int64.eq</a></span> <span class="id">i</span> (<span class="id"><a href="compcert.lib.Integers.html#Int64.repr">Int64.repr</a></span> <span class="id"><a href="compcert.lib.Integers.html#Int64.min_signed">Int64.min_signed</a></span>) &amp;&amp; <span class="id"><a href="compcert.lib.Integers.html#Int64.eq">Int64.eq</a></span> <span class="id">n2</span> <span class="id"><a href="compcert.lib.Integers.html#Int64.mone">Int64.mone</a></span>); <span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>; <span class="tactic">eauto</span>. <span class="id">econstructor</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#eval_divls_mull">eval_divls_mull</a></span>; <span class="tactic">eauto</span>.<br/>
** <span class="tactic">eapply</span> <span class="id"><a href="compcert.x86.SelectLongproof.html#eval_divls_base">eval_divls_base</a></span>; <span class="tactic">eauto</span>.<br/>
- <span class="tactic">eapply</span> <span class="id"><a href="compcert.x86.SelectLongproof.html#eval_divls_base">eval_divls_base</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="eval_modls">eval_modls</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">le</span> <span class="id">a</span> <span class="id">b</span> <span class="id">x</span> <span class="id">y</span> <span class="id">z</span>,<br/>
&nbsp;&nbsp;<span class="id">eval_expr</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.ge">ge</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.sp">sp</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.e">e</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.m">m</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#le">le</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#a">a</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">eval_expr</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.ge">ge</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.sp">sp</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.e">e</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.m">m</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#le">le</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#b">b</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id"><a href="compcert.common.Values.html#Val.modls">Val.modls</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#y">y</a></span> = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#z">z</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v</span>, <span class="id">eval_expr</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.ge">ge</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.sp">sp</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.e">e</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.m">m</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#le">le</a></span> (<span class="id"><a href="compcert.backend.SelectDiv.html#modls">modls</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#a">a</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#b">b</a></span>) <span class="id"><a href="compcert.backend.SelectDivproof.html#v">v</a></span> /\ <span class="id"><a href="compcert.common.Values.html#Val.lessdef">Val.lessdef</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#z">z</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#v">v</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2421')">Proof.</div>
<div class="proofscript" id="proof2421">
&nbsp;&nbsp;<span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.SelectDiv.html#modls">modls</a></span>; <span class="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.x86.SelectLong.html#is_longconst">is_longconst</a></span> <span class="id">b</span>) <span class="kwd">as</span> [<span class="id">n2</span>|] <span class="id">eqn</span>:<span class="id">N2</span>.<br/>
- <span class="tactic">assert</span> (<span class="id">y</span> = <span class="id"><a href="compcert.common.Values.html#Vlong">Vlong</a></span> <span class="id">n2</span>) <span class="tactic">by</span> (<span class="tactic">eapply</span> <span class="id"><a href="compcert.x86.SelectLongproof.html#is_longconst_sound">is_longconst_sound</a></span>; <span class="tactic">eauto</span>). <span class="tactic">subst</span> <span class="id">y</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.x86.SelectLong.html#is_longconst">is_longconst</a></span> <span class="id">a</span>) <span class="kwd">as</span> [<span class="id">n1</span>|] <span class="id">eqn</span>:<span class="id">N1</span>.<br/>
+ <span class="tactic">assert</span> (<span class="id">x</span> = <span class="id"><a href="compcert.common.Values.html#Vlong">Vlong</a></span> <span class="id">n1</span>) <span class="tactic">by</span> (<span class="tactic">eapply</span> <span class="id"><a href="compcert.x86.SelectLongproof.html#is_longconst_sound">is_longconst_sound</a></span>; <span class="tactic">eauto</span>). <span class="tactic">subst</span> <span class="id">x</span>.<br/>
&nbsp;&nbsp;<span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Integers.html#Int64.eq">Int64.eq</a></span> <span class="id">n2</span> <span class="id"><a href="compcert.lib.Integers.html#Int64.zero">Int64.zero</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|| <span class="id"><a href="compcert.lib.Integers.html#Int64.eq">Int64.eq</a></span> <span class="id">n1</span> (<span class="id"><a href="compcert.lib.Integers.html#Int64.repr">Int64.repr</a></span> <span class="id"><a href="compcert.lib.Integers.html#Int64.min_signed">Int64.min_signed</a></span>) &amp;&amp; <span class="id"><a href="compcert.lib.Integers.html#Int64.eq">Int64.eq</a></span> <span class="id">n2</span> <span class="id"><a href="compcert.lib.Integers.html#Int64.mone">Int64.mone</a></span>); <span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>. <span class="tactic">apply</span> <span class="id"><a href="compcert.x86.SelectLongproof.html#eval_longconst">eval_longconst</a></span>. <span class="id">constructor</span>.<br/>
+ <span class="tactic">destruct</span> (<span class="id">Int64.is_power2</span>' <span class="id">n2</span>) <span class="kwd">as</span> [<span class="id">l</span>|] <span class="id">eqn</span>:<span class="id">POW</span>.<br/>
* <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Integers.html#Int.ltu">Int.ltu</a></span> <span class="id">l</span> (<span class="id"><a href="compcert.lib.Integers.html#Int.repr">Int.repr</a></span> 63)) <span class="id">eqn</span>:<span class="id">LT</span>.<br/>
**<span class="tactic">destruct</span> <span class="id">x</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H1</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Integers.html#Int64.eq">Int64.eq</a></span> <span class="id">n2</span> <span class="id"><a href="compcert.lib.Integers.html#Int64.zero">Int64.zero</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|| <span class="id"><a href="compcert.lib.Integers.html#Int64.eq">Int64.eq</a></span> <span class="id">i</span> (<span class="id"><a href="compcert.lib.Integers.html#Int64.repr">Int64.repr</a></span> <span class="id"><a href="compcert.lib.Integers.html#Int64.min_signed">Int64.min_signed</a></span>) &amp;&amp; <span class="id"><a href="compcert.lib.Integers.html#Int64.eq">Int64.eq</a></span> <span class="id">n2</span> <span class="id"><a href="compcert.lib.Integers.html#Int64.mone">Int64.mone</a></span>) <span class="id">eqn</span>:<span class="id">D</span>; <span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id"><a href="compcert.common.Values.html#Val.divls">Val.divls</a></span> (<span class="id"><a href="compcert.common.Values.html#Vlong">Vlong</a></span> <span class="id">i</span>) (<span class="id"><a href="compcert.common.Values.html#Vlong">Vlong</a></span> <span class="id">n2</span>) = <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#Some">Some</a></span> (<span class="id"><a href="compcert.common.Values.html#Vlong">Vlong</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int64.divs">Int64.divs</a></span> <span class="id">i</span> <span class="id">n2</span>))).<br/>
&nbsp;&nbsp;{ <span class="tactic">simpl</span>; <span class="tactic">rewrite</span> <span class="id">D</span>; <span class="tactic">auto</span>. }<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.common.Values.html#Val.divls_pow2">Val.divls_pow2</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> <span class="id">EQ</span>.<br/>
&nbsp;&nbsp;<span class="tactic">set</span> (<span class="id">le</span>' := <span class="id"><a href="compcert.common.Values.html#Vlong">Vlong</a></span> <span class="id">i</span> :: <span class="id">le</span>).<br/>
&nbsp;&nbsp;<span class="tactic">assert</span> (<span class="id">A</span>: <span class="id">eval_expr</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.ge">ge</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.sp">sp</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.e">e</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.m">m</a></span> <span class="id">le</span>' (<span class="id"><a href="compcert.backend.CminorSel.html#Eletvar">Eletvar</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#O">O</a></span>) (<span class="id"><a href="compcert.common.Values.html#Vlong">Vlong</a></span> <span class="id">i</span>)) <span class="tactic">by</span> (<span class="id">constructor</span>; <span class="tactic">auto</span>).<br/>
&nbsp;&nbsp;<span class="id">exploit</span> <span class="id"><a href="compcert.x86.SelectLongproof.html#eval_shrxlimm">eval_shrxlimm</a></span>; <span class="tactic">eauto</span>. <span class="tactic">intros</span> (<span class="id">v1</span> &amp; <span class="id">A1</span> &amp; <span class="id">B1</span>). <span class="id">inv</span> <span class="id">B1</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;<span class="id">econstructor</span>. <span class="tactic">eauto</span>. <span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#eval_modl_from_divl">eval_modl_from_divl</a></span>. <span class="id">eexact</span> <span class="id">A1</span>. <span class="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Integers.html#Int64.mods_divs">Int64.mods_divs</a></span>. <span class="tactic">auto</span>.<br/>
**<span class="tactic">eapply</span> <span class="id"><a href="compcert.x86.SelectLongproof.html#eval_modls_base">eval_modls_base</a></span>; <span class="tactic">eauto</span>.<br/>
* <span class="tactic">destruct</span> (<span class="id"><a href="compcert.driver.Compopts.html#optim_for_size">Compopts.optim_for_size</a></span> <span class="id"><a href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt">tt</a></span>). <span class="tactic">eapply</span> <span class="id"><a href="compcert.x86.SelectLongproof.html#eval_modls_base">eval_modls_base</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.backend.SelectDiv.html#divls_mul_params">divls_mul_params</a></span> (<span class="id"><a href="compcert.lib.Integers.html#Int64.signed">Int64.signed</a></span> <span class="id">n2</span>)) <span class="kwd">as</span> [[<span class="id">p</span> <span class="id">M</span>]|] <span class="id">eqn</span>:<span class="id">PARAMS</span>.<br/>
** <span class="tactic">destruct</span> <span class="id">x</span>; <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H1</span>; <span class="tactic">try</span> <span class="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Integers.html#Int64.eq">Int64.eq</a></span> <span class="id">n2</span> <span class="id"><a href="compcert.lib.Integers.html#Int64.zero">Int64.zero</a></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|| <span class="id"><a href="compcert.lib.Integers.html#Int64.eq">Int64.eq</a></span> <span class="id">i</span> (<span class="id"><a href="compcert.lib.Integers.html#Int64.repr">Int64.repr</a></span> <span class="id"><a href="compcert.lib.Integers.html#Int64.min_signed">Int64.min_signed</a></span>) &amp;&amp; <span class="id"><a href="compcert.lib.Integers.html#Int64.eq">Int64.eq</a></span> <span class="id">n2</span> <span class="id"><a href="compcert.lib.Integers.html#Int64.mone">Int64.mone</a></span>); <span class="id">inv</span> <span class="id">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id">econstructor</span>; <span class="tactic">split</span>; <span class="tactic">eauto</span>. <span class="id">econstructor</span>. <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="tactic">rewrite</span> <span class="id"><a href="compcert.lib.Integers.html#Int64.mods_divs">Int64.mods_divs</a></span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#eval_modl_from_divl">eval_modl_from_divl</a></span>; <span class="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="tactic">eapply</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#eval_divls_mull">eval_divls_mull</a></span>; <span class="tactic">eauto</span>.<br/>
** <span class="tactic">eapply</span> <span class="id"><a href="compcert.x86.SelectLongproof.html#eval_modls_base">eval_modls_base</a></span>; <span class="tactic">eauto</span>.<br/>
- <span class="tactic">eapply</span> <span class="id"><a href="compcert.x86.SelectLongproof.html#eval_modls_base">eval_modls_base</a></span>; <span class="tactic">eauto</span>.<br/>
Qed.</div>
<br/>
<h1> Floating-point division </h1>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="eval_divf">eval_divf</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">le</span> <span class="id">a</span> <span class="id">b</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;<span class="id">eval_expr</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.ge">ge</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.sp">sp</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.e">e</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.m">m</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#le">le</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#a">a</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">eval_expr</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.ge">ge</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.sp">sp</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.e">e</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.m">m</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#le">le</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#b">b</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v</span>, <span class="id">eval_expr</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.ge">ge</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.sp">sp</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.e">e</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.m">m</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#le">le</a></span> (<span class="id"><a href="compcert.backend.SelectDiv.html#divf">divf</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#a">a</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#b">b</a></span>) <span class="id"><a href="compcert.backend.SelectDivproof.html#v">v</a></span> /\ <span class="id"><a href="compcert.common.Values.html#Val.lessdef">Val.lessdef</a></span> (<span class="id"><a href="compcert.common.Values.html#Val.divf">Val.divf</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#y">y</a></span>) <span class="id"><a href="compcert.backend.SelectDivproof.html#v">v</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2422')">Proof.</div>
<div class="proofscript" id="proof2422">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> <span class="id">y</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.SelectDiv.html#divf">divf</a></span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.backend.SelectDiv.html#divf_match">divf_match</a></span> <span class="id">b</span>); <span class="tactic">intros</span>.<br/>
- <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.SelectDiv.html#divfimm">divfimm</a></span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Floats.html#Float.exact_inverse">Float.exact_inverse</a></span> <span class="id">n2</span>) <span class="kwd">as</span> [<span class="id">n2</span>' | ] <span class="id">eqn</span>:<span class="id">EINV</span>.<br/>
&nbsp;&nbsp;+ <span class="id">inv</span> <span class="id">H0</span>. <span class="id">inv</span> <span class="id">H4</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H6</span>. <span class="id">inv</span> <span class="id">H6</span>. <span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">EvalOp</span>. <span class="id">constructor</span>. <span class="tactic">eauto</span>. <span class="id">constructor</span>. <span class="id">EvalOp</span>. <span class="tactic">simpl</span>; <span class="tactic">eauto</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">x</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>. <span class="id">erewrite</span> <span class="id"><a href="compcert.lib.Floats.html#Float.div_mul_inverse">Float.div_mul_inverse</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;+ <span class="id">TrivialExists</span>.<br/>
- <span class="id">TrivialExists</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">Theorem</span> <span class="id"><a name="eval_divfs">eval_divfs</a></span>:<br/>
&nbsp;&nbsp;<span class="kwd">forall</span> <span class="id">le</span> <span class="id">a</span> <span class="id">b</span> <span class="id">x</span> <span class="id">y</span>,<br/>
&nbsp;&nbsp;<span class="id">eval_expr</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.ge">ge</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.sp">sp</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.e">e</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.m">m</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#le">le</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#a">a</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">eval_expr</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.ge">ge</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.sp">sp</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.e">e</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.m">m</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#le">le</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#b">b</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#y">y</a></span> -&gt;<br/>
&nbsp;&nbsp;<span class="id">exists</span> <span class="id">v</span>, <span class="id">eval_expr</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.ge">ge</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.sp">sp</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.e">e</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS.m">m</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#le">le</a></span> (<span class="id"><a href="compcert.backend.SelectDiv.html#divfs">divfs</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#a">a</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#b">b</a></span>) <span class="id"><a href="compcert.backend.SelectDivproof.html#v">v</a></span> /\ <span class="id"><a href="compcert.common.Values.html#Val.lessdef">Val.lessdef</a></span> (<span class="id"><a href="compcert.common.Values.html#Val.divfs">Val.divfs</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#x">x</a></span> <span class="id"><a href="compcert.backend.SelectDivproof.html#y">y</a></span>) <span class="id"><a href="compcert.backend.SelectDivproof.html#v">v</a></span>.<br/>
<div class="toggleproof" onclick="toggleDisplay('proof2423')">Proof.</div>
<div class="proofscript" id="proof2423">
&nbsp;&nbsp;<span class="tactic">intros</span> <span class="id">until</span> <span class="id">y</span>. <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.SelectDiv.html#divfs">divfs</a></span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.backend.SelectDiv.html#divfs_match">divfs_match</a></span> <span class="id">b</span>); <span class="tactic">intros</span>.<br/>
- <span class="tactic">unfold</span> <span class="id"><a href="compcert.backend.SelectDiv.html#divfsimm">divfsimm</a></span>. <span class="tactic">destruct</span> (<span class="id"><a href="compcert.lib.Floats.html#Float32.exact_inverse">Float32.exact_inverse</a></span> <span class="id">n2</span>) <span class="kwd">as</span> [<span class="id">n2</span>' | ] <span class="id">eqn</span>:<span class="id">EINV</span>.<br/>
&nbsp;&nbsp;+ <span class="id">inv</span> <span class="id">H0</span>. <span class="id">inv</span> <span class="id">H4</span>. <span class="tactic">simpl</span> <span class="kwd">in</span> <span class="id">H6</span>. <span class="id">inv</span> <span class="id">H6</span>. <span class="id">econstructor</span>; <span class="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id">EvalOp</span>. <span class="id">constructor</span>. <span class="tactic">eauto</span>. <span class="id">constructor</span>. <span class="id">EvalOp</span>. <span class="tactic">simpl</span>; <span class="tactic">eauto</span>. <span class="id">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">simpl</span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="tactic">destruct</span> <span class="id">x</span>; <span class="tactic">simpl</span>; <span class="tactic">auto</span>. <span class="id">erewrite</span> <span class="id"><a href="compcert.lib.Floats.html#Float32.div_mul_inverse">Float32.div_mul_inverse</a></span>; <span class="tactic">eauto</span>.<br/>
&nbsp;&nbsp;+ <span class="id">TrivialExists</span>.<br/>
- <span class="id">TrivialExists</span>.<br/>
Qed.</div>
<br/>
<span class="kwd">End</span> <span class="id"><a href="compcert.backend.SelectDivproof.html#CMCONSTRS">CMCONSTRS</a></span>.<br/>

</div>
<div class="footer"><hr/>Generated by <a href="https://github.com/xavierleroy/coq2html/">coq2html</div>
</body>
</html>
